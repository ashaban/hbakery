import{_ as K,s as F,x as o,r as g,a5 as Q,q as R,Y as W,v as q,j as l,$ as w,a0 as $,z as b,P as v,D as d,J as m,E as j,I as u,a6 as X,a2 as Z}from"./index-BWC57mqE.js";import{u as _,r as h}from"./index-Di-IQXeH.js";import{V as ee}from"./VContainer-CSFeTSsk.js";import{V as E}from"./VDialog-C_uX5X1X.js";import{V as D,e as p,d as ae}from"./VCard-BI_548n6.js";import{V as c}from"./VTextField-BUBZtWvQ.js";import{V as C}from"./VAutocomplete-DzvWemcH.js";import{V as te}from"./VDataTable-BT5jeeYE.js";import"./VSelect-B3SmRlp7.js";import"./VChip-CEVDHffS.js";import"./VSlideGroup-DR6QWFvL.js";const le={setup(){const r=W(),a=g(!1),y=g(!1),e=g([]),k=g([]),A=g([]),t=g({}),T=g([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Abbrrev",key:"abbrev"},{title:"Type",key:"type"},{title:"Coverage",key:"coverage"},{title:"Edit",key:"edit"}]),M=g(!1),B=g(!1),I=g(!1),s=Q({name:"",abbrev:"",website:"",type:"",coverage:""}),U=_({name:{required:h},abbrev:{required:h},type:{required:h},coverage:{required:h}},s);function z(i){return!(r.state.auth.role==="contributor"&&r.state.auth.mda!=i)}function V(){y.value=!0,fetch("/mda/getMDA").then(i=>{i.json().then(n=>{y.value=!1,e.value=n}).catch(()=>{y.value=!1})}).catch(()=>{a.value=!1})}function N(){a.value=!0,fetch("/settings/getOrgType").then(i=>{i.json().then(n=>{a.value=!1,k.value=n}).catch(()=>{a.value=!1})}).catch(()=>{a.value=!1})}function S(){U.value.name.$touch(),M.value=!0,s.name="",s.abbrev="",s.website="",s.type="",s.coverage=[]}function O(i){t.value=JSON.parse(JSON.stringify(i)),B.value=!0,s.name=i.name,s.abbrev=i.abbrev,s.website=i.website,s.type=i.typeid,s.coverage=i.coveragesFull}function J(){a.value=!0,fetch("/project/getPossibleCoverage").then(i=>{i.json().then(n=>{a.value=!1,A.value=n}).catch(()=>{a.value=!1})}).catch(()=>{a.value=!1})}function P(){a.value=!0;const i=new FormData;i.append("name",s.name),i.append("abbreviation",s.abbrev),i.append("website",s.website),i.append("type",s.type),i.append("coverage",JSON.stringify(s.coverage)),fetch("/mda/addMDA",{body:i,method:"POST"}).then(n=>{a.value=!1,M.value=!1,n.status!==200&&n.status!==201?n.json().then(f=>{r.commit("setMessage",{type:"error",text:"Failed to save MDA! "+f.error,timeout:2e3})}):n.json().then(()=>{V(),r.commit("setMessage",{type:"primary",text:"MDA saved successfully!",timeout:2e3})})}).catch(n=>{a.value=!1,r.commit("setMessage",{type:"error",text:"Failed to save MDA!",timeout:2e3}),console.error("Error:",n)})}function L(){a.value=!0;const i=new FormData;i.append("name",s.name),i.append("abbreviation",s.abbrev),i.append("website",s.website),i.append("type",s.type),i.append("coverage",JSON.stringify(s.coverage)),fetch("/mda/editMDA/"+t.value.id,{body:i,method:"POST"}).then(n=>{a.value=!1,B.value=!1,n.status!==200&&n.status!==201?n.json().then(f=>{r.commit("setMessage",{type:"error",text:"Failed to edit MDA! "+f.error,timeout:2e3})}):n.json().then(()=>{V(),r.commit("setMessage",{type:"primary",text:"MDA edited successfully!",timeout:2e3})})}).catch(n=>{a.value=!1,r.commit("setMessage",{type:"error",text:"Failed to edit MDA!",timeout:2e3}),console.error("Error:",n)})}function Y(){a.value=!0;const i=new FormData;I.value=!1,fetch("/mda/deleteMDA/"+t.value.id,{body:i,method:"DELETE"}).then(n=>{a.value=!1,B.value=!1,n.status!==200&&n.status!==201?n.json().then(f=>{r.commit("setMessage",{type:"error",text:"Failed to delete MDA! "+f.error,timeout:2e3})}):n.json().then(()=>{V(),r.commit("setMessage",{type:"primary",text:"MDA delete successfully!",timeout:2e3})})}).catch(n=>{a.value=!1,r.commit("setMessage",{type:"error",text:"Failed to delete MDA!",timeout:2e3}),console.error("Error:",n)})}function G(){fetch("/mda/csvExport").then(i=>{i.text().then(n=>{const f="csv",H="data:text/csv;charset=utf-8,"+escape(n),x=document.createElement("a");x.setAttribute("href",H),x.setAttribute("download",`MDA.${f}`),x.click()})}).catch(()=>{a.value=!1})}return R(()=>{V(),N(),J()}),{loading:a,loadingValues:y,values:e,headers:T,addDialog:M,editDialog:B,state:s,v$:U,editingItem:t,confirmDeleteDialog:I,types:k,coverages:A,canEdit:z,loadValues:V,activateAddDialog:S,activateEditDialog:O,create:P,saveEdit:L,remove:Y,csvExport:G}}},oe={class:"d-flex align-center"},re={class:"d-flex justify-end"},ie={class:"d-flex align-center"},ne={class:"d-flex justify-end justify-space-between"};function se(r,a,y,e,k,A){return q(),F(ee,{fluid:""},{default:o(()=>[l(E,{modelValue:e.addDialog,"onUpdate:modelValue":a[6]||(a[6]=t=>e.addDialog=t),"max-width":"800",transition:"dialog-top-transition"},{default:o(()=>[l(D,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[l(w,{class:"rounded-lg flex-wrap",color:"primary",flat:""},{default:o(()=>[l($,{class:"text-white font-weight-bold text-wrap"},{default:o(()=>[b("div",oe,[l(v,{class:"mr-2"},{default:o(()=>a[20]||(a[20]=[d("mdi-office-building-cog")])),_:1}),b("span",null,m(r.$t("addMDA")),1)])]),_:1}),l(j),l(u,{color:"white",icon:"mdi-close",onClick:a[0]||(a[0]=t=>e.addDialog=!1)})]),_:1}),l(D,{class:"d-flex flex-column","max-height":"100%"},{default:o(()=>[l(p,{class:"pt-6",style:{"overflow-y":"auto","max-height":"100%"}},{default:o(()=>[l(c,{modelValue:e.state.name,"onUpdate:modelValue":a[1]||(a[1]=t=>e.state.name=t),"bg-color":"#BDBDBD","error-messages":e.v$.name.$errors.map(t=>t.$message),label:r.$t("mdaName"),required:"",onBlur:e.v$.name.$touch,onInput:e.v$.name.$touch},null,8,["modelValue","error-messages","label","onBlur","onInput"]),l(c,{modelValue:e.state.abbrev,"onUpdate:modelValue":a[2]||(a[2]=t=>e.state.abbrev=t),"bg-color":"#BDBDBD","error-messages":e.v$.abbrev.$errors.map(t=>t.$message),label:r.$t("mdaAbbreviation"),required:"",onBlur:e.v$.abbrev.$touch,onInput:e.v$.abbrev.$touch},null,8,["modelValue","error-messages","label","onBlur","onInput"]),l(c,{modelValue:e.state.website,"onUpdate:modelValue":a[3]||(a[3]=t=>e.state.website=t),"bg-color":"#BDBDBD",label:r.$t("website")},null,8,["modelValue","label"]),l(C,{modelValue:e.state.type,"onUpdate:modelValue":a[4]||(a[4]=t=>e.state.type=t),"bg-color":"#BDBDBD","error-messages":e.v$.type.$errors.map(t=>t.$message),"item-title":"name","item-value":"id",items:e.types,label:r.$t("organizationType"),required:"",onBlur:e.v$.type.$touch,onChange:e.v$.type.$touch},null,8,["modelValue","error-messages","items","label","onBlur","onChange"]),l(C,{modelValue:e.state.coverage,"onUpdate:modelValue":a[5]||(a[5]=t=>e.state.coverage=t),"bg-color":"#BDBDBD","error-messages":e.v$.coverage.$errors.map(t=>t.$message),"item-title":"name","item-value":"id",items:e.coverages,label:r.$t("organizationCoverage"),multiple:"",required:"","return-object":"",onBlur:e.v$.coverage.$touch,onChange:e.v$.coverage.$touch},null,8,["modelValue","error-messages","items","label","onBlur","onChange"])]),_:1}),b("div",re,[l(u,{color:"success",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:e.create},{default:o(()=>[l(v,{start:""},{default:o(()=>a[21]||(a[21]=[d("mdi-plus")])),_:1}),d(" "+m(r.$t("add")),1)]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(E,{modelValue:e.editDialog,"onUpdate:modelValue":a[16]||(a[16]=t=>e.editDialog=t),"max-width":"800",transition:"dialog-top-transition"},{default:o(()=>[l(D,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[l(w,{class:"rounded-lg flex-wrap",color:"primary",flat:""},{default:o(()=>[l($,{class:"text-white font-weight-bold text-wrap"},{default:o(()=>[b("div",ie,[l(v,{class:"mr-2"},{default:o(()=>a[22]||(a[22]=[d("mdi-office-building-cog")])),_:1}),b("span",null,m(r.$t("editMDA")),1)])]),_:1}),l(j),l(u,{color:"white",icon:"mdi-close",onClick:a[7]||(a[7]=t=>e.editDialog=!1)})]),_:1}),l(D,{class:"d-flex flex-column","max-height":"100%"},{default:o(()=>[l(p,{class:"pt-6",style:{"overflow-y":"auto","max-height":"100%"}}),l(p,null,{default:o(()=>[l(c,{modelValue:e.editingItem.id,"onUpdate:modelValue":a[8]||(a[8]=t=>e.editingItem.id=t),"bg-color":"#BDBDBD",label:r.$t("id"),readonly:""},null,8,["modelValue","label"]),l(c,{modelValue:e.state.name,"onUpdate:modelValue":a[9]||(a[9]=t=>e.state.name=t),"bg-color":"#BDBDBD","error-messages":e.v$.name.$errors.map(t=>t.$message),label:r.$t("mdaName"),required:"",onBlur:e.v$.name.$touch,onInput:e.v$.name.$touch},null,8,["modelValue","error-messages","label","onBlur","onInput"]),l(c,{modelValue:e.state.abbrev,"onUpdate:modelValue":a[10]||(a[10]=t=>e.state.abbrev=t),"bg-color":"#BDBDBD","error-messages":e.v$.abbrev.$errors.map(t=>t.$message),label:r.$t("mdaAbbreviation"),required:"",onBlur:e.v$.abbrev.$touch,onInput:e.v$.abbrev.$touch},null,8,["modelValue","error-messages","label","onBlur","onInput"]),l(c,{modelValue:e.state.website,"onUpdate:modelValue":a[11]||(a[11]=t=>e.state.website=t),"bg-color":"#BDBDBD",label:r.$t("website")},null,8,["modelValue","label"]),l(C,{modelValue:e.state.type,"onUpdate:modelValue":a[12]||(a[12]=t=>e.state.type=t),"bg-color":"#BDBDBD","error-messages":e.v$.type.$errors.map(t=>t.$message),"item-title":"name","item-value":"id",items:e.types,label:r.$t("organizationType"),required:"",onBlur:e.v$.type.$touch,onChange:e.v$.type.$touch},null,8,["modelValue","error-messages","items","label","onBlur","onChange"]),l(C,{modelValue:e.state.coverage,"onUpdate:modelValue":a[13]||(a[13]=t=>e.state.coverage=t),"bg-color":"#BDBDBD","error-messages":e.v$.coverage.$errors.map(t=>t.$message),"item-title":"name","item-value":"id",items:e.coverages,label:r.$t("organizationCoverage"),multiple:"",required:"","return-object":"",onBlur:e.v$.coverage.$touch,onChange:e.v$.coverage.$touch},null,8,["modelValue","error-messages","items","label","onBlur","onChange"])]),_:1}),l(ae,{class:"d-flex justify-end justify-space-between"},{default:o(()=>[l(u,{color:"success",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:e.saveEdit},{default:o(()=>[l(v,{start:""},{default:o(()=>a[23]||(a[23]=[d("mdi-plus")])),_:1}),d(" "+m(r.$t("save")),1)]),_:1},8,["disabled","loading","onClick"]),l(u,{color:"black",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:a[14]||(a[14]=t=>e.editDialog=!1)},{default:o(()=>[l(v,{start:""},{default:o(()=>a[24]||(a[24]=[d("mdi-cancel")])),_:1}),d(" "+m(r.$t("cancel")),1)]),_:1},8,["disabled","loading"]),l(u,{color:"error",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:a[15]||(a[15]=t=>e.confirmDeleteDialog=!0)},{default:o(()=>[l(v,{start:""},{default:o(()=>a[25]||(a[25]=[d("mdi-delete")])),_:1}),d(" "+m(r.$t("delete")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(E,{modelValue:e.confirmDeleteDialog,"onUpdate:modelValue":a[19]||(a[19]=t=>e.confirmDeleteDialog=t),persistent:"",width:"auto"},{default:o(()=>[l(D,null,{default:o(()=>[l(w,{color:"warning",title:r.$t("confirmDeleting")+" "+e.state.name},{default:o(()=>[l(u,{color:"white",icon:"mdi-close",onClick:a[17]||(a[17]=t=>e.confirmDeleteDialog=!1)})]),_:1},8,["title"]),l(p,null,{default:o(()=>[d(m(r.$t("confirmDeleteMessage",{name:e.state.name})),1)]),_:1}),b("div",ne,[l(u,{color:"success",onClick:a[18]||(a[18]=t=>e.confirmDeleteDialog=!1)},{default:o(()=>[d(m(r.$t("cancel")),1)]),_:1}),l(u,{color:"error",onClick:e.remove},{default:o(()=>[d(m(r.$t("proceed")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),l(w,{class:"rounded-lg mb-2 px-4",color:"primary",flat:"",height:"60"},{default:o(()=>[l($,{class:"text-white font-weight-bold text-h6"},{default:o(()=>[l(v,{class:"mr-2",color:"white"},{default:o(()=>a[26]||(a[26]=[d("mdi-office-building-cog")])),_:1}),d(" "+m(r.$t("ministryDepartmentsAgencies")),1)]),_:1}),l(j),l(u,{class:"font-weight-medium mr-2",color:"white",size:"small",onClick:e.csvExport},{default:o(()=>[l(v,{color:"white",start:""},{default:o(()=>a[27]||(a[27]=[d("mdi-download")])),_:1}),d(" "+m(r.$t("download")),1)]),_:1},8,["onClick"]),l(u,{class:"text-white font-weight-medium",color:"#1A237E",size:"small",onClick:e.activateAddDialog},{default:o(()=>[l(v,{start:""},{default:o(()=>a[28]||(a[28]=[d("mdi-plus")])),_:1}),d(" "+m(r.$t("addMDA")),1)]),_:1},8,["onClick"])]),_:1}),l(D,{class:"rounded-lg"},{default:o(()=>[l(p,null,{default:o(()=>[l(X,{active:e.loadingValues,indeterminate:e.loadingValues},null,8,["active","indeterminate"]),l(te,{class:"elevation-1",dense:"",headers:e.headers,height:"300",items:e.values},{"item.coverage":o(({item:t})=>[d(m(t.coverages.join(", ")),1)]),"item.edit":o(({item:t})=>[e.canEdit(t.id)?(q(),F(v,{key:0,color:"#3F51B5",onClick:T=>e.activateEditDialog(t)},{default:o(()=>a[29]||(a[29]=[d(" mdi-square-edit-outline ")])),_:2},1032,["onClick"])):Z("",!0)]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})}const we=K(le,[["render",se]]);export{we as default};
