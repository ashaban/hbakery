import{_ as W,Z as X,s as _,v as C,x as l,j as o,z as s,$ as j,P as f,D as r,E as T,I as m,a1 as U,F as x,a2 as k,J as y,a6 as $,Y as ee,r as c,a5 as te,q as oe}from"./index-BWC57mqE.js";import{u as le,r as q}from"./index-Di-IQXeH.js";import{u as ne}from"./projectHierarchy-DKVIpnYt.js";import{V as h}from"./VDialog-C_uX5X1X.js";import{V as F,e as A,d as ae}from"./VCard-BI_548n6.js";import{V as O}from"./VForm-DLSdHKgA.js";import{V as I}from"./VTextField-BUBZtWvQ.js";import{V as J}from"./VChip-CEVDHffS.js";import{V as ie}from"./VDataTable-BT5jeeYE.js";import{V as re}from"./VContainer-CSFeTSsk.js";import"./VSlideGroup-DR6QWFvL.js";import"./VSelect-B3SmRlp7.js";const de={setup(){const u=ee(),e=c(!1),S=c([]),t=c({}),p=c(""),{getHierarchyAsync:w,loadChildren:D,hierarchies:n}=ne(),M=c([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Component",key:"component"},{title:"Edit",key:"edit"}]),B=c(!1),V=c(!1),z=c(!1),H=c(!1),d=te({name:"",component:[],componentname:""}),N=le({name:{required:q},component:{required:q}},d);function b(){e.value=!0,fetch("/settings/getSubComponent").then(i=>{i.json().then(a=>{e.value=!1,S.value=a}).catch(()=>{e.value=!1})}).catch(()=>{e.value=!1})}function L(){N.value.name.$touch(),B.value=!0,d.name="",d.component=[]}function Y(i){t.value=JSON.parse(JSON.stringify(i)),V.value=!0,d.name=i.name,d.component.push("component-"+i.componentid),d.componentname=i.component}function Z(){if(!d.component.length){p.value="Please select a component";return}e.value=!0,B.value=!1;const i=new FormData;i.append("name",d.name),i.append("component",d.component[0].split("-")[1]),fetch("/settings/addSubComponent",{body:i,method:"POST"}).then(a=>{e.value=!1,a.status!==200&&a.status!==201?a.json().then(v=>{u.commit("setMessage",{type:"error",text:"Failed to save SubComponent! "+v.error,timeout:2e3})}):a.json().then(()=>{b(),u.commit("setMessage",{type:"primary",text:"SubComponent saved successfully!",timeout:2e3})})}).catch(a=>{e.value=!1,u.commit("setMessage",{type:"error",text:"Failed to save SubComponent!",timeout:2e3}),console.error("Error:",a)})}function G(){if(!d.component.length){p.value="Please select a component";return}e.value=!0;const i=new FormData;i.append("name",d.name),i.append("component",d.component[0].split("-")[1]),fetch("/settings/editSubComponent/"+t.value.id,{body:i,method:"POST"}).then(a=>{e.value=!1,V.value=!1,a.status!==200&&a.status!==201?a.json().then(v=>{u.commit("setMessage",{type:"error",text:"Failed to edit SubComponent! "+v.error,timeout:2e3})}):a.json().then(()=>{b(),u.commit("setMessage",{type:"primary",text:"SubComponent edited successfully!",timeout:2e3})})}).catch(a=>{e.value=!1,u.commit("setMessage",{type:"error",text:"Failed to edit SubComponent!",timeout:2e3}),console.error("Error:",a)})}function K(){e.value=!0;const i=new FormData;z.value=!1,fetch("/settings/deleteSubComponent/"+t.value.id,{body:i,method:"DELETE"}).then(a=>{e.value=!1,V.value=!1,a.status!==200&&a.status!==201?a.json().then(v=>{u.commit("setMessage",{type:"error",text:"Failed to delete SubComponent! "+v.error,timeout:2e3})}):a.json().then(()=>{b(),u.commit("setMessage",{type:"primary",text:"SubComponent delete successfully!",timeout:2e3})})}).catch(a=>{e.value=!1,u.commit("setMessage",{type:"error",text:"Failed to delete SubComponent!",timeout:2e3}),console.error("Error:",a)})}function Q(i){const P=n.value.find(g=>g.id===i.path[0]).children.find(g=>g.id===i.path[1]).children.find(g=>g.id===i.path[2]);i.value?(d.componentname=P.name,p.value=""):(d.componentname="",p.value="Component is required")}function R(){fetch("/settings/getSubComponent?response=csv").then(i=>{i.text().then(a=>{const v="csv",g="data:text/csv;charset=utf-8,"+escape(a),E=document.createElement("a");E.setAttribute("href",g),E.setAttribute("download",`SubComponent.${v}`),E.click()})}).catch(()=>{e.value=!1})}return oe(()=>{b(),w("component")}),{loading:e,values:S,headers:M,addDialog:B,editDialog:V,form:H,state:d,v$:N,editingItem:t,confirmDeleteDialog:z,hierarchies:n,componenterrors:p,getHierarchyAsync:w,loadChildren:D,csvExport:R,loadValues:b,activateAddDialog:L,activateEditDialog:Y,create:Z,saveEdit:G,remove:K,componentSelected:Q}}},se={class:"d-flex align-center flex-wrap"},me={key:0,style:{color:"red"}},ue={key:1,class:"mt-4"},fe={class:"d-flex justify-end"},ce={class:"d-flex align-center flex-wrap"},ve={key:0,style:{color:"red"}},ge={key:1,class:"mt-4"},pe={class:"d-flex justify-end justify-space-between"},be={class:"d-flex justify-space-between mb-6"};function Ce(u,e,S,t,p,w){const D=X("v-treeview");return C(),_(re,{fluid:""},{default:l(()=>[o(h,{modelValue:t.addDialog,"onUpdate:modelValue":e[4]||(e[4]=n=>t.addDialog=n),transition:"dialog-top-transition",width:"auto"},{default:l(()=>[o(F,{class:"rounded-xl pa-4",elevation:"10"},{default:l(()=>[o(j,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:l(()=>[s("div",se,[o(f,{class:"mr-2 text-white"},{default:l(()=>e[16]||(e[16]=[r("mdi-cube-scan")])),_:1}),e[17]||(e[17]=s("span",{class:"text-white font-weight-bold text-h6"},"Add Sub-Component",-1))]),o(T),o(m,{color:"white",icon:"mdi-close",onClick:e[0]||(e[0]=n=>t.addDialog=!1)})]),_:1}),o(A,{class:"pt-6"},{default:l(()=>[o(O,{onSubmit:e[3]||(e[3]=U(()=>{},["prevent"]))},{default:l(()=>[o(I,{modelValue:t.state.name,"onUpdate:modelValue":e[1]||(e[1]=n=>t.state.name=n),"bg-color":"#BDBDBD","error-messages":t.v$.name.$errors.map(n=>n.$message),label:"Sub-Component Name*",required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),e[21]||(e[21]=s("br",null,null,-1)),e[22]||(e[22]=r(" Select Component*: ")),t.componenterrors?(C(),x("div",me,y(t.componenterrors),1)):k("",!0),t.state.component.length?(C(),x("div",ue,[e[18]||(e[18]=s("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Selected Component:",-1)),o(J,{color:"green",size:"large","text-color":"white",variant:"elevated"},{default:l(()=>[r(y(t.state.componentname),1)]),_:1})])):k("",!0),o(D,{modelValue:t.state.component,"onUpdate:modelValue":e[2]||(e[2]=n=>t.state.component=n),border:"",color:"primary",density:"compact",fluid:"","item-title":"name","item-value":"id",items:t.hierarchies,"load-children":t.loadChildren,"open-on-click":"",rounded:"",selectable:"","onClick:select":t.componentSelected},null,8,["modelValue","items","load-children","onClick:select"]),s("div",fe,[o(m,{color:"success",disabled:t.v$.$error||t.state.component.length===0,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.create},{default:l(()=>[o(f,{start:""},{default:l(()=>e[19]||(e[19]=[r("mdi-plus")])),_:1}),e[20]||(e[20]=r(" Add "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(h,{modelValue:t.editDialog,"onUpdate:modelValue":e[12]||(e[12]=n=>t.editDialog=n),transition:"dialog-top-transition",width:"auto"},{default:l(()=>[o(F,{class:"rounded-xl pa-4",elevation:"10"},{default:l(()=>[o(j,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:l(()=>[s("div",ce,[o(f,{class:"mr-2 text-white"},{default:l(()=>e[23]||(e[23]=[r("mdi-cube-scan")])),_:1}),e[24]||(e[24]=s("span",{class:"text-white font-weight-bold text-h6"},"Edit Sub-Component",-1))]),o(T),o(m,{color:"white",icon:"mdi-close",onClick:e[5]||(e[5]=n=>t.editDialog=!1)})]),_:1}),o(A,{class:"pt-6"},{default:l(()=>[o(O,{onSubmit:e[9]||(e[9]=U(()=>{},["prevent"]))},{default:l(()=>[o(I,{modelValue:t.editingItem.id,"onUpdate:modelValue":e[6]||(e[6]=n=>t.editingItem.id=n),"bg-color":"#BDBDBD",label:"ID",readonly:""},null,8,["modelValue"]),o(I,{modelValue:t.state.name,"onUpdate:modelValue":e[7]||(e[7]=n=>t.state.name=n),"bg-color":"#BDBDBD",clearable:"","error-messages":t.v$.name.$errors.map(n=>n.$message),label:"SubComponent",readonly:t.loading,required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","readonly","onBlur","onInput"]),e[26]||(e[26]=s("br",null,null,-1)),e[27]||(e[27]=r(" Select Component*: ")),t.componenterrors?(C(),x("div",ve,y(t.componenterrors),1)):k("",!0),t.state.component.length?(C(),x("div",ge,[e[25]||(e[25]=s("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Selected Component:",-1)),o(J,{color:"green",size:"small","text-color":"white",variant:"elevated"},{default:l(()=>[r(y(t.state.componentname),1)]),_:1})])):k("",!0),o(D,{modelValue:t.state.component,"onUpdate:modelValue":e[8]||(e[8]=n=>t.state.component=n),border:"",color:"primary",fluid:"","item-title":"name","item-value":"id",items:t.hierarchies,"load-children":t.loadChildren,"open-on-click":"",rounded:"",selectable:"","onClick:select":t.componentSelected},null,8,["modelValue","items","load-children","onClick:select"])]),_:1})]),_:1}),o(ae,{class:"d-flex justify-end justify-space-between"},{default:l(()=>[o(m,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.saveEdit},{default:l(()=>[o(f,{start:""},{default:l(()=>e[28]||(e[28]=[r("mdi-plus")])),_:1}),e[29]||(e[29]=r(" Save "))]),_:1},8,["disabled","loading","onClick"]),o(m,{color:"black",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[10]||(e[10]=n=>t.editDialog=!1)},{default:l(()=>[o(f,{start:""},{default:l(()=>e[30]||(e[30]=[r("mdi-cancel")])),_:1}),e[31]||(e[31]=r(" Cancel "))]),_:1},8,["disabled","loading"]),o(m,{color:"error",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[11]||(e[11]=n=>t.confirmDeleteDialog=!0)},{default:l(()=>[o(f,{start:""},{default:l(()=>e[32]||(e[32]=[r("mdi-delete")])),_:1}),e[33]||(e[33]=r(" Delete "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(h,{modelValue:t.confirmDeleteDialog,"onUpdate:modelValue":e[15]||(e[15]=n=>t.confirmDeleteDialog=n),persistent:"",width:"auto"},{default:l(()=>[o(F,null,{default:l(()=>[o(j,{color:"warning",title:"Confirm Deleteting "+t.state.name},{default:l(()=>[o(m,{color:"white",icon:"mdi-close",onClick:e[13]||(e[13]=n=>t.confirmDeleteDialog=!1)})]),_:1},8,["title"]),o(A,null,{default:l(()=>[r("Are you sure you want to delete "+y(t.state.name)+"?",1)]),_:1}),s("div",pe,[o(m,{color:"success",onClick:e[14]||(e[14]=n=>t.confirmDeleteDialog=!1)},{default:l(()=>e[34]||(e[34]=[r("Cancel")])),_:1}),o(m,{color:"error",onClick:t.remove},{default:l(()=>e[35]||(e[35]=[r("Proceed")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),s("div",be,[e[40]||(e[40]=r(" SubComponent ")),o(m,{class:"text-black justify-end",size:"small",onClick:t.csvExport},{default:l(()=>[o(f,{color:"green",start:""},{default:l(()=>e[36]||(e[36]=[r("mdi-download")])),_:1}),e[37]||(e[37]=r(" Download "))]),_:1},8,["onClick"]),o(m,{class:"text-white justify-end",color:"#1A237E",size:"small",onClick:t.activateAddDialog},{default:l(()=>[o(f,null,{default:l(()=>e[38]||(e[38]=[r("mdi-plus")])),_:1}),e[39]||(e[39]=r(" Add New"))]),_:1},8,["onClick"])]),o($,{active:t.loading,indeterminate:t.loading},null,8,["active","indeterminate"]),o(ie,{class:"elevation-1",dense:"",headers:t.headers,height:"300",items:t.values,loading:t.loading},{"item.edit":l(({item:n})=>[o(f,{color:"#3F51B5",onClick:M=>t.activateEditDialog(n)},{default:l(()=>e[41]||(e[41]=[r("mdi-square-edit-outline")])),_:2},1032,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1})}const Ie=W(de,[["render",Ce]]);export{Ie as default};
