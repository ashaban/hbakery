import{_ as ae,s as ne,x as l,r as c,a5 as re,q as ie,Y as se,Z as P,v as h,j as o,$ as U,z as f,P as y,D as d,J as u,E as N,I as v,Q as T,F as p,a2 as $,a3 as de,G as ue,H as me,a0 as A,a6 as ce}from"./index-BWC57mqE.js";import{c as R,r as D,u as fe}from"./index-Di-IQXeH.js";import{Q as ve}from"./vue-datepicker-C-oP6zBP.js";import{V as ge}from"./VContainer-CSFeTSsk.js";import{V as O}from"./VDialog-C_uX5X1X.js";import{V as M,e as S,d as H}from"./VCard-BI_548n6.js";import{V as q}from"./VForm-DLSdHKgA.js";import{V as m}from"./VCol-DWZn5MAN.js";import{V}from"./VTextField-BUBZtWvQ.js";import{V as J}from"./VChip-CEVDHffS.js";import{V as _}from"./VAutocomplete-DzvWemcH.js";import{V as ye}from"./VDataTable-BT5jeeYE.js";import"./VSlideGroup-DR6QWFvL.js";import"./VSelect-B3SmRlp7.js";const we={components:{VueDatePicker:ve},setup(){const r=se(),t=c(!1),C=c(!1),e=c([]),j=c([]),x=c(""),b=c([]),w=c({}),n=c([{title:"ID",key:"id"},{title:"Industry",key:"industry"},{title:"Location",key:"locationname"},{title:"Value (Million USD)",key:"value"},{title:"Year started/ reopened",key:"year"},{title:"Owned By",key:"owner"},{title:"Owner Name",key:"ownername"},{title:"Edit",key:"edit"}]),B=c(!1),E=c(!1),z=c(!1),Q=R.withMessage("Must be a valid number",a=>a==null||a===""?!0:!isNaN(Number(a))),i=re({industry:"",location:[],locationname:"",value:"",year:"",owner:"",ownername:""}),Y={industry:{required:D},value:{required:D,isNumber:Q},year:{required:D},owner:{required:D},location:{required:R.withMessage("Please select location",D)}},G=fe(Y,i),k=()=>{C.value=!0,fetch("/construction/getConstruction").then(a=>a.json()).then(a=>{C.value=!1,e.value=a}).catch(()=>{C.value=!1})},L=()=>{t.value=!0,fetch("/settings/getOwner").then(a=>a.json()).then(a=>{t.value=!1,j.value=a}).catch(()=>{t.value=!1})},Z=()=>{t.value=!0,fetch("/adminLevels/getAdminHierarchy").then(a=>a.json()).then(a=>{t.value=!1,b.value=a}).catch(()=>{t.value=!1})},K=()=>{B.value=!0,i.industry="",i.location="",i.value="",i.year="",i.owner="",i.ownername=""},W=a=>{w.value=JSON.parse(JSON.stringify(a)),E.value=!0,i.industry=a.industry,i.location=[a.locationtype+"-"+a.locationid],i.locationname=a.locationname,i.value=a.value,i.year=a.year,i.owner=a.ownerid,i.ownername=a.ownername},X=()=>{t.value=!0;const a=new FormData;a.append("industry",i.industry),a.append("location",i.location[0].split("-")[1]),a.append("locationtype",i.location[0].split("-")[0]),a.append("value",i.value),a.append("year",i.year),a.append("owner",i.owner),a.append("ownername",i.ownername),fetch("/construction/addConstruction",{method:"POST",body:a}).then(s=>(t.value=!1,B.value=!1,[200,201].includes(s.status)?s.json().then(()=>{k(),r.commit("setMessage",{type:"primary",text:"Construction saved successfully!",timeout:2e3})}):s.json().then(g=>{r.commit("setMessage",{type:"error",text:"Failed to save Construction! "+g.error,timeout:2e3})}))).catch(s=>{t.value=!1,r.commit("setMessage",{type:"error",text:"Failed to save Construction!",timeout:2e3}),console.error("Error:",s)})},ee=()=>{console.log(JSON.stringify(i,0,2)),t.value=!0;const a=new FormData;a.append("industry",i.industry),a.append("location",i.location[0].split("-")[1]),a.append("locationtype",i.location[0].split("-")[0]),a.append("value",i.value),a.append("year",i.year),a.append("owner",i.owner),a.append("ownername",i.ownername),fetch("/construction/editConstruction/"+w.value.id,{method:"POST",body:a}).then(s=>(t.value=!1,E.value=!1,[200,201].includes(s.status)?s.json().then(()=>{k(),r.commit("setMessage",{type:"primary",text:"Construction edited successfully!",timeout:2e3})}):s.json().then(g=>{r.commit("setMessage",{type:"error",text:"Failed to edit Construction! "+g.error,timeout:2e3})}))).catch(s=>{t.value=!1,r.commit("setMessage",{type:"error",text:"Failed to edit Construction!",timeout:2e3}),console.error("Error:",s)})},te=()=>{t.value=!0;const a=new FormData;z.value=!1,fetch("/construction/deleteConstruction/"+w.value.id,{method:"DELETE",body:a}).then(s=>(t.value=!1,E.value=!1,[200,201].includes(s.status)?s.json().then(()=>{k(),r.commit("setMessage",{type:"primary",text:"Construction deleted successfully!",timeout:2e3})}):s.json().then(g=>{r.commit("setMessage",{type:"error",text:"Failed to delete Construction! "+g.error,timeout:2e3})}))).catch(s=>{t.value=!1,r.commit("setMessage",{type:"error",text:"Failed to delete Construction!",timeout:2e3}),console.error("Error:",s)})};function oe(a){let s=b.value.find(g=>g.id===a.path[0]);if(a.path.shift(),a.path.length)for(const g of a.path)s=s.children.find(F=>F.id===g);a.value?(i.locationname=s.name,x.value=""):(i.locationname="",x.value="Location is required")}const le=()=>{fetch("/construction/csvExport").then(a=>a.text()).then(a=>{const s="csv",F="data:text/csv;charset=utf-8,"+escape(a),I=document.createElement("a");I.setAttribute("href",F),I.setAttribute("download",`Construction/Rehabilitation.${s}`),I.click()}).catch(()=>{t.value=!1})};return ie(()=>{k(),L(),Z()}),{store:r,loading:t,loadingValues:C,values:e,owners:j,editingItem:w,headers:n,addDialog:B,editDialog:E,confirmDeleteDialog:z,state:i,v$:G,loadValues:k,loadOwners:L,activateAddDialog:K,activateEditDialog:W,create:X,saveEdit:ee,remove:te,csvExport:le,adminHierarchy:b,locationSelected:oe,locationerrors:x}}},he={class:"d-flex align-center flex-wrap"},be={class:"text-white font-weight-bold text-h6"},pe={class:"text-subtitle-2 font-weight-medium mb-1"},Ve={key:0,class:"error-messages"},Ce={key:1,class:"mt-4"},ke={class:"text-subtitle-1 font-weight-medium mb-2"},De={class:"text-subtitle-2 font-weight-medium mb-1"},xe={class:"d-flex align-center"},Be={class:"text-subtitle-2 font-weight-medium mb-1"},Ee={key:0,style:{color:"red"}},Ue={key:1,class:"mt-4"},$e={class:"text-subtitle-1 font-weight-medium mb-2"},Me={class:"text-subtitle-2 font-weight-medium mb-1"},Se={class:"d-flex justify-end justify-space-between"};function je(r,t,C,e,j,x){const b=P("v-treeview"),w=P("VueDatePicker");return h(),ne(ge,{fluid:""},{default:l(()=>[o(O,{modelValue:e.addDialog,"onUpdate:modelValue":t[8]||(t[8]=n=>e.addDialog=n),"max-width":"800",transition:"dialog-top-transition",width:"auto"},{default:l(()=>[o(M,{class:"rounded-xl pa-4",elevation:"10"},{default:l(()=>[o(U,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:l(()=>[f("div",he,[o(y,{class:"mr-2 text-white"},{default:l(()=>t[22]||(t[22]=[d("mdi-domain")])),_:1}),f("span",be,u(r.$t("addConstructionRehabilitation")),1)]),o(N),o(v,{color:"white",icon:"mdi-close",onClick:t[0]||(t[0]=n=>e.addDialog=!1)})]),_:1}),o(S,{class:"pt-6"},{default:l(()=>[o(q,null,{default:l(()=>[o(T,{dense:""},{default:l(()=>[o(m,{cols:"12"},{default:l(()=>[o(V,{modelValue:e.state.industry,"onUpdate:modelValue":t[1]||(t[1]=n=>e.state.industry=n),"bg-color":"grey-lighten-3",clearable:"","error-messages":e.v$.industry.$errors.map(n=>n.$message),label:r.$t("industry"),onBlur:e.v$.industry.$touch,onInput:e.v$.industry.$touch},null,8,["modelValue","error-messages","label","onBlur","onInput"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[f("label",pe,u(r.$t("selectLocation")),1),o(b,{modelValue:e.state.location,"onUpdate:modelValue":[t[2]||(t[2]=n=>e.state.location=n),t[3]||(t[3]=n=>e.v$.location.$touch())],border:"",class:de({"error-border":e.v$.location.$error}),color:"primary",fluid:"","item-title":"name","item-value":"id",items:e.adminHierarchy,"open-on-click":"",rounded:"","select-strategy":"single-independent",selectable:"","onClick:select":e.locationSelected},null,8,["modelValue","class","items","onClick:select"]),e.v$.location.$error?(h(),p("div",Ve,[(h(!0),p(ue,null,me(e.v$.location.$errors,n=>(h(),p("div",{key:n.$uid},u(n.$message),1))),128))])):$("",!0),e.state.location.length?(h(),p("div",Ce,[f("div",ke,u(r.$t("selectedLocation"))+":",1),o(J,{color:"green",size:"small","text-color":"white",variant:"elevated"},{default:l(()=>[d(u(e.state.locationname),1)]),_:1})])):$("",!0)]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(V,{modelValue:e.state.value,"onUpdate:modelValue":t[4]||(t[4]=n=>e.state.value=n),"bg-color":"grey-lighten-3",clearable:"","error-messages":e.v$.value.$errors.map(n=>n.$message),label:r.$t("valueMillionUSD"),placeholder:r.$t("valuePlaceholder"),"prepend-inner-icon":"mdi-currency-usd",type:"number",onBlur:e.v$.value.$touch,onInput:e.v$.value.$touch},null,8,["modelValue","error-messages","label","placeholder","onBlur","onInput"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[f("label",De,u(r.$t("yearStartedReopened")),1),o(w,{modelValue:e.state.year,"onUpdate:modelValue":t[5]||(t[5]=n=>e.state.year=n),placeholder:r.$t("year"),"text-input":"","year-picker":""},null,8,["modelValue","placeholder"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(_,{modelValue:e.state.owner,"onUpdate:modelValue":t[6]||(t[6]=n=>e.state.owner=n),"bg-color":"grey-lighten-3",clearable:"","error-messages":e.v$.owner.$errors.map(n=>n.$message),"item-title":"name","item-value":"id",items:e.owners,label:r.$t("ownedBy"),placeholder:r.$t("selectOwner"),"prepend-inner-icon":"mdi-account",onBlur:e.v$.owner.$touch,onChange:e.v$.owner.$touch},null,8,["modelValue","error-messages","items","label","placeholder","onBlur","onChange"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(V,{modelValue:e.state.ownername,"onUpdate:modelValue":t[7]||(t[7]=n=>e.state.ownername=n),"bg-color":"grey-lighten-3",clearable:"",label:r.$t("ownerName"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),o(H,{class:"d-flex justify-end"},{default:l(()=>[o(v,{class:"text-white",color:"success",disabled:e.v$.$error,loading:e.loading,size:"large",variant:"elevated",onClick:e.create},{default:l(()=>[o(y,{start:""},{default:l(()=>t[23]||(t[23]=[d("mdi-content-save")])),_:1}),d(" "+u(r.$t("save")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(O,{modelValue:e.editDialog,"onUpdate:modelValue":t[18]||(t[18]=n=>e.editDialog=n),"max-width":"800",transition:"dialog-top-transition",width:"auto"},{default:l(()=>[o(M,{class:"rounded-xl pa-4",elevation:"10"},{default:l(()=>[o(U,{class:"rounded-lg flex-wrap",color:"primary",flat:""},{default:l(()=>[o(A,{class:"text-white font-weight-bold text-wrap"},{default:l(()=>[f("div",xe,[o(y,{class:"mr-2"},{default:l(()=>t[24]||(t[24]=[d("mdi-domain")])),_:1}),f("span",null,u(r.$t("editConstructionRehabilitation")),1)])]),_:1}),o(N),o(v,{color:"white",icon:"mdi-close",onClick:t[9]||(t[9]=n=>e.editDialog=!1)})]),_:1}),o(S,{class:"pt-6"},{default:l(()=>[o(q,null,{default:l(()=>[o(T,{dense:""},{default:l(()=>[o(m,{cols:"12"},{default:l(()=>[o(V,{modelValue:e.state.industry,"onUpdate:modelValue":t[10]||(t[10]=n=>e.state.industry=n),"bg-color":"grey-lighten-3",clearable:"","error-messages":e.v$.industry.$errors.map(n=>n.$message),label:r.$t("industry"),onBlur:e.v$.industry.$touch,onInput:e.v$.industry.$touch},null,8,["modelValue","error-messages","label","onBlur","onInput"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[f("label",Be,u(r.$t("selectLocation")),1),e.locationerrors?(h(),p("div",Ee,u(e.locationerrors),1)):$("",!0),o(b,{modelValue:e.state.location,"onUpdate:modelValue":t[11]||(t[11]=n=>e.state.location=n),border:"",color:"primary",fluid:"","item-title":"name","item-value":"id",items:e.adminHierarchy,"open-on-click":"",rounded:"","select-strategy":"single-independent",selectable:"","onClick:select":e.locationSelected},null,8,["modelValue","items","onClick:select"]),e.state.location.length?(h(),p("div",Ue,[f("div",$e,u(r.$t("selectedLocation"))+":",1),o(J,{color:"green",size:"small","text-color":"white",variant:"elevated"},{default:l(()=>[d(u(e.state.locationname),1)]),_:1})])):$("",!0)]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(V,{modelValue:e.state.value,"onUpdate:modelValue":t[12]||(t[12]=n=>e.state.value=n),"bg-color":"grey-lighten-3",clearable:"","error-messages":e.v$.value.$errors.map(n=>n.$message),label:r.$t("valueMillionUSD"),placeholder:r.$t("valuePlaceholder"),"prepend-inner-icon":"mdi-currency-usd",type:"number",onBlur:e.v$.value.$touch,onInput:e.v$.value.$touch},null,8,["modelValue","error-messages","label","placeholder","onBlur","onInput"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[f("label",Me,u(r.$t("yearStartedReopened")),1),o(w,{modelValue:e.state.year,"onUpdate:modelValue":t[13]||(t[13]=n=>e.state.year=n),placeholder:r.$t("year"),"text-input":"","year-picker":""},null,8,["modelValue","placeholder"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(_,{modelValue:e.state.owner,"onUpdate:modelValue":t[14]||(t[14]=n=>e.state.owner=n),"bg-color":"grey-lighten-3",clearable:"","error-messages":e.v$.owner.$errors.map(n=>n.$message),"item-title":"name","item-value":"id",items:e.owners,label:r.$t("ownedBy"),placeholder:r.$t("selectOwner"),"prepend-inner-icon":"mdi-account",onBlur:e.v$.owner.$touch,onChange:e.v$.owner.$touch},null,8,["modelValue","error-messages","items","label","placeholder","onBlur","onChange"])]),_:1}),o(m,{cols:"12"},{default:l(()=>[o(V,{modelValue:e.state.ownername,"onUpdate:modelValue":t[15]||(t[15]=n=>e.state.ownername=n),"bg-color":"grey-lighten-3",clearable:"",label:r.$t("ownerName"),"prepend-inner-icon":"mdi-account"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),o(H,{class:"d-flex justify-end justify-space-between"},{default:l(()=>[o(v,{color:"success",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:e.saveEdit},{default:l(()=>[o(y,{start:""},{default:l(()=>t[25]||(t[25]=[d("mdi-plus")])),_:1}),d(" "+u(r.$t("save")),1)]),_:1},8,["disabled","loading","onClick"]),o(v,{color:"black",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:t[16]||(t[16]=n=>e.editDialog=!1)},{default:l(()=>[o(y,{start:""},{default:l(()=>t[26]||(t[26]=[d("mdi-cancel")])),_:1}),d(" "+u(r.$t("cancel")),1)]),_:1},8,["disabled","loading"]),o(v,{color:"error",disabled:e.v$.$error,loading:e.loading,size:"large",type:"submit",variant:"elevated",onClick:t[17]||(t[17]=n=>e.confirmDeleteDialog=!0)},{default:l(()=>[o(y,{start:""},{default:l(()=>t[27]||(t[27]=[d("mdi-delete")])),_:1}),d(" "+u(r.$t("delete")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(O,{modelValue:e.confirmDeleteDialog,"onUpdate:modelValue":t[21]||(t[21]=n=>e.confirmDeleteDialog=n),persistent:"",width:"auto"},{default:l(()=>[o(M,null,{default:l(()=>[o(U,{color:"warning",title:r.$t("confirmDeleting")+" "+e.state.name},{default:l(()=>[o(v,{color:"white",icon:"mdi-close",onClick:t[19]||(t[19]=n=>e.confirmDeleteDialog=!1)})]),_:1},8,["title"]),o(S,null,{default:l(()=>[d(u(r.$t("confirmDeleteMessage",{name:e.state.name})),1)]),_:1}),f("div",Se,[o(v,{color:"success",onClick:t[20]||(t[20]=n=>e.confirmDeleteDialog=!1)},{default:l(()=>[d(u(r.$t("cancel")),1)]),_:1}),o(v,{color:"error",onClick:e.remove},{default:l(()=>[d(u(r.$t("proceed")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),o(U,{class:"rounded-lg mb-2 px-4",color:"primary",flat:"",height:"60"},{default:l(()=>[o(A,{class:"text-white font-weight-bold text-h6"},{default:l(()=>[o(y,{class:"mr-2",color:"white"},{default:l(()=>t[28]||(t[28]=[d("mdi-hammer-wrench")])),_:1}),d(" "+u(r.$t("constructionRehabilitation")),1)]),_:1}),o(N),o(v,{class:"font-weight-medium mr-2",color:"white",size:"small",onClick:e.csvExport},{default:l(()=>[o(y,{color:"white",start:""},{default:l(()=>t[29]||(t[29]=[d("mdi-download")])),_:1}),d(" "+u(r.$t("download")),1)]),_:1},8,["onClick"]),o(v,{class:"text-white font-weight-medium",color:"#1A237E",size:"small",onClick:e.activateAddDialog},{default:l(()=>[o(y,{start:""},{default:l(()=>t[30]||(t[30]=[d("mdi-plus")])),_:1}),d(" "+u(r.$t("addConstruction")),1)]),_:1},8,["onClick"])]),_:1}),o(M,{class:"rounded-lg"},{default:l(()=>[o(S,null,{default:l(()=>[o(ce,{active:e.loadingValues,indeterminate:e.loadingValues},null,8,["active","indeterminate"]),o(ye,{class:"elevation-1",dense:"",headers:e.headers,height:"300",items:e.values},{"item.edit":l(({item:n})=>[o(y,{color:"#3F51B5",onClick:B=>e.activateEditDialog(n)},{default:l(()=>t[31]||(t[31]=[d(" mdi-square-edit-outline ")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})}const Qe=ae(we,[["render",je],["__scopeId","data-v-d30d3e81"]]);export{Qe as default};
