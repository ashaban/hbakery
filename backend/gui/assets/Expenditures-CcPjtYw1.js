import{_ as Pe,r as V,$ as j,k as Oe,q as T,v as l,a1 as ze,t as y,h as t,x as d,Z as g,G as D,B as u,N as R,H as m,z as ee,A as h,a5 as ye,a2 as _e,a3 as ve,C as O,a4 as Le,D as x,i as z,F as Je,E as Ge,O as He,S as Qe}from"./index-C1Tj7Gr4.js";import{h as k}from"./moment-C5S46NFB.js";import{V as Ze}from"./VContainer-DjHLodrw.js";import{V as Y,b as C,d as ge,c as te}from"./VCard-BTVuuPde.js";import{V as w}from"./VCol-DviWLfXs.js";import{V as ae}from"./VAutocomplete-DxxHVteM.js";import{V as Ie}from"./VDataTableServer-DX--LLFj.js";import{V as De}from"./VTooltip-BDAA4Qkl.js";import{V as xe}from"./VChip-BoOgafMF.js";import{V as Ke}from"./VSkeletonLoader-jHZeiKRN.js";import{V as be}from"./VDialog-DXmIvNfP.js";import{V as We}from"./VForm-CB7-a3w8.js";import{V as oe}from"./VTextField-ByAT7d5t.js";import{V as Xe}from"./VTextarea-CsNS21lN.js";import{V as le}from"./VAlert-DPUzX-lz.js";import{V as et}from"./VSwitch-Dj9gh7oe.js";import{f as tt}from"./VDataTable-B2-JjakP.js";import"./VSlideGroup-CXfqPmJw.js";import"./dialog-transition-C6ql0rGP.js";const at={class:"d-flex gap-2"},ot={class:"d-flex align-center justify-space-between"},lt={class:"text-h6 font-weight-bold"},dt={class:"d-flex align-center justify-space-between"},st={class:"text-h6 font-weight-bold text-blue"},rt={class:"d-flex align-center justify-space-between"},nt={class:"text-h6 font-weight-bold text-green"},it={class:"d-flex gap-2"},ut={class:"d-flex gap-2"},mt={class:"d-flex justify-end mt-4"},pt={class:"d-flex justify-center"},ft={class:"text-center py-6 text-grey"},ct={class:"d-flex flex-column"},yt={key:0,class:"text-caption text-error mt-1"},_t={class:"d-flex flex-column"},vt={key:0,class:"text-caption text-error mt-1"},gt={key:0,class:"mt-4"},Dt={class:"d-flex flex-column"},xt={class:"d-flex flex-column"},bt={class:"text-body-1 font-weight-medium"},Vt={key:0,width:"150"},kt={key:1,width:"150"},wt={key:2,width:"150"},Yt={class:"text-center"},Et={class:"font-weight-medium"},Mt={key:0,class:"text-caption text-error mt-1"},St={key:0},ht={class:"d-flex flex-column"},Ct={key:0,class:"text-caption text-error mt-1"},Bt={key:1},Ut={class:"d-flex flex-column"},Tt={key:0,class:"text-caption text-error mt-1"},$t={key:2},At={class:"text-caption text-grey text-center"},Ft={class:"font-weight-medium"},jt={class:"font-weight-medium"},Rt={key:0,class:"text-caption text-error mt-1"},qt={class:"text-center"},Nt={class:"d-flex align-center"},Pt={class:"text-subtitle-2"},Ot={class:"text-caption text-grey"},zt={class:"d-flex justify-space-between mt-2"},Lt={class:"text-body-2 font-weight-medium"},Jt={class:"d-flex justify-space-between"},Gt={class:"text-body-2 font-weight-medium text-primary"},Ht={key:0,class:"d-flex justify-space-between"},Qt={class:"text-body-2"},Zt={__name:"Expenditures",setup(It){const Q=V(10),de=V([]),L=V([]),Ve=V(null),n=j({type_ids:[],start_from:"",start_to:"",end_from:"",end_to:""}),J=j({total_expenditure:0,total_production_cost:0,total_sale_cost:0}),Z=V(1),se=V(0),q=V(!1),N=V(!1),$=V(!1),I=V(!1),K=V(!1),W=V(!1),s=j({sameDates:!1,commonStartDate:"",commonEndDate:""}),p=j({id:null,type_id:"",start_date:"",end_date:"",amount:"",description:""}),f=j({type_id:"",start_date:"",end_date:"",amount:""}),c=V([]),_=V([]),B=j({show:!1,message:"",color:"success"}),ke=[{title:"Cost Type",key:"cost_type"},{title:"Category",key:"cost_category"},{title:"Start Date",key:"start_date"},{title:"End Date",key:"end_date"},{title:"Amount",key:"amount",align:"end"},{title:"Description",key:"description"},{title:"Actions",key:"actions",align:"center",sortable:!1}];function A(a){return Number(a||0).toLocaleString(void 0,{minimumFractionDigits:2})}function re(a){return a?new Date(a).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric"}):""}function we(){Object.assign(n,{type_ids:[],start_from:"",start_to:"",end_from:"",end_to:""}),U()}function Ye(a){return{"Production Cost":"blue-lighten-1","Sale Cost":"green-lighten-1","Administrative Cost":"purple-lighten-4","Other Cost":"orange-lighten-4"}[a]||"grey-lighten-3"}function b(a,e="success"){B.message=a,B.color=e,B.show=!0}function E(a){switch(a){case"type_id":f.type_id=p.type_id?"":"Cost type is required";break;case"start_date":f.start_date=p.start_date?"":"Start date is required";break;case"end_date":f.end_date=p.end_date?"":"End date is required",p.start_date&&p.end_date&&ne();break;case"amount":!p.amount&&p.amount!==0?f.amount="Amount is required":Number.isInteger(Number(p.amount))?p.amount<0?f.amount="Amount must be positive":f.amount="":f.amount="Amount must be a whole number";break}}function ne(){if(p.start_date&&p.end_date){const a=k(p.start_date,"DD-MM-YYYY");k(p.end_date,"DD-MM-YYYY").isBefore(a)?f.end_date="End date cannot be before start date":G("end_date")}}function G(a){f[a]=""}function Ee(){return E("type_id"),E("start_date"),E("end_date"),E("amount"),!f.type_id&&!f.start_date&&!f.end_date&&!f.amount}function Me(){c.value=[],_.value=[],s.sameDates=!1,s.commonStartDate="",s.commonEndDate="";for(let a=0;a<3;a++)X()}function X(){const a={type_id:"",start_date:s.sameDates?s.commonStartDate:"",end_date:s.sameDates?s.commonEndDate:"",amount:"",description:""};c.value.push(a),_.value.push({type_id:"",start_date:"",end_date:"",amount:""})}function Se(a){c.value.splice(a,1),_.value.splice(a,1)}function he(){c.value=[],_.value=[]}function Ce(){if(c.value.length===0){X();return}const a={...c.value[c.value.length-1]};c.value.push(a),_.value.push({type_id:"",start_date:"",end_date:"",amount:""})}function Be(){s.sameDates?c.value.forEach(a=>{a.start_date=s.commonStartDate,a.end_date=s.commonEndDate}):c.value.forEach((a,e)=>{P(e,"start_date"),P(e,"end_date")})}function Ue(){s.sameDates&&s.commonStartDate&&c.value.forEach(a=>{a.start_date=s.commonStartDate})}function Te(){s.sameDates&&s.commonEndDate&&c.value.forEach(a=>{a.end_date=s.commonEndDate})}function $e(a){if(!_.value[a])return!1;const e=_.value[a];return e.type_id||e.start_date||e.end_date||e.amount}function M(a,e){return _.value[a]?!!_.value[a][e]:!1}function H(a,e){return _.value[a]?_.value[a][e]:""}function S(a,e){_.value[a]||(_.value[a]={type_id:"",start_date:"",end_date:"",amount:""});const r=c.value[a],o=_.value[a];switch(e){case"type_id":o.type_id=r.type_id?"":"Cost type is required";break;case"start_date":s.sameDates?s.commonStartDate?o.start_date="":o.start_date="Start date is required":o.start_date=r.start_date?"":"Start date is required";break;case"end_date":s.sameDates?s.commonEndDate?o.end_date="":o.end_date="End date is required":(o.end_date=r.end_date?"":"End date is required",r.start_date&&r.end_date&&ie(a));break;case"amount":!r.amount&&r.amount!==0?o.amount="Amount is required":Number.isInteger(Number(r.amount))?r.amount<0?o.amount="Amount must be positive":o.amount="":o.amount="Amount must be a whole number";break}}function ie(a){const e=c.value[a],r=_.value[a];if(e.start_date&&e.end_date){const o=k(e.start_date,"DD-MM-YYYY");k(e.end_date,"DD-MM-YYYY").isBefore(o)?r.end_date="End date cannot be before start date":r.end_date=""}}function P(a,e){_.value[a]&&(_.value[a][e]="")}function Ae(){let a=!0;if(s.sameDates){if(!s.commonStartDate)return b("Common start date is required","error"),!1;if(!s.commonEndDate)return b("Common end date is required","error"),!1;const e=k(s.commonStartDate,"DD-MM-YYYY");if(k(s.commonEndDate,"DD-MM-YYYY").isBefore(e))return b("End date cannot be before start date","error"),!1}return c.value.forEach((e,r)=>{S(r,"type_id"),S(r,"start_date"),S(r,"end_date"),S(r,"amount");const o=_.value[r];o&&(o.type_id||o.start_date||o.end_date||o.amount)&&(a=!1)}),a}function F(){let a=0,e=0;return _.value.forEach(r=>{r&&(r.type_id||r.start_date||r.end_date||r.amount)?e++:a++}),s.sameDates&&(!s.commonStartDate||!s.commonEndDate)&&(e=c.value.length,a=0),{valid:e===0,validCount:a,invalidCount:e}}function ue(){return c.value.reduce((a,e)=>{const r=parseFloat(e.amount)||0;return a+r},0)}async function Fe(){try{const e=await(await fetch("/expenditures/types?limit=1000000")).json();L.value=e.data}catch(a){console.error("Failed to load cost types:",a),b("Failed to load cost types","error")}}async function je(){try{const a=new URLSearchParams;n.type_ids.length&&n.type_ids.forEach(o=>a.append("type_id",o)),n.start_from&&a.append("start_date_from",n.start_from),n.start_to&&a.append("start_date_to",n.start_to),n.end_from&&a.append("end_date_from",n.end_from),n.end_to&&a.append("end_date_to",n.end_to);const r=await(await fetch(`/expenditures/summary?${a.toString()}`)).json();Object.assign(J,r)}catch(a){console.error("Failed to load summary:",a)}}async function U(){I.value=!0;try{const a=new URLSearchParams;n.type_ids.length&&n.type_ids.forEach(o=>a.append("type_id",o)),n.start_from&&a.append("start_date_from",n.start_from),n.start_to&&a.append("start_date_to",n.start_to),n.end_from&&a.append("end_date_from",n.end_from),n.end_to&&a.append("end_date_to",n.end_to),a.append("page",Z.value),a.append("limit",Q.value);const r=await(await fetch(`/expenditures?${a.toString()}`)).json();de.value=r.data||[],se.value=r.totalRecords||0,await je()}catch(a){console.error("Failed to load expenditures:",a),b("Failed to load expenditures","error")}finally{I.value=!1}}function me(a=!1,e=null){$.value=a,q.value=!0,Object.keys(f).forEach(r=>f[r]=""),a&&e?Object.assign(p,{id:e.id,type_id:e.type_id,start_date:k(e.start_date).format("DD-MM-YYYY"),end_date:k(e.end_date).format("DD-MM-YYYY"),amount:e.amount,description:e.description}):Object.assign(p,{id:null,type_id:"",start_date:"",end_date:"",amount:"",description:""})}function pe(){q.value=!1,Object.keys(f).forEach(a=>f[a]="")}function Re(){N.value=!0,Me()}function fe(){N.value=!1,c.value=[],_.value=[],s.sameDates=!1,s.commonStartDate="",s.commonEndDate=""}async function ce(){if(!Ee()){b("Please fix the validation errors","error");return}K.value=!0;try{const a=$.value?"PUT":"POST",e=$.value?`/expenditures/${p.id}`:"/expenditures",r={...p,start_date:k(p.start_date,"DD-MM-YYYY").format("YYYY-MM-DD"),end_date:k(p.end_date,"DD-MM-YYYY").format("YYYY-MM-DD")},o=await fetch(e,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok){const i=await o.json();throw new Error(i.message||"Save failed")}q.value=!1,b(`Expenditure ${$.value?"updated":"created"} successfully`),await U()}catch(a){console.error("Failed to save expenditure:",a),b(a.message||"Failed to save expenditure","error")}finally{K.value=!1}}async function qe(){if(!Ae()){b("Please fix all validation errors before saving","error");return}if(c.value.length===0){b("No expenditures to save","error");return}W.value=!0;try{const a={expenditures:c.value.map(o=>({type_id:o.type_id,start_date:s.sameDates?k(s.commonStartDate,"DD-MM-YYYY").format("YYYY-MM-DD"):k(o.start_date,"DD-MM-YYYY").format("YYYY-MM-DD"),end_date:s.sameDates?k(s.commonEndDate,"DD-MM-YYYY").format("YYYY-MM-DD"):k(o.end_date,"DD-MM-YYYY").format("YYYY-MM-DD"),amount:parseFloat(o.amount),description:o.description||null}))},e=await fetch("/expenditures/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!e.ok){const o=await e.json();throw new Error(o.message||"Bulk save failed")}const r=await e.json();N.value=!1,b(`Successfully created ${r.created} expenditure(s)`,r.failed>0?"warning":"success"),r.failed>0&&r.errors&&console.warn("Some expenditures failed:",r.errors),await U()}catch(a){console.error("Failed to save bulk expenditures:",a),b(a.message||"Failed to save bulk expenditures","error")}finally{W.value=!1}}async function Ne(a){if(confirm(`Are you sure you want to delete expenditure "${a.cost_type}"?`))try{if(!(await fetch(`/expenditures/${a.id}`,{method:"DELETE"})).ok)throw new Error("Delete failed");b("Expenditure deleted successfully"),await U()}catch(e){console.error("Failed to delete expenditure:",e),b("Failed to delete expenditure","error")}}return Oe(async()=>{await Fe(),await U()}),(a,e)=>{const r=ze("VueDatePicker");return y(),T(Ze,{class:"py-6",fluid:""},{default:l(()=>[t(Y,{class:"mb-6",elevation:"2",rounded:"lg"},{default:l(()=>[t(C,{class:"d-flex align-center justify-space-between"},{default:l(()=>[e[29]||(e[29]=d("div",null,[d("h2",{class:"text-h5 font-weight-bold text-primary mb-1"}," Expenditure Management "),d("p",{class:"text-body-2 text-grey"}," Monitor and manage operational and sales costs ")],-1)),d("div",at,[a.$store.getters.hasTask("can_add_expenditure")?(y(),T(D,{key:0,color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=o=>me(!1))},{default:l(()=>e[27]||(e[27]=[u(" Add Expenditure ")])),_:1})):g("",!0),a.$store.getters.hasTask("can_add_expenditure")?(y(),T(D,{key:1,color:"secondary","prepend-icon":"mdi-plus-multiple",onClick:Re},{default:l(()=>e[28]||(e[28]=[u(" Add Multiple ")])),_:1})):g("",!0)])]),_:1})]),_:1}),t(R,{class:"mb-4"},{default:l(()=>[t(w,{cols:"12",md:"4"},{default:l(()=>[t(Y,{class:"pa-4",elevation:"3",rounded:"xl"},{default:l(()=>[d("div",ot,[d("div",null,[e[30]||(e[30]=d("div",{class:"text-body-2 text-grey"},"Total Expenditure",-1)),d("div",lt,m(A(J.total_expenditure)),1)]),t(ee,{color:"primary",size:"40",variant:"tonal"},{default:l(()=>[t(h,{color:"primary"},{default:l(()=>e[31]||(e[31]=[u("mdi-cash")])),_:1})]),_:1})])]),_:1})]),_:1}),t(w,{cols:"12",md:"4"},{default:l(()=>[t(Y,{class:"pa-4",elevation:"3",rounded:"xl"},{default:l(()=>[d("div",dt,[d("div",null,[e[32]||(e[32]=d("div",{class:"text-body-2 text-grey"},"Production Costs",-1)),d("div",st,m(A(J.total_production_cost)),1)]),t(ee,{color:"blue",size:"40",variant:"tonal"},{default:l(()=>[t(h,{color:"blue"},{default:l(()=>e[33]||(e[33]=[u("mdi-factory")])),_:1})]),_:1})])]),_:1})]),_:1}),t(w,{cols:"12",md:"4"},{default:l(()=>[t(Y,{class:"pa-4",elevation:"3",rounded:"xl"},{default:l(()=>[d("div",rt,[d("div",null,[e[34]||(e[34]=d("div",{class:"text-body-2 text-grey"},"Sale Costs",-1)),d("div",nt,m(A(J.total_sale_cost)),1)]),t(ee,{color:"green",size:"40",variant:"tonal"},{default:l(()=>[t(h,{color:"green"},{default:l(()=>e[35]||(e[35]=[u("mdi-sale")])),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),t(Y,{class:"mb-4",elevation:"2",rounded:"lg"},{default:l(()=>[t(C,null,{default:l(()=>[t(R,{dense:""},{default:l(()=>[t(w,{cols:"12",md:"4"},{default:l(()=>[t(ae,{modelValue:n.type_ids,"onUpdate:modelValue":e[1]||(e[1]=o=>n.type_ids=o),autocomplete:"off",autocorrect:"off",chips:"",clearable:"",color:"primary",inputmode:"none","item-title":"name","item-value":"id",items:L.value,label:"Filter by Cost Types",multiple:"",spellcheck:"false",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(w,{cols:"12",md:"4"},{default:l(()=>[t(ge,{class:"pl-0 pb-1 text-caption text-grey"},{default:l(()=>e[36]||(e[36]=[u(" Start Date Range ")])),_:1}),d("div",it,[t(r,{modelValue:n.start_from,"onUpdate:modelValue":e[2]||(e[2]=o=>n.start_from=o),"auto-apply":"",class:"flex-1 border rounded-lg px-2 py-1",format:"dd-MM-yyyy","model-type":"format",placeholder:"From",teleport:!0},null,8,["modelValue"]),t(r,{modelValue:n.start_to,"onUpdate:modelValue":e[3]||(e[3]=o=>n.start_to=o),"auto-apply":"",class:"flex-1 border rounded-lg px-2 py-1",format:"dd-MM-yyyy","model-type":"format",placeholder:"To",teleport:!0},null,8,["modelValue"])])]),_:1}),t(w,{cols:"12",md:"4"},{default:l(()=>[t(ge,{class:"pl-0 pb-1 text-caption text-grey"},{default:l(()=>e[37]||(e[37]=[u("End Date Range")])),_:1}),d("div",ut,[t(r,{modelValue:n.end_from,"onUpdate:modelValue":e[4]||(e[4]=o=>n.end_from=o),"auto-apply":"",class:"flex-1 border rounded-lg px-2 py-1",format:"dd-MM-yyyy","model-type":"format",placeholder:"From",teleport:!0},null,8,["modelValue"]),t(r,{modelValue:n.end_to,"onUpdate:modelValue":e[5]||(e[5]=o=>n.end_to=o),"auto-apply":"",class:"flex-1 border rounded-lg px-2 py-1",format:"dd-MM-yyyy","model-type":"format",placeholder:"To",teleport:!0},null,8,["modelValue"])])]),_:1})]),_:1}),d("div",mt,[t(D,{color:"primary","prepend-icon":"mdi-filter",onClick:U},{default:l(()=>e[38]||(e[38]=[u(" Apply Filters ")])),_:1}),t(D,{class:"ml-2","prepend-icon":"mdi-close-circle",variant:"outlined",onClick:we},{default:l(()=>e[39]||(e[39]=[u(" Clear ")])),_:1})])]),_:1})]),_:1}),t(Y,{elevation:"2",rounded:"lg"},{default:l(()=>[t(C,{class:"pa-0"},{default:l(()=>[t(Ie,{"items-per-page":Q.value,"onUpdate:itemsPerPage":e[6]||(e[6]=o=>Q.value=o),page:Z.value,"onUpdate:page":e[7]||(e[7]=o=>Z.value=o),class:"rounded-lg",density:"comfortable",headers:ke,items:de.value,"items-length":se.value,"items-per-page-options":[5,10,20,50,100],loading:I.value,"onUpdate:options":U},{loading:l(()=>[t(Ke,{type:"table-row@10"})]),"item.amount":l(({item:o})=>[t(xe,{color:"green",variant:"flat"},{default:l(()=>[u(m(A(o.amount)),1)]),_:2},1024)]),"item.cost_category":l(({item:o})=>[t(xe,{color:Ye(o.cost_category),variant:"outlined"},{default:l(()=>[u(m(o.cost_category),1)]),_:2},1032,["color"])]),"item.start_date":l(({item:o})=>[u(m(re(o.start_date)),1)]),"item.end_date":l(({item:o})=>[u(m(re(o.end_date)),1)]),"item.actions":l(({item:o})=>[d("div",pt,[t(De,{location:"top"},{activator:l(({props:i})=>[a.$store.getters.hasTask("can_edit_expenditure")?(y(),T(D,ye({key:0},i,{color:"blue",icon:"",size:"small",variant:"text",onClick:v=>me(!0,o)}),{default:l(()=>[t(h,null,{default:l(()=>e[40]||(e[40]=[u("mdi-pencil")])),_:1})]),_:2},1040,["onClick"])):g("",!0)]),default:l(()=>[e[41]||(e[41]=d("span",null,"Edit",-1))]),_:2},1024),t(De,{location:"top"},{activator:l(({props:i})=>[a.$store.getters.hasTask("can_delete_expenditure")?(y(),T(D,ye({key:0},i,{color:"red",icon:"",size:"small",variant:"text",onClick:v=>Ne(o)}),{default:l(()=>[t(h,null,{default:l(()=>e[42]||(e[42]=[u("mdi-delete")])),_:1})]),_:2},1040,["onClick"])):g("",!0)]),default:l(()=>[e[43]||(e[43]=d("span",null,"Delete",-1))]),_:2},1024)])]),"no-data":l(()=>[d("div",ft,[t(h,{color:"grey-lighten-2",size:"48"},{default:l(()=>e[44]||(e[44]=[u("mdi-inbox")])),_:1}),e[45]||(e[45]=d("div",null,"No expenditures found",-1))])]),_:1},8,["items-per-page","page","items","items-length","loading"])]),_:1})]),_:1}),t(be,{modelValue:q.value,"onUpdate:modelValue":e[21]||(e[21]=o=>q.value=o),"max-width":"600px",persistent:""},{default:l(()=>[t(Y,null,{default:l(()=>[t(_e,{class:"text-white",color:"primary",density:"comfortable"},{default:l(()=>[t(ve,null,{default:l(()=>[u(m($.value?"Edit Expenditure":"Add Expenditure"),1)]),_:1}),t(O),t(D,{color:"white",icon:"mdi-close",variant:"text",onClick:pe})]),_:1}),t(C,{class:"pa-4"},{default:l(()=>[t(We,{ref_key:"singleFormRef",ref:Ve,onSubmit:Le(ce,["prevent"])},{default:l(()=>[t(ae,{modelValue:p.type_id,"onUpdate:modelValue":e[8]||(e[8]=o=>p.type_id=o),autocomplete:"off",autocorrect:"off",color:"primary","error-messages":f.type_id,inputmode:"none","item-title":"name","item-value":"id",items:L.value,label:"Cost Type *",required:"",spellcheck:"false",variant:"outlined",onBlur:e[9]||(e[9]=o=>E("type_id")),onInput:e[10]||(e[10]=o=>G("type_id"))},null,8,["modelValue","error-messages","items"]),t(R,{dense:""},{default:l(()=>[t(w,{cols:"12",md:"6"},{default:l(()=>[d("div",ct,[e[46]||(e[46]=d("label",{class:"text-caption text-grey mb-1 required-field"},"Start Date *",-1)),t(r,{modelValue:p.start_date,"onUpdate:modelValue":[e[11]||(e[11]=o=>p.start_date=o),e[13]||(e[13]=o=>G("start_date"))],"auto-apply":"",class:z(["rounded-lg","border","px-2","py-1","w-100",f.start_date?"error-field":""]),format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0,onBlur:e[12]||(e[12]=o=>E("start_date"))},null,8,["modelValue","class"]),f.start_date?(y(),x("div",yt,m(f.start_date),1)):g("",!0)])]),_:1}),t(w,{cols:"12",md:"6"},{default:l(()=>[d("div",_t,[e[47]||(e[47]=d("label",{class:"text-caption text-grey mb-1 required-field"},"End Date *",-1)),t(r,{modelValue:p.end_date,"onUpdate:modelValue":[e[14]||(e[14]=o=>p.end_date=o),e[16]||(e[16]=o=>ne())],"auto-apply":"",class:z(["rounded-lg","border","px-2","py-1","w-100",f.end_date?"error-field":""]),format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0,onBlur:e[15]||(e[15]=o=>E("end_date"))},null,8,["modelValue","class"]),f.end_date?(y(),x("div",vt,m(f.end_date),1)):g("",!0)])]),_:1})]),_:1}),t(oe,{modelValue:p.amount,"onUpdate:modelValue":e[17]||(e[17]=o=>p.amount=o),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"primary","error-messages":f.amount,inputmode:"none",label:"Amount *",prefix:"$",required:"",spellcheck:"false",type:"number",variant:"outlined",onBlur:e[18]||(e[18]=o=>E("amount")),onInput:e[19]||(e[19]=o=>G("amount"))},null,8,["modelValue","error-messages"]),t(Xe,{modelValue:p.description,"onUpdate:modelValue":e[20]||(e[20]=o=>p.description=o),color:"primary",label:"Description",rows:"3",variant:"outlined"},null,8,["modelValue"])]),_:1},512)]),_:1}),t(te,{class:"pa-4"},{default:l(()=>[t(O),t(D,{color:"grey",variant:"outlined",onClick:pe},{default:l(()=>e[48]||(e[48]=[u("Cancel")])),_:1}),t(D,{color:"primary",loading:K.value,onClick:ce},{default:l(()=>[t(h,{start:""},{default:l(()=>e[49]||(e[49]=[u("mdi-content-save")])),_:1}),u(" "+m($.value?"Update":"Save"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(be,{modelValue:N.value,"onUpdate:modelValue":e[25]||(e[25]=o=>N.value=o),"max-width":"1200px",persistent:""},{default:l(()=>[t(Y,{class:"d-flex flex-column",style:{height:"100vh"}},{default:l(()=>[t(_e,{class:"text-white",color:"primary",density:"comfortable"},{default:l(()=>[t(ve,null,{default:l(()=>e[50]||(e[50]=[u(" Add Multiple Expenditures ")])),_:1}),t(O),t(D,{color:"white",icon:"mdi-close",variant:"text",onClick:fe})]),_:1}),t(C,{class:"pa-4 flex-grow-1",style:{"overflow-y":"auto"}},{default:l(()=>[t(le,{class:"mb-4",type:"info",variant:"tonal"},{default:l(()=>e[51]||(e[51]=[d("strong",null,"Quick Add Mode",-1),u(" - Add multiple expenditures at once. Each row will be saved as a separate expenditure record. ")])),_:1}),t(Y,{class:"mb-4",elevation:"1"},{default:l(()=>[t(C,null,{default:l(()=>[t(R,null,{default:l(()=>[t(w,{cols:"12",md:"6"},{default:l(()=>[t(et,{modelValue:s.sameDates,"onUpdate:modelValue":[e[22]||(e[22]=o=>s.sameDates=o),Be],color:"primary","hide-details":"",label:"Use same dates for all rows"},null,8,["modelValue"]),s.sameDates?(y(),x("div",gt,[t(R,{dense:""},{default:l(()=>[t(w,{cols:"12",md:"6"},{default:l(()=>[d("div",Dt,[e[52]||(e[52]=d("label",{class:"text-caption text-grey mb-1"},"Start Date",-1)),t(r,{modelValue:s.commonStartDate,"onUpdate:modelValue":[e[23]||(e[23]=o=>s.commonStartDate=o),Ue],"auto-apply":"",class:"border rounded-lg px-2 py-1 w-100",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])])]),_:1}),t(w,{cols:"12",md:"6"},{default:l(()=>[d("div",xt,[e[53]||(e[53]=d("label",{class:"text-caption text-grey mb-1"},"End Date",-1)),t(r,{modelValue:s.commonEndDate,"onUpdate:modelValue":[e[24]||(e[24]=o=>s.commonEndDate=o),Te],"auto-apply":"",class:"border rounded-lg px-2 py-1 w-100",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])])]),_:1})]),_:1})])):g("",!0)]),_:1}),t(w,{cols:"12",md:"6"},{default:l(()=>[s.sameDates?(y(),T(le,{key:0,density:"compact",type:"info",variant:"tonal"},{default:l(()=>e[54]||(e[54]=[u(" All rows will use the same start and end dates ")])),_:1})):(y(),T(le,{key:1,density:"compact",type:"info",variant:"tonal"},{default:l(()=>e[55]||(e[55]=[u(" Each row can have different dates ")])),_:1}))]),_:1})]),_:1})]),_:1})]),_:1}),t(Y,{class:"mb-4",elevation:"1"},{default:l(()=>[t(te,{class:"pa-3"},{default:l(()=>[t(D,{color:"primary","prepend-icon":"mdi-plus",onClick:X},{default:l(()=>e[56]||(e[56]=[u(" Add Row ")])),_:1}),t(D,{color:"secondary","prepend-icon":"mdi-content-copy",onClick:Ce},{default:l(()=>e[57]||(e[57]=[u(" Duplicate Last Row ")])),_:1}),t(D,{color:"grey","prepend-icon":"mdi-delete",onClick:he},{default:l(()=>e[58]||(e[58]=[u(" Clear All ")])),_:1}),t(O),d("div",bt,m(c.value.length)+" row(s) â€¢ Total: "+m(A(ue())),1)]),_:1})]),_:1}),t(Y,{class:"mb-4",elevation:"1"},{default:l(()=>[t(tt,{density:"comfortable","fixed-header":"",height:"500px"},{default:l(()=>[d("thead",null,[d("tr",null,[e[59]||(e[59]=d("th",{width:"50"},"#",-1)),e[60]||(e[60]=d("th",{width:"250"},"Cost Type *",-1)),s.sameDates?g("",!0):(y(),x("th",Vt," Start Date * ")),s.sameDates?g("",!0):(y(),x("th",kt,"End Date *")),s.sameDates?(y(),x("th",wt,"Dates")):g("",!0),e[61]||(e[61]=d("th",{width:"150"},"Amount *",-1)),e[62]||(e[62]=d("th",null,"Description",-1)),e[63]||(e[63]=d("th",{width:"50"},"Actions",-1))])]),d("tbody",null,[(y(!0),x(Je,null,Ge(c.value,(o,i)=>(y(),x("tr",{key:i,class:z($e(i)?"error-row":"")},[d("td",Yt,[d("span",Et,m(i+1),1)]),d("td",null,[t(ae,{modelValue:o.type_id,"onUpdate:modelValue":[v=>o.type_id=v,v=>P(i,"type_id")],density:"compact",error:M(i,"type_id"),"hide-details":"","item-title":"name","item-value":"id",items:L.value,variant:"outlined",onBlur:v=>S(i,"type_id")},null,8,["modelValue","onUpdate:modelValue","error","items","onBlur"]),M(i,"type_id")?(y(),x("div",Mt,m(H(i,"type_id")),1)):g("",!0)]),s.sameDates?g("",!0):(y(),x("td",St,[d("div",ht,[t(r,{modelValue:o.start_date,"onUpdate:modelValue":[v=>o.start_date=v,v=>P(i,"start_date")],"auto-apply":"",class:z(["border","rounded-lg","px-2","py-1",M(i,"start_date")?"error-field":""]),format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0,onBlur:v=>S(i,"start_date")},null,8,["modelValue","onUpdate:modelValue","class","onBlur"]),M(i,"start_date")?(y(),x("div",Ct,m(H(i,"start_date")),1)):g("",!0)])])),s.sameDates?g("",!0):(y(),x("td",Bt,[d("div",Ut,[t(r,{modelValue:o.end_date,"onUpdate:modelValue":[v=>o.end_date=v,v=>ie(i)],"auto-apply":"",class:z(["border","rounded-lg","px-2","py-1",M(i,"end_date")?"error-field":""]),format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0,onBlur:v=>S(i,"end_date")},null,8,["modelValue","onUpdate:modelValue","class","onBlur"]),M(i,"end_date")?(y(),x("div",Tt,m(H(i,"end_date")),1)):g("",!0)])])),s.sameDates?(y(),x("td",$t,[d("div",At,[d("div",Ft,m(s.commonStartDate||"Not set"),1),e[64]||(e[64]=d("div",{class:"text-xs"},"to",-1)),d("div",jt,m(s.commonEndDate||"Not set"),1)])])):g("",!0),d("td",null,[t(oe,{modelValue:o.amount,"onUpdate:modelValue":v=>o.amount=v,modelModifiers:{number:!0},density:"compact",error:M(i,"amount"),"hide-details":"",prefix:"$",type:"number",variant:"outlined",onBlur:v=>S(i,"amount"),onInput:v=>P(i,"amount")},null,8,["modelValue","onUpdate:modelValue","error","onBlur","onInput"]),M(i,"amount")?(y(),x("div",Rt,m(H(i,"amount")),1)):g("",!0)]),d("td",null,[t(oe,{modelValue:o.description,"onUpdate:modelValue":v=>o.description=v,density:"compact","hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),d("td",qt,[t(D,{color:"red",icon:"mdi-delete",size:"small",variant:"text",onClick:v=>Se(i)},null,8,["onClick"])])],2))),128))])]),_:1})]),_:1}),t(R,null,{default:l(()=>[t(w,{cols:"12",md:"6"},{default:l(()=>[t(Y,{elevation:"1"},{default:l(()=>[t(C,null,{default:l(()=>[d("div",Nt,[t(h,{class:"mr-2",color:F().valid?"green":"red"},{default:l(()=>[u(m(F().valid?"mdi-check-circle":"mdi-alert-circle"),1)]),_:1},8,["color"]),d("div",null,[d("div",Pt,m(F().valid?"All rows are valid":"Validation Issues"),1),d("div",Ot,m(F().validCount)+" valid, "+m(F().invalidCount)+" invalid ",1)])])]),_:1})]),_:1})]),_:1}),t(w,{cols:"12",md:"6"},{default:l(()=>[t(Y,{elevation:"1"},{default:l(()=>[t(C,null,{default:l(()=>[e[68]||(e[68]=d("div",{class:"text-subtitle-2"},"Summary",-1)),d("div",zt,[e[65]||(e[65]=d("div",{class:"text-caption text-grey"},"Total Rows:",-1)),d("div",Lt,m(c.value.length),1)]),d("div",Jt,[e[66]||(e[66]=d("div",{class:"text-caption text-grey"},"Total Amount:",-1)),d("div",Gt,m(A(ue())),1)]),s.sameDates?(y(),x("div",Ht,[e[67]||(e[67]=d("div",{class:"text-caption text-grey"},"Dates:",-1)),d("div",Qt,m(s.commonStartDate||"?")+" to "+m(s.commonEndDate||"?"),1)])):g("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(He),t(te,{class:"pa-4 bg-grey-lighten-4",style:{"flex-shrink":"0"}},{default:l(()=>[t(O),t(D,{color:"grey",variant:"outlined",onClick:fe},{default:l(()=>e[69]||(e[69]=[u(" Cancel ")])),_:1}),t(D,{color:"primary",disabled:!F().valid||c.value.length===0,loading:W.value,"prepend-icon":"mdi-content-save-all",onClick:qe},{default:l(()=>[u(" Save All ("+m(c.value.length)+") ",1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Qe,{modelValue:B.show,"onUpdate:modelValue":e[26]||(e[26]=o=>B.show=o),color:B.color,timeout:"3000"},{default:l(()=>[u(m(B.message),1)]),_:1},8,["modelValue","color"])]),_:1})}}},_a=Pe(Zt,[["__scopeId","data-v-d5fa0170"]]);export{_a as default};
