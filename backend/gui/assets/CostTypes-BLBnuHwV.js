import{_ as Q,r as i,a0 as b,l as W,s as j,v as P,x as a,i as t,y as g,O as U,H as d,C as s,B as u,I as C,ak as X,a4 as F,D as Y,a6 as Z,aM as w,a3 as h}from"./index-LhBGGbDo.js";import{u as ee,r as N}from"./index-CJqWPmjT.js";import{V as k,b as O,c as B}from"./VCard-CePcGudf.js";import{V as x}from"./VCol-DIVHEWFP.js";import{V as I}from"./VTextField-DdRmxMh_.js";import{V as te}from"./VAlert-QcJFPJEB.js";import{a as ae,b as le,V as se}from"./VDataTable-PuSy_Rf-.js";import{V as q}from"./VDialog-DPRaUwy_.js";import{V as oe}from"./VForm-BJyWH2Dg.js";import{V as re}from"./VContainer-Dk9Sho_f.js";import"./dialog-transition-Ci0HdeXs.js";const ne={class:"d-flex justify-space-between mb-4"},ie={class:"d-flex justify-end align-center mt-4"},de={class:"d-flex align-center flex-wrap"},ue={class:"text-white font-weight-bold text-h6"},me=10,fe={__name:"CostTypes",setup(pe){const n=i(!1),T=i([]),p=i(!1),m=i(!1),f=i(!1),$=i(null),V=i(1),D=i(1),E=b({total_types:0}),v=b({search:""}),R=["Production Cost","Sale Cost","Administrative Cost","Other Cost"],_=[{title:"Name",key:"name"},{title:"Category",key:"category"},{title:"Actions",key:"actions",sortable:!1,align:"center"}],r=b({name:"",category:""}),y=ee({name:{required:N},category:{required:N}},r);async function c(){n.value=!0;const o=new URLSearchParams({page:V.value,limit:me});v.search&&o.append("search",v.search);try{const l=await(await fetch(`/expenditures/types?${o}`)).json();T.value=l.data||[],D.value=l.totalPages||1,E.total_types=l.totalRecords||0}catch(e){console.error("Failed to load cost types",e)}finally{n.value=!1}}function L(){V.value=1,c()}function M(){v.search="",V.value=1,c()}function z(){f.value=!1,Object.assign(r,{name:"",category:""}),p.value=!0,y.value.$reset()}async function H(o){f.value=!0,$.value=o.id,Object.assign(r,{name:o.name,category:o.category}),p.value=!0}async function J(){if(y.value.$touch(),!y.value.$invalid){n.value=!0;try{const o={name:r.name,category:r.category},e=f.value?"PUT":"POST",l=f.value?`/expenditures/types/${$.value}`:"/expenditures/types";if(!(await fetch(l,{method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)throw new Error("Failed to save");p.value=!1,c()}finally{n.value=!1}}}const A=i(null);function G(o){A.value=o,m.value=!0}async function K(){n.value=!0;try{await fetch(`/expenditures/types/${A.value.id}`,{method:"DELETE"}),m.value=!1,c()}catch(o){console.error("Failed to delete",o)}finally{n.value=!1}}return W(()=>{c()}),(o,e)=>(P(),j(re,{fluid:""},{default:a(()=>[t(k,{class:"pa-4 mb-4"},{default:a(()=>[t(U,{dense:""},{default:a(()=>[t(x,{cols:"12",sm:"4"},{default:a(()=>[t(I,{modelValue:v.search,"onUpdate:modelValue":e[0]||(e[0]=l=>v.search=l),"append-inner-icon":"mdi-close-circle",clearable:"",label:"Search Cost Type","onClick:appendInner":e[1]||(e[1]=l=>v.search="")},null,8,["modelValue"])]),_:1}),t(x,{class:"d-flex justify-end",cols:"12"},{default:a(()=>[t(d,{color:"primary",onClick:L},{default:a(()=>[t(u,{start:""},{default:a(()=>e[12]||(e[12]=[s("mdi-filter")])),_:1}),e[13]||(e[13]=s(" Apply "))]),_:1}),t(d,{class:"ml-2",color:"grey",onClick:M},{default:a(()=>[t(u,{start:""},{default:a(()=>e[14]||(e[14]=[s("mdi-refresh")])),_:1}),e[15]||(e[15]=s(" Reset "))]),_:1})]),_:1})]),_:1})]),_:1}),t(te,{border:"start",class:"mb-4",type:"info",variant:"outlined"},{default:a(()=>[e[16]||(e[16]=g("strong",null,"Total Cost Types:",-1)),s(" "+C(E.total_types||"0"),1)]),_:1}),g("div",ne,[e[19]||(e[19]=g("h3",null,"Cost Types",-1)),t(d,{class:"text-white",color:"primary",size:"small",onClick:z},{default:a(()=>[t(u,{start:""},{default:a(()=>e[17]||(e[17]=[s("mdi-plus")])),_:1}),e[18]||(e[18]=s(" Add Cost Type "))]),_:1})]),t(X,{active:n.value,indeterminate:n.value},null,8,["active","indeterminate"]),t(ae,{class:"elevation-1",dense:"",headers:_,height:"400",items:T.value,loading:n.value},{"item.actions":a(({item:l})=>[t(u,{class:"mr-2",color:"primary",onClick:S=>H(l)},{default:a(()=>e[20]||(e[20]=[s(" mdi-square-edit-outline ")])),_:2},1032,["onClick"]),t(u,{color:"error",onClick:S=>G(l)},{default:a(()=>e[21]||(e[21]=[s(" mdi-delete ")])),_:2},1032,["onClick"])]),_:1},8,["items","loading"]),g("div",ie,[t(le,{modelValue:V.value,"onUpdate:modelValue":[e[2]||(e[2]=l=>V.value=l),c],length:D.value,"total-visible":"7"},null,8,["modelValue","length"])]),t(q,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value=l),"max-width":"600",transition:"dialog-top-transition"},{default:a(()=>[t(k,{class:"rounded-xl pa-4",elevation:"10"},{default:a(()=>[t(F,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:a(()=>[g("div",de,[t(u,{class:"mr-2 text-white"},{default:a(()=>e[22]||(e[22]=[s("mdi-tag-text")])),_:1}),g("span",ue,C(f.value?"Edit Cost Type":"Add Cost Type"),1)]),t(Y),t(d,{color:"white",icon:"mdi-close",onClick:e[3]||(e[3]=l=>p.value=!1)})]),_:1}),t(O,{class:"pt-6"},{default:a(()=>[t(oe,{onSubmit:e[6]||(e[6]=Z(()=>{},["prevent"]))},{default:a(()=>[t(U,{dense:""},{default:a(()=>[t(x,{cols:"12",sm:"6"},{default:a(()=>[t(I,{modelValue:r.name,"onUpdate:modelValue":e[4]||(e[4]=l=>r.name=l),"bg-color":"#E0E0E0","error-messages":w(y).name.$errors.map(l=>l.$message),label:"Cost Type Name",required:""},null,8,["modelValue","error-messages"])]),_:1}),t(x,{cols:"12",sm:"6"},{default:a(()=>[t(se,{modelValue:r.category,"onUpdate:modelValue":e[5]||(e[5]=l=>r.category=l),"bg-color":"#E0E0E0","error-messages":w(y).category.$errors.map(l=>l.$message),items:R,label:"Category",required:""},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1}),t(B,{class:"d-flex justify-end mt-2"},{default:a(()=>[t(d,{color:"success",disabled:w(y).$invalid,loading:n.value,onClick:J},{default:a(()=>[t(u,{start:""},{default:a(()=>e[23]||(e[23]=[s("mdi-content-save")])),_:1}),s(" "+C(f.value?"Save Changes":"Add Cost Type"),1)]),_:1},8,["disabled","loading"]),f.value?(P(),j(d,{key:0,color:"error",onClick:e[7]||(e[7]=l=>m.value=!0)},{default:a(()=>[t(u,{start:""},{default:a(()=>e[24]||(e[24]=[s("mdi-delete")])),_:1}),e[25]||(e[25]=s(" Delete "))]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(q,{modelValue:m.value,"onUpdate:modelValue":e[11]||(e[11]=l=>m.value=l),persistent:"",width:"400"},{default:a(()=>[t(k,null,{default:a(()=>[t(F,{color:"warning",title:"Confirm Deleting "+r.name},{default:a(()=>[t(d,{color:"white",icon:"mdi-close",onClick:e[9]||(e[9]=l=>m.value=!1)})]),_:1},8,["title"]),t(O,null,{default:a(()=>[s("Are you sure you want to delete "+C(r.name)+"?",1)]),_:1}),t(B,{class:"d-flex justify-end"},{default:a(()=>[t(d,{color:"grey",onClick:e[10]||(e[10]=l=>m.value=!1)},{default:a(()=>e[26]||(e[26]=[s("Cancel")])),_:1}),t(d,{color:"error",onClick:K},{default:a(()=>e[27]||(e[27]=[s("Delete")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},De=Q(fe,[["__scopeId","data-v-4fee6429"]]);export{De as default};
