import{_ as H,s as G,v as K,x as o,i as a,y as g,a4 as p,B as f,C as n,D as E,H as d,a6 as F,I as Q,a3 as R,a0 as W,r as v,$ as X,l as Y}from"./index-Bnk5GYx6.js";import{u as Z,r as A}from"./index-BgPRxr-N.js";import{V as C}from"./VDialog-GawDINYk.js";import{V as k,b as B,c as $}from"./VCard-CKmrYMwT.js";import{V as M}from"./VForm-CZoIHhKk.js";import{V as I}from"./VTextField--7_D2srZ.js";import{V as S}from"./VAutocomplete-GgNWZZY1.js";import{a as _}from"./VDataTable-DEKetQXu.js";import{V as ee}from"./VContainer-koWnkz3S.js";import"./dialog-transition-BvwwzNa3.js";import"./VChip-CYyzfqzx.js";import"./VSlideGroup-DPO1REek.js";const te={setup(){const m=W(),e=v(!1),b=v([]),t=v([]),D=v({}),U=v([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Unit",key:"unit"},{title:"Edit",key:"edit"}]),l=v(!1),V=v(!1),j=v(!1),N=v(!1),u=X({name:"",unit:""}),c=Z({name:{required:A},unit:{required:A}},u);function y(){e.value=!0,fetch("/items").then(s=>{s.json().then(i=>{e.value=!1,b.value=i}).catch(()=>{e.value=!1})}).catch(()=>{e.value=!1})}function T(){c.value.name.$touch(),l.value=!0,u.name=""}function z(s){D.value=JSON.parse(JSON.stringify(s)),V.value=!0,u.name=s.name,u.unit=s.unit}function h(){e.value=!0,fetch("/units").then(s=>{s.json().then(i=>{t.value=i})})}async function q(){if(c.value.$touch(),!await c.value.$validate())return;e.value=!0,l.value=!1;const i=new FormData;i.append("name",u.name),i.append("unit",u.unit),fetch("/items",{body:i,method:"POST"}).then(r=>{e.value=!1,r.status!==200&&r.status!==201?r.json().then(x=>{m.commit("setMessage",{type:"error",text:"Failed to save Unit! "+x.error,timeout:2e3})}):r.json().then(()=>{y(),m.commit("setMessage",{type:"primary",text:"Unit saved successfully!",timeout:2e3})})}).catch(r=>{e.value=!1,m.commit("setMessage",{type:"error",text:"Failed to save Unit!",timeout:2e3}),console.error("Error:",r)})}async function P(){if(c.value.$touch(),!await c.value.$validate())return;e.value=!0;const i=new FormData;i.append("name",u.name),i.append("unit",u.unit),fetch("/units/"+D.value.id,{body:i,method:"PUT"}).then(r=>{e.value=!1,V.value=!1,r.status!==200&&r.status!==201?r.json().then(x=>{m.commit("setMessage",{type:"error",text:"Failed to edit Item! "+x.error,timeout:2e3})}):r.json().then(()=>{y(),m.commit("setMessage",{type:"primary",text:"Item edited successfully!",timeout:2e3})})}).catch(r=>{e.value=!1,m.commit("setMessage",{type:"error",text:"Failed to edit Item!",timeout:2e3}),console.error("Error:",r)})}function O(){e.value=!0;const s=new FormData;j.value=!1,fetch("/units/"+D.value.id,{body:s,method:"DELETE"}).then(i=>{e.value=!1,V.value=!1,i.status!==200&&i.status!==201?i.json().then(r=>{m.commit("setMessage",{type:"error",text:"Failed to delete Item! "+r.error,timeout:2e3})}):i.json().then(()=>{y(),m.commit("setMessage",{type:"primary",text:"Item deleted successfully!",timeout:2e3})})}).catch(i=>{e.value=!1,m.commit("setMessage",{type:"error",text:"Failed to delete Item!",timeout:2e3}),console.error("Error:",i)})}function J(){fetch("/units?response=csv").then(s=>{s.text().then(i=>{const r="csv",L="data:text/csv;charset=utf-8,"+escape(i),w=document.createElement("a");w.setAttribute("href",L),w.setAttribute("download",`Item.${r}`),w.click()})}).catch(()=>{e.value=!1})}return Y(()=>{y(),h()}),{loading:e,values:b,units:t,headers:U,addDialog:l,editDialog:V,form:N,state:u,v$:c,editingItem:D,confirmDeleteDialog:j,csvExport:J,loadValues:y,activateAddDialog:T,activateEditDialog:z,create:q,saveEdit:P,remove:O}}},ae={class:"d-flex align-center flex-wrap"},le={class:"d-flex justify-end"},oe={class:"d-flex align-center flex-wrap"},ie={class:"d-flex justify-end justify-space-between"},ne={class:"d-flex justify-space-between mb-6"};function re(m,e,b,t,D,U){return K(),G(ee,{fluid:""},{default:o(()=>[a(C,{modelValue:t.addDialog,"onUpdate:modelValue":e[4]||(e[4]=l=>t.addDialog=l),transition:"dialog-top-transition",width:"600"},{default:o(()=>[a(k,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[a(p,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:o(()=>[g("div",ae,[a(f,{class:"mr-2 text-white"},{default:o(()=>e[16]||(e[16]=[n("mdi-map")])),_:1}),e[17]||(e[17]=g("span",{class:"text-white font-weight-bold text-h6"},"Add Item",-1))]),a(E),a(d,{color:"white",icon:"mdi-close",onClick:e[0]||(e[0]=l=>t.addDialog=!1)})]),_:1}),a(B,{class:"pt-6"},{default:o(()=>[a(M,{onSubmit:e[3]||(e[3]=F(()=>{},["prevent"]))},{default:o(()=>[a(I,{modelValue:t.state.name,"onUpdate:modelValue":e[1]||(e[1]=l=>t.state.name=l),"bg-color":"#BDBDBD","error-messages":t.v$.name.$errors.map(l=>l.$message),label:"Unit Name",required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),a(S,{modelValue:t.state.unit,"onUpdate:modelValue":e[2]||(e[2]=l=>t.state.unit=l),"bg-color":"#BDBDBD","error-messages":t.v$.unit.$errors.map(l=>l.$message),"item-title":l=>l?`${l.name??""}${l.shortname?` (${l.shortname})`:""}`:"","item-value":"id",items:t.units,label:"Unit",required:"",onBlur:t.v$.unit.$touch,onChange:t.v$.unit.$touch,"input-attrs":{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}},null,8,["modelValue","error-messages","item-title","items","onBlur","onChange"])]),_:1})]),_:1}),g("div",le,[a(d,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.create},{default:o(()=>[a(f,{start:""},{default:o(()=>e[18]||(e[18]=[n("mdi-plus")])),_:1}),e[19]||(e[19]=n(" Add "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),a(C,{modelValue:t.editDialog,"onUpdate:modelValue":e[12]||(e[12]=l=>t.editDialog=l),transition:"dialog-top-transition",width:"400"},{default:o(()=>[a(k,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[a(p,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:o(()=>[g("div",oe,[a(f,{class:"mr-2 text-white"},{default:o(()=>e[20]||(e[20]=[n("mdi-map")])),_:1}),e[21]||(e[21]=g("span",{class:"text-white font-weight-bold text-h6"},"Edit Unit",-1))]),a(E),a(d,{color:"white",icon:"mdi-close",onClick:e[5]||(e[5]=l=>t.editDialog=!1)})]),_:1}),a(B,{class:"pt-6"},{default:o(()=>[a(M,{onSubmit:e[9]||(e[9]=F(()=>{},["prevent"]))},{default:o(()=>[e[22]||(e[22]=g("br",null,null,-1)),a(I,{modelValue:t.editingItem.id,"onUpdate:modelValue":e[6]||(e[6]=l=>t.editingItem.id=l),"bg-color":"#BDBDBD",label:"ID",readonly:""},null,8,["modelValue"]),a(I,{modelValue:t.state.name,"onUpdate:modelValue":e[7]||(e[7]=l=>t.state.name=l),"bg-color":"#BDBDBD",clearable:"","error-messages":t.v$.name.$errors.map(l=>l.$message),label:"Unit",readonly:t.loading,required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","readonly","onBlur","onInput"]),a(S,{modelValue:t.state.unit,"onUpdate:modelValue":e[8]||(e[8]=l=>t.state.unit=l),"bg-color":"#BDBDBD","error-messages":t.v$.unit.$errors.map(l=>l.$message),"item-title":"short_name","item-value":"id",items:t.units,label:"Unit",required:"",onBlur:t.v$.unit.$touch,onChange:t.v$.unit.$touch},null,8,["modelValue","error-messages","items","onBlur","onChange"])]),_:1})]),_:1}),a($,{class:"d-flex justify-end justify-space-between"},{default:o(()=>[a(d,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.saveEdit},{default:o(()=>[a(f,{start:""},{default:o(()=>e[23]||(e[23]=[n("mdi-plus")])),_:1}),e[24]||(e[24]=n(" Save "))]),_:1},8,["disabled","loading","onClick"]),a(d,{color:"black",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[10]||(e[10]=l=>t.editDialog=!1)},{default:o(()=>[a(f,{start:""},{default:o(()=>e[25]||(e[25]=[n("mdi-cancel")])),_:1}),e[26]||(e[26]=n(" Cancel "))]),_:1},8,["disabled","loading"]),a(d,{color:"error",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[11]||(e[11]=l=>t.confirmDeleteDialog=!0)},{default:o(()=>[a(f,{start:""},{default:o(()=>e[27]||(e[27]=[n("mdi-delete")])),_:1}),e[28]||(e[28]=n(" Delete "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(C,{modelValue:t.confirmDeleteDialog,"onUpdate:modelValue":e[15]||(e[15]=l=>t.confirmDeleteDialog=l),persistent:"",width:"auto"},{default:o(()=>[a(k,null,{default:o(()=>[a(p,{color:"warning",title:"Confirm Deleteting "+t.state.name},{default:o(()=>[a(d,{color:"white",icon:"mdi-close",onClick:e[13]||(e[13]=l=>t.confirmDeleteDialog=!1)})]),_:1},8,["title"]),a(B,null,{default:o(()=>[n("Are you sure you want to delete "+Q(t.state.name)+"?",1)]),_:1}),g("div",ie,[a(d,{color:"success",onClick:e[14]||(e[14]=l=>t.confirmDeleteDialog=!1)},{default:o(()=>e[29]||(e[29]=[n("Cancel")])),_:1}),a(d,{color:"error",onClick:t.remove},{default:o(()=>e[30]||(e[30]=[n("Proceed")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),g("div",ne,[e[35]||(e[35]=n(" Items ")),a(d,{class:"text-black justify-end",size:"small",onClick:t.csvExport},{default:o(()=>[a(f,{color:"green",start:""},{default:o(()=>e[31]||(e[31]=[n("mdi-download")])),_:1}),e[32]||(e[32]=n(" Download "))]),_:1},8,["onClick"]),a(d,{class:"text-white justify-end",color:"#1A237E",size:"small",onClick:t.activateAddDialog},{default:o(()=>[a(f,null,{default:o(()=>e[33]||(e[33]=[n("mdi-plus")])),_:1}),e[34]||(e[34]=n(" Add New"))]),_:1},8,["onClick"])]),a(R,{active:t.loading,indeterminate:t.loading},null,8,["active","indeterminate"]),a(_,{class:"elevation-1",dense:"",headers:t.headers,height:"300",items:t.values,loading:t.loading},{"item.edit":o(({item:l})=>[a(f,{color:"#3F51B5",onClick:V=>t.activateEditDialog(l)},{default:o(()=>e[36]||(e[36]=[n("mdi-square-edit-outline")])),_:2},1032,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1})}const we=H(te,[["render",re]]);export{we as default};
