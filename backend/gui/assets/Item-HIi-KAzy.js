import{_ as J,s as L,v as G,x as o,i as l,y as g,a3 as p,B as f,C as n,D as E,H as d,a5 as F,I as K,aH as Q,a0 as R,r as v,$ as W,l as X}from"./index-CuMV6di3.js";import{u as Y,r as A}from"./index-D0GkZIkZ.js";import{V as C}from"./VDialog-CmVpAP_y.js";import{V as k,b as B,c as Z}from"./VCard-Bc391oxu.js";import{V as M}from"./VForm-YyT9asQ3.js";import{V as I}from"./VTextField-CjsJoSZp.js";import{V as S}from"./VAutocomplete-D3zximuH.js";import{a as _}from"./VDataTable-ChORe5xA.js";import{V as ee}from"./VContainer-C4bV-9UQ.js";import"./dialog-transition-Cab09yLL.js";import"./VChip-ZPEXUT-r.js";import"./VSlideGroup-Bd5aveAd.js";const te={setup(){const m=R(),e=v(!1),b=v([]),t=v([]),D=v({}),U=v([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Unit",key:"unit"},{title:"Edit",key:"edit"}]),a=v(!1),V=v(!1),j=v(!1),N=v(!1),u=W({name:"",unit:""}),c=Y({name:{required:A},unit:{required:A}},u);function y(){e.value=!0,fetch("/items").then(s=>{s.json().then(i=>{e.value=!1,b.value=i}).catch(()=>{e.value=!1})}).catch(()=>{e.value=!1})}function T(){c.value.name.$touch(),a.value=!0,u.name=""}function h(s){D.value=JSON.parse(JSON.stringify(s)),V.value=!0,u.name=s.name,u.unit=s.unitid}function q(){e.value=!0,fetch("/units").then(s=>{s.json().then(i=>{t.value=i})})}async function z(){if(c.value.$touch(),!await c.value.$validate())return;e.value=!0,a.value=!1;const i=new FormData;i.append("name",u.name),i.append("unit",u.unit),fetch("/items",{body:i,method:"POST"}).then(r=>{e.value=!1,r.status!==200&&r.status!==201?r.json().then(x=>{m.commit("setMessage",{type:"error",text:"Failed to save Unit! "+x.error,timeout:2e3})}):r.json().then(()=>{y(),m.commit("setMessage",{type:"primary",text:"Unit saved successfully!",timeout:2e3})})}).catch(r=>{e.value=!1,m.commit("setMessage",{type:"error",text:"Failed to save Unit!",timeout:2e3}),console.error("Error:",r)})}async function P(){if(c.value.$touch(),!await c.value.$validate())return;e.value=!0;const i=new FormData;i.append("name",u.name),i.append("unit",u.unit),fetch("/items/"+D.value.id,{body:i,method:"PUT"}).then(r=>{e.value=!1,V.value=!1,r.status!==200&&r.status!==201?r.json().then(x=>{m.commit("setMessage",{type:"error",text:"Failed to edit Item! "+x.error,timeout:2e3})}):r.json().then(()=>{y(),m.commit("setMessage",{type:"primary",text:"Item edited successfully!",timeout:2e3})})}).catch(r=>{e.value=!1,m.commit("setMessage",{type:"error",text:"Failed to edit Item!",timeout:2e3}),console.error("Error:",r)})}function O(){e.value=!0;const s=new FormData;j.value=!1,fetch("/items/"+D.value.id,{body:s,method:"DELETE"}).then(i=>{e.value=!1,V.value=!1,i.status!==200&&i.status!==201?i.json().then(r=>{m.commit("setMessage",{type:"error",text:"Failed to delete Item! "+r.error,timeout:2e3})}):i.json().then(()=>{y(),m.commit("setMessage",{type:"primary",text:"Item deleted successfully!",timeout:2e3})})}).catch(i=>{e.value=!1,m.commit("setMessage",{type:"error",text:"Failed to delete Item!",timeout:2e3}),console.error("Error:",i)})}function $(){fetch("/units?response=csv").then(s=>{s.text().then(i=>{const r="csv",H="data:text/csv;charset=utf-8,"+escape(i),w=document.createElement("a");w.setAttribute("href",H),w.setAttribute("download",`Item.${r}`),w.click()})}).catch(()=>{e.value=!1})}return X(()=>{y(),q()}),{loading:e,values:b,units:t,headers:U,addDialog:a,editDialog:V,form:N,state:u,v$:c,editingItem:D,confirmDeleteDialog:j,csvExport:$,loadValues:y,activateAddDialog:T,activateEditDialog:h,create:z,saveEdit:P,remove:O}}},ae={class:"d-flex align-center flex-wrap"},le={class:"d-flex justify-end"},oe={class:"d-flex align-center flex-wrap"},ie={class:"d-flex justify-end justify-space-between"},ne={class:"d-flex justify-space-between mb-6"};function re(m,e,b,t,D,U){return G(),L(ee,{fluid:""},{default:o(()=>[l(C,{modelValue:t.addDialog,"onUpdate:modelValue":e[4]||(e[4]=a=>t.addDialog=a),transition:"dialog-top-transition",width:"600"},{default:o(()=>[l(k,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[l(p,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:o(()=>[g("div",ae,[l(f,{class:"mr-2 text-white"},{default:o(()=>e[16]||(e[16]=[n("mdi-map")])),_:1}),e[17]||(e[17]=g("span",{class:"text-white font-weight-bold text-h6"},"Add Item",-1))]),l(E),l(d,{color:"white",icon:"mdi-close",onClick:e[0]||(e[0]=a=>t.addDialog=!1)})]),_:1}),l(B,{class:"pt-6"},{default:o(()=>[l(M,{onSubmit:e[3]||(e[3]=F(()=>{},["prevent"]))},{default:o(()=>[l(I,{modelValue:t.state.name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.state.name=a),"bg-color":"#BDBDBD","error-messages":t.v$.name.$errors.map(a=>a.$message),label:"Unit Name",required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),l(S,{modelValue:t.state.unit,"onUpdate:modelValue":e[2]||(e[2]=a=>t.state.unit=a),autocomplete:"off",autocorrect:"off","bg-color":"#BDBDBD","error-messages":t.v$.unit.$errors.map(a=>a.$message),inputmode:"none","item-title":a=>a?`${a.name??""}${a.shortname?` (${a.shortname})`:""}`:"","item-value":"id",items:t.units,label:"Unit",required:"",spellcheck:"false",onBlur:t.v$.unit.$touch,onChange:t.v$.unit.$touch},null,8,["modelValue","error-messages","item-title","items","onBlur","onChange"])]),_:1})]),_:1}),g("div",le,[l(d,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.create},{default:o(()=>[l(f,{start:""},{default:o(()=>e[18]||(e[18]=[n("mdi-plus")])),_:1}),e[19]||(e[19]=n(" Add "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),l(C,{modelValue:t.editDialog,"onUpdate:modelValue":e[12]||(e[12]=a=>t.editDialog=a),transition:"dialog-top-transition",width:"400"},{default:o(()=>[l(k,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[l(p,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:o(()=>[g("div",oe,[l(f,{class:"mr-2 text-white"},{default:o(()=>e[20]||(e[20]=[n("mdi-map")])),_:1}),e[21]||(e[21]=g("span",{class:"text-white font-weight-bold text-h6"},"Edit Unit",-1))]),l(E),l(d,{color:"white",icon:"mdi-close",onClick:e[5]||(e[5]=a=>t.editDialog=!1)})]),_:1}),l(B,{class:"pt-6"},{default:o(()=>[l(M,{onSubmit:e[9]||(e[9]=F(()=>{},["prevent"]))},{default:o(()=>[e[22]||(e[22]=g("br",null,null,-1)),l(I,{modelValue:t.editingItem.id,"onUpdate:modelValue":e[6]||(e[6]=a=>t.editingItem.id=a),"bg-color":"#BDBDBD",label:"ID",readonly:""},null,8,["modelValue"]),l(I,{modelValue:t.state.name,"onUpdate:modelValue":e[7]||(e[7]=a=>t.state.name=a),"bg-color":"#BDBDBD",clearable:"","error-messages":t.v$.name.$errors.map(a=>a.$message),label:"Unit",readonly:t.loading,required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","readonly","onBlur","onInput"]),l(S,{modelValue:t.state.unit,"onUpdate:modelValue":e[8]||(e[8]=a=>t.state.unit=a),"bg-color":"#BDBDBD","error-messages":t.v$.unit.$errors.map(a=>a.$message),"item-title":a=>a?`${a.name??""}${a.shortname?` (${a.shortname})`:""}`:"","item-value":"id",items:t.units,label:"Unit",required:"",onBlur:t.v$.unit.$touch,onChange:t.v$.unit.$touch},null,8,["modelValue","error-messages","item-title","items","onBlur","onChange"])]),_:1})]),_:1}),l(Z,{class:"d-flex justify-end justify-space-between"},{default:o(()=>[l(d,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.saveEdit},{default:o(()=>[l(f,{start:""},{default:o(()=>e[23]||(e[23]=[n("mdi-plus")])),_:1}),e[24]||(e[24]=n(" Save "))]),_:1},8,["disabled","loading","onClick"]),l(d,{color:"black",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[10]||(e[10]=a=>t.editDialog=!1)},{default:o(()=>[l(f,{start:""},{default:o(()=>e[25]||(e[25]=[n("mdi-cancel")])),_:1}),e[26]||(e[26]=n(" Cancel "))]),_:1},8,["disabled","loading"]),l(d,{color:"error",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[11]||(e[11]=a=>t.confirmDeleteDialog=!0)},{default:o(()=>[l(f,{start:""},{default:o(()=>e[27]||(e[27]=[n("mdi-delete")])),_:1}),e[28]||(e[28]=n(" Delete "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(C,{modelValue:t.confirmDeleteDialog,"onUpdate:modelValue":e[15]||(e[15]=a=>t.confirmDeleteDialog=a),persistent:"",width:"auto"},{default:o(()=>[l(k,null,{default:o(()=>[l(p,{color:"warning",title:"Confirm Deleteting "+t.state.name},{default:o(()=>[l(d,{color:"white",icon:"mdi-close",onClick:e[13]||(e[13]=a=>t.confirmDeleteDialog=!1)})]),_:1},8,["title"]),l(B,null,{default:o(()=>[n("Are you sure you want to delete "+K(t.state.name)+"?",1)]),_:1}),g("div",ie,[l(d,{color:"success",onClick:e[14]||(e[14]=a=>t.confirmDeleteDialog=!1)},{default:o(()=>e[29]||(e[29]=[n("Cancel")])),_:1}),l(d,{color:"error",onClick:t.remove},{default:o(()=>e[30]||(e[30]=[n("Proceed")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),g("div",ne,[e[35]||(e[35]=n(" Items ")),l(d,{class:"text-black justify-end",size:"small",onClick:t.csvExport},{default:o(()=>[l(f,{color:"green",start:""},{default:o(()=>e[31]||(e[31]=[n("mdi-download")])),_:1}),e[32]||(e[32]=n(" Download "))]),_:1},8,["onClick"]),l(d,{class:"text-white justify-end",color:"#1A237E",size:"small",onClick:t.activateAddDialog},{default:o(()=>[l(f,null,{default:o(()=>e[33]||(e[33]=[n("mdi-plus")])),_:1}),e[34]||(e[34]=n(" Add New"))]),_:1},8,["onClick"])]),l(Q,{active:t.loading,indeterminate:t.loading},null,8,["active","indeterminate"]),l(_,{class:"elevation-1",dense:"",headers:t.headers,height:"300",items:t.values,loading:t.loading},{"item.edit":o(({item:a})=>[l(f,{color:"#3F51B5",onClick:V=>t.activateEditDialog(a)},{default:o(()=>e[36]||(e[36]=[n("mdi-square-edit-outline")])),_:2},1032,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1})}const we=J(te,[["render",re]]);export{we as default};
