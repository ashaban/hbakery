import{_ as Q,q as k,v as a,r as u,$ as W,k as X,a0 as Y,t as p,h as t,x as V,a2 as x,A as i,B as d,C as U,G as f,H as j,Z as h,a3 as $,ae as _,aM as ee,D as S,F,E as P}from"./index-C5AuoeNd.js";import{u as le,r as b,e as oe}from"./index-fj-cY83t.js";import{V as te}from"./VContainer-BcSIjhpB.js";import{V as N}from"./VDialog-btw1dKcQ.js";import{V as C,b as A}from"./VCard-iFve92Gk.js";import{V as m}from"./VTextField-CqaUnYF9.js";import{V as E}from"./VAutocomplete-BiMhmsnJ.js";import{a as ae}from"./VDataTable-DPiP-HP8.js";import{V as q}from"./VChip-D8TbeJSB.js";import"./dialog-transition-D11mxrSC.js";import"./VSlideGroup-P1ul04zg.js";const se={setup(){const v=Y(),e=u(!1),B=u(!1),l=u([]),O=u([]),T=u([]),o=u(!1),n=u(!1),c=u(!1),w=u({}),I=u(!1),D=W({name:"",title:"",email:"",phone:"",password:"",roles:[],outlets:[]}),M=le({name:{required:b},email:{required:b,email:oe},phone:{required:b},password:{required:b},roles:{required:b}},D),R=[{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Roles",key:"roles"},{title:"Outlets",key:"outlets"},{title:"Edit",key:"edit"}];function y(){B.value=!0,fetch("/users/getUsers").then(s=>s.json()).then(s=>{l.value=s,B.value=!1}).catch(()=>B.value=!1)}function z(){fetch("/users/getRoles").then(s=>s.json()).then(s=>O.value=s)}function L(){fetch("/outlets").then(s=>s.json()).then(s=>T.value=s.data)}function J(){Object.assign(D,{name:"",title:"",email:"",phone:"",password:"",roles:[],outlets:[]}),o.value=!0}function G(s){w.value=s,Object.assign(D,{name:s.name,title:s.title,email:s.email,phone:s.phone,password:"unchangedpassword",roles:s.roles.map(r=>r.id),outlets:s.outlets.map(r=>r.id)}),n.value=!0}function H(){e.value=!0;const s=new FormData;for(const[r,g]of Object.entries(D))Array.isArray(g)?s.append(r,JSON.stringify(g)):s.append(r,g);fetch("/users/addUser",{method:"POST",body:s}).then(r=>r.json()).then(()=>{e.value=!1,o.value=!1,y(),v.commit("setMessage",{type:"success",text:"User saved successfully!",timeout:2500})})}function Z(){e.value=!0;const s=new FormData;for(const[r,g]of Object.entries(D))Array.isArray(g)?s.append(r,JSON.stringify(g)):s.append(r,g);fetch(`/users/editUser/${w.value.id}`,{method:"POST",body:s}).then(r=>r.json()).then(()=>{e.value=!1,n.value=!1,y(),v.commit("setMessage",{type:"success",text:"User updated successfully!",timeout:2500})})}function K(){e.value=!0,c.value=!1,fetch(`/users/deleteUser/${w.value.id}`,{method:"DELETE"}).then(s=>s.json()).then(()=>{e.value=!1,n.value=!1,y(),v.commit("setMessage",{type:"success",text:"User deleted successfully!",timeout:2500})})}return X(()=>{y(),z(),L()}),{loading:e,loadingValues:B,roles:O,availableOutlets:T,values:l,headers:R,state:D,v$:M,addDialog:o,editDialog:n,confirmDeleteDialog:c,editingItem:w,password_show:I,activateAddDialog:J,activateEditDialog:G,create:H,saveEdit:Z,remove:K}}},de={class:"d-flex justify-end pr-3 pb-3"},re={class:"d-flex justify-space-between pr-3 pb-3"},ie={class:"d-flex justify-end px-4 pb-4"};function ne(v,e,B,l,O,T){return p(),k(te,{fluid:""},{default:a(()=>[t(N,{modelValue:l.addDialog,"onUpdate:modelValue":e[9]||(e[9]=o=>l.addDialog=o),transition:"dialog-top-transition",width:"620"},{default:a(()=>[t(C,{class:"rounded-xl pa-4",elevation:"10"},{default:a(()=>[t(x,{class:"rounded-lg px-4",color:"primary",flat:""},{default:a(()=>[t(i,{class:"mr-2 text-white"},{default:a(()=>e[26]||(e[26]=[d("mdi-account-plus")])),_:1}),e[28]||(e[28]=V("span",{class:"text-white font-weight-bold text-h6"},"Add User",-1)),t(U),t(f,{color:"white",icon:"",onClick:e[0]||(e[0]=o=>l.addDialog=!1)},{default:a(()=>[t(i,null,{default:a(()=>e[27]||(e[27]=[d("mdi-close")])),_:1})]),_:1})]),_:1}),t(A,{class:"pt-6"},{default:a(()=>[t(m,{modelValue:l.state.name,"onUpdate:modelValue":e[1]||(e[1]=o=>l.state.name=o),"bg-color":"#BDBDBD","error-messages":l.v$.name.$errors.map(o=>o.$message),label:"Full Name",required:"",onBlur:l.v$.name.$touch},null,8,["modelValue","error-messages","onBlur"]),t(m,{modelValue:l.state.title,"onUpdate:modelValue":e[2]||(e[2]=o=>l.state.title=o),"bg-color":"#BDBDBD",label:"Title"},null,8,["modelValue"]),t(m,{modelValue:l.state.email,"onUpdate:modelValue":e[3]||(e[3]=o=>l.state.email=o),"bg-color":"#BDBDBD","error-messages":l.v$.email.$errors.map(o=>o.$message),label:"Email",required:"",onBlur:l.v$.email.$touch},null,8,["modelValue","error-messages","onBlur"]),t(m,{modelValue:l.state.phone,"onUpdate:modelValue":e[4]||(e[4]=o=>l.state.phone=o),"bg-color":"#BDBDBD","error-messages":l.v$.phone.$errors.map(o=>o.$message),label:"Phone Number",required:"",onBlur:l.v$.phone.$touch},null,8,["modelValue","error-messages","onBlur"]),t(E,{modelValue:l.state.roles,"onUpdate:modelValue":e[5]||(e[5]=o=>l.state.roles=o),"bg-color":"#BDBDBD",chips:"","closable-chips":"","error-messages":l.v$.roles.$errors.map(o=>o.$message),"item-title":"display","item-value":"id",items:l.roles,label:"Assign Roles",multiple:"",onBlur:l.v$.roles.$touch},null,8,["modelValue","error-messages","items","onBlur"]),t(E,{modelValue:l.state.outlets,"onUpdate:modelValue":e[6]||(e[6]=o=>l.state.outlets=o),"bg-color":"#BDBDBD",chips:"","closable-chips":"","item-title":"name","item-value":"id",items:l.availableOutlets,label:"Assigned Outlets",multiple:""},null,8,["modelValue","items"]),t(m,{modelValue:l.state.password,"onUpdate:modelValue":e[7]||(e[7]=o=>l.state.password=o),"append-icon":l.password_show?"mdi-eye":"mdi-eye-off","bg-color":"#BDBDBD","error-messages":l.v$.password.$errors.map(o=>o.$message),label:"Password",type:l.password_show?"text":"password",onBlur:l.v$.password.$touch,"onClick:append":e[8]||(e[8]=o=>l.password_show=!l.password_show)},null,8,["modelValue","append-icon","error-messages","type","onBlur"])]),_:1}),V("div",de,[t(f,{color:"success",disabled:l.v$.$error,loading:l.loading,onClick:l.create},{default:a(()=>[t(i,{start:""},{default:a(()=>e[29]||(e[29]=[d("mdi-check")])),_:1}),e[30]||(e[30]=d(" Save "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),t(N,{modelValue:l.editDialog,"onUpdate:modelValue":e[22]||(e[22]=o=>l.editDialog=o),transition:"dialog-top-transition",width:"620"},{default:a(()=>[t(C,{class:"rounded-xl pa-4",elevation:"10"},{default:a(()=>[t(x,{class:"rounded-lg px-4",color:"primary",flat:""},{default:a(()=>[t(i,{class:"mr-2 text-white"},{default:a(()=>e[31]||(e[31]=[d("mdi-account-edit")])),_:1}),e[33]||(e[33]=V("span",{class:"text-white font-weight-bold text-h6"},"Edit User",-1)),t(U),t(f,{color:"white",icon:"",onClick:e[10]||(e[10]=o=>l.editDialog=!1)},{default:a(()=>[t(i,null,{default:a(()=>e[32]||(e[32]=[d("mdi-close")])),_:1})]),_:1})]),_:1}),t(A,{class:"pt-6"},{default:a(()=>[t(m,{modelValue:l.editingItem.id,"onUpdate:modelValue":e[11]||(e[11]=o=>l.editingItem.id=o),"bg-color":"#BDBDBD",disabled:"",label:"User ID"},null,8,["modelValue"]),t(m,{modelValue:l.state.email,"onUpdate:modelValue":e[12]||(e[12]=o=>l.state.email=o),"bg-color":"#BDBDBD",disabled:"",label:"Email"},null,8,["modelValue"]),t(m,{modelValue:l.state.name,"onUpdate:modelValue":e[13]||(e[13]=o=>l.state.name=o),"bg-color":"#BDBDBD",label:"Full Name",onBlur:l.v$.name.$touch},null,8,["modelValue","onBlur"]),t(m,{modelValue:l.state.title,"onUpdate:modelValue":e[14]||(e[14]=o=>l.state.title=o),"bg-color":"#BDBDBD",label:"Title"},null,8,["modelValue"]),t(m,{modelValue:l.state.phone,"onUpdate:modelValue":e[15]||(e[15]=o=>l.state.phone=o),"bg-color":"#BDBDBD",label:"Phone Number",onBlur:l.v$.phone.$touch},null,8,["modelValue","onBlur"]),t(E,{modelValue:l.state.roles,"onUpdate:modelValue":e[16]||(e[16]=o=>l.state.roles=o),"bg-color":"#BDBDBD",chips:"","closable-chips":"","item-title":"display","item-value":"id",items:l.roles,label:"Assign Roles",multiple:""},null,8,["modelValue","items"]),t(E,{modelValue:l.state.outlets,"onUpdate:modelValue":e[17]||(e[17]=o=>l.state.outlets=o),"bg-color":"#BDBDBD",chips:"","closable-chips":"","item-title":"name","item-value":"id",items:l.availableOutlets,label:"Assigned Outlets",multiple:""},null,8,["modelValue","items"]),t(m,{modelValue:l.state.password,"onUpdate:modelValue":e[18]||(e[18]=o=>l.state.password=o),"append-icon":l.password_show?"mdi-eye":"mdi-eye-off","bg-color":"#BDBDBD",label:"Password",type:l.password_show?"text":"password","onClick:append":e[19]||(e[19]=o=>l.password_show=!l.password_show)},null,8,["modelValue","append-icon","type"])]),_:1}),V("div",re,[t(f,{color:"success",loading:l.loading,onClick:l.saveEdit},{default:a(()=>[t(i,{start:""},{default:a(()=>e[34]||(e[34]=[d("mdi-content-save")])),_:1}),e[35]||(e[35]=d(" Save "))]),_:1},8,["loading","onClick"]),t(f,{color:"black",onClick:e[20]||(e[20]=o=>l.editDialog=!1)},{default:a(()=>[t(i,{start:""},{default:a(()=>e[36]||(e[36]=[d("mdi-cancel")])),_:1}),e[37]||(e[37]=d(" Cancel "))]),_:1}),t(f,{color:"error",onClick:e[21]||(e[21]=o=>l.confirmDeleteDialog=!0)},{default:a(()=>[t(i,{start:""},{default:a(()=>e[38]||(e[38]=[d("mdi-delete")])),_:1}),e[39]||(e[39]=d(" Delete "))]),_:1})])]),_:1})]),_:1},8,["modelValue"]),t(N,{modelValue:l.confirmDeleteDialog,"onUpdate:modelValue":e[25]||(e[25]=o=>l.confirmDeleteDialog=o),persistent:"",width:"450"},{default:a(()=>[t(C,{class:"rounded-xl"},{default:a(()=>[t(x,{class:"px-4",color:"warning",flat:""},{default:a(()=>[t(i,{class:"mr-2 text-white"},{default:a(()=>e[40]||(e[40]=[d("mdi-alert")])),_:1}),e[42]||(e[42]=V("span",{class:"text-white font-weight-bold"},"Delete User",-1)),t(U),t(f,{color:"white",icon:"",onClick:e[23]||(e[23]=o=>l.confirmDeleteDialog=!1)},{default:a(()=>[t(i,null,{default:a(()=>e[41]||(e[41]=[d("mdi-close")])),_:1})]),_:1})]),_:1}),t(A,{class:"pt-4"},{default:a(()=>[e[43]||(e[43]=d(" Confirm deleting user ")),V("strong",null,j(l.state.name),1),e[44]||(e[44]=d("? "))]),_:1}),V("div",ie,[t(f,{variant:"text",onClick:e[24]||(e[24]=o=>l.confirmDeleteDialog=!1)},{default:a(()=>e[45]||(e[45]=[d("Cancel")])),_:1}),t(f,{color:"error",variant:"elevated",onClick:l.remove},{default:a(()=>e[46]||(e[46]=[d("Delete")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),t(x,{class:"rounded-lg mb-4 px-4",color:"primary",flat:""},{default:a(()=>[t($,{class:"text-white font-weight-bold text-h6"},{default:a(()=>[t(i,{class:"mr-2 text-white"},{default:a(()=>e[47]||(e[47]=[d("mdi-account")])),_:1}),e[48]||(e[48]=d(" Users "))]),_:1}),t(U),v.$store.getters.hasTask("can_add_users")?(p(),k(f,{key:0,class:"text-white",color:"#1A237E",size:"small",onClick:l.activateAddDialog},{default:a(()=>[t(i,{start:""},{default:a(()=>e[49]||(e[49]=[d("mdi-plus")])),_:1}),e[50]||(e[50]=d(" Add User "))]),_:1},8,["onClick"])):h("",!0)]),_:1}),t(C,{class:"rounded-lg"},{default:a(()=>[t(A,null,{default:a(()=>[t(_,{active:l.loadingValues,indeterminate:l.loadingValues},null,8,["active","indeterminate"]),t(ae,{class:"elevation-1",dense:"",headers:l.headers,items:l.values},ee({"item.roles":a(({item:o})=>[(p(!0),S(F,null,P(o.roles,n=>(p(),k(q,{key:n.id,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:a(()=>[d(j(n.display),1)]),_:2},1024))),128))]),"item.outlets":a(({item:o})=>[(p(!0),S(F,null,P(o.outlets,n=>(p(),k(q,{key:n.id,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:a(()=>[d(j(n.name),1)]),_:2},1024))),128))]),_:2},[v.$store.getters.hasTask("can_edit_users")?{name:"item.edit",fn:a(({item:o})=>[t(i,{color:"#3F51B5",onClick:n=>l.activateEditDialog(o)},{default:a(()=>e[51]||(e[51]=[d(" mdi-square-edit-outline ")])),_:2},1032,["onClick"])]),key:"0"}:void 0]),1032,["headers","items"])]),_:1})]),_:1})]),_:1})}const ke=Q(se,[["render",ne]]);export{ke as default};
