import{_ as Te,q as C,t as d,v as t,h as l,x as n,a2 as R,A as u,B as i,C as h,G as k,N as G,H as v,D as g,Z as T,F as x,E as b,K as Q,L as W,M as X,a3 as Ve,ae as De,r as y,$ as Y,d as L,k as _e}from"./index-AufZmc18.js";import{V as U}from"./VDialog-FeWyYRdM.js";import{V as p,b as F,c as E}from"./VCard-gCB2bKvl.js";import{V as N}from"./VCol-qt5Pa_73.js";import{V as S}from"./VTextField-CslDACNS.js";import{V}from"./VChip-BDEO4N76.js";import{V as q,a as I}from"./VExpansionPanels-BhjXWAfA.js";import{V as $}from"./VCheckbox-tv_PmNVT.js";import{a as Ae}from"./VDataTable-srb2EwFM.js";import{V as Be}from"./VContainer-B7y45AGF.js";import"./dialog-transition-TuGUUa7Q.js";import"./VSlideGroup-BhO_YnhD.js";const Re={name:"RolesManagement",setup(){const _=y([]),e=y([]),A=y([]),a=y(!1),O=y(!1),j=y(!1),s=y(!1),f=y(!1),w=y(!1),D=y([]),B=y([]),z=Y({id:null,name:"",display:"",tasks:[]}),H=y(""),K=y([]),r=Y({id:null,name:"",display:"",tasks:[]}),ee=[{title:"ID",key:"id"},{title:"Technical Name",key:"name"},{title:"Display Name",key:"display"},{title:"Assigned Tasks",key:"tasks"},{title:"Actions",key:"actions",sortable:!1}],J=L(()=>e.value.filter(o=>!r.tasks.find(m=>m.id===o.id))),le=L(()=>[...new Set(J.value.map(m=>m.category))].sort()),ae=L(()=>[...new Set(r.tasks.map(m=>m.category))].sort()),M=L(()=>r.name.trim()!==""&&r.display.trim()!==""&&D.value.length===0&&B.value.length===0);function Z(o,m){return(m==="available"?J.value:r.tasks).filter(Ce=>Ce.category===o)}function te(o,m){return!o||!Array.isArray(o)?[]:o.filter(c=>c.category===m)}function se(o,m){return Z(o,m).length}function oe(o){return!o||!Array.isArray(o)?[]:[...new Set(o.map(c=>c.category))].sort()}function ie(o,m){return!o||!Array.isArray(o)?0:o.filter(c=>c.category===m).length}function ne(o){return!o||!Array.isArray(o)?0:o.length}function re(){D.value=[],r.name.trim()||D.value.push("Technical name is required"),r.name.includes(" ")&&D.value.push("Technical name should not contain spaces")}function de(){B.value=[],r.display.trim()||B.value.push("Display name is required")}function fe(){A.value.forEach(o=>{const m=e.value.find(c=>c.id===o);m&&!r.tasks.find(c=>c.id===o)&&r.tasks.push(m)}),A.value=[]}function ue(o){r.tasks.find(m=>m.id===o.id)||r.tasks.push(o)}function me(o){r.tasks=r.tasks.filter(m=>m.id!==o.id)}function ge(){r.tasks=[]}function ve(o){z.id=o.id,z.name=o.name,z.display=o.display,z.tasks=[...o.tasks||[]],s.value=!0}function ke(o,m){H.value=o,K.value=m.filter(c=>c.category===o),f.value=!0}function ce(){r.id=null,r.name="",r.display="",r.tasks=[],A.value=[],D.value=[],B.value=[],O.value=!0}function ye(o){r.id=o.id,r.name=o.name,r.display=o.display,r.tasks=[...o.tasks||[]],A.value=[],D.value=[],B.value=[],j.value=!0,s.value=!1}async function P(){a.value=!0;try{const o=await fetch("/roles");o.ok?_.value=await o.json():console.error("Failed to load roles")}catch(o){console.error("Error loading roles:",o)}finally{a.value=!1}}async function xe(){try{const o=await fetch("/tasks");o.ok?e.value=await o.json():console.error("Failed to load tasks")}catch(o){console.error("Error loading tasks:",o)}}async function be(){if(M.value){a.value=!0;try{const o=await fetch("/roles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name.trim(),display:r.display.trim()})});if(!o.ok)throw new Error("Failed to create role");const m=await o.json();r.tasks.length>0&&await fetch(`/roles/${m.id}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:r.tasks.map(c=>c.id)})}),O.value=!1,await P()}catch(o){console.error("Error creating role:",o)}finally{a.value=!1}}}async function pe(){if(M.value){a.value=!0;try{await fetch(`/roles/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name.trim(),display:r.display.trim()})}),await fetch(`/roles/${r.id}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tasks:r.tasks.map(o=>o.id)})}),j.value=!1,await P()}catch(o){console.error("Error updating role:",o)}finally{a.value=!1}}}async function we(){a.value=!0;try{await fetch(`/roles/${r.id}`,{method:"DELETE"}),w.value=!1,j.value=!1,await P()}catch(o){console.error("Error deleting role:",o)}finally{a.value=!1}}return _e(()=>{P(),xe()}),{roles:_,allTasks:e,headers:ee,loading:a,addDialog:O,editDialog:j,viewDialog:s,categoryDialog:f,confirmDelete:w,roleForm:r,viewRole:z,selectedCategory:H,categoryTasks:K,unassignedTasks:J,selectedAvailableTasks:A,availableTaskCategories:le,assignedTaskCategories:ae,nameErrors:D,displayErrors:B,isFormValid:M,openAddDialog:ce,openEditDialog:ye,openViewDialog:ve,openCategoryDialog:ke,createRole:be,saveRoleEdit:pe,deleteRole:we,assignTask:ue,removeTask:me,assignSelectedTasks:fe,removeAllTasks:ge,validateName:re,validateDisplay:de,getTasksByCategory:Z,getTasksByCategoryForRole:te,getCategoryTaskCount:se,getRoleCategories:oe,getTaskCountByCategory:ie,getTaskCount:ne}}},he={class:"d-flex flex-row ga-4",style:{"min-height":"500px"}},Fe={class:"d-flex justify-space-between align-center mb-3"},Ee={class:"tasks-container"},Ne={class:"category-tasks"},Se={key:0,class:"text-caption text-grey text-center pa-4"},je={class:"d-flex justify-space-between align-center mb-3"},ze={class:"tasks-container"},Ue={class:"category-tasks"},Oe={class:"task-text"},Pe={key:0,class:"text-caption text-grey text-center pa-4"},Le={class:"d-flex justify-end pr-3 pb-3"},qe={class:"text-white font-weight-bold text-h6"},Ie={class:"d-flex flex-row ga-4",style:{"min-height":"500px"}},Je={class:"d-flex justify-space-between align-center mb-3"},Me={class:"tasks-container"},Ge={class:"category-tasks"},He={key:0,class:"text-caption text-grey text-center pa-4"},Ke={class:"d-flex justify-space-between align-center mb-3"},Ze={class:"tasks-container"},Qe={class:"category-tasks"},We={class:"task-text"},Xe={key:0,class:"text-caption text-grey text-center pa-4"},Ye={class:"d-flex justify-space-between pr-3 pb-3"},$e={class:"text-white font-weight-bold text-h6"},el={class:"tasks-summary"},ll={class:"categories-container"},al={class:"d-flex justify-space-between align-center mb-2"},tl={class:"font-weight-bold text-primary"},sl={key:0,class:"text-center pa-6"},ol={class:"text-white font-weight-bold text-h6"},il={class:"d-flex justify-end px-4 pb-4"},nl={class:"task-summary"},rl={class:"text-caption text-grey mb-1"},dl={class:"category-chips"},fl={key:0,class:"text-caption text-grey"},ul={class:"d-flex"};function ml(_,e,A,a,O,j){return d(),C(Be,{fluid:""},{default:t(()=>[l(U,{modelValue:a.addDialog,"onUpdate:modelValue":e[4]||(e[4]=s=>a.addDialog=s),transition:"dialog-bottom-transition",width:"900"},{default:t(()=>[l(p,{class:"rounded-xl pa-4",elevation:"10"},{default:t(()=>[l(R,{class:"rounded-lg px-4",color:"primary",flat:""},{default:t(()=>[l(u,{class:"mr-2 text-white"},{default:t(()=>e[21]||(e[21]=[i("mdi-shield-plus")])),_:1}),e[23]||(e[23]=n("span",{class:"text-white font-weight-bold text-h6"},"Add Role",-1)),l(h),l(k,{class:"text-white",icon:"",onClick:e[0]||(e[0]=s=>a.addDialog=!1)},{default:t(()=>[l(u,null,{default:t(()=>e[22]||(e[22]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(F,{class:"pt-6"},{default:t(()=>[l(G,null,{default:t(()=>[l(N,{cols:"12",md:"6"},{default:t(()=>[l(S,{modelValue:a.roleForm.name,"onUpdate:modelValue":e[1]||(e[1]=s=>a.roleForm.name=s),"bg-color":"#BDBDBD","error-messages":a.nameErrors,label:"Role technical name (admin, cashier)",onBlur:a.validateName},null,8,["modelValue","error-messages","onBlur"])]),_:1}),l(N,{cols:"12",md:"6"},{default:t(()=>[l(S,{modelValue:a.roleForm.display,"onUpdate:modelValue":e[2]||(e[2]=s=>a.roleForm.display=s),"bg-color":"#BDBDBD","error-messages":a.displayErrors,label:"Display name (Administrator, Sales Officer)",onBlur:a.validateDisplay},null,8,["modelValue","error-messages","onBlur"])]),_:1})]),_:1}),e[30]||(e[30]=n("h4",{class:"mt-6 mb-2 text-h6 font-weight-bold"},"Tasks Assignment",-1)),n("div",he,[l(p,{class:"flex-1 pa-3",elevation:"3"},{default:t(()=>[n("div",Fe,[e[24]||(e[24]=n("h4",{class:"font-weight-bold"},"Available Tasks",-1)),l(V,{color:"primary",size:"small",variant:"flat"},{default:t(()=>[i(v(a.unassignedTasks.length)+" tasks ",1)]),_:1})]),n("div",Ee,[(d(!0),g(x,null,b(a.availableTaskCategories,s=>(d(),g("div",{key:s,class:"category-section"},[l(q,{variant:"accordion"},{default:t(()=>[l(I,{title:`${s} (${a.getCategoryTaskCount(s,"available")})`},{text:t(()=>[n("div",Ne,[(d(!0),g(x,null,b(a.getTasksByCategory(s,"available"),f=>(d(),C($,{key:f.id,modelValue:a.selectedAvailableTasks,"onUpdate:modelValue":e[3]||(e[3]=w=>a.selectedAvailableTasks=w),class:"task-checkbox",density:"compact","hide-details":"",label:f.display,value:f.id},null,8,["modelValue","label","value"]))),128))])]),_:2},1032,["title"])]),_:2},1024)]))),128)),a.unassignedTasks.length===0?(d(),g("div",Se," No available tasks ")):T("",!0)]),l(E,{class:"px-0 pt-3"},{default:t(()=>[l(k,{block:"",color:"primary",disabled:a.selectedAvailableTasks.length===0,variant:"tonal",onClick:a.assignSelectedTasks},{default:t(()=>[l(u,{start:""},{default:t(()=>e[25]||(e[25]=[i("mdi-arrow-right")])),_:1}),i(" Assign Selected ("+v(a.selectedAvailableTasks.length)+") ",1)]),_:1},8,["disabled","onClick"])]),_:1})]),_:1}),l(p,{class:"flex-1 pa-3",elevation:"3"},{default:t(()=>[n("div",je,[e[26]||(e[26]=n("h4",{class:"font-weight-bold"},"Assigned Tasks",-1)),l(V,{color:"primary",size:"small",variant:"flat"},{default:t(()=>[i(v(a.roleForm.tasks.length)+" tasks ",1)]),_:1})]),n("div",ze,[(d(!0),g(x,null,b(a.assignedTaskCategories,s=>(d(),g("div",{key:s,class:"category-section"},[l(q,{variant:"accordion"},{default:t(()=>[l(I,{title:`${s} (${a.getCategoryTaskCount(s,"assigned")})`},{text:t(()=>[n("div",Ue,[(d(!0),g(x,null,b(a.getTasksByCategory(s,"assigned"),f=>(d(),g("div",{key:f.id,class:"task-item"},[n("span",Oe,v(f.display),1),l(k,{icon:"",size:"x-small",variant:"text",onClick:w=>a.removeTask(f)},{default:t(()=>[l(u,{color:"error",size:"16"},{default:t(()=>e[27]||(e[27]=[i("mdi-close")])),_:1})]),_:2},1032,["onClick"])]))),128))])]),_:2},1032,["title"])]),_:2},1024)]))),128)),a.roleForm.tasks.length===0?(d(),g("div",Pe," No tasks assigned ")):T("",!0)]),l(E,{class:"px-0 pt-3"},{default:t(()=>[l(k,{block:"",color:"error",disabled:a.roleForm.tasks.length===0,variant:"tonal",onClick:a.removeAllTasks},{default:t(()=>[l(u,{start:""},{default:t(()=>e[28]||(e[28]=[i("mdi-delete-sweep")])),_:1}),e[29]||(e[29]=i(" Remove All "))]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})])]),_:1}),n("div",Le,[l(k,{color:"success",disabled:!a.isFormValid,loading:a.loading,variant:"elevated",onClick:a.createRole},{default:t(()=>[l(u,{start:""},{default:t(()=>e[31]||(e[31]=[i("mdi-check")])),_:1}),e[32]||(e[32]=i(" Save Role "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),l(U,{modelValue:a.editDialog,"onUpdate:modelValue":e[10]||(e[10]=s=>a.editDialog=s),transition:"dialog-bottom-transition",width:"900"},{default:t(()=>[l(p,{class:"rounded-xl pa-4",elevation:"10"},{default:t(()=>[l(R,{class:"rounded-lg px-4",color:"primary",flat:""},{default:t(()=>[l(u,{class:"mr-2 text-white"},{default:t(()=>e[33]||(e[33]=[i("mdi-shield-edit")])),_:1}),n("span",qe," Edit Role – "+v(a.roleForm.display),1),l(h),l(k,{class:"text-white",icon:"",onClick:e[5]||(e[5]=s=>a.editDialog=!1)},{default:t(()=>[l(u,null,{default:t(()=>e[34]||(e[34]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(F,{class:"pt-6"},{default:t(()=>[l(G,null,{default:t(()=>[l(N,{cols:"12",md:"6"},{default:t(()=>[l(S,{modelValue:a.roleForm.name,"onUpdate:modelValue":e[6]||(e[6]=s=>a.roleForm.name=s),"bg-color":"#BDBDBD","error-messages":a.nameErrors,label:"Role Technical Name",onBlur:a.validateName},null,8,["modelValue","error-messages","onBlur"])]),_:1}),l(N,{cols:"12",md:"6"},{default:t(()=>[l(S,{modelValue:a.roleForm.display,"onUpdate:modelValue":e[7]||(e[7]=s=>a.roleForm.display=s),"bg-color":"#BDBDBD","error-messages":a.displayErrors,label:"Role Display Name",onBlur:a.validateDisplay},null,8,["modelValue","error-messages","onBlur"])]),_:1})]),_:1}),e[41]||(e[41]=n("h4",{class:"mt-6 mb-2 text-h6 font-weight-bold"},"Tasks Assignment",-1)),n("div",Ie,[l(p,{class:"flex-1 pa-3",elevation:"3"},{default:t(()=>[n("div",Je,[e[35]||(e[35]=n("h4",{class:"font-weight-bold"},"Available Tasks",-1)),l(V,{color:"primary",size:"small",variant:"flat"},{default:t(()=>[i(v(a.unassignedTasks.length)+" tasks ",1)]),_:1})]),n("div",Me,[(d(!0),g(x,null,b(a.availableTaskCategories,s=>(d(),g("div",{key:s,class:"category-section"},[l(q,{variant:"accordion"},{default:t(()=>[l(I,{title:`${s} (${a.getCategoryTaskCount(s,"available")})`},{text:t(()=>[n("div",Ge,[(d(!0),g(x,null,b(a.getTasksByCategory(s,"available"),f=>(d(),C($,{key:f.id,modelValue:a.selectedAvailableTasks,"onUpdate:modelValue":e[8]||(e[8]=w=>a.selectedAvailableTasks=w),class:"task-checkbox",density:"compact","hide-details":"",label:f.display,value:f.id},null,8,["modelValue","label","value"]))),128))])]),_:2},1032,["title"])]),_:2},1024)]))),128)),a.unassignedTasks.length===0?(d(),g("div",He," No available tasks ")):T("",!0)]),l(E,{class:"px-0 pt-3"},{default:t(()=>[l(k,{block:"",color:"primary",disabled:a.selectedAvailableTasks.length===0,variant:"tonal",onClick:a.assignSelectedTasks},{default:t(()=>[l(u,{start:""},{default:t(()=>e[36]||(e[36]=[i("mdi-arrow-right")])),_:1}),i(" Assign Selected ("+v(a.selectedAvailableTasks.length)+") ",1)]),_:1},8,["disabled","onClick"])]),_:1})]),_:1}),l(p,{class:"flex-1 pa-3",elevation:"3"},{default:t(()=>[n("div",Ke,[e[37]||(e[37]=n("h4",{class:"font-weight-bold"},"Assigned Tasks",-1)),l(V,{color:"primary",size:"small",variant:"flat"},{default:t(()=>[i(v(a.roleForm.tasks.length)+" tasks ",1)]),_:1})]),n("div",Ze,[(d(!0),g(x,null,b(a.assignedTaskCategories,s=>(d(),g("div",{key:s,class:"category-section"},[l(q,{variant:"accordion"},{default:t(()=>[l(I,{title:`${s} (${a.getCategoryTaskCount(s,"assigned")})`},{text:t(()=>[n("div",Qe,[(d(!0),g(x,null,b(a.getTasksByCategory(s,"assigned"),f=>(d(),g("div",{key:f.id,class:"task-item"},[n("span",We,v(f.display),1),l(k,{icon:"",size:"x-small",variant:"text",onClick:w=>a.removeTask(f)},{default:t(()=>[l(u,{color:"error",size:"16"},{default:t(()=>e[38]||(e[38]=[i("mdi-close")])),_:1})]),_:2},1032,["onClick"])]))),128))])]),_:2},1032,["title"])]),_:2},1024)]))),128)),a.roleForm.tasks.length===0?(d(),g("div",Xe," No tasks assigned ")):T("",!0)]),l(E,{class:"px-0 pt-3"},{default:t(()=>[l(k,{block:"",color:"error",disabled:a.roleForm.tasks.length===0,variant:"tonal",onClick:a.removeAllTasks},{default:t(()=>[l(u,{start:""},{default:t(()=>e[39]||(e[39]=[i("mdi-delete-sweep")])),_:1}),e[40]||(e[40]=i(" Remove All "))]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})])]),_:1}),n("div",Ye,[l(k,{color:"success",disabled:!a.isFormValid,loading:a.loading,variant:"elevated",onClick:a.saveRoleEdit},{default:t(()=>[l(u,{start:""},{default:t(()=>e[42]||(e[42]=[i("mdi-content-save")])),_:1}),e[43]||(e[43]=i(" Save "))]),_:1},8,["disabled","loading","onClick"]),l(k,{color:"error",variant:"elevated",onClick:e[9]||(e[9]=s=>a.confirmDelete=!0)},{default:t(()=>[l(u,{start:""},{default:t(()=>e[44]||(e[44]=[i("mdi-delete")])),_:1}),e[45]||(e[45]=i(" Delete "))]),_:1})])]),_:1})]),_:1},8,["modelValue"]),l(U,{modelValue:a.viewDialog,"onUpdate:modelValue":e[14]||(e[14]=s=>a.viewDialog=s),transition:"dialog-bottom-transition",width:"700"},{default:t(()=>[l(p,{class:"rounded-xl pa-4",elevation:"10"},{default:t(()=>[l(R,{class:"rounded-lg px-4",color:"info",flat:""},{default:t(()=>[l(u,{class:"mr-2 text-white"},{default:t(()=>e[46]||(e[46]=[i("mdi-eye")])),_:1}),n("span",$e," View Role – "+v(a.viewRole.display),1),l(h),l(k,{class:"text-white",icon:"",onClick:e[11]||(e[11]=s=>a.viewDialog=!1)},{default:t(()=>[l(u,null,{default:t(()=>e[47]||(e[47]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(F,{class:"pt-6"},{default:t(()=>[l(G,null,{default:t(()=>[l(N,{cols:"12",md:"6"},{default:t(()=>[l(S,{"bg-color":"#BDBDBD",label:"Role Technical Name","model-value":a.viewRole.name,readonly:""},null,8,["model-value"])]),_:1}),l(N,{cols:"12",md:"6"},{default:t(()=>[l(S,{"bg-color":"#BDBDBD",label:"Role Display Name","model-value":a.viewRole.display,readonly:""},null,8,["model-value"])]),_:1})]),_:1}),e[52]||(e[52]=n("h4",{class:"mt-6 mb-2 text-h6 font-weight-bold"},"Assigned Tasks",-1)),n("div",el,[l(V,{class:"mb-3",color:"primary",variant:"flat"},{default:t(()=>{var s;return[i(" Total: "+v(((s=a.viewRole.tasks)==null?void 0:s.length)||0)+" tasks assigned ",1)]}),_:1}),n("div",ll,[(d(!0),g(x,null,b(a.getRoleCategories(a.viewRole.tasks),s=>(d(),g("div",{key:s,class:"category-card"},[l(p,{class:"pa-3",elevation:"2"},{default:t(()=>[n("div",al,[n("h5",tl,v(s),1),l(V,{color:"primary",size:"small",variant:"outlined"},{default:t(()=>[i(v(a.getTaskCountByCategory(a.viewRole.tasks,s)),1)]),_:2},1024)]),l(Q,{density:"compact"},{default:t(()=>[(d(!0),g(x,null,b(a.getTasksByCategoryForRole(a.viewRole.tasks,s),f=>(d(),C(W,{key:f.id,class:"px-0"},{prepend:t(()=>[l(u,{color:"success",size:"16"},{default:t(()=>e[48]||(e[48]=[i("mdi-check-circle")])),_:1})]),default:t(()=>[l(X,{class:"text-caption"},{default:t(()=>[i(v(f.display),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]))),128))]),!a.viewRole.tasks||a.viewRole.tasks.length===0?(d(),g("div",sl,[l(u,{color:"grey",size:"48"},{default:t(()=>e[49]||(e[49]=[i("mdi-shield-off")])),_:1}),e[50]||(e[50]=n("div",{class:"text-h6 text-grey mt-2"},"No Tasks Assigned",-1)),e[51]||(e[51]=n("div",{class:"text-caption text-grey"}," This role doesn't have any permissions assigned yet. ",-1))])):T("",!0)])]),_:1}),l(E,{class:"justify-end pr-3 pb-3"},{default:t(()=>[_.$store.getters.hasTask("can_add_settings")?(d(),C(k,{key:0,color:"primary",variant:"elevated",onClick:e[12]||(e[12]=s=>a.openEditDialog(a.viewRole))},{default:t(()=>[l(u,{start:""},{default:t(()=>e[53]||(e[53]=[i("mdi-pencil")])),_:1}),e[54]||(e[54]=i(" Edit Role "))]),_:1})):T("",!0),l(k,{variant:"tonal",onClick:e[13]||(e[13]=s=>a.viewDialog=!1)},{default:t(()=>e[55]||(e[55]=[i(" Close ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(U,{modelValue:a.categoryDialog,"onUpdate:modelValue":e[17]||(e[17]=s=>a.categoryDialog=s),transition:"dialog-bottom-transition",width:"500"},{default:t(()=>[l(p,{class:"rounded-xl pa-4",elevation:"10"},{default:t(()=>[l(R,{class:"rounded-lg px-4",color:"primary",flat:""},{default:t(()=>[l(u,{class:"mr-2 text-white"},{default:t(()=>e[56]||(e[56]=[i("mdi-folder-eye")])),_:1}),n("span",ol,v(a.selectedCategory)+" Tasks ",1),l(h),l(k,{class:"text-white",icon:"",onClick:e[15]||(e[15]=s=>a.categoryDialog=!1)},{default:t(()=>[l(u,null,{default:t(()=>e[57]||(e[57]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(F,{class:"pt-6"},{default:t(()=>[l(V,{class:"mb-3",color:"primary",variant:"flat"},{default:t(()=>[i(v(a.categoryTasks.length)+" tasks in this category ",1)]),_:1}),l(Q,null,{default:t(()=>[(d(!0),g(x,null,b(a.categoryTasks,s=>(d(),C(W,{key:s.id,class:"px-0"},{prepend:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[58]||(e[58]=[i("mdi-check")])),_:1})]),append:t(()=>[l(V,{size:"x-small",variant:"outlined"},{default:t(()=>[i(v(s.code),1)]),_:2},1024)]),default:t(()=>[l(X,null,{default:t(()=>[i(v(s.display),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),l(E,{class:"justify-end pr-3 pb-3"},{default:t(()=>[l(k,{variant:"tonal",onClick:e[16]||(e[16]=s=>a.categoryDialog=!1)},{default:t(()=>e[59]||(e[59]=[i(" Close ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(U,{modelValue:a.confirmDelete,"onUpdate:modelValue":e[20]||(e[20]=s=>a.confirmDelete=s),width:"450"},{default:t(()=>[l(p,{class:"rounded-xl"},{default:t(()=>[l(R,{class:"px-4",color:"warning",flat:""},{default:t(()=>[l(u,{class:"mr-2 text-white"},{default:t(()=>e[60]||(e[60]=[i("mdi-alert")])),_:1}),e[62]||(e[62]=n("span",{class:"text-white font-weight-bold"},"Delete Role",-1)),l(h),l(k,{class:"text-white",icon:"",onClick:e[18]||(e[18]=s=>a.confirmDelete=!1)},{default:t(()=>[l(u,null,{default:t(()=>e[61]||(e[61]=[i("mdi-close")])),_:1})]),_:1})]),_:1}),l(F,{class:"pt-4"},{default:t(()=>[e[63]||(e[63]=i(" Are you sure you want to delete role ")),n("strong",null,v(a.roleForm.display),1),e[64]||(e[64]=i("? ")),e[65]||(e[65]=n("div",{class:"text-caption text-warning mt-2"}," Note: This action cannot be undone. ",-1))]),_:1}),n("div",il,[l(k,{variant:"text",onClick:e[19]||(e[19]=s=>a.confirmDelete=!1)},{default:t(()=>e[66]||(e[66]=[i("Cancel")])),_:1}),l(k,{color:"error",loading:a.loading,variant:"elevated",onClick:a.deleteRole},{default:t(()=>e[67]||(e[67]=[i(" Delete ")])),_:1},8,["loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),l(R,{class:"rounded-lg mb-4 px-4",color:"primary",flat:"",height:"60"},{default:t(()=>[l(Ve,{class:"text-white font-weight-bold text-h6"},{default:t(()=>[l(u,{class:"mr-2",color:"white"},{default:t(()=>e[68]||(e[68]=[i("mdi-shield-account")])),_:1}),e[69]||(e[69]=i(" Roles & Permissions "))]),_:1}),l(h),_.$store.getters.hasTask("can_add_settings")?(d(),C(k,{key:0,class:"text-white",color:"#1A237E",size:"small",onClick:a.openAddDialog},{default:t(()=>[l(u,{start:""},{default:t(()=>e[70]||(e[70]=[i("mdi-plus")])),_:1}),e[71]||(e[71]=i(" Add Role "))]),_:1},8,["onClick"])):T("",!0)]),_:1}),l(p,{class:"rounded-lg"},{default:t(()=>[l(F,null,{default:t(()=>[l(De,{active:a.loading,indeterminate:""},null,8,["active"]),l(Ae,{class:"elevation-1",dense:"",headers:a.headers,items:a.roles,loading:a.loading},{"item.tasks":t(({item:s})=>[n("div",nl,[n("div",rl,v(a.getTaskCount(s.tasks))+" tasks assigned ",1),n("div",dl,[(d(!0),g(x,null,b(a.getRoleCategories(s.tasks),f=>(d(),C(V,{key:f,class:"ma-1",color:"primary",size:"x-small",variant:"outlined",onClick:w=>a.openCategoryDialog(f,s.tasks)},{default:t(()=>[i(v(f)+" ("+v(a.getTaskCountByCategory(s.tasks,f))+") ",1)]),_:2},1032,["onClick"]))),128)),a.getTaskCount(s.tasks)===0?(d(),g("span",fl," No tasks assigned ")):T("",!0)])])]),"item.actions":t(({item:s})=>[n("div",ul,[l(u,{class:"mr-2",color:"info",size:"18",onClick:f=>a.openViewDialog(s)},{default:t(()=>e[72]||(e[72]=[i(" mdi-eye ")])),_:2},1032,["onClick"]),_.$store.getters.hasTask("can_add_settings")?(d(),C(u,{key:0,color:"#3F51B5",size:"18",onClick:f=>a.openEditDialog(s)},{default:t(()=>e[73]||(e[73]=[i(" mdi-square-edit-outline ")])),_:2},1032,["onClick"])):T("",!0)])]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})}const Dl=Te(Re,[["render",ml],["__scopeId","data-v-1371f7d2"]]);export{Dl as default};
