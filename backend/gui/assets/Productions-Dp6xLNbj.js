import{g as At,p as Ut,f as St,h as l,a5 as Ve,a6 as vl,d as E,a7 as bl,r as S,a8 as xl,x as o,F as N,a9 as Vl,aa as gt,ab as wl,_ as kl,$ as De,k as ql,q as y,v as t,a1 as hl,t as c,Z as x,B as d,G as C,A as u,H as n,N as j,z as h,C as te,O as ce,L as K,ac as vt,ad as bt,ae as xt,i as de,K as me,M as X,af as Q,D as P,a2 as Ie,a3 as je,E as Y,a4 as Vt}from"./index-H50W8i2e.js";import{h as Dt}from"./moment-C5S46NFB.js";import{V as zl}from"./VContainer-DMI-Talr.js";import{V as le}from"./VAlert-BPfj7QNO.js";import{V as g,b as v,a as be,c as wt}from"./VCard-C5kPO-IU.js";import{V as p}from"./VCol-DKsUkiwi.js";import{V as w}from"./VChip-CknWNZ2i.js";import{V as fe}from"./VAutocomplete-CV6x0zIW.js";import{c as He,m as Pl,d as Cl,e as Al,V as ie,a as xe,f as kt,b as Ul}from"./VDataTable-DzzvSt4O.js";import{V as qt}from"./VSkeletonLoader-DfvCyuAl.js";import{V as Sl}from"./VBadge-DVfURfUf.js";import{V as Te}from"./VDialog-CbIFtiIj.js";import{V as ht}from"./VForm-DkaCVQlE.js";import{a as zt,b as Dl,m as Il,V as R}from"./VTextField-DlorsO1F.js";import{V as jl}from"./VSwitch-CTNrBcxO.js";import{V as Pt,a as Ne,b as Ct,c as $e}from"./VTabs-DbM2dakC.js";import{V as Tl}from"./VTooltip-DwwKazbP.js";import{V as Nl,a as $l,b as Bl,c as Ml}from"./VExpansionPanels-Cw2jxTjr.js";import"./VSlideGroup-CGGaxYAb.js";import"./dialog-transition-CzUKY-Zy.js";const Le=D=>D?Dt(D).format("DD-MM-YYYY HH:mm"):"",Oe=D=>D?Dt(D,"DD-MM-YYYY HH:mm").format("YYYY-MM-DD HH:mm"):null,Fl=Ut({...Pl({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Rl=At()({name:"VRadio",props:Fl(),setup(D,G){let{slots:W}=G;return St(()=>{const F=He.filterProps(D);return l(He,Ve(F,{class:["v-radio",D.class],style:D.style,type:"radio"}),W)}),{}}}),El=Ut({height:{type:[Number,String],default:"auto"},...Il(),...wl(Al(),["multiple"]),trueIcon:{type:gt,default:"$radioOn"},falseIcon:{type:gt,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Gl=At()({name:"VRadioGroup",inheritAttrs:!1,props:El(),emits:{"update:modelValue":D=>!0},setup(D,G){let{attrs:W,slots:F}=G;const ee=vl(),L=E(()=>D.id||`radio-group-${ee}`),Z=bl(D,"modelValue"),pe=S();return St(()=>{const[ae,_e]=xl(W),ye=zt.filterProps(D),ne=He.filterProps(D),U=F.label?F.label({label:D.label,props:{for:L.value}}):D.label;return l(zt,Ve({ref:pe,class:["v-radio-group",D.class],style:D.style},ae,ye,{modelValue:Z.value,"onUpdate:modelValue":O=>Z.value=O,id:L.value}),{...F,default:O=>{let{id:H,messagesId:se,isDisabled:q,isReadonly:ze}=O;return o(N,null,[U&&l(Dl,{id:H.value},{default:()=>[U]}),l(Cl,Ve(ne,{id:H.value,"aria-describedby":se.value,defaultsTarget:"VRadio",trueIcon:D.trueIcon,falseIcon:D.falseIcon,type:D.type,disabled:q.value,readonly:ze.value,"aria-labelledby":U?H.value:void 0,multiple:!1},_e,{modelValue:Z.value,"onUpdate:modelValue":J=>Z.value=J}),F)])}})}),Vl({},pe)}}),Ll={class:"d-flex align-center justify-space-between"},Ol={class:"d-flex gap-2"},Hl={class:"d-flex align-center"},Ql={class:"text-h5 font-weight-bold text-blue"},Yl={class:"text-caption text-grey"},Jl={class:"d-flex align-center"},Kl={class:"text-h5 font-weight-bold text-green"},Wl={class:"d-flex align-center"},Zl={class:"text-h5 font-weight-bold text-orange"},Xl={class:"d-flex align-center"},ea={class:"text-h5 font-weight-bold text-purple"},ta={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},la={class:"d-flex align-center mb-4"},aa={class:"d-flex align-center mb-2"},oa={class:"d-flex align-center mb-2"},da={class:"d-flex align-center"},sa={class:"d-flex align-center mb-2"},ia={class:"d-flex align-center mb-2"},na={class:"d-flex justify-space-between align-center"},ra={class:"text-caption text-grey"},ua={class:"d-flex gap-2"},ca={class:"d-flex align-center"},ma={class:"font-weight-medium"},fa={class:"text-caption text-grey"},pa={class:"text-caption"},_a={class:"text-no-wrap"},ya={class:"text-no-wrap"},ga={class:"d-flex align-center"},va={class:"font-weight-medium"},ba={class:"d-flex justify-end"},xa={class:"d-flex align-center justify-space-between"},Va={class:"d-flex align-center"},wa={class:"text-white text-caption opacity-75"},ka={class:"text-center py-8"},qa={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},ha={class:"d-flex align-center mb-4"},za={class:"d-flex align-center mb-2"},Pa={class:"d-flex align-center mb-2"},Ca={class:"d-flex align-center"},Aa={class:"d-flex align-center mb-2"},Ua={class:"d-flex align-center mb-2"},Sa={class:"d-flex justify-space-between align-center"},Da={class:"text-caption text-grey"},Ia={class:"d-flex gap-2"},ja={class:"d-flex align-center"},Ta={class:"font-weight-medium"},Na={class:"text-caption text-grey"},$a={class:"d-flex align-center"},Ba={class:"font-weight-medium"},Ma={class:"text-no-wrap"},Fa={class:"text-no-wrap"},Ra={class:"d-flex align-center"},Ea={class:"font-weight-medium"},Ga={class:"d-flex justify-end"},La={class:"d-flex align-center justify-space-between"},Oa={class:"d-flex align-center"},Ha={class:"text-white text-caption opacity-75"},Qa={class:"text-center py-8"},Ya={class:"d-flex justify-space-between align-center"},Ja={class:"text-body-2 text-grey"},Ka={class:"text-h6 font-weight-bold"},Wa={class:"text-body-1 font-weight-medium"},Za={class:"text-body-1 font-weight-medium"},Xa={class:"text-body-1 font-weight-medium"},eo={class:"text-body-1 font-weight-medium"},to={class:"text-h6 font-weight-bold text-green"},lo={class:"text-h6 font-weight-bold text-orange"},ao={class:"text-h6 font-weight-bold text-red"},oo={class:"text-h6 font-weight-bold text-primary"},so={class:"d-flex align-center"},io={class:"font-weight-medium"},no={class:"text-caption text-grey"},ro={key:0,class:"d-flex flex-column"},uo={class:"font-weight-medium text-green"},co={class:"text-caption text-orange"},mo={class:"text-caption text-red"},fo={key:1,class:"text-grey"},po={class:"text-white text-caption font-weight-bold"},_o={key:0,class:"text-caption"},yo={key:1,class:"text-caption text-grey"},go={class:"d-flex align-center mb-4"},vo={class:"position-relative w-100"},bo={key:0,class:"datepicker-label"},xo={class:"d-flex align-center mb-4"},Vo={class:"d-flex align-center mb-3"},wo={class:"font-weight-medium text-h6"},ko={class:"text-caption text-grey"},qo={class:"mb-2"},ho={class:"d-flex align-center mb-3"},zo={class:"text-h6 font-weight-bold text-green"},Po={class:"text-h6 font-weight-bold text-orange"},Co={class:"text-h6 font-weight-bold text-red"},Ao={class:"text-h6 font-weight-bold text-primary"},Uo={class:"d-flex align-center mb-4"},So={class:"position-relative w-100"},Do={key:0,class:"datepicker-label"},Io={class:"position-relative w-100"},jo={key:0,class:"datepicker-label"},To={class:"d-flex align-center justify-space-between mb-4"},No={class:"d-flex align-center"},$o={class:"d-flex align-center mb-3"},Bo={class:"text-body-2 text-grey"},Mo={class:"d-flex align-center mb-3"},Fo={class:"d-flex align-center justify-space-between mb-4"},Ro={class:"d-flex align-center"},Eo={class:"d-flex align-center"},Go={class:"d-flex align-center"},Lo={class:"d-flex align-center mb-4"},Oo={class:"text-h6 font-weight-medium"},Ho={class:"d-flex align-center justify-space-between w-100 pr-4"},Qo={class:"d-flex align-center"},Yo={class:"d-flex align-center"},Jo={class:"text-caption text-grey mb-2"},Ko={class:"d-flex align-center"},Wo={class:"ml-2 flex-grow-1"},Zo={class:"font-weight-medium"},Xo={key:0,class:"text-caption text-grey"},ed={class:"mt-2"},td={class:"d-flex align-center"},ld={class:"d-flex align-center justify-space-between mb-4"},ad={class:"d-flex align-center"},od={class:"d-flex gap-2"},dd={class:"d-flex justify-space-between align-center"},sd={class:"text-caption text-grey"},id={class:"d-flex align-center mb-4"},nd={class:"text-h6 font-weight-bold"},rd={class:"text-body-1 font-weight-medium"},ud={class:"text-body-1 font-weight-medium"},cd={class:"text-body-1 font-weight-medium"},md={class:"text-body-1 font-weight-medium"},fd={class:"text-body-1 font-weight-medium"},pd={class:"text-body-1 font-weight-medium"},_d={class:"text-body-1 font-weight-medium"},yd={class:"text-body-1 font-weight-medium"},gd={class:"text-h6 font-weight-bold text-green"},vd={class:"text-h6 font-weight-bold text-blue"},bd={class:"text-h6 font-weight-bold text-green"},xd={class:"text-h6 font-weight-bold text-orange"},Vd={class:"text-h6 font-weight-bold text-red"},wd={class:"text-body-1 font-weight-medium"},kd={class:"text-white text-caption font-weight-bold"},qd={class:"text-caption text-grey"},hd={key:0,class:"text-caption text-grey ml-2"},zd={class:"text-caption text-grey ml-2"},Pd={class:"text-white text-caption font-weight-bold"},Cd={key:0,class:"text-caption"},Ad={key:1,class:"text-caption text-grey"},Ud={class:"text-caption text-grey"},Sd={__name:"Productions",setup(D){const G=S(!1),W=S(!1),F=S([]),ee=S([]),L=S(!1),Z=S(1),pe=S(1),ae=S(!1),_e=S(!1),ye=S(!1),ne=S(!1),U=S(null),O=S(!0),H=S(!1),se=S(!1),q=S(null),ze=S(""),J=S(0),we=S([]),ke=S([]),Pe=S([]),Be=S([]),$=De({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),B=De({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",team_leader:""}),_=De({id:null,planned_at:null,produced_at:null,notes:"",good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],staff:[],products:[]}),I=De({batch_id:null,produced_at:null,notes:"",products:[]}),It=[{label:"By Product",value:"by_product"},{label:"By Ingredient",value:"by_ingredient"}],jt=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],Tt=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],Qe=[{title:"On Date",value:"="},{title:"After",value:">"},{title:"Before",value:"<"},{title:"On or After",value:">="},{title:"On or Before",value:"<="},{title:"Between",value:"in"}],Nt=[{title:"Batch Code",key:"batch_code",sortable:!0},{title:"Status",key:"status",sortable:!0,align:"center"},{title:"Production Stats",key:"production_stats",sortable:!1},{title:"Planned Start",key:"planned_at",sortable:!0},{title:"Produced At",key:"produced_at",sortable:!0},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Created By",key:"created_by_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"100px"}],$t=[{title:"Product",key:"product_name",sortable:!0},{title:"Planned Qty",key:"qty_product",sortable:!0,align:"center"},{title:"Status",key:"produced",sortable:!0,align:"center"},{title:"Actual Output",key:"good_qty",sortable:!1},{title:"Actions",key:"actions",sortable:!1,align:"center"}],Bt=[{title:"Product / Batch",key:"product_name",sortable:!0},{title:"Quantity",key:"qty_product",sortable:!0,align:"center"},{title:"Staffs",key:"staff_count",sortable:!0,align:"center"},{title:"Mode",key:"mode",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Planned At",key:"planned_at",sortable:!0},{title:"Produced At",key:"produced_at",sortable:!0},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"180px"}],Ye=[{title:"Ingredient",key:"item_name"},{title:"Quantity Required",key:"qty_required"},{title:"Available",key:"available",align:"center"},{title:"Unit",key:"unit",align:"center"}],Mt=[{title:"Staff Member",key:"staff_id",width:"250px"},{title:"Role",key:"role",width:"240px"},{title:"Notes",key:"notes",width:"240px"},{title:"Actions",key:"actions",align:"center",sortable:!1}],Je=s=>({completed:"green",partial:"orange",pending:"red",cancelled:"grey"})[s]||"grey",Ke=s=>({completed:"Completed",partial:"Partial",pending:"Pending",cancelled:"Cancelled"})[s]||s,Ft=s=>({completed:"bg-green",partial:"bg-orange",pending:"bg-red",cancelled:"bg-grey"})[s]||"bg-primary",Rt=s=>({pending:"bg-orange",completed:"bg-green",active:"bg-primary",cancelled:"bg-red"})[s]||"bg-primary",Et=E(()=>{let s=0;return Object.keys($).forEach(e=>{const f=$[e];(Array.isArray(f)&&f.length||f&&f!=="all")&&s++}),s}),Gt=E(()=>{let s=0;return Object.keys(B).forEach(e=>{const f=B[e];(Array.isArray(f)&&f.length||f&&f!=="all")&&s++}),s}),Lt=()=>{L.value=!L.value,Z.value=1,ge()},ge=()=>{L.value?qe():fl()},qe=async()=>{G.value=!0;try{const s=new URLSearchParams({page:Z.value,limit:10});Object.entries(B).forEach(([a,m])=>{m&&m!=="all"&&!(Array.isArray(m)&&!m.length)&&s.append(a,m)});const f=await(await fetch(`/productions/batches?${s.toString()}`)).json();ee.value=f.data||[],pe.value=f.totalPages||1}catch(s){console.error("Failed to load batches:",s),ee.value=[]}finally{G.value=!1}},Ot=()=>{Object.assign(B,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",team_leader:""}),qe()},Ht=()=>{Z.value=1,qe()},We=async s=>{var e;try{const a=await(await fetch(`/productions/batches/${s.id}`)).json();U.value=a.batch,U.value.products=a.products||[],U.value.staff=((e=a.products.find(m=>m.staff.length))==null?void 0:e.staff)||[],ye.value=!0}catch(f){console.error("Failed to load batch details:",f)}},Qt=async s=>{try{const f=await(await fetch(`/productions/batches/${s.id}`)).json();U.value=f.batch,I.batch_id=s.id,I.produced_at=Le(new Date),I.notes="",I.products=f.products.map(a=>({production_id:a.production_id,product_id:a.product_id,product_name:a.product_name,planned_qty:a.qty_product,good_qty:a.good_qty||"",damaged_qty:a.damaged_qty||"",reject_qty:a.reject_qty||"",actual_qty:(a.good_qty||0)+(a.damaged_qty||0)+(a.reject_qty||0),hasDiscrepancy:parseFloat(a.good_qty)!==parseFloat(a.planned_qty),discrepancies:a.discrepancies||[]})),ne.value=!0}catch(e){console.error("Failed to load batch for actual production:",e)}},Me=()=>{ne.value=!1,I.batch_id=null,I.produced_at=null,I.notes="",I.products=[]},ve=s=>{s.actual_qty=(Number(s.good_qty)||0)+(Number(s.damaged_qty)||0)+(Number(s.reject_qty)||0),s.hasDiscrepancy=Number(s.good_qty)!==Number(s.planned_qty),s.hasDiscrepancy||(s.discrepancies=[]),s.hasDiscrepancy&&(!s.discrepancies||s.discrepancies.length===0)&&Fe(s)},Fe=s=>{s.discrepancies||(s.discrepancies=[]),s.discrepancies.push({reason_id:null,notes:""})},Ze=(s,e)=>{s.discrepancies&&s.discrepancies.splice(e,1)},Ce=E(()=>{const s={good_qty:0,damaged_qty:0,reject_qty:0,actual_qty:0};return I.products.forEach(e=>{s.good_qty+=Number(e.good_qty)||0,s.damaged_qty+=Number(e.damaged_qty)||0,s.reject_qty+=Number(e.reject_qty)||0,s.actual_qty+=Number(e.actual_qty)||0}),s}),Yt=E(()=>!I.produced_at||I.products.length===0?!1:I.products.every(e=>(Number(e.good_qty)||0)>=0&&(Number(e.damaged_qty)||0)>=0&&(Number(e.reject_qty)||0)>=0)&&!W.value),Xe=async()=>{W.value=!0;try{const s={produced_at:Oe(I.produced_at),notes:I.notes,products:I.products.map(a=>({production_id:a.production_id,good_qty:Number(a.good_qty)||0,damaged_qty:Number(a.damaged_qty)||0,reject_qty:Number(a.reject_qty)||0,actual_qty:Number(a.actual_qty)||0,discrepancies:(a.discrepancies||[]).filter(m=>m.reason_id)}))},e=await fetch(`/productions/batches/${I.batch_id}/actual`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),f=await e.json();if(!e.ok){alert(f.message||"Failed to save actual production.");return}ne.value=!1,await qe(),Me()}catch(s){console.error("Failed to save batch actual production:",s),alert("Failed to save actual production. Please try again.")}finally{W.value=!1}},Jt=s=>{We(s)},Kt=async s=>{if(confirm(`Are you sure you want to delete batch ${s.batch_code}? This will also delete all productions in this batch.`))try{await fetch(`/productions/batches/${s.id}`,{method:"DELETE"}),await qe()}catch(e){console.error("Failed to delete batch:",e),alert("Failed to delete batch. Please try again.")}},Wt=s=>{ut({id:s})},Zt=E(()=>L.value?ee.value.length:F.value.length),Xt=E(()=>L.value?ee.value.reduce((s,e)=>s+Number(e.total_good_qty||0),0):F.value.reduce((s,e)=>s+Number(e.qty_product||e.total_qty||0),0)),el=E(()=>L.value?ee.value.reduce((s,e)=>s+(e.staff?e.staff.length:0),0):F.value.reduce((s,e)=>s+Number(e.staff_count||0),0)),tl=E(()=>F.value.reduce((s,e)=>s+Number(e.total_pay||0),0).toFixed(2)),et=E(()=>_.products.some(s=>(s.ingredients||[]).some(e=>e.exceeds))),tt=E(()=>{const s=_.staff.map(e=>{var f;return typeof e.staff_id=="object"?(f=e.staff_id)==null?void 0:f.id:e.staff_id}).filter(Boolean);return ke.value.filter(e=>!s.includes(e.id))}),lt=E(()=>_.staff.filter(s=>s.staff_id).length),at=E(()=>_.products.reduce((s,e)=>s+Number(e.computed_qty_product||0),0)),ot=E(()=>{const s=new Map;for(const e of _.products)for(const f of e.ingredients||[]){if(!f.item_id)continue;s.has(f.item_id)||s.set(f.item_id,{item_id:f.item_id,item_name:f.item_name,unit:f.unit,qty_required:0,available:f.available||0,exceeds:!1});const a=s.get(f.item_id);a.qty_required+=Number(f.qty_required||0),a.available=f.available||a.available||0}for(const e of s.values())e.qty_required=+e.qty_required.toFixed(3),e.exceeds=e.qty_required>(e.available||0);return Array.from(s.values()).sort((e,f)=>e.item_name.localeCompare(f.item_name))}),ll=E(()=>{if(!_.planned_at||!_.products.length)return!1;for(const f of _.products)if(!f.product_id||!f.mode||!f.computed_qty_product||f.computed_qty_product<=0||!f.ingredients||!f.ingredients.length)return!1;const s=_.staff.some(f=>f.staff_id),e=_.products.every(f=>(f.productGroups||[]).every(a=>!a.is_mandatory||f.group_choices[a.id]));return!(et.value||!e||!s||W.value)});function oe(s){return s?new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}function Ae(s){var e;return((e=we.value.find(f=>f.id===s))==null?void 0:e.name)||"Product"}function al(s){const e=Ae(s.product_id);return s.product_id?s.computed_qty_product?`${e} • ${s.computed_qty_product} units`:e:"Select product & mode"}function ol(s,e){const f=Ae(s.product_id);return`${e+1}. ${f}`}const Re=S(!1);function dl(){const s=at.value,e=Number(_.good_qty||0);Re.value=!!(s&&e!==s),Re.value&&!_.discrepancies.length&&sl()}function sl(){_.discrepancies.push({reason_id:null,notes:""})}function dt(){_.staff.push({staff_id:null,role:"",notes:""})}function il(s){_.staff.splice(s,1)}function nl(){_.staff=[]}let rl=1;function st(){return{uid:rl++,product_id:null,mode:"by_product",qty_product_input:null,base_ingredient_id:null,base_ingredient_qty:null,baseUnit:"",computed_qty_product:0,recipeItems:[],productGroups:[],group_choices:{},expandedGroups:[],ingredients:[],innerTab:"ingredients"}}function Ee(){_.products.push(st()),J.value==="summary"&&(J.value=0)}function ul(s){_.products.splice(s,1),typeof J.value=="number"&&J.value>=_.products.length&&(J.value=_.products.length?_.products.length-1:"summary")}async function it(s){if(s.recipeItems=[],s.productGroups=[],s.group_choices={},s.expandedGroups=[],s.ingredients=[],s.base_ingredient_id=null,s.base_ingredient_qty=null,s.baseUnit="",s.computed_qty_product=0,!!s.product_id)try{const f=await(await fetch(`/products/${s.product_id}/groups`)).json();s.recipeItems=f.fixed_items||[],s.productGroups=f.groups||[],s.productGroups.forEach((a,m)=>{var r;const i=(r=a.combinations)==null?void 0:r.find(V=>V.is_default);i&&(s.group_choices[a.id]=i.id),s.expandedGroups.push(m)}),re(s)}catch(e){console.error("Failed to load product details:",e)}}function re(s){var a,m,i;if(!s.product_id||!s.mode){s.ingredients=[],s.computed_qty_product=0;return}let e=0;if(s.mode==="by_product")e=Number(s.qty_product_input||0);else if(s.mode==="by_ingredient"){const r=s.recipeItems.find(V=>V.item_id===Number(s.base_ingredient_id));s.baseUnit=(r==null?void 0:r.unit)||"",r&&r.quantity_per_unit>0&&s.base_ingredient_qty>0&&(e=Number(s.base_ingredient_qty)/r.quantity_per_unit)}if(!e||e<=0){s.ingredients=[],s.computed_qty_product=0;return}s.computed_qty_product=+e.toFixed(3);const f=[];for(const r of s.recipeItems){const V=((a=Pe.value.find(M=>M.item_id===r.item_id))==null?void 0:a.available_qty)||0,A=+(r.quantity_per_unit*e).toFixed(3);f.push({item_id:r.item_id,item_name:r.item_name,unit_id:r.unit_id,unit:r.unit,qty_required:A,available:+V,exceeds:A>V,from_group:!1,group_id:null,group_name:null,combination_id:null})}for(const r of s.productGroups){const V=s.group_choices[r.id];if(!V)continue;const A=(m=r.combinations)==null?void 0:m.find(M=>M.id===V);if(!(!A||!A.options))for(const M of A.options){const ue=((i=Pe.value.find(Se=>Se.item_id===M.item_id))==null?void 0:i.available_qty)||0,he=+(M.quantity_per_unit*e).toFixed(3);f.push({item_id:M.item_id,item_name:M.item_name,unit:M.unit,qty_required:he,available:+ue,exceeds:he>ue,from_group:!0,group_id:r.id,group_name:r.name,combination_id:V})}}s.ingredients=f}function Ge(){ae.value=!0,H.value=!1,se.value=!1,O.value=!0,Ue(),Ee(),dt()}function nt(){ae.value=!1,Re.value=!1,H.value=!1,se.value=!1,Ue()}function Ue(){Object.assign(_,{id:null,planned_at:null,produced_at:null,notes:"",good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],staff:[],products:[]}),J.value=0}function cl(){Object.assign($,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),ge()}function ml(){Z.value=1,ge()}async function fl(){G.value=!0;try{const s=new URLSearchParams({page:Z.value,limit:10});Object.entries($).forEach(([a,m])=>{m&&m!=="all"&&!(Array.isArray(m)&&!m.length)&&s.append(a,m)});const f=await(await fetch(`/productions?${s.toString()}`)).json();F.value=f.data||[],pe.value=f.totalPages||1}catch(s){console.error("Failed to load productions:",s),F.value=[]}finally{G.value=!1}}async function pl(){try{const e=await(await fetch("/products?limit=1000&page=1")).json();we.value=e.data||[]}catch(s){console.error("Failed to load products:",s)}}async function _l(){try{const e=await(await fetch("/staffs?status=Active&limit=1000&page=1")).json();ke.value=e.data||[]}catch(s){console.error("Failed to load staff:",s)}}async function rt(){try{const s=await fetch("/items/availableStock");Pe.value=await s.json()}catch(s){console.error("Failed to load stock:",s)}}async function yl(){try{const e=await(await fetch("/productions/discrepancyReasons")).json();Be.value=e.data||[]}catch(s){console.error("Failed to load discrepancy reasons:",s)}}async function ut(s){try{const e=await fetch(`/productions/${s.id}`);q.value=await e.json(),_e.value=!0}catch(e){console.error("Failed to load production details:",e)}}const ct=s=>({"Team Leader":"blue",Assistant:"green",Support:"orange"})[s]||"grey",gl=async s=>{H.value=!0,se.value=!1,ae.value=!0,O.value=!0,Ue();try{const e=await fetch(`/productions/batches/${s.id}`),f=await e.json();if(!e.ok)throw new Error(f.message||"Failed to load batch for editing.");_.id=f.batch.id,_.notes=f.batch.notes||"",_.planned_at=Le(f.batch.planned_at),_.produced_at=Le(f.batch.produced_at),_.products=[],(f.products||[]).forEach(a=>{const m=st();m.production_id=a.production_id,m.product_id=a.product_id,m.product_name=a.product_name,m.planned_qty=a.qty_product||0,m.good_qty=a.good_qty||0,m.damaged_qty=a.damaged_qty||0,m.reject_qty=a.reject_qty||0,m.actual_qty=a.actual_qty||0,m.hasDiscrepancy=a.discrepancies.length>0,m.discrepancies=a.discrepancies||[],m.mode=a.mode||"by_product",_.staff=a.staff||[],m.mode==="by_product"?m.qty_product_input=Number(a.qty_product||0):(m.base_ingredient_id=a.base_ingredient_id||null,m.base_ingredient_qty=a.base_ingredient_qty||null),m.computed_qty_product=Number(a.qty_product||0)||0,_.products.push(m)}),_.products.length||Ee();for(const a of f.products||[]){const m=_.products.find(r=>r.production_id===a.production_id)||_.products.find(r=>r.product_id===a.product_id);if(!m||!m.product_id)continue;await it(m);const i=a.group_choices||[];i.length?i.forEach(r=>{r.group_id&&r.combination_id&&(m.group_choices[r.group_id]=r.combination_id)}):Array.isArray(a.ingredients)&&a.ingredients.forEach(r=>{r.group_id&&r.combination_id&&(m.group_choices[r.group_id]=r.combination_id)}),Array.isArray(a.ingredients)&&a.ingredients.length&&(m.ingredients=a.ingredients.map(r=>{var M;const V=((M=Pe.value.find(ue=>ue.item_id===r.item_id))==null?void 0:M.available_qty)||0,A=Number(r.qty_required||r.quantity||0);return{item_id:r.item_id,item_name:r.item_name,unit:r.unit,qty_required:A,available:+V,exceeds:A>V,from_group:!!r.group_id,group_id:r.group_id||null,group_name:r.group_name||null,combination_id:r.combination_id||null}}))}J.value=_.products.length?0:"summary",dl()}catch(e){console.error("Failed to load batch for editing:",e),alert("Failed to load batch for editing."),ae.value=!1}};async function mt(){W.value=!0;try{const s=_.products.map(r=>{const V=Object.entries(r.group_choices||{}).filter(([,A])=>A).map(([A,M])=>({group_id:Number(A),combination_id:M}));return{production_id:r.production_id||null,product_id:r.product_id,mode:r.mode,qty_product:r.computed_qty_product,good_qty:r.good_qty||0,damaged_qty:r.damaged_qty||0,reject_qty:r.reject_qty||0,actual_qty:r.actual_qty||0,discrepancies:r.discrepancies,base_ingredient_id:r.base_ingredient_id,base_ingredient_qty:r.base_ingredient_qty,ingredients:(r.ingredients||[]).map(A=>({item_id:A.item_id,qty_required:Number(A.qty_required||0),unit:A.unit,group_id:A.group_id||null,combination_id:A.combination_id||null})),group_choices:V}}),e={planned_at:Oe(_.planned_at),produced_at:_.produced_at?Oe(_.produced_at):null,notes:_.notes,products:s,staffs:_.staff.filter(r=>r.staff_id).map(r=>({staff_id:typeof r.staff_id=="object"?r.staff_id.id:r.staff_id,role:r.role||null,notes:r.notes||null}))},f=H.value?`/productions/${_.id}`:"/productions",a=H.value?"PUT":"POST",m=await fetch(f,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await m.json();if(!m.ok){i.error==="INSUFFICIENT_STOCK"?alert(`${i.message}
Available: ${i.details.available}
Required: ${i.details.required}`):alert(i.message||"Failed to save production.");return}ae.value=!1,Ue(),await rt(),await ge()}catch(s){console.error("Failed to save production:",s),alert("Failed to save production. Please try again.")}finally{W.value=!1}}return ql(async()=>{await Promise.all([_l(),pl(),ge(),yl(),rt()])}),(s,e)=>{const f=hl("VueDatePicker");return c(),y(zl,{class:"production-container",fluid:""},{default:t(()=>[_.damaged_qty>0||_.reject_qty>0?(c(),y(le,{key:0,border:"start",class:"mt-2",type:"warning",variant:"tonal"},{default:t(()=>e[27]||(e[27]=[d(" Some quantities were marked as damaged or reject — please ensure they're tracked in the ledger. ")])),_:1})):x("",!0),l(g,{class:"mb-6",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-6"},{default:t(()=>[o("div",Ll,[e[31]||(e[31]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Production Management "),o("p",{class:"text-body-1 text-grey"}," Manage production batches and individual productions ")],-1)),o("div",Ol,[s.$store.getters.hasTask("can_schedule_production")?(c(),y(C,{key:0,class:"px-6",color:"primary",elevation:"2",size:"large",onClick:Ge},{default:t(()=>[l(u,{size:"20",start:""},{default:t(()=>e[28]||(e[28]=[d("mdi-plus-circle")])),_:1}),e[29]||(e[29]=d(" New Production "))]),_:1})):x("",!0),l(C,{class:"px-6",color:"secondary",elevation:"2",size:"large",onClick:Lt},{default:t(()=>[l(u,{size:"20",start:""},{default:t(()=>e[30]||(e[30]=[d("mdi-view-grid")])),_:1}),d(" "+n(L.value?"Show Individual":"Show Batches"),1)]),_:1})])])]),_:1})]),_:1}),l(j,{class:"mb-6"},{default:t(()=>[l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(g,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Hl,[l(h,{class:"mr-3",color:"blue-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"blue",size:"24"},{default:t(()=>e[32]||(e[32]=[d("mdi-factory")])),_:1})]),_:1}),o("div",null,[o("div",Ql,n(L.value?ee.value.length:F.value.length),1),o("div",Yl,n(L.value?"Total Batches":"Total Productions"),1)])])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(g,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Jl,[l(h,{class:"mr-3",color:"green-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"green",size:"24"},{default:t(()=>e[33]||(e[33]=[d("mdi-account-group")])),_:1})]),_:1}),o("div",null,[o("div",Kl,n(el.value),1),e[34]||(e[34]=o("div",{class:"text-caption text-grey"},"Staff Assignments",-1))])])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(g,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Wl,[l(h,{class:"mr-3",color:"orange-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"orange",size:"24"},{default:t(()=>e[35]||(e[35]=[d("mdi-chart-line")])),_:1})]),_:1}),o("div",null,[o("div",Zl,n(Xt.value),1),e[36]||(e[36]=o("div",{class:"text-caption text-grey"},"Total Units (Planned)",-1))])])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(g,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Xl,[l(h,{class:"mr-3",color:"purple-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"purple",size:"24"},{default:t(()=>e[37]||(e[37]=[d("mdi-cash-multiple")])),_:1})]),_:1}),o("div",null,[o("div",ea,n(tl.value),1),e[38]||(e[38]=o("div",{class:"text-caption text-grey"},"Labor Cost",-1))])])]),_:1})]),_:1})]),_:1})]),_:1}),L.value?(c(),y(g,{key:1,class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-0"},{default:t(()=>[o("div",ta,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[39]||(e[39]=[d("mdi-view-grid")])),_:1}),e[40]||(e[40]=o("h3",{class:"text-h6 font-weight-medium"},"Production Batches",-1))]),l(g,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",la,[l(h,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[41]||(e[41]=[d("mdi-filter")])),_:1})]),_:1}),e[42]||(e[42]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Batch Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your batch records ")],-1)),l(te),l(w,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(n(Gt.value)+" Active ",1)]),_:1})]),l(ce,{class:"mb-6"}),l(j,{class:"align-start",dense:""},{default:t(()=>[l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(g,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",aa,[l(u,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[43]||(e[43]=[d("mdi-package-variant")])),_:1}),e[44]||(e[44]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(fe,{modelValue:B.product_id,"onUpdate:modelValue":e[0]||(e[0]=a=>B.product_id=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:we.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(g,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",oa,[l(u,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[45]||(e[45]=[d("mdi-progress-clock")])),_:1}),e[46]||(e[46]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(ie,{modelValue:B.status,"onUpdate:modelValue":e[1]||(e[1]=a=>B.status=a),color:"primary",density:"compact","hide-details":"",items:Tt,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:m})=>[l(K,vt(bt(m)),{prepend:t(()=>[l(u,{color:a.raw.color||"grey"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",da,[l(u,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,n(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(g,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",sa,[l(u,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[47]||(e[47]=[d("mdi-account-tie")])),_:1}),e[48]||(e[48]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(fe,{modelValue:B.team_leader,"onUpdate:modelValue":e[2]||(e[2]=a=>B.team_leader=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:ke.value,placeholder:"All Leaders",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(g,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",ia,[l(u,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[49]||(e[49]=[d("mdi-calendar-clock")])),_:1}),e[50]||(e[50]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(j,{class:"align-center",dense:""},{default:t(()=>[l(p,{cols:"12",sm:"4"},{default:t(()=>[l(ie,{modelValue:B.planned_at_op,"onUpdate:modelValue":e[3]||(e[3]=a=>B.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:Qe,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(p,{cols:"12",sm:"4"},{default:t(()=>[l(f,{modelValue:B.planned_at,"onUpdate:modelValue":e[4]||(e[4]=a=>B.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),B.planned_at_op==="in"?(c(),y(p,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(f,{modelValue:B.planned_end,"onUpdate:modelValue":e[5]||(e[5]=a=>B.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ce,{class:"mt-4 mb-4"}),o("div",na,[o("div",ra,[l(u,{class:"mr-1",size:"14"},{default:t(()=>e[51]||(e[51]=[d("mdi-information")])),_:1}),e[52]||(e[52]=d(" Use filters to find specific batch records "))]),o("div",ua,[l(C,{class:"px-4",color:"grey",variant:"outlined",onClick:Ot},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[53]||(e[53]=[d("mdi-refresh")])),_:1}),e[54]||(e[54]=d(" Reset All "))]),_:1}),l(C,{class:"px-4",color:"primary",elevation:"2",onClick:Ht},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[55]||(e[55]=[d("mdi-filter-check")])),_:1}),e[56]||(e[56]=d(" Apply Filters "))]),_:1})])])]),_:1}),l(xt,{active:G.value,color:"primary",height:"4",indeterminate:G.value},null,8,["active","indeterminate"]),l(xe,{class:"elevation-0",density:"comfortable",headers:Nt,hover:"",items:ee.value,loading:G.value,search:ze.value},{loading:t(()=>[l(qt,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(w,{class:"font-weight-bold text-uppercase",color:Je(a.status),size:"small",variant:"flat"},{default:t(()=>[d(n(Ke(a.status)),1)]),_:2},1032,["color"])]),"item.batch_code":t(({item:a})=>[o("div",ca,[l(h,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[57]||(e[57]=[d("mdi-package-variant")])),_:1})]),_:1}),o("div",null,[o("div",ma,n(a.batch_code),1),o("div",fa,n(a.total_products)+" products ",1)])])]),"item.production_stats":t(({item:a})=>[o("div",pa,[l(w,{class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(a.total_good_qty||0)+" good ",1)]),_:2},1024),l(w,{class:"mr-1 mb-1",color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(a.total_damaged_qty||0)+" damaged ",1)]),_:2},1024),l(w,{class:"mb-1",color:"red",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(a.total_reject_qty||0)+" reject ",1)]),_:2},1024)])]),"item.planned_at":t(({item:a})=>[o("div",_a,n(oe(a.planned_at)),1)]),"item.produced_at":t(({item:a})=>[o("div",ya,n(oe(a.produced_at)||"Not completed"),1)]),"item.team_leader_name":t(({item:a})=>[o("div",ga,[l(h,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(u,{color:"blue-grey",size:"14"},{default:t(()=>e[58]||(e[58]=[d("mdi-account-tie")])),_:1})]),_:1}),o("span",va,n(a.team_leader_name),1)])]),"item.actions":t(({item:a})=>[o("div",ba,[l(kt,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:m})=>[l(C,Ve(m,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[l(u,null,{default:t(()=>e[59]||(e[59]=[d("mdi-dots-vertical")])),_:1})]),_:2},1040)]),default:t(()=>[l(g,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(v,{class:de(["pa-4",Ft(a.status)])},{default:t(()=>[o("div",xa,[o("div",Va,[l(h,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"18"},{default:t(()=>e[60]||(e[60]=[d(" mdi-package-variant ")])),_:1})]),_:1}),o("div",null,[e[61]||(e[61]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Batch Actions ",-1)),o("div",wa,n(a.batch_code),1)])]),l(w,{color:"white",size:"small",variant:"flat"},{default:t(()=>[d(n(a.status),1)]),_:2},1024)])]),_:2},1032,["class"]),l(me,{class:"pa-2",density:"compact"},{default:t(()=>[s.$store.getters.hasTask("can_see_production")?(c(),y(K,{key:0,class:"rounded-lg mb-1 action-item",onClick:m=>We(a)},{prepend:t(()=>[l(h,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"blue",size:"18"},{default:t(()=>e[62]||(e[62]=[d(" mdi-eye-outline ")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[63]||(e[63]=[d(" View Batch Details ")])),_:1}),l(Q,{class:"text-caption text-blue"},{default:t(()=>e[64]||(e[64]=[d(" Complete batch information ")])),_:1})]),_:2},1032,["onClick"])):x("",!0),a.produced_count>0&&s.$store.getters.hasTask("can_edit_actual_production")||a.produced_count<=0&&s.$store.getters.hasTask("can_add_actual_production")?(c(),y(K,{key:1,class:"rounded-lg mb-1 action-item",onClick:m=>Qt(a)},{prepend:t(()=>[l(h,{class:"mr-3",color:"green-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"green",size:"18"},{default:t(()=>e[65]||(e[65]=[d(" mdi-plus-circle ")])),_:1})]),_:1})]),default:t(()=>[a.produced_count>0?(c(),P(N,{key:0},[l(X,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[66]||(e[66]=[d(" Edit Actual Production ")])),_:1}),l(Q,{class:"text-caption text-green"},{default:t(()=>e[67]||(e[67]=[d(" Edit Recorded output for all products ")])),_:1})],64)):(c(),P(N,{key:1},[l(X,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[68]||(e[68]=[d(" Add Actual Production ")])),_:1}),l(Q,{class:"text-caption text-green"},{default:t(()=>e[69]||(e[69]=[d(" Record output for all products ")])),_:1})],64))]),_:2},1032,["onClick"])):x("",!0),s.$store.getters.hasTask("can_edit_production")?(c(),y(K,{key:2,class:"rounded-lg mb-1 action-item",onClick:m=>gl(a)},{prepend:t(()=>[l(h,{class:"mr-3",color:"orange-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"orange",size:"18"},{default:t(()=>e[70]||(e[70]=[d(" mdi-pencil-outline ")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[71]||(e[71]=[d(" Edit Batch ")])),_:1}),l(Q,{class:"text-caption text-orange"},{default:t(()=>e[72]||(e[72]=[d(" Modify batch products & staff ")])),_:1})]),_:2},1032,["onClick"])):x("",!0),l(K,{class:"rounded-lg mb-1 action-item",onClick:m=>Jt(a)},{prepend:t(()=>[l(h,{class:"mr-3",color:"purple-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"purple",size:"18"},{default:t(()=>e[73]||(e[73]=[d(" mdi-format-list-bulleted ")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[74]||(e[74]=[d(" View Products ")])),_:1}),l(Q,{class:"text-caption text-purple"},{default:t(()=>e[75]||(e[75]=[d(" See all products in batch ")])),_:1})]),_:2},1032,["onClick"]),l(ce,{class:"my-2"}),s.$store.getters.hasTask("can_delete_production")?(c(),y(K,{key:3,class:"rounded-lg action-item text-error",onClick:m=>Kt(a)},{prepend:t(()=>[l(h,{class:"mr-3",color:"red-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"red",size:"18"},{default:t(()=>e[76]||(e[76]=[d(" mdi-delete-outline ")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"text-body-2 font-weight-medium text-error"},{default:t(()=>e[77]||(e[77]=[d(" Delete Batch ")])),_:1}),l(Q,{class:"text-caption text-red"},{default:t(()=>e[78]||(e[78]=[d(" Remove permanently ")])),_:1})]),_:2},1032,["onClick"])):x("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",ka,[l(u,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[79]||(e[79]=[d(" mdi-inbox ")])),_:1}),e[82]||(e[82]=o("div",{class:"text-h6 text-grey"},"No batches found",-1)),e[83]||(e[83]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production batch ",-1)),l(C,{class:"mt-4",color:"primary",onClick:Ge},{default:t(()=>[l(u,{start:""},{default:t(()=>e[80]||(e[80]=[d("mdi-plus")])),_:1}),e[81]||(e[81]=d(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1})):(c(),y(g,{key:2,class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-0"},{default:t(()=>[o("div",qa,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[84]||(e[84]=[d("mdi-table")])),_:1}),e[85]||(e[85]=o("h3",{class:"text-h6 font-weight-medium"},"Production Records",-1))]),l(g,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",ha,[l(h,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[86]||(e[86]=[d("mdi-filter")])),_:1})]),_:1}),e[87]||(e[87]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Production Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your production records ")],-1)),l(te),l(w,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(n(Et.value)+" Active ",1)]),_:1})]),l(ce,{class:"mb-6"}),l(j,{class:"align-start",dense:""},{default:t(()=>[l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(g,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",za,[l(u,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[88]||(e[88]=[d("mdi-package-variant")])),_:1}),e[89]||(e[89]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(fe,{modelValue:$.product_id,"onUpdate:modelValue":e[6]||(e[6]=a=>$.product_id=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:we.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(g,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",Pa,[l(u,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[90]||(e[90]=[d("mdi-progress-clock")])),_:1}),e[91]||(e[91]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(ie,{modelValue:$.status,"onUpdate:modelValue":e[7]||(e[7]=a=>$.status=a),color:"primary",density:"compact","hide-details":"",items:jt,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:m})=>[l(K,vt(bt(m)),{prepend:t(()=>[l(u,{color:a.raw.color||"grey"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",Ca,[l(u,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,n(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(g,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",Aa,[l(u,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[92]||(e[92]=[d("mdi-account-tie")])),_:1}),e[93]||(e[93]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(fe,{modelValue:$.team_leader,"onUpdate:modelValue":e[8]||(e[8]=a=>$.team_leader=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:ke.value,placeholder:"All Leaders",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(g,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",Ua,[l(u,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[94]||(e[94]=[d("mdi-calendar-clock")])),_:1}),e[95]||(e[95]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(j,{class:"align-center",dense:""},{default:t(()=>[l(p,{cols:"12",sm:"4"},{default:t(()=>[l(ie,{modelValue:$.planned_at_op,"onUpdate:modelValue":e[9]||(e[9]=a=>$.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:Qe,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(p,{cols:"12",sm:"4"},{default:t(()=>[l(f,{modelValue:$.planned_at,"onUpdate:modelValue":e[10]||(e[10]=a=>$.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),$.planned_at_op==="in"?(c(),y(p,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(f,{modelValue:$.planned_end,"onUpdate:modelValue":e[11]||(e[11]=a=>$.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ce,{class:"mt-4 mb-4"}),o("div",Sa,[o("div",Da,[l(u,{class:"mr-1",size:"14"},{default:t(()=>e[96]||(e[96]=[d("mdi-information")])),_:1}),e[97]||(e[97]=d(" Use filters to find specific production records "))]),o("div",Ia,[l(C,{class:"px-4",color:"grey",variant:"outlined",onClick:cl},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[98]||(e[98]=[d("mdi-refresh")])),_:1}),e[99]||(e[99]=d(" Reset All "))]),_:1}),l(C,{class:"px-4",color:"primary",elevation:"2",onClick:ml},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[100]||(e[100]=[d("mdi-filter-check")])),_:1}),e[101]||(e[101]=d(" Apply Filters "))]),_:1})])])]),_:1}),l(xt,{active:G.value,color:"primary",height:"4",indeterminate:G.value},null,8,["active","indeterminate"]),l(xe,{class:"elevation-0",density:"comfortable",headers:Bt,hover:"",items:F.value,loading:G.value,search:ze.value},{loading:t(()=>[l(qt,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(w,{class:"font-weight-bold text-uppercase",color:a.produced_at?"green":"red",size:"small",variant:"flat"},{default:t(()=>[d(n(a.produced_at?"Completed":"Pending"),1)]),_:2},1032,["color"])]),"item.product_name":t(({item:a})=>[o("div",ja,[l(h,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[102]||(e[102]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",Ta,n(a.product_name||a.batch_label),1),o("div",Na,n(a.mode||"Multiple Products"),1)])])]),"item.qty_product":t(({item:a})=>[l(w,{color:"green",size:"small",variant:"flat"},{default:t(()=>[l(u,{size:"16",start:""},{default:t(()=>e[103]||(e[103]=[d("mdi-counter")])),_:1}),d(" "+n(parseFloat(a.qty_product||a.total_qty||0)),1)]),_:2},1024)]),"item.staff_count":t(({item:a})=>[o("div",$a,[l(h,{class:"mr-2",color:"blue-lighten-5",size:"28"},{default:t(()=>[l(u,{color:"blue",size:"14"},{default:t(()=>e[104]||(e[104]=[d("mdi-account-group")])),_:1})]),_:1}),o("span",Ba,n(a.staff_count||0),1)])]),"item.planned_at":t(({item:a})=>[o("div",Ma,n(a.planned_at),1)]),"item.produced_at":t(({item:a})=>[o("div",Fa,n(a.produced_at),1)]),"item.produced_by_name":t(({item:a})=>[o("div",Ra,[l(h,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(u,{color:"blue-grey",size:"14"},{default:t(()=>e[105]||(e[105]=[d("mdi-account")])),_:1})]),_:1}),o("span",Ea,n(a.produced_by_name),1)])]),"item.actions":t(({item:a})=>[o("div",Ga,[l(kt,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:m})=>[l(C,Ve(m,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[a.produced_at?(c(),y(u,{key:1},{default:t(()=>e[107]||(e[107]=[d("mdi-dots-vertical")])),_:1})):(c(),y(Sl,{key:0,color:"orange",dot:"",location:"top end","offset-x":"2","offset-y":"2"},{default:t(()=>[l(u,null,{default:t(()=>e[106]||(e[106]=[d("mdi-dots-vertical")])),_:1})]),_:1}))]),_:2},1040)]),default:t(()=>[l(g,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(v,{class:de(["pa-4",Rt(a.produced_at?"completed":"pending")])},{default:t(()=>[o("div",La,[o("div",Oa,[l(h,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"18"},{default:t(()=>e[108]||(e[108]=[d(" mdi-factory ")])),_:1})]),_:1}),o("div",null,[e[109]||(e[109]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Production Actions ",-1)),o("div",Ha,n(a.product_name||"Batch"),1)])]),l(w,{color:"white",size:"small",variant:"flat"},{default:t(()=>[d(n(a.produced_at?"completed":"pending"),1)]),_:2},1024)])]),_:2},1032,["class"]),l(me,{class:"pa-2",density:"compact"},{default:t(()=>[l(K,{class:"rounded-lg mb-1 action-item",onClick:m=>ut(a)},{prepend:t(()=>[l(h,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"blue",size:"18"},{default:t(()=>e[110]||(e[110]=[d(" mdi-eye-outline ")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[111]||(e[111]=[d(" View Details ")])),_:1}),l(Q,{class:"text-caption text-blue"},{default:t(()=>e[112]||(e[112]=[d(" Complete information ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",Qa,[l(u,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[113]||(e[113]=[d(" mdi-inbox ")])),_:1}),e[116]||(e[116]=o("div",{class:"text-h6 text-grey"},"No productions found",-1)),e[117]||(e[117]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production record ",-1)),l(C,{class:"mt-4",color:"primary",onClick:Ge},{default:t(()=>[l(u,{start:""},{default:t(()=>e[114]||(e[114]=[d("mdi-plus")])),_:1}),e[115]||(e[115]=d(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1})),l(g,{elevation:"2",rounded:"lg"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Ya,[o("div",Ja," Showing "+n(L.value?ee.value.length:F.value.length)+" of "+n(Zt.value)+" records ",1),l(Ul,{modelValue:Z.value,"onUpdate:modelValue":[e[12]||(e[12]=a=>Z.value=a),ge],color:"primary",length:pe.value,"total-visible":7},null,8,["modelValue","length"])])]),_:1})]),_:1}),l(Te,{modelValue:ye.value,"onUpdate:modelValue":e[14]||(e[14]=a=>ye.value=a),"max-width":"1200",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(g,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ie,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(h,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[118]||(e[118]=[d("mdi-package-variant")])),_:1})]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a;return[d(" Batch Details - "+n((a=U.value)==null?void 0:a.batch_code),1)]}),_:1}),l(te),l(C,{color:"white",icon:"mdi-close",variant:"text",onClick:e[13]||(e[13]=a=>ye.value=!1)})]),_:1}),l(v,{class:"pa-6"},{default:t(()=>{var a,m;return[l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[l(j,null,{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[119]||(e[119]=o("div",{class:"text-body-2 text-grey"},"Batch Code",-1)),o("div",Ka,n((i=U.value)==null?void 0:i.batch_code),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[120]||(e[120]=o("div",{class:"text-body-2 text-grey"},"Status",-1)),l(w,{class:"mt-1",color:Je((i=U.value)==null?void 0:i.status),size:"small"},{default:t(()=>{var r;return[d(n(Ke((r=U.value)==null?void 0:r.status)),1)]}),_:1},8,["color"])]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[121]||(e[121]=o("div",{class:"text-body-2 text-grey"},"Created By",-1)),o("div",Wa,n((i=U.value)==null?void 0:i.created_by_name),1)]}),_:1})]),_:1}),l(j,{class:"mt-2"},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[122]||(e[122]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",Za,n(oe((i=U.value)==null?void 0:i.planned_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[123]||(e[123]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",Xa,n(oe((i=U.value)==null?void 0:i.produced_at)||"Not completed"),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[124]||(e[124]=o("div",{class:"text-body-2 text-grey"},"Team Leader",-1)),o("div",eo,n((i=U.value)==null?void 0:i.team_leader_name),1)]}),_:1})]),_:1}),l(j,{class:"mt-4"},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var i;return[o("div",to,n(((i=U.value)==null?void 0:i.total_good_qty)||0),1),e[125]||(e[125]=o("div",{class:"text-caption text-grey"},"Good Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var i;return[o("div",lo,n(((i=U.value)==null?void 0:i.total_damaged_qty)||0),1),e[126]||(e[126]=o("div",{class:"text-caption text-grey"},"Damaged",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var i;return[o("div",ao,n(((i=U.value)==null?void 0:i.total_reject_qty)||0),1),e[127]||(e[127]=o("div",{class:"text-caption text-grey"},"Reject",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var i;return[o("div",oo,n(((i=U.value)==null?void 0:i.total_products)||0),1),e[128]||(e[128]=o("div",{class:"text-caption text-grey"},"Total Products",-1))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(g,{class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[129]||(e[129]=[d("mdi-format-list-bulleted")])),_:1}),e[130]||(e[130]=d(" Products in Batch "))]),_:1}),l(v,{class:"pa-0"},{default:t(()=>{var i;return[l(xe,{class:"elevation-0",headers:$t,items:((i=U.value)==null?void 0:i.products)||[]},{"item.product_name":t(({item:r})=>[o("div",so,[l(h,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[131]||(e[131]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",io,n(r.product_name),1),o("div",no," Planned: "+n(r.qty_product)+" units ",1)])])]),"item.produced":t(({item:r})=>[l(w,{color:r.produced_at?"green":"orange",size:"small",variant:"flat"},{default:t(()=>[d(n(r.produced_at?"Produced":"Pending"),1)]),_:2},1032,["color"])]),"item.good_qty":t(({item:r})=>[r.produced_at?(c(),P("div",ro,[o("span",uo,n(r.good_qty||0)+" good",1),o("span",co,n(r.damaged_qty||0)+" damaged",1),o("span",mo,n(r.reject_qty||0)+" reject",1)])):(c(),P("span",fo,"Not produced"))]),"item.actions":t(({item:r})=>[r.production_id?(c(),y(C,{key:0,color:"primary",size:"small",variant:"text",onClick:V=>Wt(r.production_id)},{default:t(()=>[l(u,{size:"16"},{default:t(()=>e[132]||(e[132]=[d("mdi-eye")])),_:1}),e[133]||(e[133]=d(" View "))]),_:2},1032,["onClick"])):x("",!0)]),_:1},8,["items"])]}),_:1})]),_:1}),(m=(a=U.value)==null?void 0:a.staff)!=null&&m.length?(c(),y(g,{key:0,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"blue"},{default:t(()=>e[134]||(e[134]=[d("mdi-account-group")])),_:1}),e[135]||(e[135]=d(" Staff Assignments ")),l(w,{class:"ml-2",color:"blue",size:"small",variant:"flat"},{default:t(()=>[d(n(U.value.staff.length)+" staff ",1)]),_:1})]),_:1}),l(v,{class:"pa-0"},{default:t(()=>[l(me,{class:"pa-0",lines:"two"},{default:t(()=>[(c(!0),P(N,null,Y(U.value.staff,(i,r)=>(c(),y(K,{key:i.staff_id,class:de(["px-4",{"bg-grey-lighten-4":r%2===0}])},{prepend:t(()=>[l(h,{class:"mr-3",color:"blue",size:"36"},{default:t(()=>[o("span",po,n(r+1),1)]),_:2},1024)]),default:t(()=>[l(X,{class:"font-weight-medium"},{default:t(()=>[d(n(i.staff_name)+" ",1),l(w,{class:"ml-2",color:ct(i.role),size:"x-small",variant:"flat"},{default:t(()=>[d(n(i.role),1)]),_:2},1032,["color"])]),_:2},1024),l(Q,{class:"mt-1"},{default:t(()=>[i.notes?(c(),P("span",_o,n(i.notes),1)):(c(),P("span",yo," No notes "))]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Te,{modelValue:ne.value,"onUpdate:modelValue":e[17]||(e[17]=a=>ne.value=a),"max-width":"1000",persistent:"",scrollable:""},{default:t(()=>[l(g,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ie,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(h,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[136]||(e[136]=[d("mdi-plus-circle")])),_:1})]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a;return[d(" Add Actual Production - "+n((a=U.value)==null?void 0:a.batch_code),1)]}),_:1}),l(te),l(C,{color:"white",icon:"mdi-close",variant:"text",onClick:Me})]),_:1}),l(v,{class:"pa-6"},{default:t(()=>[l(ht,{onSubmit:Vt(Xe,["prevent"])},{default:t(()=>[l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",go,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[137]||(e[137]=[d("mdi-calendar-clock")])),_:1}),e[138]||(e[138]=o("h4",{class:"text-h6 font-weight-medium"}," Production Information ",-1))]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"6"},{default:t(()=>[o("div",vo,[I.produced_at?(c(),P("span",bo," Actual Production Date & Time ")):x("",!0),l(f,{modelValue:I.produced_at,"onUpdate:modelValue":e[15]||(e[15]=a=>I.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1}),l(p,{cols:"12",md:"6"},{default:t(()=>[l(R,{modelValue:I.notes,"onUpdate:modelValue":e[16]||(e[16]=a=>I.notes=a),color:"primary",label:"Production Notes (optional)","prepend-inner-icon":"mdi-note-text",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",xo,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[139]||(e[139]=[d("mdi-scale-balance")])),_:1}),e[140]||(e[140]=o("h4",{class:"text-h6 font-weight-medium"}," Actual Production Quantities ",-1))]),I.products.some(a=>a.hasDiscrepancy)?(c(),y(le,{key:0,border:"start",class:"mb-4",type:"warning",variant:"tonal"},{default:t(()=>e[141]||(e[141]=[d(" Some products have discrepancies between planned and actual quantities. ")])),_:1})):x("",!0),(c(!0),P(N,null,Y(I.products,(a,m)=>(c(),y(g,{key:a.production_id,class:"mb-4",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Vo,[l(h,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[142]||(e[142]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",wo,n(a.product_name),1),o("div",ko," Planned: "+n(a.planned_qty)+" units ",1)]),l(te),l(w,{color:a.hasDiscrepancy?"orange":"green",size:"small",variant:"flat"},{default:t(()=>[d(n(a.hasDiscrepancy?"Discrepancy":"On Track"),1)]),_:2},1032,["color"])]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.good_qty,"onUpdate:modelValue":i=>a.good_qty=i,modelModifiers:{number:!0},color:"green",density:"compact",label:`Good Quantity (${a.planned_qty} planned)`,type:"number",variant:"outlined",onInput:i=>ve(a)},{"prepend-inner":t(()=>[l(u,{color:"green",size:"20"},{default:t(()=>e[143]||(e[143]=[d("mdi-check-decagram")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.damaged_qty,"onUpdate:modelValue":i=>a.damaged_qty=i,modelModifiers:{number:!0},color:"orange",density:"compact",label:"Damaged Quantity",type:"number",variant:"outlined",onInput:i=>ve(a)},{"prepend-inner":t(()=>[l(u,{color:"orange",size:"20"},{default:t(()=>e[144]||(e[144]=[d("mdi-alert-circle-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.reject_qty,"onUpdate:modelValue":i=>a.reject_qty=i,modelModifiers:{number:!0},color:"red",density:"compact",label:"Reject Quantity",type:"number",variant:"outlined",onInput:i=>ve(a)},{"prepend-inner":t(()=>[l(u,{color:"red",size:"20"},{default:t(()=>e[145]||(e[145]=[d("mdi-close-octagon-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.actual_qty,"onUpdate:modelValue":i=>a.actual_qty=i,modelModifiers:{number:!0},color:"primary",density:"compact",label:"Total Actual",readonly:"",type:"number",variant:"outlined"},{"prepend-inner":t(()=>[l(u,{color:"primary",size:"20"},{default:t(()=>e[146]||(e[146]=[d("mdi-counter")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a.hasDiscrepancy?(c(),P(N,{key:0},[l(ce,{class:"my-3"}),o("div",qo,[l(w,{color:"orange",size:"small",variant:"flat"},{default:t(()=>[d(" Discrepancy: "+n(Math.abs(a.planned_qty-a.good_qty))+" units ",1)]),_:2},1024)]),(c(!0),P(N,null,Y(a.discrepancies,(i,r)=>(c(),y(j,{key:r,class:"align-center mb-2"},{default:t(()=>[l(p,{cols:"12",md:"5"},{default:t(()=>[l(ie,{modelValue:i.reason_id,"onUpdate:modelValue":V=>i.reason_id=V,density:"compact","item-title":"name","item-value":"id",items:Be.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(p,{cols:"12",md:"5"},{default:t(()=>[l(R,{modelValue:i.notes,"onUpdate:modelValue":V=>i.notes=V,density:"compact",label:"Notes",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(C,{color:"error",icon:"",size:"small",variant:"text",onClick:V=>Ze(a,r)},{default:t(()=>[l(u,null,{default:t(()=>e[147]||(e[147]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(C,{color:"primary",size:"small",variant:"outlined",onClick:i=>Fe(a)},{default:t(()=>[l(u,{start:""},{default:t(()=>e[148]||(e[148]=[d("mdi-plus")])),_:1}),e[149]||(e[149]=d(" Add Reason "))]),_:2},1032,["onClick"])],64)):x("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(g,{class:"rounded-lg pa-4",variant:"outlined"},{default:t(()=>[o("div",ho,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[150]||(e[150]=[d("mdi-chart-box")])),_:1}),e[151]||(e[151]=o("h4",{class:"text-h6 font-weight-medium"},"Batch Summary",-1))]),l(j,null,{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>[o("div",zo,n(Ce.value.good_qty),1),e[152]||(e[152]=o("div",{class:"text-caption text-grey"},"Total Good",-1))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>[o("div",Po,n(Ce.value.damaged_qty),1),e[153]||(e[153]=o("div",{class:"text-caption text-grey"},"Total Damaged",-1))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>[o("div",Co,n(Ce.value.reject_qty),1),e[154]||(e[154]=o("div",{class:"text-caption text-grey"},"Total Reject",-1))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>[o("div",Ao,n(Ce.value.actual_qty),1),e[155]||(e[155]=o("div",{class:"text-caption text-grey"},"Total Actual",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(wt,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(te),l(C,{class:"px-6",color:"grey",variant:"outlined",onClick:Me},{default:t(()=>e[156]||(e[156]=[d(" Cancel ")])),_:1}),l(C,{class:"px-6",color:"success",disabled:!Yt.value,elevation:"2",loading:W.value,onClick:Xe},{default:t(()=>[l(u,{start:""},{default:t(()=>e[157]||(e[157]=[d("mdi-content-save-check")])),_:1}),e[158]||(e[158]=d(" Save Actual Production "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Te,{modelValue:ae.value,"onUpdate:modelValue":e[24]||(e[24]=a=>ae.value=a),"max-width":"1400",persistent:"",scrollable:""},{default:t(()=>[l(g,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ie,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(h,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary",icon:H.value?"mdi-pencil":"mdi-plus"},null,8,["icon"])]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>[d(n(se.value?"Add Actual Quantity":H.value?"Edit Production":"Create New Production (Multiple Products)"),1)]),_:1}),l(te),l(C,{color:"white",icon:"mdi-close",variant:"text",onClick:nt})]),_:1}),l(v,{class:"pa-6"},{default:t(()=>[l(ht,{onSubmit:Vt(mt,["prevent"])},{default:t(()=>[l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Uo,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[159]||(e[159]=[d(" mdi-information ")])),_:1}),e[160]||(e[160]=o("h4",{class:"text-h6 font-weight-medium"},"Batch Information",-1))]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>[o("div",So,[_.planned_at?(c(),P("span",Do," Planned Production Date & Time ")):x("",!0),l(f,{modelValue:_.planned_at,"onUpdate:modelValue":e[18]||(e[18]=a=>_.planned_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Planned Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1}),H.value||se.value?(c(),y(p,{key:0,cols:"12",md:"4"},{default:t(()=>[o("div",Io,[_.produced_at?(c(),P("span",jo," Actual Production Date & Time ")):x("",!0),l(f,{modelValue:_.produced_at,"onUpdate:modelValue":e[19]||(e[19]=a=>_.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1})):x("",!0),l(p,{cols:"12",md:"4"},{default:t(()=>[l(R,{modelValue:_.notes,"onUpdate:modelValue":e[20]||(e[20]=a=>_.notes=a),color:"primary",label:"Batch Notes (optional)","prepend-inner-icon":"mdi-note-text",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",To,[o("div",No,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[161]||(e[161]=[d(" mdi-package-variant ")])),_:1}),e[162]||(e[162]=o("h4",{class:"text-h6 font-weight-medium"}," Products in this Batch ",-1))]),l(C,{color:"primary",size:"small",variant:"outlined",onClick:Ee},{default:t(()=>[l(u,{start:""},{default:t(()=>e[163]||(e[163]=[d("mdi-plus")])),_:1}),e[164]||(e[164]=d(" Add Product "))]),_:1})]),_.products.length?x("",!0):(c(),y(le,{key:0,border:"start",class:"mb-3",type:"info",variant:"tonal"},{default:t(()=>e[165]||(e[165]=[d(" Add one or more products to this production batch. Each product keeps its own mode and ingredients. ")])),_:1})),(c(!0),P(N,null,Y(_.products,(a,m)=>(c(),y(j,{key:a.uid,dense:""},{default:t(()=>[l(p,{cols:"12"},{default:t(()=>[l(g,{class:"mb-3",ripple:!1,variant:"outlined"},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",$o,[l(w,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(" Product #"+n(m+1),1)]),_:2},1024),o("span",Bo,n(al(a)),1),l(te),_.products.length>1?(c(),y(C,{key:0,color:"error",icon:"",size:"x-small",variant:"text",onClick:i=>ul(m)},{default:t(()=>[l(u,null,{default:t(()=>e[166]||(e[166]=[d("mdi-close")])),_:1})]),_:2},1032,["onClick"])):x("",!0)]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"5"},{default:t(()=>[l(fe,{modelValue:a.product_id,"onUpdate:modelValue":[i=>a.product_id=i,()=>it(a)],clearable:"",density:"compact","item-title":"name","item-value":"id",items:we.value,label:"Select Product","prepend-inner-icon":"mdi-package-variant",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(ie,{modelValue:a.mode,"onUpdate:modelValue":[i=>a.mode=i,()=>re(a)],density:"compact","item-title":"label","item-value":"value",items:It,label:"Production Mode","prepend-inner-icon":"mdi-cog",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a.mode==="by_product"?(c(),y(p,{key:0,cols:"12",md:"4"},{default:t(()=>[l(R,{modelValue:a.qty_product_input,"onUpdate:modelValue":i=>a.qty_product_input=i,modelModifiers:{number:!0},density:"compact",label:"Planned Units","prepend-inner-icon":"mdi-counter",type:"number",variant:"outlined",onInput:()=>re(a)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024)):a.mode==="by_ingredient"?(c(),P(N,{key:1},[l(p,{cols:"12",md:"4"},{default:t(()=>[l(fe,{modelValue:a.base_ingredient_id,"onUpdate:modelValue":[i=>a.base_ingredient_id=i,()=>re(a)],density:"compact",disabled:!a.recipeItems.length,"item-title":"item_name","item-value":"item_id",items:a.recipeItems,label:"Base Ingredient","prepend-inner-icon":"mdi-ingredient",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.base_ingredient_qty,"onUpdate:modelValue":i=>a.base_ingredient_qty=i,modelModifiers:{number:!0},density:"compact",disabled:!a.base_ingredient_id,label:`Base Qty (${a.baseUnit||"units"})`,"prepend-inner-icon":"mdi-weight",type:"number",variant:"outlined",onInput:()=>re(a)},null,8,["modelValue","onUpdate:modelValue","disabled","label","onInput"])]),_:2},1024),l(p,{class:"d-flex align-center",cols:"12",md:"1"},{default:t(()=>[a.computed_qty_product?(c(),y(w,{key:0,color:"blue",size:"small",variant:"flat"},{default:t(()=>[d(" Planned "+n(a.computed_qty_product)+" units ",1)]),_:2},1024)):x("",!0)]),_:2},1024)],64)):x("",!0),H.value||se.value?(c(),y(v,{key:2,class:"pa-4"},{default:t(()=>[o("div",Mo,[l(w,{color:a.hasDiscrepancy?"orange":"green",size:"small",variant:"flat"},{default:t(()=>[d(n(a.hasDiscrepancy?"Discrepancy: "+Math.abs(a.planned_qty-a.good_qty)+" units":"On Track"),1)]),_:2},1032,["color"])]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.good_qty,"onUpdate:modelValue":i=>a.good_qty=i,modelModifiers:{number:!0},color:"green",density:"compact",label:`Good Quantity (${a.planned_qty} planned)`,type:"number",variant:"outlined",onInput:i=>ve(a)},{"prepend-inner":t(()=>[l(u,{color:"green",size:"20"},{default:t(()=>e[167]||(e[167]=[d("mdi-check-decagram")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.damaged_qty,"onUpdate:modelValue":i=>a.damaged_qty=i,modelModifiers:{number:!0},color:"orange",density:"compact",label:"Damaged Quantity",type:"number",variant:"outlined",onInput:i=>ve(a)},{"prepend-inner":t(()=>[l(u,{color:"orange",size:"20"},{default:t(()=>e[168]||(e[168]=[d("mdi-alert-circle-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.reject_qty,"onUpdate:modelValue":i=>a.reject_qty=i,modelModifiers:{number:!0},color:"red",density:"compact",label:"Reject Quantity",type:"number",variant:"outlined",onInput:i=>ve(a)},{"prepend-inner":t(()=>[l(u,{color:"red",size:"20"},{default:t(()=>e[169]||(e[169]=[d("mdi-close-octagon-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(R,{modelValue:a.actual_qty,"onUpdate:modelValue":i=>a.actual_qty=i,modelModifiers:{number:!0},color:"primary",density:"compact",label:"Total Actual",readonly:"",type:"number",variant:"outlined"},{"prepend-inner":t(()=>[l(u,{color:"primary",size:"20"},{default:t(()=>e[170]||(e[170]=[d("mdi-counter")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a.hasDiscrepancy?(c(),P(N,{key:0},[l(ce,{class:"my-3"}),(c(!0),P(N,null,Y(a.discrepancies,(i,r)=>(c(),y(j,{key:r,class:"align-center mb-2"},{default:t(()=>[l(p,{cols:"12",md:"5"},{default:t(()=>[l(ie,{modelValue:i.reason_id,"onUpdate:modelValue":V=>i.reason_id=V,density:"compact","item-title":"name","item-value":"id",items:Be.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(p,{cols:"12",md:"5"},{default:t(()=>[l(R,{modelValue:i.notes,"onUpdate:modelValue":V=>i.notes=V,density:"compact",label:"Notes",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(C,{color:"error",icon:"",size:"small",variant:"text",onClick:V=>Ze(a,r)},{default:t(()=>[l(u,null,{default:t(()=>e[171]||(e[171]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(C,{color:"primary",size:"small",variant:"outlined",onClick:i=>Fe(a)},{default:t(()=>[l(u,{start:""},{default:t(()=>e[172]||(e[172]=[d("mdi-plus")])),_:1}),e[173]||(e[173]=d(" Add Reason "))]),_:2},1032,["onClick"])],64)):x("",!0)]),_:2},1024)):x("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),_.products.length?(c(),y(le,{key:1,border:"start",class:"mt-2",type:"success",variant:"tonal"},{default:t(()=>[e[174]||(e[174]=d(" Total planned units for this batch: ")),o("b",null,n(at.value),1)]),_:1})):x("",!0)]),_:1}),l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Fo,[o("div",Ro,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[175]||(e[175]=[d(" mdi-ingredient ")])),_:1}),e[176]||(e[176]=o("h4",{class:"text-h6 font-weight-medium"}," Ingredients & Groups ",-1))]),l(jl,{modelValue:O.value,"onUpdate:modelValue":e[21]||(e[21]=a=>O.value=a),color:"primary","hide-details":"",inset:"",label:O.value?"Editing Enabled":"Editing Disabled"},null,8,["modelValue","label"])]),et.value?(c(),y(le,{key:0,border:"start",class:"mb-3",type:"error",variant:"tonal"},{default:t(()=>e[177]||(e[177]=[d(" Some ingredients exceed available stock. Please adjust quantities before saving. ")])),_:1})):x("",!0),l(Pt,{modelValue:J.value,"onUpdate:modelValue":e[22]||(e[22]=a=>J.value=a),"bg-color":"transparent",color:"primary",density:"comfortable","show-arrows":""},{default:t(()=>[(c(!0),P(N,null,Y(_.products,(a,m)=>(c(),y(Ne,{key:a.uid,value:m},{default:t(()=>[d(n(ol(a,m)),1)]),_:2},1032,["value"]))),128)),_.products.length?(c(),y(Ne,{key:0,value:"summary"},{default:t(()=>e[178]||(e[178]=[d(" All Ingredients Summary ")])),_:1})):x("",!0)]),_:1},8,["modelValue"]),l(Ct,{modelValue:J.value,"onUpdate:modelValue":e[23]||(e[23]=a=>J.value=a),class:"mt-4"},{default:t(()=>[(c(!0),P(N,null,Y(_.products,(a,m)=>(c(),y($e,{key:`win-${a.uid}`,value:m},{default:t(()=>[l(Pt,{modelValue:a.innerTab,"onUpdate:modelValue":i=>a.innerTab=i,class:"mb-2",color:"primary",density:"compact"},{default:t(()=>[l(Ne,{value:"ingredients"},{default:t(()=>e[179]||(e[179]=[d("Ingredients")])),_:1}),l(Ne,{value:"groups"},{default:t(()=>e[180]||(e[180]=[d(" Ingredient Groups ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(Ct,{modelValue:a.innerTab,"onUpdate:modelValue":i=>a.innerTab=i},{default:t(()=>[l($e,{value:"ingredients"},{default:t(()=>[l(xe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Ye,items:a.ingredients},{"item.item_name":t(({item:i})=>[o("div",Eo,[i.from_group?(c(),y(u,{key:0,class:"mr-2",color:"purple",size:"16"},{default:t(()=>e[181]||(e[181]=[d(" mdi-cog ")])),_:1})):x("",!0),o("span",null,n(i.item_name),1),i.group_name?(c(),y(w,{key:1,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(i.group_name),1)]),_:2},1024)):x("",!0)])]),"item.qty_required":t(({item:i})=>[o("div",Go,[l(R,{modelValue:i.qty_required,"onUpdate:modelValue":r=>i.qty_required=r,modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",density:"compact",disabled:!O.value,error:i.exceeds,"error-messages":i.exceeds?["Exceeds available stock"]:[],"hide-details":"",inputmode:"none",spellcheck:"false",style:{"max-width":"140px"},type:"number",variant:"outlined",onInput:r=>i.exceeds=Number(i.qty_required)>Number(i.available||0)},{"append-inner":t(()=>[o("span",{class:de(["text-caption",i.exceeds?"text-error":"text-grey"])},n(i.unit),3)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","error","error-messages","onInput"]),i.exceeds?(c(),y(Tl,{key:0,location:"top",text:"Maximum available: "+(i.available||0)+" "+(i.unit||"")},{activator:t(({props:r})=>[l(C,Ve({ref_for:!0},r,{class:"ml-1",color:"orange",icon:"",size:"x-small",variant:"text",onClick:V=>{i.qty_required=i.available||0,i.exceeds=!1}}),{default:t(()=>[l(u,{size:"16"},{default:t(()=>e[182]||(e[182]=[d(" mdi-information-outline ")])),_:1})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):x("",!0)])]),"item.available":t(({item:i})=>[l(w,{class:"font-weight-medium",color:i.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[d(n(i.available||0)+" "+n(i.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:i})=>[l(w,{color:"blue-grey",size:"small",variant:"outlined"},{default:t(()=>[d(n(i.unit),1)]),_:2},1024)]),"no-data":t(()=>e[183]||(e[183]=[o("div",{class:"text-center py-4 text-grey"}," Configure this product (mode + quantity) to calculate ingredients ",-1)])),_:2},1032,["items"]),a.computed_qty_product?(c(),y(le,{key:0,border:"start",class:"mt-3",type:"success",variant:"tonal"},{default:t(()=>[e[184]||(e[184]=d(" Planned units for ")),o("b",null,n(Ae(a.product_id)),1),e[185]||(e[185]=d(": ")),o("b",null,n(a.computed_qty_product),1),e[186]||(e[186]=d(". Ingredients above are specific to this product. "))]),_:2},1024)):x("",!0)]),_:2},1024),l($e,{value:"groups"},{default:t(()=>[a.productGroups&&a.productGroups.length?(c(),y(g,{key:0,class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(v,{class:"pa-4"},{default:t(()=>[o("div",Lo,[l(u,{class:"mr-2",color:"purple"},{default:t(()=>e[187]||(e[187]=[d(" mdi-cog ")])),_:1}),o("h5",Oo," Ingredient Groups for "+n(Ae(a.product_id)),1),l(w,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[d(n(a.productGroups.length)+" groups ",1)]),_:2},1024)]),l(le,{class:"mb-4",type:"info",variant:"tonal"},{default:t(()=>e[188]||(e[188]=[d(" Select combinations per group to update ingredients for this product. ")])),_:1}),l(Nl,{modelValue:a.expandedGroups,"onUpdate:modelValue":i=>a.expandedGroups=i,multiple:""},{default:t(()=>[(c(!0),P(N,null,Y(a.productGroups,(i,r)=>(c(),y($l,{key:i.id,class:"mb-2"},{default:t(()=>[l(Bl,{class:"font-weight-medium"},{default:t(()=>[o("div",Ho,[o("div",Qo,[l(u,{class:"mr-2",color:"purple"},{default:t(()=>e[189]||(e[189]=[d(" mdi-cog ")])),_:1}),o("span",null,n(i.name),1),i.is_mandatory?(c(),y(w,{key:0,class:"ml-2",color:"red",size:"x-small",variant:"flat"},{default:t(()=>e[190]||(e[190]=[d(" Required ")])),_:1})):(c(),y(w,{key:1,class:"ml-2",color:"grey",size:"x-small",variant:"outlined"},{default:t(()=>e[191]||(e[191]=[d(" Optional ")])),_:1}))]),o("div",Yo,[l(w,{class:"mr-2",color:"blue",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(i.selection_mode),1)]),_:2},1024),a.group_choices[i.id]?(c(),y(w,{key:0,color:"green",size:"x-small",variant:"flat"},{default:t(()=>e[192]||(e[192]=[d(" Selected ")])),_:1})):(c(),y(w,{key:1,color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>e[193]||(e[193]=[d(" Not Selected ")])),_:1}))])])]),_:2},1024),l(Ml,null,{default:t(()=>[o("p",Jo,n(i.description),1),l(Gl,{modelValue:a.group_choices[i.id],"onUpdate:modelValue":[V=>a.group_choices[i.id]=V,()=>re(a)],"hide-details":""},{default:t(()=>[l(j,null,{default:t(()=>[(c(!0),P(N,null,Y(i.combinations,V=>(c(),y(p,{key:V.id,cols:"12",md:"6"},{default:t(()=>[l(g,{class:de(["combination-card",{selected:a.group_choices[i.id]===V.id}]),variant:"outlined",onClick:A=>{a.group_choices[i.id]=V.id,re(a)}},{default:t(()=>[l(v,{class:"pa-3"},{default:t(()=>[o("div",Ko,[l(Rl,{"hide-details":"",value:V.id},null,8,["value"]),o("div",Wo,[o("div",Zo,n(V.name),1),V.notes?(c(),P("div",Xo,n(V.notes),1)):x("",!0),o("div",ed,[(c(!0),P(N,null,Y(V.options,A=>(c(),y(w,{key:A.option_id,class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(A.item_name)+": "+n(A.quantity_per_unit)+" "+n(A.unit),1)]),_:2},1024))),128))])]),V.is_default?(c(),y(w,{key:0,color:"orange",size:"x-small",variant:"flat"},{default:t(()=>e[194]||(e[194]=[d(" Default ")])),_:1})):x("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):(c(),y(le,{key:1,border:"start",type:"info",variant:"tonal"},{default:t(()=>e[195]||(e[195]=[d(" No ingredient groups configured for this product. ")])),_:1}))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["value"]))),128)),l($e,{value:"summary"},{default:t(()=>[l(xe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Ye,items:ot.value},{"item.item_name":t(({item:a})=>[o("div",td,[l(h,{class:"mr-2",color:"primary",size:"22",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"14"},{default:t(()=>e[196]||(e[196]=[d(" mdi-ingredient ")])),_:1})]),_:1}),o("span",null,n(a.item_name),1)])]),"item.qty_required":t(({item:a})=>[l(w,{color:a.exceeds?"red":"green",size:"small",variant:"outlined"},{default:t(()=>[d(n(a.qty_required)+" "+n(a.unit),1)]),_:2},1032,["color"])]),"item.available":t(({item:a})=>[l(w,{color:a.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[d(n(a.available||0)+" "+n(a.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:a})=>[o("span",null,n(a.unit),1)]),"no-data":t(()=>e[197]||(e[197]=[o("div",{class:"text-center py-4 text-grey"}," Add products and configure ingredients to see a consolidated summary. ",-1)])),_:1},8,["items"]),ot.value.length?(c(),y(le,{key:0,border:"start",class:"mt-3",type:"success",variant:"tonal"},{default:t(()=>e[198]||(e[198]=[d(" Consolidated ingredient requirements across all products in this batch. ")])),_:1})):x("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",ld,[o("div",ad,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[199]||(e[199]=[d(" mdi-account-group ")])),_:1}),e[200]||(e[200]=o("h4",{class:"text-h6 font-weight-medium"},"Staff Assignment",-1))]),o("div",od,[l(C,{color:"primary",disabled:!tt.value.length,size:"small",variant:"outlined",onClick:dt},{default:t(()=>[l(u,{start:""},{default:t(()=>e[201]||(e[201]=[d("mdi-account-plus")])),_:1}),e[202]||(e[202]=d(" Add Staff "))]),_:1},8,["disabled"]),l(C,{color:"secondary",disabled:!_.staff.length,size:"small",variant:"outlined",onClick:nl},{default:t(()=>[l(u,{start:""},{default:t(()=>e[203]||(e[203]=[d("mdi-account-remove")])),_:1}),e[204]||(e[204]=d(" Clear All "))]),_:1},8,["disabled"])])]),l(xe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Mt,items:_.staff},{"item.staff_id":t(({item:a})=>[l(fe,{modelValue:a.staff_id,"onUpdate:modelValue":m=>a.staff_id=m,density:"compact",disabled:!O.value,"hide-details":"","item-title":"name","item-value":"id",items:ke.value,placeholder:"Select Staff",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),"item.role":t(({item:a})=>[l(ie,{modelValue:a.role,"onUpdate:modelValue":m=>a.role=m,density:"compact",disabled:!O.value,"hide-details":"",items:["Team Leader","Assistant","Support"],"prepend-inner-icon":"mdi-account-tie",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":t(({item:a})=>[l(R,{modelValue:a.notes,"onUpdate:modelValue":m=>a.notes=m,density:"compact",disabled:!O.value,"hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.actions":t(({index:a})=>[l(C,{color:"error",disabled:!O.value,icon:"",size:"small",variant:"text",onClick:m=>il(a)},{default:t(()=>[l(u,null,{default:t(()=>e[205]||(e[205]=[d("mdi-delete")])),_:1})]),_:2},1032,["disabled","onClick"])]),"no-data":t(()=>e[206]||(e[206]=[o("div",{class:"text-center py-4 text-grey"},' No staff assigned. Click "Add Staff" to assign team members. ',-1)])),_:1},8,["items"]),_.staff.length?(c(),y(le,{key:0,border:"start",class:"mt-4",type:"info",variant:"tonal"},{default:t(()=>[o("div",dd,[o("div",null,[e[207]||(e[207]=o("strong",null,"Team Summary:",-1)),l(w,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(n(_.staff.length)+" staff members ",1)]),_:1})]),o("div",sd,n(lt.value)+" of "+n(tt.value.length+lt.value)+" staff assigned ",1)])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1}),l(wt,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(te),l(C,{class:"px-6",color:"grey",variant:"outlined",onClick:nt},{default:t(()=>e[208]||(e[208]=[d(" Cancel ")])),_:1}),l(C,{class:"px-6",color:"success",disabled:!ll.value,elevation:"2",loading:W.value,onClick:mt},{default:t(()=>[l(u,{start:""},{default:t(()=>e[209]||(e[209]=[d("mdi-content-save-check")])),_:1}),d(" "+n(H.value?"Update Production":"Create Production"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Te,{modelValue:_e.value,"onUpdate:modelValue":e[26]||(e[26]=a=>_e.value=a),"max-width":"1000",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(g,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ie,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(h,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[210]||(e[210]=[d("mdi-eye")])),_:1})]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a,m;return[d(" Production Details - "+n((m=(a=q.value)==null?void 0:a.production)==null?void 0:m.product_name),1)]}),_:1}),l(te),l(C,{color:"white",icon:"mdi-close",variant:"text",onClick:e[25]||(e[25]=a=>_e.value=!1)})]),_:1}),l(v,{class:"pa-6"},{default:t(()=>{var a,m,i,r,V,A,M,ue,he,Se,ft,pt,_t,yt;return[l(g,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>{var z,T;return[o("div",id,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[211]||(e[211]=[d("mdi-information")])),_:1}),e[212]||(e[212]=o("h4",{class:"text-h6 font-weight-medium"},"Production Information",-1))]),l(j,null,{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[213]||(e[213]=o("div",{class:"text-body-2 text-grey"},"Production ID",-1)),o("div",nd," #"+n((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.id),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[214]||(e[214]=o("div",{class:"text-body-2 text-grey"},"Product",-1)),o("div",rd,n((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.product_name),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[215]||(e[215]=o("div",{class:"text-body-2 text-grey"},"Production Mode",-1)),o("div",ud,n((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.mode),1)]}),_:1})]),_:1}),l(j,{class:"mt-2"},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[216]||(e[216]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",cd,n(oe((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.planned_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[217]||(e[217]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",md,n(oe((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.produced_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[218]||(e[218]=o("div",{class:"text-body-2 text-grey"},"Produced By",-1)),o("div",fd,n((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.produced_by_name),1)]}),_:1})]),_:1}),l(j,{class:"mt-2"},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[219]||(e[219]=o("div",{class:"text-body-2 text-grey"},"Created",-1)),o("div",pd,n(oe((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.created)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[220]||(e[220]=o("div",{class:"text-body-2 text-grey"},"Last Updated",-1)),o("div",_d,n(oe((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.updated_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var b,k;return[e[221]||(e[221]=o("div",{class:"text-body-2 text-grey"},"Batch ID",-1)),o("div",yd,n(((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.batch_id)||"N/A"),1)]}),_:1})]),_:1}),l(j,{class:"mt-4"},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var b,k;return[o("div",gd,n((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.qty_product),1),e[222]||(e[222]=o("div",{class:"text-caption text-grey"},"Planned Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var b,k;return[o("div",vd,n((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.actual_qty),1),e[223]||(e[223]=o("div",{class:"text-caption text-grey"},"Actual Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"2"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var b,k;return[o("div",bd,n(((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.good_qty)||0),1),e[224]||(e[224]=o("div",{class:"text-caption text-grey"},"Good",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"2"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var b,k;return[o("div",xd,n(((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.damaged_qty)||0),1),e[225]||(e[225]=o("div",{class:"text-caption text-grey"},"Damaged",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"2"},{default:t(()=>[l(g,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(v,null,{default:t(()=>{var b,k;return[o("div",Vd,n(((k=(b=q.value)==null?void 0:b.production)==null?void 0:k.reject_qty)||0),1),e[226]||(e[226]=o("div",{class:"text-caption text-grey"},"Reject",-1))]}),_:1})]),_:1})]),_:1})]),_:1}),(T=(z=q.value)==null?void 0:z.production)!=null&&T.notes?(c(),y(j,{key:0,class:"mt-4"},{default:t(()=>[l(p,{cols:"12"},{default:t(()=>[e[227]||(e[227]=o("div",{class:"text-body-2 text-grey"},"Notes",-1)),o("div",wd,n(q.value.production.notes),1)]),_:1})]),_:1})):x("",!0)]}),_:1}),l(g,{class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[228]||(e[228]=[d("mdi-ingredient")])),_:1}),e[229]||(e[229]=d(" Ingredients Used ")),l(w,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>{var z,T;return[d(n(((T=(z=q.value)==null?void 0:z.items)==null?void 0:T.length)||0)+" items ",1)]}),_:1})]),_:1}),l(v,{class:"pa-0"},{default:t(()=>[l(me,{class:"pa-0",lines:"two"},{default:t(()=>{var z;return[(c(!0),P(N,null,Y(((z=q.value)==null?void 0:z.items)||[],(T,b)=>(c(),y(K,{key:T.id,class:de(["px-4",{"bg-grey-lighten-4":b%2===0}])},{prepend:t(()=>[l(h,{class:"mr-3",color:"primary",size:"36"},{default:t(()=>[o("span",kd,n(b+1),1)]),_:2},1024)]),default:t(()=>[l(X,{class:"font-weight-medium"},{default:t(()=>[d(n(T.item_name)+" ",1),T.group_name?(c(),y(w,{key:0,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(T.group_name),1)]),_:2},1024)):x("",!0),T.combination_name?(c(),y(w,{key:1,class:"ml-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(T.combination_name),1)]),_:2},1024)):x("",!0)]),_:2},1024),l(Q,{class:"mt-1"},{default:t(()=>[l(w,{class:"mr-2",color:"primary",size:"small",variant:"outlined"},{default:t(()=>[d(n(T.qty_required)+" "+n(T.unit||""),1)]),_:2},1024),o("span",qd," Item ID: "+n(T.item_id),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]}),_:1})]),_:1})]),_:1}),(m=(a=q.value)==null?void 0:a.group_choices)!=null&&m.length?(c(),y(g,{key:0,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"purple"},{default:t(()=>e[230]||(e[230]=[d("mdi-cog")])),_:1}),e[231]||(e[231]=d(" Ingredient Group Choices ")),l(w,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[d(n(q.value.group_choices.length)+" groups ",1)]),_:1})]),_:1}),l(v,{class:"pa-0"},{default:t(()=>[l(me,{class:"pa-0",lines:"two"},{default:t(()=>[(c(!0),P(N,null,Y(q.value.group_choices,(z,T)=>(c(),y(K,{key:z.id,class:de(["px-4",{"bg-grey-lighten-4":T%2===0}])},{prepend:t(()=>[l(h,{class:"mr-3",color:"purple",size:"36"},{default:t(()=>[l(u,{color:"white",size:"18"},{default:t(()=>e[232]||(e[232]=[d("mdi-cog")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"font-weight-medium"},{default:t(()=>[d(n(z.group_name),1)]),_:2},1024),l(Q,{class:"mt-1"},{default:t(()=>[l(w,{color:"green",size:"small",variant:"outlined"},{default:t(()=>[d(n(z.combination_name),1)]),_:2},1024),z.chosen_by_name?(c(),P("span",hd," Chosen by: "+n(z.chosen_by_name),1)):x("",!0),o("span",zd," Created: "+n(oe(z.created_at)),1)]),_:2},1024),z.notes?(c(),y(Q,{key:0,class:"mt-1 text-caption"},{default:t(()=>[e[233]||(e[233]=o("strong",null,"Notes:",-1)),d(" "+n(z.notes),1)]),_:2},1024)):x("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0),(r=(i=q.value)==null?void 0:i.staff)!=null&&r.length?(c(),y(g,{key:1,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"blue"},{default:t(()=>e[234]||(e[234]=[d("mdi-account-group")])),_:1}),e[235]||(e[235]=d(" Staff Assignments ")),l(w,{class:"ml-2",color:"blue",size:"small",variant:"flat"},{default:t(()=>[d(n(q.value.staff.length)+" staff ",1)]),_:1})]),_:1}),l(v,{class:"pa-0"},{default:t(()=>[l(me,{class:"pa-0",lines:"two"},{default:t(()=>[(c(!0),P(N,null,Y(q.value.staff,(z,T)=>(c(),y(K,{key:z.staff_id,class:de(["px-4",{"bg-grey-lighten-4":T%2===0}])},{prepend:t(()=>[l(h,{class:"mr-3",color:"blue",size:"36"},{default:t(()=>[o("span",Pd,n(T+1),1)]),_:2},1024)]),default:t(()=>[l(X,{class:"font-weight-medium"},{default:t(()=>[d(n(z.staff_name)+" ",1),l(w,{class:"ml-2",color:ct(z.role),size:"x-small",variant:"flat"},{default:t(()=>[d(n(z.role),1)]),_:2},1032,["color"])]),_:2},1024),l(Q,{class:"mt-1"},{default:t(()=>[z.notes?(c(),P("span",Cd,n(z.notes),1)):(c(),P("span",Ad," No notes "))]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0),(A=(V=q.value)==null?void 0:V.discrepancies)!=null&&A.length?(c(),y(g,{key:2,class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"orange"},{default:t(()=>e[236]||(e[236]=[d("mdi-alert-circle")])),_:1}),e[237]||(e[237]=d(" Discrepancies ")),l(w,{class:"ml-2",color:"orange",size:"small",variant:"flat"},{default:t(()=>[d(n(q.value.discrepancies.length)+" issues ",1)]),_:1})]),_:1}),l(v,{class:"pa-0"},{default:t(()=>[l(me,{class:"pa-0",lines:"two"},{default:t(()=>[(c(!0),P(N,null,Y(q.value.discrepancies,(z,T)=>(c(),y(K,{key:z.id,class:de(["px-4",{"bg-grey-lighten-4":T%2===0}])},{prepend:t(()=>[l(h,{class:"mr-3",color:"orange",size:"36"},{default:t(()=>[l(u,{color:"white",size:"18"},{default:t(()=>e[238]||(e[238]=[d("mdi-alert")])),_:1})]),_:1})]),default:t(()=>[l(X,{class:"font-weight-medium"},{default:t(()=>[d(n(z.reason_name),1)]),_:2},1024),l(Q,{class:"mt-1"},{default:t(()=>[o("span",Ud," Reason ID: "+n(z.reason_id),1)]),_:2},1024),z.notes?(c(),y(Q,{key:0,class:"mt-1 text-caption"},{default:t(()=>[e[239]||(e[239]=o("strong",null,"Notes:",-1)),d(" "+n(z.notes),1)]),_:2},1024)):x("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0),!((ue=(M=q.value)==null?void 0:M.items)!=null&&ue.length)&&!((Se=(he=q.value)==null?void 0:he.staff)!=null&&Se.length)&&!((pt=(ft=q.value)==null?void 0:ft.group_choices)!=null&&pt.length)&&!((yt=(_t=q.value)==null?void 0:_t.discrepancies)!=null&&yt.length)?(c(),y(g,{key:3,class:"rounded-lg text-center py-8",variant:"outlined"},{default:t(()=>[l(u,{class:"mb-2",color:"grey",size:"48"},{default:t(()=>e[240]||(e[240]=[d("mdi-information-outline")])),_:1}),e[241]||(e[241]=o("div",{class:"text-h6 text-grey"},"No Additional Data",-1)),e[242]||(e[242]=o("div",{class:"text-body-2 text-grey mt-2"}," This production record doesn't have any additional items, staff, or discrepancies. ",-1))]),_:1})):x("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Zd=kl(Sd,[["__scopeId","data-v-f7955bb4"]]);export{Zd as default};
