import{_ as L,s as T,x as r,r as d,a0 as G,l as H,a1 as K,v as I,i as t,y as p,a3 as b,B as g,C as i,D as E,H as f,I as q,a4 as Q,aD as W,E as X,F as Y,G as Z}from"./index-BDGZztMX.js";import{u as $,r as B,e as _}from"./index-KjYgCwLa.js";import{V as ee}from"./VContainer-DinoKQ-l.js";import{V as F}from"./VDialog-DH7CDtJX.js";import{V as y,b as x}from"./VCard-Brm6sCYj.js";import{V as m}from"./VTextField-DPyBwJal.js";import{V as h}from"./VAutocomplete-DJYfsC50.js";import{a as le}from"./VDataTable-O-9_8YpB.js";import{V as oe}from"./VChip-DbwpO9qV.js";import"./dialog-transition-3l4xy3-4.js";import"./VSlideGroup-kB5ySh_a.js";const te={setup(){const u=K(),e=d(!1),D=d(!1),l=d(!1),U=d([]),k=d([]),o=d([]),v=d({}),N=d([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Role",key:"role"},{title:"Outlets",key:"outlets"},{title:"Edit",key:"edit"}]),C=d(!1),w=d(!1),j=d(!1),s=G({name:"",title:"",email:"",phone:"",role:"",password:"",outlets:[]}),O=$({name:{required:B},email:{required:B,email:_},phone:{required:B},role:{required:B},password:{required:B}},s);function V(){D.value=!0,fetch("/users/getUsers").then(a=>{a.json().then(n=>{D.value=!1,U.value=n}).catch(()=>{D.value=!1})}).catch(()=>{e.value=!1})}function M(){e.value=!0,fetch("/users/getRoles").then(a=>{a.json().then(n=>{e.value=!1,k.value=n}).catch(()=>{e.value=!1})}).catch(()=>{e.value=!1})}function A(){fetch("/outlets").then(a=>a.json()).then(a=>{o.value=a.data}).catch(a=>{console.error("Failed to load outlets",a)})}function S(){O.value.name.$touch(),C.value=!0,s.name="",s.title="",s.email="",s.phone="",s.role="",s.password="",s.outlets=[]}function P(a){v.value=JSON.parse(JSON.stringify(a)),w.value=!0,s.name=a.name,s.title=a.title,s.email=a.email,s.phone=a.phone,s.role=a.roleid,s.password="unchangedpassword",s.outlets=a.outlets?a.outlets.map(n=>n.id):[]}function z(){e.value=!0;const a=new FormData;a.append("name",s.name),a.append("title",s.title),a.append("email",s.email),a.append("phone",s.phone),a.append("role",s.role),a.append("password",s.password),s.outlets.forEach(n=>{a.append("outlets",n)}),fetch("/users/addUser",{body:a,method:"POST"}).then(n=>{e.value=!1,C.value=!1,n.status!==200&&n.status!==201?n.json().then(c=>{u.commit("setMessage",{type:"error",text:"Failed to save User! "+c.error,timeout:2e3})}):n.json().then(()=>{V(),u.commit("setMessage",{type:"primary",text:"User saved successfully!",timeout:2e3})})}).catch(n=>{e.value=!1,u.commit("setMessage",{type:"error",text:"Failed to save User!",timeout:2e3}),console.error("Error:",n)})}function R(){e.value=!0;const a=new FormData;a.append("name",s.name),a.append("title",s.title),a.append("email",s.email),a.append("phone",s.phone),a.append("role",s.role),a.append("password",s.password),a.append("outlets",JSON.stringify(s.outlets)),fetch("/users/editUser/"+v.value.id,{body:a,method:"POST"}).then(n=>{e.value=!1,w.value=!1,n.status!==200&&n.status!==201?n.json().then(c=>{u.commit("setMessage",{type:"error",text:"Failed to edit User! "+c.error,timeout:2e3})}):n.json().then(()=>{V(),u.commit("setMessage",{type:"primary",text:"User edited successfully!",timeout:2e3})})}).catch(n=>{e.value=!1,u.commit("setMessage",{type:"error",text:"Failed to edit User!",timeout:2e3}),console.error("Error:",n)})}function J(){e.value=!0;const a=new FormData;j.value=!1,fetch("/users/deleteUser/"+v.value.id,{body:a,method:"DELETE"}).then(n=>{e.value=!1,w.value=!1,n.status!==200&&n.status!==201?n.json().then(c=>{u.commit("setMessage",{type:"error",text:"Failed to delete User! "+c.error,timeout:2e3})}):n.json().then(()=>{V(),u.commit("setMessage",{type:"primary",text:"User deleted successfully!",timeout:2e3})})}).catch(n=>{e.value=!1,u.commit("setMessage",{type:"error",text:"Failed to delete User!",timeout:2e3}),console.error("Error:",n)})}return H(()=>{V(),M(),A()}),{loading:e,loadingValues:D,values:U,headers:N,addDialog:C,editDialog:w,state:s,v$:O,editingItem:v,confirmDeleteDialog:j,roles:k,availableOutlets:o,password_show:l,loadValues:V,activateAddDialog:S,activateEditDialog:P,create:z,saveEdit:R,remove:J}}},ae={class:"d-flex align-center flex-wrap"},re={class:"d-flex justify-end"},se={class:"d-flex align-center flex-wrap"},ne={class:"d-flex justify-end justify-space-between"},ie={class:"d-flex justify-end justify-space-between"};function de(u,e,D,l,U,k){return I(),T(ee,{fluid:""},{default:r(()=>[t(F,{modelValue:l.addDialog,"onUpdate:modelValue":e[9]||(e[9]=o=>l.addDialog=o),transition:"dialog-top-transition",width:"600"},{default:r(()=>[t(y,{class:"rounded-xl pa-4",elevation:"10"},{default:r(()=>[t(b,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:r(()=>[p("div",ae,[t(g,{class:"mr-2 text-white"},{default:r(()=>e[26]||(e[26]=[i("mdi-account")])),_:1}),e[27]||(e[27]=p("span",{class:"text-white font-weight-bold text-h6"},"Add User",-1))]),t(E),t(f,{color:"white",icon:"mdi-close",onClick:e[0]||(e[0]=o=>l.addDialog=!1)})]),_:1}),t(x,{class:"pt-6"},{default:r(()=>[t(m,{modelValue:l.state.name,"onUpdate:modelValue":e[1]||(e[1]=o=>l.state.name=o),"bg-color":"#BDBDBD","error-messages":l.v$.name.$errors.map(o=>o.$message),label:"Full Name",required:"",onBlur:l.v$.name.$touch,onInput:l.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),t(m,{modelValue:l.state.title,"onUpdate:modelValue":e[2]||(e[2]=o=>l.state.title=o),"bg-color":"#BDBDBD",label:"Title"},null,8,["modelValue"]),t(m,{modelValue:l.state.email,"onUpdate:modelValue":e[3]||(e[3]=o=>l.state.email=o),"bg-color":"#BDBDBD","error-messages":l.v$.email.$errors.map(o=>o.$message),label:"Email",required:"",onBlur:l.v$.email.$touch,onInput:l.v$.email.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),t(m,{modelValue:l.state.phone,"onUpdate:modelValue":e[4]||(e[4]=o=>l.state.phone=o),"bg-color":"#BDBDBD","error-messages":l.v$.phone.$errors.map(o=>o.$message),label:"Phone Number",required:"",onBlur:l.v$.phone.$touch,onInput:l.v$.phone.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),t(h,{modelValue:l.state.role,"onUpdate:modelValue":e[5]||(e[5]=o=>l.state.role=o),autocomplete:"off",autocorrect:"off","bg-color":"#BDBDBD","error-messages":l.v$.role.$errors.map(o=>o.$message),inputmode:"none","item-title":"name","item-value":"id",items:l.roles,label:"Role",required:"",spellcheck:"false",onBlur:l.v$.role.$touch,onChange:l.v$.role.$touch},null,8,["modelValue","error-messages","items","onBlur","onChange"]),t(h,{modelValue:l.state.outlets,"onUpdate:modelValue":e[6]||(e[6]=o=>l.state.outlets=o),autocomplete:"off",autocorrect:"off","bg-color":"#BDBDBD",chips:"","closable-chips":"","item-title":"name","item-value":"id",items:l.availableOutlets,label:"Assigned Outlets",multiple:"",spellcheck:"false",variant:"outlined"},null,8,["modelValue","items"]),t(m,{modelValue:l.state.password,"onUpdate:modelValue":e[7]||(e[7]=o=>l.state.password=o),"append-icon":l.password_show?"mdi-eye":"mdi-eye-off","bg-color":"#BDBDBD","error-messages":l.v$.password.$errors.map(o=>o.$message),label:"Password",required:"",type:l.password_show?"text":"password",onBlur:l.v$.password.$touch,"onClick:append":e[8]||(e[8]=o=>l.password_show=!l.password_show),onInput:l.v$.password.$touch},null,8,["modelValue","append-icon","error-messages","type","onBlur","onInput"])]),_:1}),p("div",re,[t(f,{color:"success",disabled:l.v$.$error,loading:l.loading,size:"small",type:"submit",variant:"elevated",onClick:l.create},{default:r(()=>[t(g,{start:""},{default:r(()=>e[28]||(e[28]=[i("mdi-plus")])),_:1}),e[29]||(e[29]=i(" Add "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:l.editDialog,"onUpdate:modelValue":e[22]||(e[22]=o=>l.editDialog=o),transition:"dialog-top-transition",width:"auto"},{default:r(()=>[t(y,{class:"rounded-xl pa-4",elevation:"10",style:{width:"600px"}},{default:r(()=>[t(b,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:r(()=>[p("div",se,[t(g,{class:"mr-2 text-white"},{default:r(()=>e[30]||(e[30]=[i("mdi-account")])),_:1}),e[31]||(e[31]=p("span",{class:"text-white font-weight-bold text-h6"},"Edit User",-1))]),t(E),t(f,{color:"white",icon:"mdi-close",onClick:e[10]||(e[10]=o=>l.editDialog=!1)})]),_:1}),t(x,{class:"pt-6"},{default:r(()=>[t(m,{modelValue:l.editingItem.id,"onUpdate:modelValue":e[11]||(e[11]=o=>l.editingItem.id=o),"bg-color":"#BDBDBD",disabled:"",label:"ID"},null,8,["modelValue"]),t(m,{modelValue:l.state.email,"onUpdate:modelValue":e[12]||(e[12]=o=>l.state.email=o),"bg-color":"#BDBDBD",density:"compact",disabled:"","error-messages":l.v$.email.$errors.map(o=>o.$message),label:"Email",required:"",onBlur:l.v$.email.$touch,onInput:l.v$.email.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),t(m,{modelValue:l.state.name,"onUpdate:modelValue":e[13]||(e[13]=o=>l.state.name=o),"bg-color":"#BDBDBD","error-messages":l.v$.name.$errors.map(o=>o.$message),label:"Full Name",required:"",onBlur:l.v$.name.$touch,onInput:l.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),t(m,{modelValue:l.state.title,"onUpdate:modelValue":e[14]||(e[14]=o=>l.state.title=o),"bg-color":"#BDBDBD",label:"Title"},null,8,["modelValue"]),t(m,{modelValue:l.state.phone,"onUpdate:modelValue":e[15]||(e[15]=o=>l.state.phone=o),"bg-color":"#BDBDBD","error-messages":l.v$.phone.$errors.map(o=>o.$message),label:"Phone Number",required:"",onBlur:l.v$.phone.$touch,onInput:l.v$.phone.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),t(h,{modelValue:l.state.role,"onUpdate:modelValue":e[16]||(e[16]=o=>l.state.role=o),autocomplete:"off",autocorrect:"off","bg-color":"#BDBDBD","error-messages":l.v$.role.$errors.map(o=>o.$message),inputmode:"none","item-title":"name","item-value":"id",items:l.roles,label:"Role",required:"",spellcheck:"false",onBlur:l.v$.role.$touch,onChange:l.v$.role.$touch},null,8,["modelValue","error-messages","items","onBlur","onChange"]),t(h,{modelValue:l.state.outlets,"onUpdate:modelValue":e[17]||(e[17]=o=>l.state.outlets=o),autocomplete:"off",autocorrect:"off","bg-color":"#BDBDBD",chips:"","closable-chips":"","item-title":"name","item-value":"id",items:l.availableOutlets,label:"Assigned Outlets",multiple:"",spellcheck:"false",variant:"outlined"},null,8,["modelValue","items"]),t(m,{modelValue:l.state.password,"onUpdate:modelValue":e[18]||(e[18]=o=>l.state.password=o),"append-icon":l.password_show?"mdi-eye":"mdi-eye-off","bg-color":"#BDBDBD",label:"Password",type:l.password_show?"text":"password","onClick:append":e[19]||(e[19]=o=>l.password_show=!l.password_show)},null,8,["modelValue","append-icon","type"])]),_:1}),p("div",ne,[t(f,{color:"success",disabled:l.v$.$error,loading:l.loading,size:"large",type:"submit",variant:"elevated",onClick:l.saveEdit},{default:r(()=>[t(g,{start:""},{default:r(()=>e[32]||(e[32]=[i("mdi-pencil")])),_:1}),e[33]||(e[33]=i(" Save "))]),_:1},8,["disabled","loading","onClick"]),t(f,{color:"black",disabled:l.v$.$error,loading:l.loading,size:"large",type:"submit",variant:"elevated",onClick:e[20]||(e[20]=o=>l.editDialog=!1)},{default:r(()=>[t(g,{start:""},{default:r(()=>e[34]||(e[34]=[i("mdi-cancel")])),_:1}),e[35]||(e[35]=i(" Cancel "))]),_:1},8,["disabled","loading"]),t(f,{color:"error",disabled:l.v$.$error,loading:l.loading,size:"large",type:"submit",variant:"elevated",onClick:e[21]||(e[21]=o=>l.confirmDeleteDialog=!0)},{default:r(()=>[t(g,{start:""},{default:r(()=>e[36]||(e[36]=[i("mdi-delete")])),_:1}),e[37]||(e[37]=i(" Delete "))]),_:1},8,["disabled","loading"])])]),_:1})]),_:1},8,["modelValue"]),t(F,{modelValue:l.confirmDeleteDialog,"onUpdate:modelValue":e[25]||(e[25]=o=>l.confirmDeleteDialog=o),persistent:"",width:"auto"},{default:r(()=>[t(y,null,{default:r(()=>[t(b,{color:"warning",title:"Confirm Deleting User: "+l.state.name},{default:r(()=>[t(f,{color:"white",icon:"mdi-close",onClick:e[23]||(e[23]=o=>l.confirmDeleteDialog=!1)})]),_:1},8,["title"]),t(x,null,{default:r(()=>[i("Confirm Delete User: "+q(l.state.name),1)]),_:1}),p("div",ie,[t(f,{color:"success",onClick:e[24]||(e[24]=o=>l.confirmDeleteDialog=!1)},{default:r(()=>e[38]||(e[38]=[i("Cancel")])),_:1}),t(f,{color:"error",onClick:l.remove},{default:r(()=>e[39]||(e[39]=[i("Proceed")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),t(b,{class:"rounded-lg mb-2 px-4",color:"primary",flat:"",height:"60"},{default:r(()=>[t(Q,{class:"text-white font-weight-bold text-h6"},{default:r(()=>[t(g,{class:"mr-2",color:"white"},{default:r(()=>e[40]||(e[40]=[i("mdi-account")])),_:1}),e[41]||(e[41]=i(" Users "))]),_:1}),t(E),t(f,{class:"text-white font-weight-medium",color:"#1A237E",size:"small",onClick:l.activateAddDialog},{default:r(()=>[t(g,{start:""},{default:r(()=>e[42]||(e[42]=[i("mdi-plus")])),_:1}),e[43]||(e[43]=i(" Add User "))]),_:1},8,["onClick"])]),_:1}),t(y,{class:"rounded-lg"},{default:r(()=>[t(x,null,{default:r(()=>[t(W,{active:l.loadingValues,indeterminate:l.loadingValues},null,8,["active","indeterminate"]),t(le,{class:"elevation-1",dense:"",headers:l.headers,height:"300",items:l.values},{"item.outlets":r(({item:o})=>[(I(!0),X(Y,null,Z(o.outlets,v=>(I(),T(oe,{key:v.id,class:"ma-1",color:"primary",size:"small",variant:"outlined"},{default:r(()=>[i(q(v.name),1)]),_:2},1024))),128))]),"item.edit":r(({item:o})=>[t(g,{color:"#3F51B5",onClick:v=>l.activateEditDialog(o)},{default:r(()=>e[44]||(e[44]=[i("mdi-square-edit-outline")])),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1})}const ye=L(te,[["render",de]]);export{ye as default};
