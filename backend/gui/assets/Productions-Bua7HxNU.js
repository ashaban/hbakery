import{a as ye,p as _e,a6 as ft,a7 as Ot,h as be,i as l,X as pt,Y as Gt,y as o,n as se,j as K,a8 as Ht,a9 as Qt,m as Oe,aa as nt,ab as vt,ac as Yt,e as L,ad as N,B as f,ae as Ge,af as Kt,ag as Te,ah as Jt,ai as Xt,aj as Wt,ak as gt,al as Zt,am as el,an as tl,ao as ll,ap as al,aq as ol,ar as nl,as as sl,at as dl,au as il,av as ge,aw as yt,ax as $e,r as C,ay as _t,F as W,az as bt,aA as rl,aB as ul,aC as cl,aD as ml,aE as fl,R as pl,_ as vl,$ as Me,l as gl,s as V,x as t,a1 as yl,v as g,a2 as h,C as n,H as G,O as X,A as T,I as i,D as Ae,Q as Pe,M as de,aF as _l,aG as bl,aH as xl,L as De,N as fe,aI as pe,a3 as st,a4 as dt,a5 as Vl,E,G as ie}from"./index-CuMV6di3.js";import{h as xt}from"./moment-C5S46NFB.js";import{V as kl}from"./VContainer-C4bV-9UQ.js";import{V as ve}from"./VAlert-DFpP9jW7.js";import{V as P,b as R,c as wl,a as it}from"./VCard-Bc391oxu.js";import{V as _}from"./VCol-CjmsdnHv.js";import{V as q,a as rt}from"./VChip-ZPEXUT-r.js";import{V as Ce}from"./VAutocomplete-D3zximuH.js";import{c as ze,m as Vt,d as ql,e as hl,V as Se,a as Be,f as Pl,b as Cl}from"./VDataTable-ChORe5xA.js";import{V as Sl}from"./VBadge-RC7q91gu.js";import{V as zl}from"./VSkeletonLoader-CC7RybwI.js";import{V as ut}from"./VDialog-CmVpAP_y.js";import{V as Il}from"./VForm-YyT9asQ3.js";import{a as Ue,b as Al,m as kt,u as Dl,V as ne}from"./VTextField-CjsJoSZp.js";import{V as Tl}from"./VTooltip-imVvsKEt.js";import{V as Ul}from"./VTextarea-Ciq86fFP.js";import"./VSlideGroup-Bd5aveAd.js";import"./dialog-transition-Cab09yLL.js";const ct=s=>s?xt(s).format("DD-MM-YYYY HH:mm"):"",mt=s=>s?xt(s,"DD-MM-YYYY HH:mm").format("YYYY-MM-DD HH:mm"):null,Ie=Symbol.for("vuetify:v-expansion-panel"),wt=_e({...Oe(),...Qt()},"VExpansionPanelText"),Ne=ye()({name:"VExpansionPanelText",props:wt(),setup(s,U){let{slots:b}=U;const m=ft(Ie);if(!m)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:D,onAfterLeave:F}=Ot(s,m.isSelected);return be(()=>l(Ht,{onAfterLeave:F},{default:()=>{var I;return[pt(o("div",{class:K(["v-expansion-panel-text",s.class]),style:se(s.style)},[b.default&&D.value&&o("div",{class:"v-expansion-panel-text__wrapper"},[(I=b.default)==null?void 0:I.call(b)])]),[[Gt,m.isSelected.value]])]}})),{}}}),qt=_e({color:String,expandIcon:{type:Te,default:"$expand"},collapseIcon:{type:Te,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...Oe(),...Kt()},"VExpansionPanelTitle"),Le=ye()({name:"VExpansionPanelTitle",directives:{vRipple:nt},props:qt(),setup(s,U){let{slots:b}=U;const m=ft(Ie);if(!m)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:D,backgroundColorStyles:F}=vt(()=>s.color),{dimensionStyles:I}=Yt(s),M=L(()=>({collapseIcon:s.collapseIcon,disabled:m.disabled.value,expanded:m.isSelected.value,expandIcon:s.expandIcon,readonly:s.readonly})),S=N(()=>m.isSelected.value?s.collapseIcon:s.expandIcon);return be(()=>{var w;return pt(o("button",{class:K(["v-expansion-panel-title",{"v-expansion-panel-title--active":m.isSelected.value,"v-expansion-panel-title--focusable":s.focusable,"v-expansion-panel-title--static":s.static},D.value,s.class]),style:se([F.value,I.value,s.style]),type:"button",tabindex:m.disabled.value?-1:void 0,disabled:m.disabled.value,"aria-expanded":m.isSelected.value,onClick:s.readonly?void 0:m.toggle},[o("span",{class:"v-expansion-panel-title__overlay"},null),(w=b.default)==null?void 0:w.call(b,M.value),!s.hideActions&&l(Ge,{defaults:{VIcon:{icon:S.value}}},{default:()=>{var B;return[o("span",{class:"v-expansion-panel-title__icon"},[((B=b.actions)==null?void 0:B.call(b,M.value))??l(f,null,null)])]}})]),[[nt,s.ripple]])}),{}}}),ht=_e({title:String,text:String,bgColor:String,...tl(),...el(),...Zt(),...gt(),...qt(),...wt()},"VExpansionPanel"),Fl=ye()({name:"VExpansionPanel",props:ht(),emits:{"group:selected":s=>!0},setup(s,U){let{slots:b}=U;const m=Jt(s,Ie),{backgroundColorClasses:D,backgroundColorStyles:F}=vt(()=>s.bgColor),{elevationClasses:I}=Xt(s),{roundedClasses:M}=Wt(s),S=N(()=>(m==null?void 0:m.disabled.value)||s.disabled),w=L(()=>m.group.items.value.reduce(($,z,H)=>(m.group.selected.value.includes(z.id)&&$.push(H),$),[])),B=L(()=>{const $=m.group.items.value.findIndex(z=>z.id===m.id);return!m.isSelected.value&&w.value.some(z=>z-$===1)}),x=L(()=>{const $=m.group.items.value.findIndex(z=>z.id===m.id);return!m.isSelected.value&&w.value.some(z=>z-$===-1)});return ll(Ie,m),be(()=>{const $=!!(b.text||s.text),z=!!(b.title||s.title),H=Le.filterProps(s),Z=Ne.filterProps(s);return l(s.tag,{class:K(["v-expansion-panel",{"v-expansion-panel--active":m.isSelected.value,"v-expansion-panel--before-active":B.value,"v-expansion-panel--after-active":x.value,"v-expansion-panel--disabled":S.value},M.value,D.value,s.class]),style:se([F.value,s.style])},{default:()=>[o("div",{class:K(["v-expansion-panel__shadow",...I.value])},null),l(Ge,{defaults:{VExpansionPanelTitle:{...H},VExpansionPanelText:{...Z}}},{default:()=>{var Q;return[z&&l(Le,{key:"title"},{default:()=>[b.title?b.title():s.title]}),$&&l(Ne,{key:"text"},{default:()=>[b.text?b.text():s.text]}),(Q=b.default)==null?void 0:Q.call(b)]}})]})}),{groupItem:m}}}),jl=["default","accordion","inset","popout"],El=_e({flat:Boolean,...il(),...dl(ht(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...sl(),...Oe(),...gt(),variant:{type:String,default:"default",validator:s=>jl.includes(s)}},"VExpansionPanels"),Rl=ye()({name:"VExpansionPanels",props:El(),emits:{"update:modelValue":s=>!0},setup(s,U){let{slots:b}=U;const{next:m,prev:D}=al(s,Ie),{themeClasses:F}=ol(s),I=N(()=>s.variant&&`v-expansion-panels--variant-${s.variant}`);return nl({VExpansionPanel:{bgColor:N(()=>s.bgColor),collapseIcon:N(()=>s.collapseIcon),color:N(()=>s.color),eager:N(()=>s.eager),elevation:N(()=>s.elevation),expandIcon:N(()=>s.expandIcon),focusable:N(()=>s.focusable),hideActions:N(()=>s.hideActions),readonly:N(()=>s.readonly),ripple:N(()=>s.ripple),rounded:N(()=>s.rounded),static:N(()=>s.static)}}),be(()=>l(s.tag,{class:K(["v-expansion-panels",{"v-expansion-panels--flat":s.flat,"v-expansion-panels--tile":s.tile},F.value,I.value,s.class]),style:se(s.style)},{default:()=>{var M;return[(M=b.default)==null?void 0:M.call(b,{prev:D,next:m})]}})),{next:m,prev:D}}}),Ml=_e({...Vt({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Bl=ye()({name:"VRadio",props:Ml(),setup(s,U){let{slots:b}=U;return be(()=>{const m=ze.filterProps(s);return l(ze,ge(m,{class:["v-radio",s.class],style:s.style,type:"radio"}),b)}),{}}}),$l=_e({height:{type:[Number,String],default:"auto"},...kt(),...rl(hl(),["multiple"]),trueIcon:{type:Te,default:"$radioOn"},falseIcon:{type:Te,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Nl=ye()({name:"VRadioGroup",inheritAttrs:!1,props:$l(),emits:{"update:modelValue":s=>!0},setup(s,U){let{attrs:b,slots:m}=U;const D=yt(),F=L(()=>s.id||`radio-group-${D}`),I=$e(s,"modelValue"),M=C();return be(()=>{const[S,w]=_t(b),B=Ue.filterProps(s),x=ze.filterProps(s),$=m.label?m.label({label:s.label,props:{for:F.value}}):s.label;return l(Ue,ge({ref:M,class:["v-radio-group",s.class],style:s.style},S,B,{modelValue:I.value,"onUpdate:modelValue":z=>I.value=z,id:F.value}),{...m,default:z=>{let{id:H,messagesId:Z,isDisabled:Q,isReadonly:j}=z;return o(W,null,[$&&l(Al,{id:H.value},{default:()=>[$]}),l(ql,ge(x,{id:H.value,"aria-describedby":Z.value,defaultsTarget:"VRadio",trueIcon:s.trueIcon,falseIcon:s.falseIcon,type:s.type,disabled:Q.value,readonly:j.value,"aria-labelledby":$?H.value:void 0,multiple:!1},w,{modelValue:I.value,"onUpdate:modelValue":ee=>I.value=ee}),m)])}})}),bt({},M)}}),Ll=_e({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...kt(),...Vt()},"VSwitch"),Ol=ye()({name:"VSwitch",inheritAttrs:!1,props:Ll(),emits:{"update:focused":s=>!0,"update:modelValue":s=>!0,"update:indeterminate":s=>!0},setup(s,U){let{attrs:b,slots:m}=U;const D=$e(s,"indeterminate"),F=$e(s,"modelValue"),{loaderClasses:I}=ul(s),{isFocused:M,focus:S,blur:w}=Dl(s),B=C(),x=C(),$=cl&&window.matchMedia("(forced-colors: active)").matches,z=N(()=>typeof s.loading=="string"&&s.loading!==""?s.loading:s.color),H=yt(),Z=N(()=>s.id||`switch-${H}`);function Q(){D.value&&(D.value=!1)}function j(ee){var le,re;ee.stopPropagation(),ee.preventDefault(),(re=(le=B.value)==null?void 0:le.input)==null||re.click()}return be(()=>{const[ee,le]=_t(b),re=Ue.filterProps(s),ue=ze.filterProps(s);return l(Ue,ge({ref:x,class:["v-switch",{"v-switch--flat":s.flat},{"v-switch--inset":s.inset},{"v-switch--indeterminate":D.value},I.value,s.class]},ee,re,{modelValue:F.value,"onUpdate:modelValue":d=>F.value=d,id:Z.value,focused:M.value,style:s.style}),{...m,default:d=>{let{id:A,messagesId:J,isDisabled:Y,isReadonly:we,isValid:xe}=d;const ce={model:F,isValid:xe};return l(ze,ge({ref:B},ue,{modelValue:F.value,"onUpdate:modelValue":[ae=>F.value=ae,Q],id:A.value,"aria-describedby":J.value,type:"checkbox","aria-checked":D.value?"mixed":void 0,disabled:Y.value,readonly:we.value,onFocus:S,onBlur:w},le),{...m,default:ae=>{let{backgroundColorClasses:qe,backgroundColorStyles:te}=ae;return o("div",{class:K(["v-switch__track",$?void 0:qe.value]),style:se(te.value),onClick:j},[m["track-true"]&&o("div",{key:"prepend",class:"v-switch__track-true"},[m["track-true"](ce)]),m["track-false"]&&o("div",{key:"append",class:"v-switch__track-false"},[m["track-false"](ce)])])},input:ae=>{let{inputNode:qe,icon:te,backgroundColorClasses:Fe,backgroundColorStyles:je}=ae;return o(W,null,[qe,o("div",{class:K(["v-switch__thumb",{"v-switch__thumb--filled":te||s.loading},s.inset||$?void 0:Fe.value]),style:se(s.inset?void 0:je.value)},[m.thumb?l(Ge,{defaults:{VIcon:{icon:te,size:"x-small"}}},{default:()=>[m.thumb({...ce,icon:te})]}):l(ml,null,{default:()=>[s.loading?l(fl,{name:"v-switch",active:!0,color:xe.value===!1?void 0:z.value},{default:he=>m.loader?m.loader(he):l(pl,{active:he.isActive,color:he.color,indeterminate:!0,size:"16",width:"2"},null)}):te&&l(f,{key:String(te),icon:te,size:"x-small"},null)]})])])}})}})}),bt({},x)}}),Gl={class:"d-flex align-center justify-space-between"},Hl={class:"d-flex align-center"},Ql={class:"text-h5 font-weight-bold text-blue"},Yl={class:"d-flex align-center"},Kl={class:"text-h5 font-weight-bold text-green"},Jl={class:"d-flex align-center"},Xl={class:"text-h5 font-weight-bold text-orange"},Wl={class:"d-flex align-center"},Zl={class:"text-h5 font-weight-bold text-purple"},ea={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},ta={class:"d-flex align-center mb-4"},la={class:"d-flex align-center mb-2"},aa={class:"d-flex align-center mb-2"},oa={class:"d-flex align-center"},na={class:"d-flex align-center mb-2"},sa={class:"d-flex align-center mb-2"},da={class:"d-flex justify-space-between align-center"},ia={class:"text-caption text-grey"},ra={class:"d-flex gap-2"},ua={class:"d-flex align-center"},ca={class:"font-weight-medium"},ma={class:"text-caption text-grey"},fa={class:"d-flex align-center"},pa={class:"font-weight-medium"},va={class:"text-no-wrap"},ga={class:"text-no-wrap"},ya={class:"d-flex align-center"},_a={class:"font-weight-medium"},ba={class:"d-flex justify-end"},xa={class:"d-flex align-center justify-space-between"},Va={class:"d-flex align-center"},ka={class:"text-white text-caption opacity-75"},wa={class:"text-center py-8"},qa={class:"d-flex justify-space-between align-center"},ha={class:"text-body-2 text-grey"},Pa={class:"d-flex align-center mb-4"},Ca={class:"position-relative w-100"},Sa={key:0,class:"datepicker-label"},za={class:"d-flex align-center mb-4"},Ia={class:"d-flex align-center mb-4"},Aa={class:"position-relative w-100"},Da={key:0,class:"datepicker-label"},Ta={class:"d-flex align-center justify-space-between mb-4"},Ua={class:"d-flex align-center"},Fa={class:"d-flex gap-2"},ja={class:"d-flex justify-space-between align-center"},Ea={class:"text-caption text-grey"},Ra={class:"d-flex align-center justify-space-between mb-4"},Ma={class:"d-flex align-center"},Ba={class:"d-flex align-center"},$a={class:"d-flex align-center"},Na={class:"d-flex align-center mb-4"},La={class:"d-flex align-center justify-space-between w-100 pr-4"},Oa={class:"d-flex align-center"},Ga={class:"d-flex align-center"},Ha={class:"mb-3"},Qa={class:"text-caption text-grey mb-2"},Ya={class:"d-flex align-center"},Ka={class:"ml-2 flex-grow-1"},Ja={class:"font-weight-medium"},Xa={key:0,class:"text-caption text-grey"},Wa={class:"mt-2"},Za={class:"d-flex justify-space-between align-center"},eo={class:"text-caption text-grey"},to={key:0},lo={class:"text-h6 font-weight-bold"},ao={class:"text-h6 font-weight-bold text-primary"},oo={class:"output-bar"},no={class:"d-flex justify-space-between mt-1 text-caption text-grey"},so={class:"text-body-1 font-weight-medium"},io={class:"d-flex align-center"},ro={class:"text-body-1 font-weight-medium"},uo={class:"d-flex align-center"},co={class:"text-body-1 font-weight-medium"},mo={class:"d-flex align-center mb-4"},fo={key:0},po={class:"d-flex align-center mb-3"},vo={class:"d-flex flex-wrap gap-2 align-center"},go={key:0,class:"text-caption text-grey mt-1"},yo={class:"pa-4 bg-grey-lighten-4"},_o={class:"text-h6 text-primary font-weight-bold"},bo={class:"text-white text-caption font-weight-bold"},xo={__name:"Productions",setup(s){const U=C(!1),b=C(!1),m=C([]),D=C(1),F=C(1),I=C(!1),M=C(!1),S=C(!0),w=C(!1),B=C(!1),x=C(null),$=C(""),z=C([]),H=C([]),Z=C([]),Q=C([]),j=C([]),ee=C(""),le=C([]),re=C([]),ue=C(!1),d=Me({planned_at:null,produced_at:null,mode:"",product_id:"",qty_product:null,actual_qty:null,good_qty:null,damaged_qty:null,reject_qty:null,base_ingredient_id:"",base_ingredient_qty:null,notes:"",staff:[],discrepancies:[],group_choices:{}}),A=Me({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),J=Me({qty_product:0}),Y=C([]);function we(){d.actual_qty=(Number(d.good_qty)||0)+(Number(d.damaged_qty)||0)+(Number(d.reject_qty)||0),Ke()}const xe=L(()=>{var v,a,u,c;const r=Number((a=(v=x.value)==null?void 0:v.production)==null?void 0:a.actual_qty)||0,e=Number((c=(u=x.value)==null?void 0:u.production)==null?void 0:c.good_qty)||0;return r?e/r*100:0}),ce=L(()=>{var v,a,u,c;const r=Number((a=(v=x.value)==null?void 0:v.production)==null?void 0:a.actual_qty)||0,e=Number((c=(u=x.value)==null?void 0:u.production)==null?void 0:c.damaged_qty)||0;return r?e/r*100:0}),ae=L(()=>{var v,a,u,c;const r=Number((a=(v=x.value)==null?void 0:v.production)==null?void 0:a.actual_qty)||0,e=Number((c=(u=x.value)==null?void 0:u.production)==null?void 0:c.reject_qty)||0;return r?e/r*100:0}),qe=[{label:"By Product",value:"by_product"},{label:"By Ingredient",value:"by_ingredient"}],te=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],Fe=[{title:"On Date",value:"="},{title:"After",value:">"},{title:"Before",value:"<"},{title:"On or After",value:">="},{title:"On or Before",value:"<="},{title:"Between",value:"in"}],je=[{title:"Product",key:"product_name",sortable:!0,width:"250px"},{title:"Quantity",key:"qty_product",sortable:!0,align:"center"},{title:"Staffs",key:"staff_count",sortable:!0,align:"center"},{title:"Mode",key:"mode",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Planned At",key:"planned_at",sortable:!0,width:"150px"},{title:"Produced At",key:"produced_at",sortable:!0,width:"150px"},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"180px"}],he=[{title:"Ingredient",key:"item_name"},{title:"Quantity Required",key:"qty_required"},{title:"Available",key:"available",align:"center"},{title:"Unit",key:"unit",align:"center"}],Pt=[{title:"Staff Member",key:"staff_id",width:"250px"},{title:"Role",key:"role",width:"240px"},{title:"Notes",key:"notes",width:"240px"},{title:"Actions",key:"actions",align:"center",sortable:!1}],Ct=r=>({pending:"bg-orange",completed:"bg-green",active:"bg-primary",cancelled:"bg-red"})[r]||"bg-primary",St=L(()=>{let r=0;return Object.keys(A).forEach(v=>{A[v]&&A[v]!=="all"&&(Array.isArray(A[v])?A[v].length>0&&r++:r++)}),r}),He=L(()=>Y.value.some(r=>r.exceeds)),Ee=L(()=>{const r=d.staff.map(e=>{var v;return(v=e.staff_id)==null?void 0:v.id}).filter(e=>!!e);return Z.value.filter(e=>!r.includes(e.id))}),Qe=L(()=>d.staff.filter(r=>r.staff_id).length),zt=L(()=>m.value.length),It=L(()=>m.value.reduce((r,e)=>r+(e.qty_product||0),0)),At=L(()=>m.value.reduce((r,e)=>parseInt(r)+parseInt(e.staff_count||0),0)),Dt=L(()=>m.value.reduce((r,e)=>r+(e.total_pay||0),0).toFixed(2)),Tt=L(()=>{const r=d.staff.some(O=>O.staff_id),e=Y.value.length>0,v=J.qty_product>0,a=d.product_id;let u=!0;B.value&&(u=d.actual_qty!==null&&d.actual_qty>=0);let c=!0;d.actual_qty&&!d.produced_at&&(c=!1);const k=j.value.every(O=>!O.is_mandatory||d.group_choices[O.id]);return a&&e&&v&&r&&u&&k&&!He.value&&d.planned_at&&c&&!b.value});async function Ye(){try{const r=await fetch("/items/availableStock");le.value=await r.json()}catch(r){console.error("Failed to load stock:",r)}}async function Ut(){const e=await(await fetch("/productions/discrepancyReasons")).json();re.value=e.data||[]}function Ke(){const r=parseFloat(J.qty_product),e=parseFloat(d.good_qty);ue.value=!!(e&&e!==r||d.good_qty==0),ue.value&&!d.discrepancies.length&&Je()}function Je(){d.discrepancies.push({reason_id:null,notes:""})}function Ft(r){d.discrepancies.splice(r,1)}function Xe(r){return r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}function We(){d.staff.push({staff_id:"",role:"",notes:""})}function jt(r){d.staff.splice(r,1)}function Et(){d.staff=[]}function Ze(){I.value=!1,ue.value=!1,Re()}function Re(){Object.assign(d,{mode:"",product_id:"",qty_product:null,good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],base_ingredient_id:"",base_ingredient_qty:null,notes:"",staff:[],group_choices:{}}),J.qty_product=0,Y.value=[],j.value=[],z.value=[]}function Rt(){Object.assign(A,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),Ve()}function Mt(){D.value=1,Ve()}async function Ve(){U.value=!0;try{const r=new URLSearchParams({page:D.value,limit:10,...A}),v=await(await fetch(`/productions?${r.toString()}`)).json();m.value=v.data||[],F.value=v.totalPages||1}catch(r){console.error("Failed to load productions:",r),m.value=[]}finally{U.value=!1}}async function Bt(){try{const e=await(await fetch("/products?limit=1000&page=1")).json();H.value=e.data||[]}catch(r){console.error("Failed to load products:",r),H.value=[]}}async function $t(){try{const e=await(await fetch("/staffs?status=Active&limit=1000&page=1")).json();Z.value=e.data||[]}catch(r){console.error("Failed to load staff:",r),Z.value=[]}}async function et(){if(Y.value=[],J.qty_product=0,ee.value="",j.value=[],z.value=[],!!d.product_id)try{const e=await(await fetch(`/products/${d.product_id}/groups`)).json();j.value=e.groups||[],Q.value=e.fixed_items||[],w.value?j.value.forEach((v,a)=>{z.value.push(a)}):j.value.forEach((v,a)=>{var c;const u=(c=v.combinations)==null?void 0:c.find(k=>k.is_default);u&&(d.group_choices[v.id]=u.id),z.value.push(a)}),w.value||me()}catch(r){console.error("Failed to load product details:",r),Q.value=[],j.value=[]}}function me(){if(!d.product_id||Q.value.length===0)return;let r=0;if(d.mode==="by_product")r=Number(d.qty_product)||0;else if(d.mode==="by_ingredient"){const v=Q.value.find(a=>a.item_id===Number(d.base_ingredient_id));ee.value=(v==null?void 0:v.unit)||"",v&&v.quantity_per_unit>0&&d.base_ingredient_qty>0&&(r=d.base_ingredient_qty/v.quantity_per_unit)}J.qty_product=r;const e=[];Q.value.forEach(v=>{var u;const a=((u=le.value.find(c=>c.item_id===v.item_id))==null?void 0:u.available_qty)||0;e.push({item_id:v.item_id,item_name:v.item_name,unit_id:v.unit_id,unit:v.unit,qty_required:+(v.quantity_per_unit*r).toFixed(3),available:+a,exceeds:v.quantity_per_unit*r>a,from_group:!1,group_name:null})}),j.value.forEach(v=>{var c;const a=d.group_choices[v.id];if(!a)return;const u=(c=v.combinations)==null?void 0:c.find(k=>k.id===a);u!=null&&u.options&&u.options.forEach(k=>{var oe;const O=((oe=le.value.find(p=>p.item_id===k.item_id))==null?void 0:oe.available_qty)||0;e.push({item_id:k.item_id,item_name:k.item_name,unit:k.unit,qty_required:+(k.quantity_per_unit*r).toFixed(3),available:+O,exceeds:k.quantity_per_unit*r>O,from_group:!0,group_name:v.name})})}),Y.value=e}function tt(){I.value=!0,w.value=!1,B.value=!1,S.value=!0,Re(),We()}async function lt(r,e){e==="actual"?B.value=!0:B.value=!1,w.value=!0,I.value=!0,S.value=!1;try{const a=await(await fetch(`/productions/${r.id}`)).json();Object.assign(d,{id:a.production.id,mode:a.production.mode,product_id:a.production.product_id,qty_product:parseFloat(a.production.qty_product),actual_qty:parseFloat(a.production.actual_qty),good_qty:parseFloat(a.production.good_qty),damaged_qty:parseFloat(a.production.damaged_qty),reject_qty:parseFloat(a.production.reject_qty),base_ingredient_id:a.production.base_ingredient_id,base_ingredient_qty:parseFloat(a.production.base_ingredient_qty),planned_at:ct(a.production.planned_at),produced_at:ct(a.production.produced_at),notes:a.production.notes,staff:a.staff.map(u=>({staff_id:{id:u.staff_id,name:u.staff_name},role:u.role||"",notes:u.notes||""}))||[],discrepancies:a.discrepancies}),await et(),d.group_choices={},a.group_choices&&a.group_choices.length>0&&a.group_choices.forEach(u=>{d.group_choices[u.group_id]=u.combination_id}),me(),a.discrepancies.length&&Ke(),J.qty_product=a.production.qty_product,Y.value=a.items.map(u=>{var k;const c=((k=le.value.find(O=>O.item_id===u.item_id))==null?void 0:k.available_qty)||0;return{item_id:u.item_id,item_name:u.item_name,unit_id:u.unit_id,unit:u.unit,qty_required:parseFloat(u.qty_required),available:+c,exceeds:parseFloat(u.qty_required)>c,from_group:!!u.group_id,group_name:u.group_name}})}catch(v){console.error("Failed to load production for editing:",v)}}async function at(){b.value=!0;try{const r=Object.entries(d.group_choices).filter(([c,k])=>k).map(([c,k])=>({group_id:parseInt(c),combination_id:k})),e={product_id:d.product_id,base_ingredient_id:d.base_ingredient_id,base_ingredient_qty:d.base_ingredient_qty,planned_at:mt(d.planned_at),produced_at:mt(d.produced_at),mode:d.mode,qty_product:J.qty_product,good_qty:d.good_qty||0,damaged_qty:d.damaged_qty||0,reject_qty:d.reject_qty||0,actual_qty:d.actual_qty||0,notes:d.notes,ingredients:Y.value.map(c=>{var k,O;return{item_id:c.item_id,qty_required:c.qty_required,group_id:c.from_group?(k=j.value.find(oe=>oe.name===c.group_name))==null?void 0:k.id:null,combination_id:c.from_group?d.group_choices[(O=j.value.find(oe=>oe.name===c.group_name))==null?void 0:O.id]:null}}),staffs:d.staff.filter(c=>c.staff_id),discrepancies:d.discrepancies.filter(c=>c.reason_id),group_choices:r},v=w.value?`/productions/${d.id}`:"/productions",a=w.value?"PUT":"POST",u=await fetch(v,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!u.ok){const c=await u.json();c.error==="INSUFFICIENT_STOCK"?alert(`${c.message}
Available: ${c.details.available}
Required: ${c.details.required}`):alert(c.message||"Failed to save production.");return}I.value=!1,Ye(),Re(),await Ve()}catch(r){console.error("Failed to save production:",r),alert("Failed to save production. Please try again.")}finally{b.value=!1}}async function Nt(r){try{const e=await fetch(`/productions/${r.id}`);x.value=await e.json(),M.value=!0}catch(e){console.error("Failed to load production details:",e)}}async function Lt(r){if(confirm("Are you sure you want to delete this production?"))try{await fetch(`/productions/${r.id}`,{method:"DELETE"}),await Ve()}catch(e){console.error("Failed to delete production:",e),alert("Failed to delete production. Please try again.")}}return gl(async()=>{await Promise.all([$t(),Bt(),Ve(),Ut(),Ye()])}),(r,e)=>{const v=yl("VueDatePicker");return g(),V(kl,{class:"production-container",fluid:""},{default:t(()=>[d.damaged_qty>0||d.reject_qty>0?(g(),V(ve,{key:0,border:"start",class:"mt-2",type:"warning",variant:"tonal"},{default:t(()=>e[24]||(e[24]=[n(" Some quantities were marked as damaged or reject â€” please ensure they're tracked in the ledger. ")])),_:1})):h("",!0),l(P,{class:"mb-6",elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-6"},{default:t(()=>[o("div",Gl,[e[27]||(e[27]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Production Management "),o("p",{class:"text-body-1 text-grey"}," Manage production batches and assign staff teams ")],-1)),l(G,{class:"px-6",color:"primary",elevation:"2",size:"large",onClick:tt},{default:t(()=>[l(f,{size:"20",start:""},{default:t(()=>e[25]||(e[25]=[n("mdi-plus-circle")])),_:1}),e[26]||(e[26]=n(" New Production "))]),_:1})])]),_:1})]),_:1}),l(X,{class:"mb-6"},{default:t(()=>[l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(P,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-4"},{default:t(()=>[o("div",Hl,[l(T,{class:"mr-3",color:"blue-lighten-5",size:"48"},{default:t(()=>[l(f,{color:"blue",size:"24"},{default:t(()=>e[28]||(e[28]=[n("mdi-factory")])),_:1})]),_:1}),o("div",null,[o("div",Ql,i(m.value.length),1),e[29]||(e[29]=o("div",{class:"text-caption text-grey"},"Total Productions",-1))])])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(P,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-4"},{default:t(()=>[o("div",Yl,[l(T,{class:"mr-3",color:"green-lighten-5",size:"48"},{default:t(()=>[l(f,{color:"green",size:"24"},{default:t(()=>e[30]||(e[30]=[n("mdi-account-group")])),_:1})]),_:1}),o("div",null,[o("div",Kl,i(At.value),1),e[31]||(e[31]=o("div",{class:"text-caption text-grey"},"Staff Assignments",-1))])])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(P,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-4"},{default:t(()=>[o("div",Jl,[l(T,{class:"mr-3",color:"orange-lighten-5",size:"48"},{default:t(()=>[l(f,{color:"orange",size:"24"},{default:t(()=>e[32]||(e[32]=[n("mdi-chart-line")])),_:1})]),_:1}),o("div",null,[o("div",Xl,i(It.value),1),e[33]||(e[33]=o("div",{class:"text-caption text-grey"},"Total Units",-1))])])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(P,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-4"},{default:t(()=>[o("div",Wl,[l(T,{class:"mr-3",color:"purple-lighten-5",size:"48"},{default:t(()=>[l(f,{color:"purple",size:"24"},{default:t(()=>e[34]||(e[34]=[n("mdi-cash-multiple")])),_:1})]),_:1}),o("div",null,[o("div",Zl," $"+i(Dt.value),1),e[35]||(e[35]=o("div",{class:"text-caption text-grey"},"Labor Cost",-1))])])]),_:1})]),_:1})]),_:1})]),_:1}),l(P,{class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-0"},{default:t(()=>[o("div",ea,[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[36]||(e[36]=[n("mdi-table")])),_:1}),e[37]||(e[37]=o("h3",{class:"text-h6 font-weight-medium"},"Production Records",-1))]),l(P,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",ta,[l(T,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(f,{color:"primary"},{default:t(()=>e[38]||(e[38]=[n("mdi-filter")])),_:1})]),_:1}),e[39]||(e[39]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Production Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your production records ")],-1)),l(Ae),l(q,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[n(i(St.value)+" Active ",1)]),_:1})]),l(Pe,{class:"mb-6"}),l(X,{class:"align-start",dense:""},{default:t(()=>[l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(P,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(R,{class:"pa-3"},{default:t(()=>[o("div",la,[l(f,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[40]||(e[40]=[n("mdi-package-variant")])),_:1}),e[41]||(e[41]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(Ce,{modelValue:A.product_id,"onUpdate:modelValue":e[0]||(e[0]=a=>A.product_id=a),autocomplete:"off",autocorrect:"off",clearable:"",color:"primary",density:"compact","hide-details":"",inputmode:"none","item-title":"name","item-value":"id",items:H.value,placeholder:"All Products",spellcheck:"false",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(P,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(R,{class:"pa-3"},{default:t(()=>[o("div",aa,[l(f,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[42]||(e[42]=[n("mdi-progress-clock")])),_:1}),e[43]||(e[43]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(Se,{modelValue:A.status,"onUpdate:modelValue":e[1]||(e[1]=a=>A.status=a),color:"primary",density:"compact","hide-details":"",items:te,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:u})=>[l(de,_l(bl(u)),{prepend:t(()=>[l(f,{color:a.raw.color||"grey"},{default:t(()=>[n(i(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",oa,[l(f,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[n(i(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,i(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(P,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(R,{class:"pa-3"},{default:t(()=>[o("div",na,[l(f,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[44]||(e[44]=[n("mdi-account-tie")])),_:1}),e[45]||(e[45]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(Ce,{modelValue:A.team_leader,"onUpdate:modelValue":e[2]||(e[2]=a=>A.team_leader=a),autocomplete:"off",autocorrect:"off",clearable:"",color:"primary",density:"compact","hide-details":"",inputmode:"none","item-title":"name","item-value":"id",items:Z.value,placeholder:"All Leaders",spellcheck:"false",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(P,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(R,{class:"pa-3"},{default:t(()=>[o("div",sa,[l(f,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[46]||(e[46]=[n("mdi-calendar-clock")])),_:1}),e[47]||(e[47]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(X,{class:"align-center",dense:""},{default:t(()=>[l(_,{cols:"12",sm:"4"},{default:t(()=>[l(Se,{modelValue:A.planned_at_op,"onUpdate:modelValue":e[3]||(e[3]=a=>A.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:Fe,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",sm:"4"},{default:t(()=>[l(v,{modelValue:A.planned_at,"onUpdate:modelValue":e[4]||(e[4]=a=>A.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),A.planned_at_op==="in"?(g(),V(_,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(v,{modelValue:A.planned_end,"onUpdate:modelValue":e[5]||(e[5]=a=>A.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):h("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(Pe,{class:"mt-4 mb-4"}),o("div",da,[o("div",ia,[l(f,{class:"mr-1",size:"14"},{default:t(()=>e[48]||(e[48]=[n("mdi-information")])),_:1}),e[49]||(e[49]=n(" Use filters to find specific production records "))]),o("div",ra,[l(G,{class:"px-4",color:"grey",size:"small",variant:"outlined",onClick:Rt},{default:t(()=>[l(f,{size:"18",start:""},{default:t(()=>e[50]||(e[50]=[n("mdi-refresh")])),_:1}),e[51]||(e[51]=n(" Reset All "))]),_:1}),l(G,{class:"px-4",color:"primary",elevation:"2",size:"small",onClick:Mt},{default:t(()=>[l(f,{size:"18",start:""},{default:t(()=>e[52]||(e[52]=[n("mdi-filter-check")])),_:1}),e[53]||(e[53]=n(" Apply Filters "))]),_:1})])])]),_:1}),l(xl,{active:U.value,color:"primary",height:"4",indeterminate:U.value},null,8,["active","indeterminate"]),l(Be,{class:"elevation-0",density:"comfortable",headers:je,hover:"",items:m.value,loading:U.value,search:$.value},{loading:t(()=>[l(zl,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(q,{class:"font-weight-bold text-uppercase",color:a.produced_at?"green":"red",size:"small",variant:"flat"},{default:t(()=>[n(i(a.produced_at?"Completed":"Pending"),1)]),_:2},1032,["color"])]),"item.product_name":t(({item:a})=>[o("div",ua,[l(T,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(f,{color:"primary",size:"16"},{default:t(()=>e[54]||(e[54]=[n("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",ca,i(a.product_name),1),o("div",ma,i(a.mode),1)])])]),"item.qty_product":t(({item:a})=>[l(q,{color:"green",size:"small",variant:"flat"},{default:t(()=>[l(f,{size:"16",start:""},{default:t(()=>e[55]||(e[55]=[n("mdi-counter")])),_:1}),n(" "+i(parseFloat(a.qty_product)),1)]),_:2},1024)]),"item.staff_count":t(({item:a})=>[o("div",fa,[l(T,{class:"mr-2",color:"blue-lighten-5",size:"28"},{default:t(()=>[l(f,{color:"blue",size:"14"},{default:t(()=>e[56]||(e[56]=[n("mdi-account-group")])),_:1})]),_:1}),o("span",pa,i(a.staff_count||0),1)])]),"item.planned_at":t(({item:a})=>[o("div",va,i(a.planned_at),1)]),"item.produced_at":t(({item:a})=>[o("div",ga,i(a.produced_at),1)]),"item.produced_by_name":t(({item:a})=>[o("div",ya,[l(T,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(f,{color:"blue-grey",size:"14"},{default:t(()=>e[57]||(e[57]=[n("mdi-account")])),_:1})]),_:1}),o("span",_a,i(a.produced_by_name),1)])]),"item.actions":t(({item:a})=>[o("div",ba,[l(Pl,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:u})=>[l(G,ge(u,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[a.produced_at?(g(),V(f,{key:1},{default:t(()=>e[59]||(e[59]=[n("mdi-dots-vertical")])),_:1})):(g(),V(Sl,{key:0,color:"orange",dot:"",location:"top end","offset-x":"2","offset-y":"2"},{default:t(()=>[l(f,null,{default:t(()=>e[58]||(e[58]=[n("mdi-dots-vertical")])),_:1})]),_:1}))]),_:2},1040)]),default:t(()=>[l(P,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(R,{class:K(["pa-4",Ct(a.produced_at?"completed":"pending")])},{default:t(()=>[o("div",xa,[o("div",Va,[l(T,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(f,{color:"primary",size:"18"},{default:t(()=>e[60]||(e[60]=[n("mdi-factory")])),_:1})]),_:1}),o("div",null,[e[61]||(e[61]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Production Actions ",-1)),o("div",ka,i(a.product_name),1)])]),l(q,{color:"white",size:"small",variant:"flat"},{default:t(()=>[n(i(a.produced_at?"completed":"pending"),1)]),_:2},1024)])]),_:2},1032,["class"]),l(De,{class:"pa-2",density:"compact"},{default:t(()=>[l(de,{class:"rounded-lg mb-1 action-item",onClick:u=>Nt(a)},{prepend:t(()=>[l(T,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(f,{color:"blue",size:"18"},{default:t(()=>e[62]||(e[62]=[n("mdi-eye-outline")])),_:1})]),_:1})]),default:t(()=>[l(fe,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[63]||(e[63]=[n(" View Details ")])),_:1}),l(pe,{class:"text-caption text-blue"},{default:t(()=>e[64]||(e[64]=[n(" Complete information ")])),_:1})]),_:2},1032,["onClick"]),l(de,{class:"rounded-lg mb-1 action-item",disabled:a.produced_at,onClick:u=>lt(a,"actual")},{prepend:t(()=>[l(T,{class:"mr-3",color:"green-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(f,{color:"green",size:"18"},{default:t(()=>e[65]||(e[65]=[n("mdi-plus-circle")])),_:1})]),_:1})]),default:t(()=>[l(fe,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[66]||(e[66]=[n(" Add Actual Production ")])),_:1}),l(pe,{class:"text-caption text-green"},{default:t(()=>e[67]||(e[67]=[n(" Record actual output ")])),_:1})]),_:2},1032,["disabled","onClick"]),l(de,{class:"rounded-lg mb-1 action-item",onClick:u=>lt(a)},{prepend:t(()=>[l(T,{class:"mr-3",color:"orange-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(f,{color:"orange",size:"18"},{default:t(()=>e[68]||(e[68]=[n("mdi-pencil-outline")])),_:1})]),_:1})]),default:t(()=>[l(fe,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[69]||(e[69]=[n(" Edit Production ")])),_:1}),l(pe,{class:"text-caption text-orange"},{default:t(()=>e[70]||(e[70]=[n(" Modify details ")])),_:1})]),_:2},1032,["onClick"]),l(Pe,{class:"my-2"}),l(de,{class:"rounded-lg action-item text-error",onClick:u=>Lt(a)},{prepend:t(()=>[l(T,{class:"mr-3",color:"red-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(f,{color:"red",size:"18"},{default:t(()=>e[71]||(e[71]=[n("mdi-delete-outline")])),_:1})]),_:1})]),default:t(()=>[l(fe,{class:"text-body-2 font-weight-medium text-error"},{default:t(()=>e[72]||(e[72]=[n(" Delete Production ")])),_:1}),l(pe,{class:"text-caption text-red"},{default:t(()=>e[73]||(e[73]=[n(" Remove permanently ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",wa,[l(f,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[74]||(e[74]=[n("mdi-inbox")])),_:1}),e[77]||(e[77]=o("div",{class:"text-h6 text-grey"},"No productions found",-1)),e[78]||(e[78]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production record ",-1)),l(G,{class:"mt-4",color:"primary",onClick:tt},{default:t(()=>[l(f,{start:""},{default:t(()=>e[75]||(e[75]=[n("mdi-plus")])),_:1}),e[76]||(e[76]=n(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1}),l(P,{elevation:"2",rounded:"lg"},{default:t(()=>[l(R,{class:"pa-4"},{default:t(()=>[o("div",qa,[o("div",ha," Showing "+i(m.value.length)+" of "+i(zt.value)+" records ",1),l(Cl,{modelValue:D.value,"onUpdate:modelValue":[e[6]||(e[6]=a=>D.value=a),Ve],color:"primary",length:F.value,"total-visible":7},null,8,["modelValue","length"])])]),_:1})]),_:1}),l(ut,{modelValue:I.value,"onUpdate:modelValue":e[21]||(e[21]=a=>I.value=a),"max-width":"1200",persistent:"",scrollable:""},{default:t(()=>[l(P,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(st,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(T,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(f,{color:"primary",icon:w.value?"mdi-pencil":"mdi-plus"},null,8,["icon"])]),_:1}),l(dt,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>[n(i(B.value?"Add Actual Quantity":w.value?"Edit Production":"Create New Production"),1)]),_:1}),l(Ae),l(G,{color:"white",icon:"mdi-close",variant:"text",onClick:Ze})]),_:1}),l(R,{class:"pa-6"},{default:t(()=>[l(Il,{onSubmit:Vl(at,["prevent"])},{default:t(()=>[l(P,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Pa,[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[79]||(e[79]=[n("mdi-information")])),_:1}),e[80]||(e[80]=o("h4",{class:"text-h6 font-weight-medium"},"Basic Information",-1))]),l(X,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>[o("div",Ca,[d.planned_at?(g(),E("span",Sa,"Planned Production Date & Time")):h("",!0),l(v,{modelValue:d.planned_at,"onUpdate:modelValue":e[7]||(e[7]=a=>d.planned_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100",disabled:w.value&&!S.value,"enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Planned Production Date & Time",teleport:!0},null,8,["modelValue","disabled"])])]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(Se,{modelValue:d.mode,"onUpdate:modelValue":e[8]||(e[8]=a=>d.mode=a),color:"primary",disabled:w.value,"item-title":"label","item-value":"value",items:qe,label:"Production Mode","prepend-inner-icon":"mdi-cog",required:"",variant:"outlined"},null,8,["modelValue","disabled"])]),_:1}),l(_,{cols:"12",md:"5"},{default:t(()=>[l(Ce,{modelValue:d.product_id,"onUpdate:modelValue":[e[9]||(e[9]=a=>d.product_id=a),et],autocomplete:"off",autocorrect:"off",color:"primary",disabled:w.value,inputmode:"none","item-title":"name","item-value":"id",items:H.value,label:"Select Product","prepend-inner-icon":"mdi-package-variant",required:"",spellcheck:"false",variant:"outlined"},null,8,["modelValue","disabled","items"])]),_:1})]),_:1})]),_:1}),l(P,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",za,[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[81]||(e[81]=[n("mdi-scale")])),_:1}),e[82]||(e[82]=o("h4",{class:"text-h6 font-weight-medium"}," Quantity Configuration ",-1))]),d.mode==="by_product"?(g(),V(X,{key:0,dense:""},{default:t(()=>[l(_,{cols:"12",md:"6"},{default:t(()=>[l(ne,{modelValue:d.qty_product,"onUpdate:modelValue":e[10]||(e[10]=a=>d.qty_product=a),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"primary",disabled:w.value&&!S.value,inputmode:"none",label:"Quantity of Product","prepend-inner-icon":"mdi-numeric",required:"",spellcheck:"false",type:"number",variant:"outlined",onInput:me},null,8,["modelValue","disabled"])]),_:1}),l(_,{cols:"12",md:"6"},{default:t(()=>[l(ve,{class:"mt-2",type:"info",variant:"tonal"},{default:t(()=>e[83]||(e[83]=[n(" Enter the total number of product units to produce ")])),_:1})]),_:1})]),_:1})):d.mode==="by_ingredient"?(g(),V(X,{key:1,dense:""},{default:t(()=>[l(_,{cols:"12",md:"6"},{default:t(()=>[l(Ce,{modelValue:d.base_ingredient_id,"onUpdate:modelValue":[e[11]||(e[11]=a=>d.base_ingredient_id=a),me],autocomplete:"off",autocorrect:"off",color:"primary",disabled:!Q.value.length||w.value&&!S.value,inputmode:"none","item-title":"item_name","item-value":"item_id",items:Q.value,label:"Base Ingredient","prepend-inner-icon":"mdi-ingredient",spellcheck:"false",variant:"outlined"},null,8,["modelValue","disabled","items"])]),_:1}),l(_,{cols:"12",md:"6"},{default:t(()=>[l(ne,{modelValue:d.base_ingredient_qty,"onUpdate:modelValue":e[12]||(e[12]=a=>d.base_ingredient_qty=a),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"primary",disabled:!d.base_ingredient_id||w.value&&!S.value,inputmode:"none",label:`Ingredient Quantity (${ee.value||"units"})`,"prepend-inner-icon":"mdi-weight",required:"",spellcheck:"false",type:"number",variant:"outlined",onInput:me},null,8,["modelValue","disabled","label"])]),_:1})]),_:1})):h("",!0)]),_:1}),w.value?(g(),V(P,{key:0,class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Ia,[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[84]||(e[84]=[n("mdi-scale-balance")])),_:1}),e[85]||(e[85]=o("h4",{class:"text-h6 font-weight-medium"}," Actual Output & Discrepancies ",-1))]),l(X,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>[l(ne,{modelValue:d.good_qty,"onUpdate:modelValue":e[13]||(e[13]=a=>d.good_qty=a),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"green",inputmode:"none",label:"Good Quantity","prepend-inner-icon":"mdi-check-decagram",spellcheck:"false",type:"number",variant:"outlined",onInput:we},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>[l(ne,{modelValue:d.damaged_qty,"onUpdate:modelValue":e[14]||(e[14]=a=>d.damaged_qty=a),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"orange",inputmode:"none",label:"Damaged Quantity","prepend-inner-icon":"mdi-alert-circle-outline",spellcheck:"false",type:"number",variant:"outlined",onInput:we},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>[l(ne,{modelValue:d.reject_qty,"onUpdate:modelValue":e[15]||(e[15]=a=>d.reject_qty=a),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"red",inputmode:"none",label:"Reject Quantity","prepend-inner-icon":"mdi-close-octagon-outline",spellcheck:"false",type:"number",variant:"outlined",onInput:we},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",md:"6"},{default:t(()=>[l(ne,{modelValue:d.actual_qty,"onUpdate:modelValue":e[16]||(e[16]=a=>d.actual_qty=a),modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",color:"primary",disabled:!B.value&&w.value&&!S.value,inputmode:"none",label:"Total Actual Quantity Produced","prepend-inner-icon":"mdi-counter",readonly:"",required:"",spellcheck:"false",type:"number",variant:"outlined"},null,8,["modelValue","disabled"])]),_:1}),l(_,{cols:"6",md:"6"},{default:t(()=>[o("div",Aa,[d.produced_at?(g(),E("span",Da,"Actual Production Date & Time")):h("",!0),l(v,{modelValue:d.produced_at,"onUpdate:modelValue":e[17]||(e[17]=a=>d.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100",disabled:!B.value&&w.value&&!S.value,"enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue","disabled"])])]),_:1}),ue.value?(g(),V(_,{key:0,cols:"12",md:"6"},{default:t(()=>[l(ve,{border:"start",class:"mt-2",type:"warning",variant:"tonal"},{default:t(()=>[n(" Discrepancy detected (Planned: "+i(parseFloat(J.qty_product))+" | Good Quantity: "+i(d.good_qty)+") ",1)]),_:1})]),_:1})):h("",!0)]),_:1}),ue.value?(g(),E(W,{key:0},[l(Pe,{class:"my-4"}),(g(!0),E(W,null,ie(d.discrepancies,(a,u)=>(g(),V(X,{key:u,class:"align-center mb-3"},{default:t(()=>[l(_,{cols:"12",md:"5"},{default:t(()=>[l(Se,{modelValue:a.reason_id,"onUpdate:modelValue":c=>a.reason_id=c,color:"primary","hide-details":"","item-title":"name","item-value":"id",items:re.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(_,{cols:"12",md:"5"},{default:t(()=>[l(ne,{modelValue:a.notes,"onUpdate:modelValue":c=>a.notes=c,autocomplete:"off",autocorrect:"off",color:"primary","hide-details":"",inputmode:"none",label:"Notes",spellcheck:"false",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(_,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(G,{color:"error",icon:"",variant:"text",onClick:c=>Ft(u)},{default:t(()=>[l(f,null,{default:t(()=>e[86]||(e[86]=[n("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(G,{color:"primary",size:"small",variant:"outlined",onClick:Je},{default:t(()=>[l(f,{start:""},{default:t(()=>e[87]||(e[87]=[n("mdi-plus")])),_:1}),e[88]||(e[88]=n(" Add Reason "))]),_:1})],64)):h("",!0)]),_:1})):h("",!0),l(P,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Ta,[o("div",Ua,[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[89]||(e[89]=[n("mdi-account-group")])),_:1}),e[90]||(e[90]=o("h4",{class:"text-h6 font-weight-medium"},"Staff Assignment",-1))]),o("div",Fa,[l(G,{color:"primary",disabled:!Ee.value.length,size:"small",variant:"outlined",onClick:We},{default:t(()=>[l(f,{start:""},{default:t(()=>e[91]||(e[91]=[n("mdi-account-plus")])),_:1}),e[92]||(e[92]=n(" Add Staff "))]),_:1},8,["disabled"]),l(G,{color:"secondary",disabled:!d.staff.length,size:"small",variant:"outlined",onClick:Et},{default:t(()=>[l(f,{start:""},{default:t(()=>e[93]||(e[93]=[n("mdi-account-remove")])),_:1}),e[94]||(e[94]=n(" Clear All "))]),_:1},8,["disabled"])])]),l(Be,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Pt,items:d.staff},{"item.staff_id":t(({item:a,index:u})=>[l(Ce,{modelValue:a.staff_id,"onUpdate:modelValue":c=>a.staff_id=c,autocomplete:"off",autocorrect:"off",density:"compact",disabled:!S.value,"hide-details":"",inputmode:"none","item-title":"name","item-value":"id",items:Ee.value,placeholder:"Select Staff","return-object":"",spellcheck:"false",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),"item.role":t(({item:a})=>[l(Se,{modelValue:a.role,"onUpdate:modelValue":u=>a.role=u,clearable:"",color:"primary",density:"compact",disabled:!S.value,"hide-details":"",items:["Team Leader","Assistant","Support"],"prepend-inner-icon":"mdi-account-tie",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":t(({item:a})=>[l(ne,{modelValue:a.notes,"onUpdate:modelValue":u=>a.notes=u,autocomplete:"off",autocorrect:"off",density:"compact",disabled:!S.value,"hide-details":"",inputmode:"none",spellcheck:"false",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.actions":t(({item:a,index:u})=>[l(G,{color:"error",disabled:!S.value,icon:"",size:"small",variant:"text",onClick:c=>jt(u)},{default:t(()=>[l(f,null,{default:t(()=>e[95]||(e[95]=[n("mdi-delete")])),_:1})]),_:2},1032,["disabled","onClick"])]),"no-data":t(()=>e[96]||(e[96]=[o("div",{class:"text-center py-4 text-grey"},' No staff assigned. Click "Add Staff" to assign team members. ',-1)])),_:1},8,["items"]),d.staff.length?(g(),V(ve,{key:0,border:"start",class:"mt-4",type:"info",variant:"tonal"},{default:t(()=>[o("div",ja,[o("div",null,[e[97]||(e[97]=o("strong",null,"Team Summary:",-1)),l(q,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[n(i(d.staff.length)+" staff members ",1)]),_:1})]),o("div",Ea,i(Qe.value)+" of "+i(Ee.value.length+Qe.value)+" staff assigned ",1)])]),_:1})):h("",!0)]),_:1}),l(P,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Ra,[o("div",Ma,[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[98]||(e[98]=[n("mdi-ingredient")])),_:1}),e[99]||(e[99]=o("h4",{class:"text-h6 font-weight-medium"}," Ingredients Required ",-1))]),l(Ol,{modelValue:S.value,"onUpdate:modelValue":e[18]||(e[18]=a=>S.value=a),color:"primary","hide-details":"",inset:"",label:S.value?"Editing Enabled":"Editing Disabled"},null,8,["modelValue","label"])]),He.value?(g(),V(ve,{key:0,border:"start",class:"mb-3",type:"error",variant:"tonal"},{default:t(()=>e[100]||(e[100]=[n(" Some ingredients exceed available stock. Please adjust quantities before saving. ")])),_:1})):h("",!0),l(Be,{class:"elevation-1 rounded-lg",density:"comfortable",headers:he,items:Y.value},{"item.item_name":t(({item:a})=>[o("div",Ba,[a.from_group?(g(),V(f,{key:0,class:"mr-2",color:"purple",size:"16"},{default:t(()=>e[101]||(e[101]=[n("mdi-cog")])),_:1})):h("",!0),o("span",null,i(a.item_name),1),a.group_name?(g(),V(q,{key:1,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[n(i(a.group_name),1)]),_:2},1024)):h("",!0)])]),"item.qty_required":t(({item:a})=>[o("div",$a,[l(ne,{modelValue:a.qty_required,"onUpdate:modelValue":u=>a.qty_required=u,modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",density:"compact",error:a.exceeds,"error-messages":a.exceeds?["Exceeds available stock"]:[],"hide-details":"",inputmode:"none",spellcheck:"false",style:{"max-width":"140px"},type:"number",variant:"outlined",onInput:u=>a.exceeds=a.qty_required>a.available},{"append-inner":t(()=>[o("span",{class:K(["text-caption",a.exceeds?"text-error":"text-grey"])},i(a.unit),3)]),_:2},1032,["modelValue","onUpdate:modelValue","error","error-messages","onInput"]),a.exceeds?(g(),V(Tl,{key:0,location:"top",text:"Maximum available: "+a.available+" "+a.unit},{activator:t(({props:u})=>[l(G,ge(u,{class:"ml-1",color:"orange",icon:"",size:"x-small",variant:"text",onClick:c=>{a.qty_required=a.available,a.exceeds=!1}}),{default:t(()=>[l(f,{size:"16"},{default:t(()=>e[102]||(e[102]=[n("mdi-information-outline")])),_:1})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):h("",!0)])]),"item.available":t(({item:a})=>[l(q,{class:"font-weight-medium",color:a.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[n(i(a.available)+" "+i(a.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:a})=>[l(q,{color:"blue-grey",size:"small",variant:"outlined"},{default:t(()=>[n(i(a.unit),1)]),_:2},1024)]),"no-data":t(()=>e[103]||(e[103]=[o("div",{class:"text-center py-4 text-grey"}," Select a product and configure quantities to view ingredients ",-1)])),_:1},8,["items"]),j.value.length>0?(g(),V(P,{key:1,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(R,{class:"pa-4"},{default:t(()=>[o("div",Na,[l(f,{class:"mr-2",color:"purple"},{default:t(()=>e[104]||(e[104]=[n("mdi-cog")])),_:1}),e[105]||(e[105]=o("h5",{class:"text-h6 font-weight-medium"}," Ingredient Groups ",-1)),l(q,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[n(i(j.value.length)+" groups ",1)]),_:1})]),l(ve,{class:"mb-4",type:"info",variant:"tonal"},{default:t(()=>e[106]||(e[106]=[n(" Select combinations for each ingredient group. Ingredients will update automatically. ")])),_:1}),l(Rl,{modelValue:z.value,"onUpdate:modelValue":e[19]||(e[19]=a=>z.value=a),multiple:""},{default:t(()=>[(g(!0),E(W,null,ie(j.value,(a,u)=>(g(),V(Fl,{key:a.id,class:"mb-2"},{default:t(()=>[l(Le,{class:"font-weight-medium"},{default:t(()=>[o("div",La,[o("div",Oa,[l(f,{class:"mr-2",color:"purple"},{default:t(()=>e[107]||(e[107]=[n("mdi-cog")])),_:1}),o("span",null,i(a.name),1),a.is_mandatory?(g(),V(q,{key:0,class:"ml-2",color:"red",size:"x-small",variant:"flat"},{default:t(()=>e[108]||(e[108]=[n(" Required ")])),_:1})):(g(),V(q,{key:1,class:"ml-2",color:"grey",size:"x-small",variant:"outlined"},{default:t(()=>e[109]||(e[109]=[n(" Optional ")])),_:1}))]),o("div",Ga,[l(q,{class:"mr-2",color:"blue",size:"x-small",variant:"outlined"},{default:t(()=>[n(i(a.selection_mode),1)]),_:2},1024),d.group_choices[a.id]?(g(),V(q,{key:0,color:"green",size:"x-small",variant:"flat"},{default:t(()=>e[110]||(e[110]=[n(" Selected ")])),_:1})):(g(),V(q,{key:1,color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>e[111]||(e[111]=[n(" Not Selected ")])),_:1}))])])]),_:2},1024),l(Ne,null,{default:t(()=>[o("div",Ha,[o("p",Qa,i(a.description),1),l(Nl,{modelValue:d.group_choices[a.id],"onUpdate:modelValue":[c=>d.group_choices[a.id]=c,me],"hide-details":""},{default:t(()=>[l(X,null,{default:t(()=>[(g(!0),E(W,null,ie(a.combinations,c=>(g(),V(_,{key:c.id,cols:"12",md:"6"},{default:t(()=>[l(P,{class:K(["combination-card",{selected:d.group_choices[a.id]===c.id}]),variant:"outlined",onClick:k=>{d.group_choices[a.id]=c.id,me()}},{default:t(()=>[l(R,{class:"pa-3"},{default:t(()=>[o("div",Ya,[l(Bl,{"hide-details":"",value:c.id},null,8,["value"]),o("div",Ka,[o("div",Ja,i(c.name),1),c.notes?(g(),E("div",Xa,i(c.notes),1)):h("",!0),o("div",Wa,[(g(!0),E(W,null,ie(c.options,k=>(g(),V(q,{key:k.option_id,class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[n(i(k.item_name)+": "+i(k.quantity_per_unit)+" "+i(k.unit),1)]),_:2},1024))),128))])]),c.is_default?(g(),V(q,{key:0,color:"orange",size:"x-small",variant:"flat"},{default:t(()=>e[112]||(e[112]=[n(" Default ")])),_:1})):h("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):h("",!0),Y.value.length?(g(),V(ve,{key:2,border:"start",class:"mt-4",type:"success",variant:"tonal"},{default:t(()=>[o("div",Za,[o("div",null,[e[113]||(e[113]=o("strong",null,"Total Product Units:",-1)),l(q,{class:"ml-2",color:"success",size:"small",variant:"flat"},{default:t(()=>[o("b",null,i(parseFloat(J.qty_product)||0),1)]),_:1})]),o("div",eo,[n(i(Y.value.length)+" ingredients required ",1),j.value.length>0?(g(),E("span",to," â€¢ "+i(Object.keys(d.group_choices).filter(a=>d.group_choices[a]).length)+"/"+i(j.value.length)+" groups selected ",1)):h("",!0)])])]),_:1})):h("",!0)]),_:1}),l(Ul,{modelValue:d.notes,"onUpdate:modelValue":e[20]||(e[20]=a=>d.notes=a),color:"primary",disabled:!S.value&&w.value,label:"Additional Notes","prepend-inner-icon":"mdi-note-text",rows:"3",variant:"outlined"},null,8,["modelValue","disabled"])]),_:1})]),_:1}),l(wl,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(Ae),l(G,{class:"px-6",color:"grey",variant:"outlined",onClick:Ze},{default:t(()=>e[114]||(e[114]=[n(" Cancel ")])),_:1}),l(G,{class:"px-6",color:"success",disabled:!Tt.value,elevation:"2",loading:b.value,onClick:at},{default:t(()=>[l(f,{start:""},{default:t(()=>e[115]||(e[115]=[n("mdi-content-save-check")])),_:1}),n(" "+i(w.value?"Update Production":"Create Production"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ut,{modelValue:M.value,"onUpdate:modelValue":e[23]||(e[23]=a=>M.value=a),"max-width":"900",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(P,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(st,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(T,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(f,{color:"primary"},{default:t(()=>e[116]||(e[116]=[n("mdi-eye")])),_:1})]),_:1}),l(dt,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>e[117]||(e[117]=[n(" Production Details ")])),_:1}),l(Ae),l(G,{color:"white",icon:"mdi-close",variant:"text",onClick:e[22]||(e[22]=a=>M.value=!1)})]),_:1}),l(R,{class:"pa-6"},{default:t(()=>{var a,u,c,k,O,oe;return[l(P,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[l(X,null,{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>{var p,y;return[e[118]||(e[118]=o("div",{class:"text-body-2 text-grey"},"Production ID",-1)),o("div",lo," #"+i((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.id),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var p,y;return[e[119]||(e[119]=o("div",{class:"text-body-2 text-grey"},"Product",-1)),o("div",ao,i((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.product_name),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var p,y;return[e[120]||(e[120]=o("div",{class:"text-body-2 text-grey"},"Planning Mode",-1)),l(q,{color:((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.mode)==="by_product"?"blue":"orange",variant:"flat"},{default:t(()=>{var ke,ot;return[n(i((ot=(ke=x.value)==null?void 0:ke.production)==null?void 0:ot.mode),1)]}),_:1},8,["color"])]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>[e[122]||(e[122]=o("div",{class:"text-body-2 text-grey"},"Planned Units",-1)),l(q,{color:"blue",size:"large",variant:"flat"},{default:t(()=>{var p,y;return[l(f,{start:""},{default:t(()=>e[121]||(e[121]=[n("mdi-counter")])),_:1}),n(" "+i(parseFloat((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.qty_product)),1)]}),_:1})]),_:1}),l(_,{cols:"12",md:"6"},{default:t(()=>[e[123]||(e[123]=o("div",{class:"text-body-2 text-grey mb-2"}," Actual Output Breakdown ",-1)),l(rt,{class:"d-flex flex-wrap gap-2 mb-3",column:""},{default:t(()=>[l(q,{class:"font-weight-medium",color:"green","prepend-icon":"mdi-check-decagram",size:"small",variant:"flat"},{default:t(()=>{var p,y;return[n(" Good: "+i(parseFloat((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.good_qty)||0),1)]}),_:1}),l(q,{class:"font-weight-medium",color:"orange","prepend-icon":"mdi-alert-circle-outline",size:"small",variant:"flat"},{default:t(()=>{var p,y;return[n(" Damaged: "+i(parseFloat((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.damaged_qty)||0),1)]}),_:1}),l(q,{class:"font-weight-medium",color:"red","prepend-icon":"mdi-close-octagon-outline",size:"small",variant:"flat"},{default:t(()=>{var p,y;return[n(" Reject: "+i(parseFloat((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.reject_qty)||0),1)]}),_:1}),l(q,{class:"font-weight-bold",color:"blue","prepend-icon":"mdi-counter",size:"small",variant:"flat"},{default:t(()=>{var p,y;return[n(" Total: "+i(parseFloat((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.actual_qty)||0),1)]}),_:1})]),_:1}),e[124]||(e[124]=o("div",{class:"mb-2 text-caption text-grey"}," Quality Distribution ",-1)),o("div",oo,[xe.value>0?(g(),E("div",{key:0,class:"bar-segment good",style:se({width:xe.value+"%"})},null,4)):h("",!0),ce.value>0?(g(),E("div",{key:1,class:"bar-segment damaged",style:se({width:ce.value+"%"})},null,4)):h("",!0),ae.value>0?(g(),E("div",{key:2,class:"bar-segment reject",style:se({width:ae.value+"%"})},null,4)):h("",!0)]),o("div",no,[o("div",null,"Good: "+i(xe.value.toFixed(1))+"%",1),o("div",null,"Damaged: "+i(ce.value.toFixed(1))+"%",1),o("div",null,"Reject: "+i(ae.value.toFixed(1))+"%",1)])]),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>[e[126]||(e[126]=o("div",{class:"text-body-2 text-grey"},"Team Size",-1)),l(q,{color:"purple",variant:"flat"},{default:t(()=>{var p,y;return[l(f,{start:""},{default:t(()=>e[125]||(e[125]=[n("mdi-account-group")])),_:1}),n(" "+i(((y=(p=x.value)==null?void 0:p.staff)==null?void 0:y.length)||0)+" members ",1)]}),_:1})]),_:1}),l(_,{cols:"4",md:"4"},{default:t(()=>{var p,y;return[e[127]||(e[127]=o("div",{class:"text-body-2 text-grey"},"Planned By",-1)),o("div",so,i((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.produced_by_name),1)]}),_:1}),l(_,{cols:"4",md:"4"},{default:t(()=>{var p,y;return[o("div",io,[l(T,{class:"mr-3",color:"orange-lighten-5",size:"40"},{default:t(()=>[l(f,{color:"orange"},{default:t(()=>e[128]||(e[128]=[n("mdi-calendar-clock")])),_:1})]),_:1}),o("div",null,[e[129]||(e[129]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",ro,i(Xe((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.planned_at)),1)])])]}),_:1}),l(_,{cols:"4",md:"4"},{default:t(()=>{var p,y;return[o("div",uo,[l(T,{class:"mr-3",color:"green-lighten-5",size:"40"},{default:t(()=>[l(f,{color:"green"},{default:t(()=>e[130]||(e[130]=[n("mdi-calendar-check")])),_:1})]),_:1}),o("div",null,[e[131]||(e[131]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",co,i(Xe((y=(p=x.value)==null?void 0:p.production)==null?void 0:y.produced_at)),1)])])]}),_:1})]),_:1})]),_:1}),(u=(a=x.value)==null?void 0:a.group_choices)!=null&&u.length?(g(),V(P,{key:0,class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",mo,[l(f,{class:"mr-2",color:"purple"},{default:t(()=>e[132]||(e[132]=[n("mdi-cog")])),_:1}),e[133]||(e[133]=o("h4",{class:"text-h6 font-weight-medium"}," Ingredient Group Choices ",-1))]),l(De,{lines:"two"},{default:t(()=>[(g(!0),E(W,null,ie(x.value.group_choices,p=>(g(),V(de,{key:p.id},{prepend:t(()=>[l(T,{class:"mr-3",color:"purple-lighten-5",size:"40"},{default:t(()=>[l(f,{color:"purple"},{default:t(()=>e[134]||(e[134]=[n("mdi-cog")])),_:1})]),_:1})]),default:t(()=>[l(fe,{class:"font-weight-medium"},{default:t(()=>[n(i(p.group_name),1)]),_:2},1024),l(pe,null,{default:t(()=>[n(" Selected: "+i(p.combination_name)+" ",1),p.chosen_by_name?(g(),E("span",fo,"â€¢ Chosen by: "+i(p.chosen_by_name),1)):h("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):h("",!0),(k=(c=x.value)==null?void 0:c.discrepancies)!=null&&k.length?(g(),V(P,{key:1,class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",po,[l(f,{class:"mr-2",color:"red"},{default:t(()=>e[135]||(e[135]=[n("mdi-alert-circle")])),_:1}),e[136]||(e[136]=o("h5",{class:"text-h6 font-weight-medium text-red"}," Discrepancy Details ",-1))]),e[137]||(e[137]=o("div",{class:"mb-3 text-body-2 text-grey"}," The actual produced quantity differs from the planned quantity. Below are the reported reasons: ",-1)),l(rt,{class:"d-flex flex-wrap gap-2",column:"",multiple:""},{default:t(()=>[(g(!0),E(W,null,ie(x.value.discrepancies,(p,y)=>(g(),V(q,{key:y,color:"red-lighten-2","prepend-icon":"mdi-alert",variant:"outlined"},{default:t(()=>[n(i(p.name)+" - "+i(p.notes),1)]),_:2},1024))),128))]),_:1})]),_:1})):h("",!0),(oe=(O=x.value)==null?void 0:O.staff)!=null&&oe.length?(g(),V(P,{key:2,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(it,{class:"d-flex align-center"},{default:t(()=>[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[138]||(e[138]=[n("mdi-account-group")])),_:1}),e[139]||(e[139]=n(" Assigned Staff Team "))]),_:1}),l(R,{class:"pa-0"},{default:t(()=>[l(De,{class:"pa-0",lines:"two"},{default:t(()=>[(g(!0),E(W,null,ie(x.value.staff,(p,y)=>(g(),V(de,{key:y,class:K(["px-4",{"bg-grey-lighten-4":y%2===0}])},{prepend:t(()=>[l(T,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(f,{color:"white",size:"20"},{default:t(()=>e[140]||(e[140]=[n("mdi-account")])),_:1})]),_:1})]),append:t(()=>[l(q,{color:"success",size:"small",variant:"flat"},{default:t(()=>e[141]||(e[141]=[n(" Active ")])),_:1})]),default:t(()=>[l(fe,{class:"font-weight-medium"},{default:t(()=>[n(i(p.name),1)]),_:2},1024),l(pe,{class:"mt-1"},{default:t(()=>[o("div",vo,[p.role?(g(),V(q,{key:0,color:"blue",size:"small",variant:"outlined"},{default:t(()=>[n(i(p.role),1)]),_:2},1024)):h("",!0)]),p.notes?(g(),E("div",go,i(p.notes),1)):h("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),l(Pe),o("div",yo,[l(X,{dense:""},{default:t(()=>[l(_,{class:"text-center",cols:"12",md:"4"},{default:t(()=>[o("div",_o,i(x.value.staff.length),1),e[142]||(e[142]=o("div",{class:"text-caption text-grey"},"Team Members",-1))]),_:1})]),_:1})])]),_:1})]),_:1})):h("",!0),l(P,{class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(it,{class:"d-flex align-center"},{default:t(()=>[l(f,{class:"mr-2",color:"primary"},{default:t(()=>e[143]||(e[143]=[n("mdi-ingredient")])),_:1}),e[144]||(e[144]=n(" Ingredients Used "))]),_:1}),l(R,{class:"pa-0"},{default:t(()=>[l(De,{class:"pa-0",lines:"two"},{default:t(()=>{var p;return[(g(!0),E(W,null,ie(((p=x.value)==null?void 0:p.items)||[],(y,ke)=>(g(),V(de,{key:ke,class:K(["px-4",{"bg-grey-lighten-4":ke%2===0}])},{prepend:t(()=>[l(T,{class:"mr-3",color:"primary",size:"36"},{default:t(()=>[o("span",bo,i(ke+1),1)]),_:2},1024)]),default:t(()=>[l(fe,{class:"font-weight-medium"},{default:t(()=>[n(i(y.item_name)+" ",1),y.group_name?(g(),V(q,{key:0,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[n(i(y.group_name),1)]),_:2},1024)):h("",!0)]),_:2},1024),l(pe,{class:"mt-1"},{default:t(()=>[l(q,{class:"mr-2",color:"primary",size:"small",variant:"outlined"},{default:t(()=>[n(i(y.qty_required)+" "+i(y.unit||""),1)]),_:2},1024),e[145]||(e[145]=o("span",{class:"text-grey"},"Required",-1))]),_:2},1024)]),_:2},1032,["class"]))),128))]}),_:1})]),_:1})]),_:1})]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Mo=vl(xo,[["__scopeId","data-v-aa0373b4"]]);export{Mo as default};
