import{a as mt,p as ft,a7 as Le,a8 as pt,r as x,a9 as vt,aa as Ne,ab as yt,h as gt,ac as _t,i as l,ad as ge,y as o,n as Oe,j as oe,ae as bt,af as xt,B as n,ag as Vt,R as wt,F as ae,ah as kt,_ as qt,a0 as ze,e as j,l as Pt,s as k,x as t,a2 as zt,v as g,H as h,C as d,O as F,A as q,I as r,D as ve,S,Q as ne,M as B,ai as Ce,aj as Se,a3 as A,ak as Ct,L as Ae,N as ee,al as te,am as St,a4 as He,a5 as Ye,a6 as At,E as N,G as ye,an as ht}from"./index-LhBGGbDo.js";import{h as Ze,V as Dt}from"./VSkeletonLoader-CYQ7bdS0.js";import{V as Ut}from"./VContainer-Dk9Sho_f.js";import{V as _,b as C,c as Ft,a as Qe}from"./VCard-CePcGudf.js";import{V as c}from"./VCol-DIVHEWFP.js";import{V as re}from"./VAutocomplete-BKA6hC-W.js";import{c as Ge,m as Mt,V as Q,a as he,d as It,b as Tt}from"./VDataTable-PuSy_Rf-.js";import{V as Ke}from"./VDialog-DPRaUwy_.js";import{V as Rt}from"./VForm-BJyWH2Dg.js";import{u as jt,a as Je,m as Bt,V as le}from"./VTextField-DdRmxMh_.js";import{V as ue}from"./VAlert-QcJFPJEB.js";import{V as $t,a as Et}from"./VTooltip-BnjPLEeO.js";import"./dialog-transition-Ci0HdeXs.js";const We=y=>y?Ze(y).format("DD-MM-YYYY HH:mm"):"",Xe=y=>y?Ze(y,"DD-MM-YYYY HH:mm").format("YYYY-MM-DD HH:mm"):null,Lt=ft({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...Bt(),...Mt()},"VSwitch"),Nt=mt()({name:"VSwitch",inheritAttrs:!1,props:Lt(),emits:{"update:focused":y=>!0,"update:modelValue":y=>!0,"update:indeterminate":y=>!0},setup(y,O){let{attrs:G,slots:V}=O;const T=Le(y,"indeterminate"),$=Le(y,"modelValue"),{loaderClasses:E}=pt(y),{isFocused:K,focus:z,blur:P}=jt(y),M=x(),w=x(),ce=vt&&window.matchMedia("(forced-colors: active)").matches,J=Ne(()=>typeof y.loading=="string"&&y.loading!==""?y.loading:y.color),W=yt(),R=Ne(()=>y.id||`switch-${W}`);function de(){T.value&&(T.value=!1)}function me(H){var I,i;H.stopPropagation(),H.preventDefault(),(i=(I=M.value)==null?void 0:I.input)==null||i.click()}return gt(()=>{const[H,I]=_t(G),i=Je.filterProps(y),p=Ge.filterProps(y);return l(Je,ge({ref:w,class:["v-switch",{"v-switch--flat":y.flat},{"v-switch--inset":y.inset},{"v-switch--indeterminate":T.value},E.value,y.class]},H,i,{modelValue:$.value,"onUpdate:modelValue":b=>$.value=b,id:R.value,focused:K.value,style:y.style}),{...V,default:b=>{let{id:_e,messagesId:be,isDisabled:xe,isReadonly:Ve,isValid:fe}=b;const ie={model:$,isValid:fe};return l(Ge,ge({ref:M},p,{modelValue:$.value,"onUpdate:modelValue":[L=>$.value=L,de],id:_e.value,"aria-describedby":be.value,type:"checkbox","aria-checked":T.value?"mixed":void 0,disabled:xe.value,readonly:Ve.value,onFocus:z,onBlur:P},I),{...V,default:L=>{let{backgroundColorClasses:Y,backgroundColorStyles:U}=L;return o("div",{class:oe(["v-switch__track",ce?void 0:Y.value]),style:Oe(U.value),onClick:me},[V["track-true"]&&o("div",{key:"prepend",class:"v-switch__track-true"},[V["track-true"](ie)]),V["track-false"]&&o("div",{key:"append",class:"v-switch__track-false"},[V["track-false"](ie)])])},input:L=>{let{inputNode:Y,icon:U,backgroundColorClasses:we,backgroundColorStyles:ke}=L;return o(ae,null,[Y,o("div",{class:oe(["v-switch__thumb",{"v-switch__thumb--filled":U||y.loading},y.inset||ce?void 0:we.value]),style:Oe(y.inset?void 0:ke.value)},[V.thumb?l(bt,{defaults:{VIcon:{icon:U,size:"x-small"}}},{default:()=>[V.thumb({...ie,icon:U})]}):l(xt,null,{default:()=>[y.loading?l(Vt,{name:"v-switch",active:!0,color:fe.value===!1?void 0:J.value},{default:se=>V.loader?V.loader(se):l(wt,{active:se.isActive,color:se.color,indeterminate:!0,size:"16",width:"2"},null)}):U&&l(n,{key:String(U),icon:U,size:"x-small"},null)]})])])}})}})}),kt({},w)}}),Ot={class:"d-flex align-center justify-space-between"},Ht={class:"d-flex align-center"},Yt={class:"text-h5 font-weight-bold text-blue"},Qt={class:"d-flex align-center"},Gt={class:"text-h5 font-weight-bold text-green"},Kt={class:"d-flex align-center"},Jt={class:"text-h5 font-weight-bold text-orange"},Wt={class:"d-flex align-center"},Xt={class:"text-h5 font-weight-bold text-purple"},Zt={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},el={class:"d-flex align-center mb-4"},tl={class:"d-flex align-center mb-2"},ll={class:"d-flex align-center mb-2"},al={class:"d-flex align-center"},ol={class:"d-flex align-center mb-2"},dl={class:"d-flex align-center mb-2"},il={class:"d-flex align-center mb-2"},sl={class:"d-flex align-center mb-2"},nl={class:"d-flex justify-space-between align-center"},rl={class:"text-caption text-grey"},ul={class:"d-flex gap-2"},cl={class:"d-flex align-center"},ml={class:"font-weight-medium"},fl={class:"text-caption text-grey"},pl={class:"d-flex align-center"},vl={class:"font-weight-medium"},yl={class:"text-no-wrap"},gl={class:"text-no-wrap"},_l={class:"d-flex align-center"},bl={class:"font-weight-medium"},xl={class:"d-flex justify-end"},Vl={class:"d-flex align-center justify-space-between"},wl={class:"d-flex align-center"},kl={class:"text-white text-caption opacity-75"},ql={class:"text-center py-8"},Pl={class:"d-flex justify-space-between align-center"},zl={class:"text-body-2 text-grey"},Cl={class:"d-flex align-center mb-4"},Sl={class:"position-relative w-100"},Al={key:0,class:"datepicker-label"},hl={class:"d-flex align-center mb-4"},Dl={class:"d-flex align-center mb-4"},Ul={class:"position-relative w-100"},Fl={key:0,class:"datepicker-label"},Ml={class:"d-flex align-center justify-space-between mb-4"},Il={class:"d-flex align-center"},Tl={class:"d-flex gap-2"},Rl={class:"d-flex justify-space-between align-center"},jl={class:"text-caption text-grey"},Bl={class:"d-flex align-center justify-space-between mb-4"},$l={class:"d-flex align-center"},El={class:"d-flex align-center"},Ll={class:"d-flex justify-space-between align-center"},Nl={class:"text-caption text-grey"},Ol={class:"text-h6 font-weight-bold"},Hl={class:"text-h6 font-weight-bold text-primary"},Yl={class:"text-body-1 font-weight-medium"},Ql={class:"d-flex align-center"},Gl={class:"text-body-1 font-weight-medium"},Kl={class:"d-flex align-center"},Jl={class:"text-body-1 font-weight-medium"},Wl={class:"d-flex align-center mb-3"},Xl={class:"d-flex flex-wrap gap-2 align-center"},Zl={key:0,class:"text-caption text-grey mt-1"},ea={class:"pa-4 bg-grey-lighten-4"},ta={class:"text-h6 text-primary font-weight-bold"},la={class:"text-white text-caption font-weight-bold"},aa={__name:"Productions",setup(y){const O=x(!1),G=x(!1),V=x([]),T=x(1),$=x(1),E=x(!1),K=x(!1),z=x(!0),P=x(!1),M=x(!1),w=x(null),ce=x(""),J=x([]),W=x([]),R=x([]),de=x(""),me=x([]),H=x([]),I=x(!1),i=ze({planned_at:null,produced_at:null,mode:"",product_id:"",qty_product:null,actual_qty:null,base_ingredient_id:"",base_ingredient_qty:null,notes:"",staff:[],discrepancies:[]}),p=ze({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),b=ze({qty_product:0,ingredients:[]}),_e=[{label:"By Product",value:"by_product"},{label:"By Ingredient",value:"by_ingredient"}],be=[{title:"Product",key:"product_name",sortable:!0,width:"250px"},{title:"Quantity",key:"qty_product",sortable:!0,align:"center"},{title:"Staffs",key:"staff_count",sortable:!0,align:"center"},{title:"Mode",key:"mode",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Planned At",key:"planned_at",sortable:!0,width:"150px"},{title:"Produced At",key:"produced_at",sortable:!0,width:"150px"},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"180px"}],xe=[{title:"Ingredient",key:"item_name"},{title:"Quantity Required",key:"qty_required"},{title:"Available",key:"available",align:"center"}],Ve=[{title:"Staff Member",key:"staff_id",width:"250px"},{title:"Role",key:"role",width:"240px"},{title:"Notes",key:"notes",width:"240px"},{title:"Actions",key:"actions",align:"center",sortable:!1}],fe=s=>({pending:"bg-orange",completed:"bg-green",active:"bg-primary",cancelled:"bg-red"})[s]||"bg-primary",ie=j(()=>{let s=0;return Object.keys(p).forEach(v=>{p[v]&&p[v]!=="all"&&(Array.isArray(p[v])?p[v].length>0&&s++:s++)}),s}),L=j(()=>b.ingredients.some(s=>s.exceeds)),Y=j(()=>{const s=i.staff.map(e=>{var v;return(v=e.staff_id)==null?void 0:v.id}).filter(e=>!!e);return W.value.filter(e=>!s.includes(e.id))}),U=j(()=>i.staff.filter(s=>s.staff_id).length),we=j(()=>V.value.length),ke=j(()=>V.value.reduce((s,e)=>s+(e.qty_product||0),0)),se=j(()=>V.value.reduce((s,e)=>parseInt(s)+parseInt(e.staff_count||0),0)),et=j(()=>V.value.reduce((s,e)=>s+(e.total_pay||0),0).toFixed(2)),tt=j(()=>{const s=i.staff.some(pe=>pe.staff_id),e=b.ingredients.length>0,v=b.qty_product>0,a=i.product_id;let u=!0;M.value&&(u=i.actual_qty!==null&&i.actual_qty>=0);let D=!0;return i.actual_qty&&!i.produced_at&&(D=!1),a&&e&&v&&s&&u&&!L.value&&i.planned_at&&D&&!G.value});async function De(){try{const s=await fetch("/items/availableStock");me.value=await s.json()}catch(s){console.error("Failed to load stock:",s)}}async function lt(){const e=await(await fetch("/productions/discrepancyReasons")).json();H.value=e.data||[]}function Ue(){console.log(parseFloat(i.actual_qty));const s=parseFloat(b.qty_product),e=parseFloat(i.actual_qty);I.value=!!(e&&e!==s),I.value&&!i.discrepancies.length&&Fe()}function Fe(){i.discrepancies.push({reason_id:null,notes:""})}function at(s){i.discrepancies.splice(s,1)}function Me(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}function Ie(){i.staff.push({staff_id:"",role:"",notes:""})}function ot(s){i.staff.splice(s,1)}function dt(){i.staff=[]}function Te(){E.value=!1,I.value=!1,qe()}function qe(){Object.assign(i,{mode:"",product_id:"",qty_product:null,actual_qty:null,discrepancies:[],base_ingredient_id:"",base_ingredient_qty:null,notes:"",staff:[]}),b.qty_product=0,b.ingredients=[]}function it(){Object.assign(p,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),X()}function st(){T.value=1,X()}async function X(){O.value=!0;try{const s=new URLSearchParams({page:T.value,limit:10,...p}),v=await(await fetch(`/productions?${s.toString()}`)).json();V.value=v.data||[],$.value=v.totalPages||1}catch(s){console.error("Failed to load productions:",s),V.value=[]}finally{O.value=!1}}async function nt(){try{const e=await(await fetch("/products?limit=1000&page=1")).json();J.value=e.data||[]}catch(s){console.error("Failed to load products:",s),J.value=[]}}async function rt(){try{const e=await(await fetch("/staffs?status=Active&limit=1000&page=1")).json();W.value=e.data||[]}catch(s){console.error("Failed to load staff:",s),W.value=[]}}async function Re(){if(b.ingredients=[],b.qty_product=0,de.value="",!!i.product_id)try{const v=(await(await fetch(`/products/${i.product_id}`)).json()).items||[];R.value=v.map(a=>({item_id:a.item_id,item_name:a.item_name||a.name,quantity_per_unit:Number(a.quantity_per_unit),unit_id:a.unit_id,unit:a.unit||a.unit_short}))}catch(s){console.error("Failed to load product details:",s),R.value=[]}}function Pe(){if(!i.product_id||R.value.length===0)return;let s=0;if(i.mode==="by_product")s=Number(i.qty_product)||0;else if(i.mode==="by_ingredient"){const e=R.value.find(v=>v.item_id===Number(i.base_ingredient_id));de.value=(e==null?void 0:e.unit)||"",e&&e.quantity_per_unit>0&&i.base_ingredient_qty>0&&(s=i.base_ingredient_qty/e.quantity_per_unit)}b.qty_product=s,b.ingredients=R.value.map(e=>{var a;const v=((a=me.value.find(u=>u.item_id===e.item_id))==null?void 0:a.available_qty)||0;return{item_id:e.item_id,item_name:e.item_name,unit_id:e.unit_id,unit:e.unit,qty_required:+(e.quantity_per_unit*s).toFixed(3),available:+v,exceeds:e.quantity_per_unit*s>v}})}function je(){E.value=!0,P.value=!1,M.value=!1,z.value=!0,qe(),Ie()}async function Be(s,e){e==="actual"?M.value=!0:M.value=!1,P.value=!0,E.value=!0,z.value=!1;try{const a=await(await fetch(`/productions/${s.id}`)).json();Object.assign(i,{id:a.production.id,mode:a.production.mode,product_id:a.production.product_id,qty_product:parseFloat(a.production.qty_product),actual_qty:parseFloat(a.production.actual_qty),base_ingredient_id:a.production.base_ingredient_id,base_ingredient_qty:parseFloat(a.production.base_ingredient_qty),planned_at:We(a.production.planned_at),produced_at:We(a.production.produced_at),notes:a.production.notes,staff:a.staff.map(u=>({staff_id:{id:u.id,name:u.name},role:u.role||"",notes:u.notes||""}))||[],discrepancies:a.discrepancies}),a.discrepancies.length&&Ue(),Re(),b.qty_product=a.production.qty_product,b.ingredients=a.items.map(u=>({item_id:u.item_id,item_name:u.item_name,unit_id:u.unit_id,unit:u.unit,qty_required:parseFloat(u.qty_required)}))}catch(v){console.error("Failed to load production for editing:",v)}}async function $e(){G.value=!0;try{const s={product_id:i.product_id,base_ingredient_id:i.base_ingredient_id,base_ingredient_qty:i.base_ingredient_qty,planned_at:Xe(i.planned_at),produced_at:Xe(i.produced_at),mode:i.mode,qty_product:b.qty_product,actual_qty:i.actual_qty,notes:i.notes,ingredients:b.ingredients,staffs:i.staff.filter(u=>u.staff_id),discrepancies:i.discrepancies.filter(u=>u.reason_id)},e=P.value?`/productions/${i.id}`:"/productions",v=P.value?"PUT":"POST",a=await fetch(e,{method:v,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const u=await a.json();u.error==="INSUFFICIENT_STOCK"?alert(`${u.message}
Available: ${u.details.available}
Required: ${u.details.required}`):alert(u.message||"Failed to save production.");return}E.value=!1,De(),qe(),await X()}catch(s){console.error("Failed to save production:",s),alert("Failed to save production. Please try again.")}finally{G.value=!1}}async function ut(s){try{const e=await fetch(`/productions/${s.id}`);w.value=await e.json(),K.value=!0}catch(e){console.error("Failed to load production details:",e)}}async function ct(s){if(confirm("Are you sure you want to delete this production?"))try{await fetch(`/productions/${s.id}`,{method:"DELETE"}),await X()}catch(e){console.error("Failed to delete production:",e),alert("Failed to delete production. Please try again.")}}return Pt(async()=>{await Promise.all([rt(),nt(),X(),lt(),De()])}),(s,e)=>{const v=zt("VueDatePicker");return g(),k(Ut,{fluid:"",class:"production-container"},{default:t(()=>[l(_,{class:"mb-6",elevation:"2",rounded:"lg"},{default:t(()=>[l(C,{class:"pa-6"},{default:t(()=>[o("div",Ot,[e[26]||(e[26]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Production Management "),o("p",{class:"text-body-1 text-grey"}," Manage production batches and assign staff teams ")],-1)),l(h,{color:"primary",size:"large",onClick:je,class:"px-6",elevation:"2"},{default:t(()=>[l(n,{start:"",size:"20"},{default:t(()=>e[24]||(e[24]=[d("mdi-plus-circle")])),_:1}),e[25]||(e[25]=d(" New Production "))]),_:1})])]),_:1})]),_:1}),l(F,{class:"mb-6"},{default:t(()=>[l(c,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(_,{class:"stat-card",elevation:"2",rounded:"lg",border:""},{default:t(()=>[l(C,{class:"pa-4"},{default:t(()=>[o("div",Ht,[l(q,{color:"blue-lighten-5",size:"48",class:"mr-3"},{default:t(()=>[l(n,{color:"blue",size:"24"},{default:t(()=>e[27]||(e[27]=[d("mdi-factory")])),_:1})]),_:1}),o("div",null,[o("div",Yt,r(V.value.length),1),e[28]||(e[28]=o("div",{class:"text-caption text-grey"},"Total Productions",-1))])])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(_,{class:"stat-card",elevation:"2",rounded:"lg",border:""},{default:t(()=>[l(C,{class:"pa-4"},{default:t(()=>[o("div",Qt,[l(q,{color:"green-lighten-5",size:"48",class:"mr-3"},{default:t(()=>[l(n,{color:"green",size:"24"},{default:t(()=>e[29]||(e[29]=[d("mdi-account-group")])),_:1})]),_:1}),o("div",null,[o("div",Gt,r(se.value),1),e[30]||(e[30]=o("div",{class:"text-caption text-grey"},"Staff Assignments",-1))])])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(_,{class:"stat-card",elevation:"2",rounded:"lg",border:""},{default:t(()=>[l(C,{class:"pa-4"},{default:t(()=>[o("div",Kt,[l(q,{color:"orange-lighten-5",size:"48",class:"mr-3"},{default:t(()=>[l(n,{color:"orange",size:"24"},{default:t(()=>e[31]||(e[31]=[d("mdi-chart-line")])),_:1})]),_:1}),o("div",null,[o("div",Jt,r(ke.value),1),e[32]||(e[32]=o("div",{class:"text-caption text-grey"},"Total Units",-1))])])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(_,{class:"stat-card",elevation:"2",rounded:"lg",border:""},{default:t(()=>[l(C,{class:"pa-4"},{default:t(()=>[o("div",Wt,[l(q,{color:"purple-lighten-5",size:"48",class:"mr-3"},{default:t(()=>[l(n,{color:"purple",size:"24"},{default:t(()=>e[33]||(e[33]=[d("mdi-cash-multiple")])),_:1})]),_:1}),o("div",null,[o("div",Xt," $"+r(et.value),1),e[34]||(e[34]=o("div",{class:"text-caption text-grey"},"Labor Cost",-1))])])]),_:1})]),_:1})]),_:1})]),_:1}),l(_,{elevation:"2",rounded:"lg",class:"mb-4"},{default:t(()=>[l(C,{class:"pa-0"},{default:t(()=>[o("div",Zt,[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[35]||(e[35]=[d("mdi-table")])),_:1}),e[36]||(e[36]=o("h3",{class:"text-h6 font-weight-medium"},"Production Records",-1))]),l(_,{class:"pa-6 mb-6",elevation:"3",rounded:"lg",border:""},{default:t(()=>[o("div",el,[l(q,{size:"40",color:"primary",variant:"tonal",class:"mr-3"},{default:t(()=>[l(n,{color:"primary"},{default:t(()=>e[37]||(e[37]=[d("mdi-filter")])),_:1})]),_:1}),e[38]||(e[38]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"},"Production Filters"),o("p",{class:"text-caption text-grey mt-1"},"Refine your production records")],-1)),l(ve),l(S,{size:"small",color:"primary",variant:"flat",class:"mr-2"},{default:t(()=>[d(r(ie.value)+" Active ",1)]),_:1})]),l(ne,{class:"mb-6"}),l(F,{dense:"",class:"align-start"},{default:t(()=>[l(c,{cols:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg h-100",border:""},{default:t(()=>[l(C,{class:"pa-3"},{default:t(()=>[o("div",tl,[l(n,{color:"primary",size:"18",class:"mr-2"},{default:t(()=>e[39]||(e[39]=[d("mdi-package-variant")])),_:1}),e[40]||(e[40]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(re,{modelValue:p.product_id,"onUpdate:modelValue":e[0]||(e[0]=a=>p.product_id=a),items:J.value,"item-title":"name","item-value":"id",placeholder:"All Products",clearable:"",variant:"underlined",density:"compact","hide-details":"",color:"primary"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg h-100",border:""},{default:t(()=>[l(C,{class:"pa-3"},{default:t(()=>[o("div",ll,[l(n,{color:"blue",size:"18",class:"mr-2"},{default:t(()=>e[41]||(e[41]=[d("mdi-progress-clock")])),_:1}),e[42]||(e[42]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(Q,{modelValue:p.status,"onUpdate:modelValue":e[1]||(e[1]=a=>p.status=a),items:[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],placeholder:"Select Status",variant:"underlined",density:"compact","hide-details":"",color:"primary"},{item:t(({item:a,props:u})=>[l(B,Ce(Se(u)),{prepend:t(()=>[l(n,{color:a.raw.color||"grey"},{default:t(()=>[d(r(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",al,[l(n,{color:a.raw.color||"grey",size:"16",class:"mr-2"},{default:t(()=>[d(r(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,r(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg h-100",border:""},{default:t(()=>[l(C,{class:"pa-3"},{default:t(()=>[o("div",ol,[l(n,{color:"purple",size:"18",class:"mr-2"},{default:t(()=>e[43]||(e[43]=[d("mdi-account-tie")])),_:1}),e[44]||(e[44]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(re,{modelValue:p.team_leader,"onUpdate:modelValue":e[2]||(e[2]=a=>p.team_leader=a),items:W.value,"item-title":"name","item-value":"id",placeholder:"All Leaders",clearable:"",variant:"underlined",density:"compact","hide-details":"",color:"primary"},{item:t(({props:a,item:u})=>[l(B,Ce(Se(a)),{prepend:t(()=>[l(q,{size:"28",color:"blue-grey-lighten-5",class:"mr-3"},{default:t(()=>[l(n,{size:"14",color:"blue-grey"},{default:t(()=>e[45]||(e[45]=[d("mdi-account")])),_:1})]),_:1})]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",sm:"6",md:"4",lg:"3"},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg h-100",border:""},{default:t(()=>[l(C,{class:"pa-3"},{default:t(()=>[o("div",dl,[l(n,{color:"red",size:"18",class:"mr-2"},{default:t(()=>e[46]||(e[46]=[d("mdi-alert-circle")])),_:1}),e[47]||(e[47]=o("label",{class:"text-caption font-weight-medium text-primary"},"Discrepancy Reasons",-1))]),l(Q,{modelValue:p.discrepancy_reason,"onUpdate:modelValue":e[3]||(e[3]=a=>p.discrepancy_reason=a),items:[{title:"Machine Failure",icon:"mdi-robot-off",color:"red"},{title:"Ingredient Shortage",icon:"mdi-sack",color:"orange"},{title:"Power Outage",icon:"mdi-power-plug-off",color:"amber"},{title:"Human Error",icon:"mdi-account-alert",color:"blue"}],placeholder:"Select Reasons",multiple:"",clearable:"",variant:"underlined",density:"compact","hide-details":"",color:"primary"},{item:t(({item:a,props:u})=>[l(B,Ce(Se(u)),{prepend:t(()=>[l(n,{color:a.raw.color,size:"16"},{default:t(()=>[d(r(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[l(S,{size:"small",color:a.raw.color,variant:"tonal",class:"mr-1 mb-1"},{default:t(()=>[l(n,{start:"",size:"14"},{default:t(()=>[d(r(a.raw.icon),1)]),_:2},1024),d(" "+r(a.title),1)]),_:2},1032,["color"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",md:"8",lg:"6"},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg",border:""},{default:t(()=>[l(C,{class:"pa-3"},{default:t(()=>[o("div",il,[l(n,{color:"green",size:"18",class:"mr-2"},{default:t(()=>e[48]||(e[48]=[d("mdi-calendar-clock")])),_:1}),e[49]||(e[49]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(F,{dense:"",class:"align-center"},{default:t(()=>[l(c,{cols:"12",sm:"4"},{default:t(()=>[l(Q,{modelValue:p.planned_at_op,"onUpdate:modelValue":e[4]||(e[4]=a=>p.planned_at_op=a),items:[{title:"On Date",value:"="},{title:"After",value:">"},{title:"Before",value:"<"},{title:"On or After",value:">="},{title:"On or Before",value:"<="},{title:"Between",value:"in"}],variant:"underlined",density:"compact","hide-details":"",color:"primary"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",sm:"4"},{default:t(()=>[l(v,{"auto-apply":"",teleport:!0,modelValue:p.planned_at,"onUpdate:modelValue":e[5]||(e[5]=a=>p.planned_at=a),format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date"},null,8,["modelValue"])]),_:1}),p.planned_at_op==="in"?(g(),k(c,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(v,{modelValue:p.planned_end,"onUpdate:modelValue":e[6]||(e[6]=a=>p.planned_end=a),"auto-apply":"",teleport:!0,format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date"},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),l(c,{cols:"12",md:"8",lg:"6"},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg",border:""},{default:t(()=>[l(C,{class:"pa-3"},{default:t(()=>[o("div",sl,[l(n,{color:"orange",size:"18",class:"mr-2"},{default:t(()=>e[50]||(e[50]=[d("mdi-calendar-check")])),_:1}),e[51]||(e[51]=o("label",{class:"text-caption font-weight-medium text-primary"},"Produced Date Range",-1))]),l(F,{dense:"",class:"align-center"},{default:t(()=>[l(c,{cols:"12",sm:"4"},{default:t(()=>[l(Q,{modelValue:p.produced_at_op,"onUpdate:modelValue":e[7]||(e[7]=a=>p.produced_at_op=a),items:[{title:"On Date",value:"="},{title:"After",value:">"},{title:"Before",value:"<"},{title:"On or After",value:">="},{title:"On or Before",value:"<="},{title:"Between",value:"in"}],variant:"underlined",density:"compact","hide-details":"",color:"primary"},null,8,["modelValue"])]),_:1}),l(c,{cols:"12",sm:"4"},{default:t(()=>[l(v,{modelValue:p.produced_at,"onUpdate:modelValue":e[8]||(e[8]=a=>p.produced_at=a),placeholder:"Start Date","auto-apply":"",teleport:!0,format:"dd-MM-yyyy","model-type":"format"},null,8,["modelValue"])]),_:1}),p.produced_at_op==="in"?(g(),k(c,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(v,{modelValue:p.produced_end,"onUpdate:modelValue":e[9]||(e[9]=a=>p.produced_end=a),placeholder:"End Date","auto-apply":"",teleport:!0,format:"dd-MM-yyyy","model-type":"format"},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ne,{class:"mt-4 mb-4"}),o("div",nl,[o("div",rl,[l(n,{size:"14",class:"mr-1"},{default:t(()=>e[52]||(e[52]=[d("mdi-information")])),_:1}),e[53]||(e[53]=d(" Use filters to find specific production records "))]),o("div",ul,[l(h,{color:"grey",variant:"outlined",onClick:it,size:"small",class:"px-4"},{default:t(()=>[l(n,{start:"",size:"18"},{default:t(()=>e[54]||(e[54]=[d("mdi-refresh")])),_:1}),e[55]||(e[55]=d(" Reset All "))]),_:1}),l(h,{color:"primary",onClick:st,size:"small",class:"px-4",elevation:"2"},{default:t(()=>[l(n,{start:"",size:"18"},{default:t(()=>e[56]||(e[56]=[d("mdi-filter-check")])),_:1}),e[57]||(e[57]=d(" Apply Filters "))]),_:1})])])]),_:1}),l(Ct,{active:O.value,indeterminate:O.value,color:"primary",height:"4"},null,8,["active","indeterminate"]),l(he,{headers:be,items:V.value,loading:O.value,search:ce.value,class:"elevation-0",density:"comfortable",hover:""},{loading:t(()=>[l(Dt,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(S,{color:a.produced_at?"green":"red",variant:"flat",size:"small",class:"font-weight-bold text-uppercase"},{default:t(()=>[d(r(a.produced_at?"Completed":"Pending"),1)]),_:2},1032,["color"])]),"item.product_name":t(({item:a})=>[o("div",cl,[l(q,{size:"32",color:"primary",variant:"tonal",class:"mr-3"},{default:t(()=>[l(n,{size:"16",color:"primary"},{default:t(()=>e[58]||(e[58]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",ml,r(a.product_name),1),o("div",fl,r(a.mode),1)])])]),"item.qty_product":t(({item:a})=>[l(S,{size:"small",color:"green",variant:"flat"},{default:t(()=>[l(n,{start:"",size:"16"},{default:t(()=>e[59]||(e[59]=[d("mdi-counter")])),_:1}),d(" "+r(parseFloat(a.qty_product)),1)]),_:2},1024)]),"item.staff_count":t(({item:a})=>[o("div",pl,[l(q,{size:"28",color:"blue-lighten-5",class:"mr-2"},{default:t(()=>[l(n,{size:"14",color:"blue"},{default:t(()=>e[60]||(e[60]=[d("mdi-account-group")])),_:1})]),_:1}),o("span",vl,r(a.staff_count||0),1)])]),"item.planned_at":t(({item:a})=>[o("div",yl,r(a.planned_at),1)]),"item.produced_at":t(({item:a})=>[o("div",gl,r(a.produced_at),1)]),"item.produced_by_name":t(({item:a})=>[o("div",_l,[l(q,{size:"28",color:"blue-grey-lighten-5",class:"mr-2"},{default:t(()=>[l(n,{size:"14",color:"blue-grey"},{default:t(()=>e[61]||(e[61]=[d("mdi-account")])),_:1})]),_:1}),o("span",bl,r(a.produced_by_name),1)])]),"item.actions":t(({item:a})=>[o("div",xl,[l(It,{location:"bottom end",transition:"scale-transition","close-on-content-click":!1},{activator:t(({props:u})=>[l(h,ge(u,{icon:"",size:"small",variant:"text",color:"primary",class:"action-menu-btn"}),{default:t(()=>[a.status==="pending"?(g(),k(St,{key:0,color:"orange",dot:"",location:"top end","offset-x":"2","offset-y":"2"},{default:t(()=>[l(n,null,{default:t(()=>e[62]||(e[62]=[d("mdi-dots-vertical")])),_:1})]),_:1})):(g(),k(n,{key:1},{default:t(()=>e[63]||(e[63]=[d("mdi-dots-vertical")])),_:1}))]),_:2},1040)]),default:t(()=>[l(_,{elevation:"8",rounded:"lg","min-width":"240"},{default:t(()=>[l(C,{class:oe(["pa-4",fe(a.status)])},{default:t(()=>[o("div",Vl,[o("div",wl,[l(q,{size:"32",color:"white",variant:"tonal",class:"mr-3"},{default:t(()=>[l(n,{color:"primary",size:"18"},{default:t(()=>e[64]||(e[64]=[d("mdi-factory")])),_:1})]),_:1}),o("div",null,[e[65]||(e[65]=o("div",{class:"text-white text-body-2 font-weight-bold"},"Production Actions",-1)),o("div",kl,r(a.product_name),1)])]),l(S,{size:"small",color:"white",variant:"flat"},{default:t(()=>[d(r(a.status||"active"),1)]),_:2},1024)])]),_:2},1032,["class"]),l(Ae,{density:"compact",class:"pa-2"},{default:t(()=>[l(B,{onClick:u=>ut(a),class:"rounded-lg mb-1 action-item"},{prepend:t(()=>[l(q,{size:"36",color:"blue-lighten-5",variant:"flat",class:"mr-3"},{default:t(()=>[l(n,{color:"blue",size:"18"},{default:t(()=>e[66]||(e[66]=[d("mdi-eye-outline")])),_:1})]),_:1})]),default:t(()=>[l(ee,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[67]||(e[67]=[d(" View Details ")])),_:1}),l(te,{class:"text-caption text-blue"},{default:t(()=>e[68]||(e[68]=[d(" Complete information ")])),_:1})]),_:2},1032,["onClick"]),l(B,{onClick:u=>Be(a,"actual"),class:"rounded-lg mb-1 action-item",disabled:a.status==="completed"},{prepend:t(()=>[l(q,{size:"36",color:"green-lighten-5",variant:"flat",class:"mr-3"},{default:t(()=>[l(n,{color:"green",size:"18"},{default:t(()=>e[69]||(e[69]=[d("mdi-plus-circle")])),_:1})]),_:1})]),default:t(()=>[l(ee,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[70]||(e[70]=[d(" Add Actual Production ")])),_:1}),l(te,{class:"text-caption text-green"},{default:t(()=>e[71]||(e[71]=[d(" Record actual output ")])),_:1})]),_:2},1032,["onClick","disabled"]),l(B,{onClick:u=>Be(a),class:"rounded-lg mb-1 action-item"},{prepend:t(()=>[l(q,{size:"36",color:"orange-lighten-5",variant:"flat",class:"mr-3"},{default:t(()=>[l(n,{color:"orange",size:"18"},{default:t(()=>e[72]||(e[72]=[d("mdi-pencil-outline")])),_:1})]),_:1})]),default:t(()=>[l(ee,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[73]||(e[73]=[d(" Edit Production ")])),_:1}),l(te,{class:"text-caption text-orange"},{default:t(()=>e[74]||(e[74]=[d(" Modify details ")])),_:1})]),_:2},1032,["onClick"]),l(ne,{class:"my-2"}),l(B,{onClick:u=>ct(a),class:"rounded-lg action-item text-error"},{prepend:t(()=>[l(q,{size:"36",color:"red-lighten-5",variant:"flat",class:"mr-3"},{default:t(()=>[l(n,{color:"red",size:"18"},{default:t(()=>e[75]||(e[75]=[d("mdi-delete-outline")])),_:1})]),_:1})]),default:t(()=>[l(ee,{class:"text-body-2 font-weight-medium text-error"},{default:t(()=>e[76]||(e[76]=[d(" Delete Production ")])),_:1}),l(te,{class:"text-caption text-red"},{default:t(()=>e[77]||(e[77]=[d(" Remove permanently ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",ql,[l(n,{size:"64",color:"grey-lighten-2",class:"mb-4"},{default:t(()=>e[78]||(e[78]=[d("mdi-inbox")])),_:1}),e[81]||(e[81]=o("div",{class:"text-h6 text-grey"},"No productions found",-1)),e[82]||(e[82]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production record ",-1)),l(h,{color:"primary",class:"mt-4",onClick:je},{default:t(()=>[l(n,{start:""},{default:t(()=>e[79]||(e[79]=[d("mdi-plus")])),_:1}),e[80]||(e[80]=d(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1}),l(_,{elevation:"2",rounded:"lg"},{default:t(()=>[l(C,{class:"pa-4"},{default:t(()=>[o("div",Pl,[o("div",zl," Showing "+r(V.value.length)+" of "+r(we.value)+" records ",1),l(Tt,{modelValue:T.value,"onUpdate:modelValue":[e[10]||(e[10]=a=>T.value=a),X],length:$.value,"total-visible":7,color:"primary"},null,8,["modelValue","length"])])]),_:1})]),_:1}),l(Ke,{modelValue:E.value,"onUpdate:modelValue":e[21]||(e[21]=a=>E.value=a),"max-width":"1200",scrollable:"",persistent:""},{default:t(()=>[l(_,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(He,{color:"primary",density:"comfortable",class:"rounded-t-xl"},{default:t(()=>[l(q,{size:"36",color:"white",class:"mr-3"},{default:t(()=>[l(n,{color:"primary",icon:P.value?"mdi-pencil":"mdi-plus"},null,8,["icon"])]),_:1}),l(Ye,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>[d(r(M.value?"Add Actual Quantity":P.value?"Edit Production":"Create New Production"),1)]),_:1}),l(ve),l(h,{icon:"mdi-close",variant:"text",color:"white",onClick:Te})]),_:1}),l(C,{class:"pa-6"},{default:t(()=>[l(Rt,{onSubmit:At($e,["prevent"])},{default:t(()=>[l(_,{variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[o("div",Cl,[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[83]||(e[83]=[d("mdi-information")])),_:1}),e[84]||(e[84]=o("h4",{class:"text-h6 font-weight-medium"},"Basic Information",-1))]),l(F,{dense:""},{default:t(()=>[l(c,{cols:"12",md:"4"},{default:t(()=>[o("div",Sl,[i.planned_at?(g(),N("span",Al," Planned Production Date & Time ")):A("",!0),l(v,{disabled:P.value&&!z.value,modelValue:i.planned_at,"onUpdate:modelValue":e[11]||(e[11]=a=>i.planned_at=a),"enable-time-picker":!0,teleport:!0,"auto-apply":"",format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Planned Production Date & Time",class:"rounded-lg border px-4 py-2 w-100"},null,8,["disabled","modelValue"])])]),_:1}),l(c,{cols:"12",md:"3"},{default:t(()=>[l(Q,{modelValue:i.mode,"onUpdate:modelValue":e[12]||(e[12]=a=>i.mode=a),items:_e,"item-title":"label","item-value":"value",label:"Production Mode",required:"",disabled:P.value,variant:"outlined",color:"primary","prepend-inner-icon":"mdi-cog"},null,8,["modelValue","disabled"])]),_:1}),l(c,{cols:"12",md:"5"},{default:t(()=>[l(re,{modelValue:i.product_id,"onUpdate:modelValue":[e[13]||(e[13]=a=>i.product_id=a),Re],items:J.value,"item-title":"name","item-value":"id",label:"Select Product",required:"",disabled:P.value,variant:"outlined",color:"primary","prepend-inner-icon":"mdi-package-variant"},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),_:1}),l(_,{variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[o("div",hl,[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[85]||(e[85]=[d("mdi-scale")])),_:1}),e[86]||(e[86]=o("h4",{class:"text-h6 font-weight-medium"},"Quantity Configuration",-1))]),i.mode==="by_product"?(g(),k(F,{key:0,dense:""},{default:t(()=>[l(c,{cols:"12",md:"6"},{default:t(()=>[l(le,{modelValue:i.qty_product,"onUpdate:modelValue":e[14]||(e[14]=a=>i.qty_product=a),modelModifiers:{number:!0},type:"number",label:"Quantity of Product",required:"",disabled:P.value&&!z.value,variant:"outlined",color:"primary","prepend-inner-icon":"mdi-numeric",onInput:Pe},null,8,["modelValue","disabled"])]),_:1}),l(c,{cols:"12",md:"6"},{default:t(()=>[l(ue,{type:"info",variant:"tonal",class:"mt-2"},{default:t(()=>e[87]||(e[87]=[d(" Enter the total number of product units to produce ")])),_:1})]),_:1})]),_:1})):A("",!0),i.mode==="by_ingredient"?(g(),k(F,{key:1,dense:""},{default:t(()=>[l(c,{cols:"12",md:"6"},{default:t(()=>[l(re,{modelValue:i.base_ingredient_id,"onUpdate:modelValue":[e[15]||(e[15]=a=>i.base_ingredient_id=a),Pe],items:R.value,"item-title":"item_name","item-value":"item_id",label:"Base Ingredient",disabled:!R.value.length||P.value&&!z.value,variant:"outlined",color:"primary","prepend-inner-icon":"mdi-ingredient"},null,8,["modelValue","items","disabled"])]),_:1}),l(c,{cols:"12",md:"6"},{default:t(()=>[l(le,{modelValue:i.base_ingredient_qty,"onUpdate:modelValue":e[16]||(e[16]=a=>i.base_ingredient_qty=a),modelModifiers:{number:!0},type:"number",label:`Ingredient Quantity (${de.value||"units"})`,required:"",disabled:!i.base_ingredient_id||P.value&&!z.value,variant:"outlined",color:"primary","prepend-inner-icon":"mdi-weight",onInput:Pe},null,8,["modelValue","label","disabled"])]),_:1})]),_:1})):A("",!0)]),_:1}),P.value?(g(),k(_,{key:0,variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[o("div",Dl,[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[88]||(e[88]=[d("mdi-scale-balance")])),_:1}),e[89]||(e[89]=o("h4",{class:"text-h6 font-weight-medium"},"Actual Output & Discrepancies",-1))]),l(F,{dense:""},{default:t(()=>[l(c,{cols:"12",md:"6"},{default:t(()=>[l(le,{disabled:!M.value&&P.value&&!z.value,modelValue:i.actual_qty,"onUpdate:modelValue":e[17]||(e[17]=a=>i.actual_qty=a),modelModifiers:{number:!0},type:"number",label:"Actual Quantity Produced",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-counter",onInput:Ue,required:""},null,8,["disabled","modelValue"])]),_:1}),l(c,{cols:"6",md:"6"},{default:t(()=>[o("div",Ul,[i.produced_at?(g(),N("span",Fl," Actual Production Date & Time ")):A("",!0),l(v,{disabled:!M.value&&P.value&&!z.value,modelValue:i.produced_at,"onUpdate:modelValue":e[18]||(e[18]=a=>i.produced_at=a),"enable-time-picker":!0,teleport:!0,"auto-apply":"",format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",class:"rounded-lg border px-4 py-2 w-100"},null,8,["disabled","modelValue"])])]),_:1}),I.value?(g(),k(c,{key:0,cols:"12",md:"6"},{default:t(()=>[l(ue,{type:"warning",variant:"tonal",border:"start",class:"mt-2"},{default:t(()=>[d(" Discrepancy detected (Planned: "+r(parseFloat(b.qty_product))+" | Actual: "+r(i.actual_qty)+") ",1)]),_:1})]),_:1})):A("",!0)]),_:1}),I.value?(g(),N(ae,{key:0},[l(ne,{class:"my-4"}),(g(!0),N(ae,null,ye(i.discrepancies,(a,u)=>(g(),k(F,{key:u,class:"align-center mb-3"},{default:t(()=>[l(c,{cols:"12",md:"5"},{default:t(()=>[l(Q,{modelValue:a.reason_id,"onUpdate:modelValue":D=>a.reason_id=D,items:H.value,"item-title":"name","item-value":"id",label:"Reason",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-alert-circle-outline","hide-details":""},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(c,{cols:"12",md:"5"},{default:t(()=>[l(le,{modelValue:a.notes,"onUpdate:modelValue":D=>a.notes=D,label:"Notes",variant:"outlined",color:"primary","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(c,{cols:"12",md:"2",class:"text-right"},{default:t(()=>[l(h,{icon:"",color:"error",variant:"text",onClick:D=>at(u)},{default:t(()=>[l(n,null,{default:t(()=>e[90]||(e[90]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(h,{color:"primary",variant:"outlined",size:"small",onClick:Fe},{default:t(()=>[l(n,{start:""},{default:t(()=>e[91]||(e[91]=[d("mdi-plus")])),_:1}),e[92]||(e[92]=d(" Add Reason "))]),_:1})],64)):A("",!0)]),_:1})):A("",!0),l(_,{variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[o("div",Ml,[o("div",Il,[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[93]||(e[93]=[d("mdi-account-group")])),_:1}),e[94]||(e[94]=o("h4",{class:"text-h6 font-weight-medium"},"Staff Assignment",-1))]),o("div",Tl,[l(h,{color:"primary",variant:"outlined",size:"small",onClick:Ie,disabled:!Y.value.length},{default:t(()=>[l(n,{start:""},{default:t(()=>e[95]||(e[95]=[d("mdi-account-plus")])),_:1}),e[96]||(e[96]=d(" Add Staff "))]),_:1},8,["disabled"]),l(h,{color:"secondary",variant:"outlined",size:"small",onClick:dt,disabled:!i.staff.length},{default:t(()=>[l(n,{start:""},{default:t(()=>e[97]||(e[97]=[d("mdi-account-remove")])),_:1}),e[98]||(e[98]=d(" Clear All "))]),_:1},8,["disabled"])])]),l(he,{headers:Ve,items:i.staff,class:"elevation-1 rounded-lg",density:"comfortable"},{"item.staff_id":t(({item:a,index:u})=>[l(re,{modelValue:a.staff_id,"onUpdate:modelValue":D=>a.staff_id=D,items:Y.value,"item-title":"name","item-value":"id",density:"compact",variant:"outlined",placeholder:"Select Staff","hide-details":"",disabled:!z.value,"return-object":""},null,8,["modelValue","onUpdate:modelValue","items","disabled"])]),"item.role":t(({item:a})=>[l(Q,{modelValue:a.role,"onUpdate:modelValue":u=>a.role=u,items:["Team Leader","Assistant","Support"],density:"compact",variant:"outlined",color:"primary",clearable:"","prepend-inner-icon":"mdi-account-tie","hide-details":"",disabled:!z.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":t(({item:a})=>[l(le,{modelValue:a.notes,"onUpdate:modelValue":u=>a.notes=u,density:"compact",variant:"outlined","hide-details":"",disabled:!z.value},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.actions":t(({item:a,index:u})=>[l(h,{icon:"",size:"small",variant:"text",color:"error",disabled:!z.value,onClick:D=>ot(u)},{default:t(()=>[l(n,null,{default:t(()=>e[99]||(e[99]=[d("mdi-delete")])),_:1})]),_:2},1032,["disabled","onClick"])]),"no-data":t(()=>e[100]||(e[100]=[o("div",{class:"text-center py-4 text-grey"},' No staff assigned. Click "Add Staff" to assign team members. ',-1)])),_:1},8,["items"]),i.staff.length?(g(),k(ue,{key:0,type:"info",variant:"tonal",border:"start",class:"mt-4"},{default:t(()=>[o("div",Rl,[o("div",null,[e[101]||(e[101]=o("strong",null,"Team Summary:",-1)),l(S,{size:"small",color:"primary",variant:"flat",class:"ml-2"},{default:t(()=>[d(r(i.staff.length)+" staff members ",1)]),_:1})]),o("div",jl,r(U.value)+" of "+r(Y.value.length+U.value)+" staff assigned ",1)])]),_:1})):A("",!0)]),_:1}),l(_,{variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[o("div",Bl,[o("div",$l,[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[102]||(e[102]=[d("mdi-ingredient")])),_:1}),e[103]||(e[103]=o("h4",{class:"text-h6 font-weight-medium"},"Ingredients Required",-1))]),l(Nt,{modelValue:z.value,"onUpdate:modelValue":e[19]||(e[19]=a=>z.value=a),label:z.value?"Editing Enabled":"Editing Disabled",color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"])]),L.value?(g(),k(ue,{key:0,type:"error",variant:"tonal",border:"start",class:"mb-3"},{default:t(()=>e[104]||(e[104]=[d(" Some ingredients exceed available stock. Please adjust quantities before saving. ")])),_:1})):A("",!0),l(he,{headers:xe,items:b.ingredients,class:"elevation-1 rounded-lg",density:"comfortable"},{"item.qty_required":t(({item:a})=>[o("div",El,[l(le,{modelValue:a.qty_required,"onUpdate:modelValue":u=>a.qty_required=u,modelModifiers:{number:!0},type:"number",density:"compact",variant:"outlined","hide-details":"",style:{"max-width":"140px"},error:a.exceeds,"error-messages":a.exceeds?["Exceeds available stock"]:[],onInput:u=>a.exceeds=a.qty_required>a.available},{"append-inner":t(()=>[o("span",{class:oe(["text-caption",a.exceeds?"text-error":"text-grey"])},r(a.unit),3)]),_:2},1032,["modelValue","onUpdate:modelValue","error","error-messages","onInput"]),a.exceeds?(g(),k($t,{key:0,text:"Maximum available: "+a.available+" "+a.unit,location:"top"},{activator:t(({props:u})=>[l(h,ge(u,{icon:"",size:"x-small",color:"orange",variant:"text",class:"ml-1",onClick:D=>{a.qty_required=a.available,a.exceeds=!1}}),{default:t(()=>[l(n,{size:"16"},{default:t(()=>e[105]||(e[105]=[d("mdi-information-outline")])),_:1})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):A("",!0)])]),"item.available":t(({item:a})=>[l(S,{color:a.exceeds?"red":"blue",variant:"outlined",size:"small",class:"font-weight-medium"},{default:t(()=>[d(r(a.available)+" "+r(a.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:a})=>[l(S,{size:"small",variant:"outlined",color:"blue-grey"},{default:t(()=>[d(r(a.unit),1)]),_:2},1024)]),"no-data":t(()=>e[106]||(e[106]=[o("div",{class:"text-center py-4 text-grey"}," Select a product to view required ingredients ",-1)])),_:1},8,["items"]),b.ingredients.length?(g(),k(ue,{key:1,type:"success",variant:"tonal",border:"start",class:"mt-4"},{default:t(()=>[o("div",Ll,[o("div",null,[e[107]||(e[107]=o("strong",null,"Total Product Units:",-1)),l(S,{size:"small",color:"success",variant:"flat",class:"ml-2"},{default:t(()=>[o("b",null,r(parseFloat(b.qty_product)||0),1)]),_:1})]),o("div",Nl,r(b.ingredients.length)+" ingredients required ",1)])]),_:1})):A("",!0)]),_:1}),l(Et,{modelValue:i.notes,"onUpdate:modelValue":e[20]||(e[20]=a=>i.notes=a),label:"Additional Notes",rows:"3",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-note-text",disabled:!z.value&&P.value},null,8,["modelValue","disabled"])]),_:1})]),_:1}),l(Ft,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(ve),l(h,{variant:"outlined",color:"grey",onClick:Te,class:"px-6"},{default:t(()=>e[108]||(e[108]=[d(" Cancel ")])),_:1}),l(h,{color:"success",loading:G.value,disabled:!tt.value,onClick:$e,class:"px-6",elevation:"2"},{default:t(()=>[l(n,{start:""},{default:t(()=>e[109]||(e[109]=[d("mdi-content-save-check")])),_:1}),d(" "+r(P.value?"Update Production":"Create Production"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ke,{modelValue:K.value,"onUpdate:modelValue":e[23]||(e[23]=a=>K.value=a),"max-width":"900"},{default:t(()=>[l(_,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(He,{color:"primary",density:"comfortable",class:"rounded-t-xl"},{default:t(()=>[l(q,{size:"36",color:"white",class:"mr-3"},{default:t(()=>[l(n,{color:"primary"},{default:t(()=>e[110]||(e[110]=[d("mdi-eye")])),_:1})]),_:1}),l(Ye,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>e[111]||(e[111]=[d(" Production Details ")])),_:1}),l(ve),l(h,{icon:"mdi-close",variant:"text",color:"white",onClick:e[22]||(e[22]=a=>K.value=!1)})]),_:1}),l(C,{class:"pa-6"},{default:t(()=>{var a,u,D,pe;return[l(_,{variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[l(F,null,{default:t(()=>[l(c,{cols:"12",md:"4"},{default:t(()=>{var m,f;return[e[112]||(e[112]=o("div",{class:"text-body-2 text-grey"},"Production ID",-1)),o("div",Ol,"#"+r((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.id),1)]}),_:1}),l(c,{cols:"12",md:"4"},{default:t(()=>{var m,f;return[e[113]||(e[113]=o("div",{class:"text-body-2 text-grey"},"Product",-1)),o("div",Hl,r((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.product_name),1)]}),_:1}),l(c,{cols:"12",md:"4"},{default:t(()=>{var m,f;return[e[114]||(e[114]=o("div",{class:"text-body-2 text-grey"},"Planning Mode",-1)),l(S,{color:((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.mode)==="by_product"?"blue":"orange",variant:"flat"},{default:t(()=>{var Z,Ee;return[d(r((Ee=(Z=w.value)==null?void 0:Z.production)==null?void 0:Ee.mode),1)]}),_:1},8,["color"])]}),_:1}),l(c,{cols:"12",md:"4"},{default:t(()=>[e[116]||(e[116]=o("div",{class:"text-body-2 text-grey"},"Planned Units",-1)),l(S,{color:"blue",variant:"flat",size:"large"},{default:t(()=>{var m,f;return[l(n,{start:""},{default:t(()=>e[115]||(e[115]=[d("mdi-counter")])),_:1}),d(" "+r(parseFloat((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.qty_product)),1)]}),_:1})]),_:1}),l(c,{cols:"12",md:"4"},{default:t(()=>[e[118]||(e[118]=o("div",{class:"text-body-2 text-grey"},"Actual Units",-1)),l(S,{color:"green",variant:"flat",size:"large"},{default:t(()=>{var m,f;return[l(n,{start:""},{default:t(()=>e[117]||(e[117]=[d("mdi-check-decagram")])),_:1}),d(" "+r(parseFloat((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.actual_qty)||"—"),1)]}),_:1})]),_:1}),l(c,{cols:"12",md:"4"},{default:t(()=>[e[120]||(e[120]=o("div",{class:"text-body-2 text-grey"},"Team Size",-1)),l(S,{color:"purple",variant:"flat"},{default:t(()=>{var m,f;return[l(n,{start:""},{default:t(()=>e[119]||(e[119]=[d("mdi-account-group")])),_:1}),d(" "+r(((f=(m=w.value)==null?void 0:m.staff)==null?void 0:f.length)||0)+" members ",1)]}),_:1})]),_:1}),l(c,{cols:"4",md:"4"},{default:t(()=>{var m,f;return[e[121]||(e[121]=o("div",{class:"text-body-2 text-grey"},"Planned By",-1)),o("div",Yl,r((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.produced_by_name),1)]}),_:1}),l(c,{cols:"4",md:"4"},{default:t(()=>{var m,f;return[o("div",Ql,[l(q,{size:"40",color:"orange-lighten-5",class:"mr-3"},{default:t(()=>[l(n,{color:"orange"},{default:t(()=>e[122]||(e[122]=[d("mdi-calendar-clock")])),_:1})]),_:1}),o("div",null,[e[123]||(e[123]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",Gl,r(Me((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.planned_at)),1)])])]}),_:1}),l(c,{cols:"4",md:"4"},{default:t(()=>{var m,f;return[o("div",Kl,[l(q,{size:"40",color:"green-lighten-5",class:"mr-3"},{default:t(()=>[l(n,{color:"green"},{default:t(()=>e[124]||(e[124]=[d("mdi-calendar-check")])),_:1})]),_:1}),o("div",null,[e[125]||(e[125]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",Jl,r(Me((f=(m=w.value)==null?void 0:m.production)==null?void 0:f.produced_at)),1)])])]}),_:1})]),_:1})]),_:1}),(u=(a=w.value)==null?void 0:a.discrepancies)!=null&&u.length?(g(),k(_,{key:0,variant:"outlined",class:"rounded-lg pa-4 mb-4"},{default:t(()=>[o("div",Wl,[l(n,{color:"red",class:"mr-2"},{default:t(()=>e[126]||(e[126]=[d("mdi-alert-circle")])),_:1}),e[127]||(e[127]=o("h5",{class:"text-h6 font-weight-medium text-red"},"Discrepancy Details",-1))]),e[128]||(e[128]=o("div",{class:"mb-3 text-body-2 text-grey"}," The actual produced quantity differs from the planned quantity. Below are the reported reasons: ",-1)),l(ht,{column:"",multiple:"",class:"d-flex flex-wrap gap-2"},{default:t(()=>[(g(!0),N(ae,null,ye(w.value.discrepancies,(m,f)=>(g(),k(S,{key:f,color:"red-lighten-2",variant:"outlined","prepend-icon":"mdi-alert"},{default:t(()=>[d(r(m.name)+" - "+r(m.notes),1)]),_:2},1024))),128))]),_:1})]),_:1})):A("",!0),(pe=(D=w.value)==null?void 0:D.staff)!=null&&pe.length?(g(),k(_,{key:1,variant:"outlined",class:"rounded-lg mb-4"},{default:t(()=>[l(Qe,{class:"d-flex align-center"},{default:t(()=>[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[129]||(e[129]=[d("mdi-account-group")])),_:1}),e[130]||(e[130]=d(" Assigned Staff Team "))]),_:1}),l(C,{class:"pa-0"},{default:t(()=>[l(Ae,{lines:"two",class:"pa-0"},{default:t(()=>[(g(!0),N(ae,null,ye(w.value.staff,(m,f)=>(g(),k(B,{key:f,class:oe(["px-4",{"bg-grey-lighten-4":f%2===0}])},{prepend:t(()=>[l(q,{color:"primary",size:"40",variant:"tonal",class:"mr-3"},{default:t(()=>[l(n,{color:"white",size:"20"},{default:t(()=>e[131]||(e[131]=[d("mdi-account")])),_:1})]),_:1})]),append:t(()=>[l(S,{size:"small",variant:"flat",color:"success"},{default:t(()=>e[132]||(e[132]=[d(" Active ")])),_:1})]),default:t(()=>[l(ee,{class:"font-weight-medium"},{default:t(()=>[d(r(m.name),1)]),_:2},1024),l(te,{class:"mt-1"},{default:t(()=>[o("div",Xl,[m.role?(g(),k(S,{key:0,size:"small",color:"blue",variant:"outlined"},{default:t(()=>[d(r(m.role),1)]),_:2},1024)):A("",!0)]),m.notes?(g(),N("div",Zl,r(m.notes),1)):A("",!0)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),l(ne),o("div",ea,[l(F,{dense:""},{default:t(()=>[l(c,{cols:"12",md:"4",class:"text-center"},{default:t(()=>[o("div",ta,r(w.value.staff.length),1),e[133]||(e[133]=o("div",{class:"text-caption text-grey"},"Team Members",-1))]),_:1})]),_:1})])]),_:1})]),_:1})):A("",!0),l(_,{variant:"outlined",class:"rounded-lg"},{default:t(()=>[l(Qe,{class:"d-flex align-center"},{default:t(()=>[l(n,{color:"primary",class:"mr-2"},{default:t(()=>e[134]||(e[134]=[d("mdi-ingredient")])),_:1}),e[135]||(e[135]=d(" Ingredients Used "))]),_:1}),l(C,{class:"pa-0"},{default:t(()=>[l(Ae,{lines:"two",class:"pa-0"},{default:t(()=>{var m;return[(g(!0),N(ae,null,ye(((m=w.value)==null?void 0:m.items)||[],(f,Z)=>(g(),k(B,{key:Z,class:oe(["px-4",{"bg-grey-lighten-4":Z%2===0}])},{prepend:t(()=>[l(q,{color:"primary",size:"36",class:"mr-3"},{default:t(()=>[o("span",la,r(Z+1),1)]),_:2},1024)]),default:t(()=>[l(ee,{class:"font-weight-medium"},{default:t(()=>[d(r(f.item_name),1)]),_:2},1024),l(te,{class:"mt-1"},{default:t(()=>[l(S,{size:"small",color:"primary",variant:"outlined",class:"mr-2"},{default:t(()=>[d(r(f.qty_required)+" "+r(f.unit||""),1)]),_:2},1024),e[136]||(e[136]=o("span",{class:"text-grey"},"Required",-1))]),_:2},1024)]),_:2},1032,["class"]))),128))]}),_:1})]),_:1})]),_:1})]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},ga=qt(aa,[["__scopeId","data-v-57c0699e"]]);export{ga as default};
