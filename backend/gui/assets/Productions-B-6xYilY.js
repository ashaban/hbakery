import{a as we,p as ke,a6 as $t,a7 as Dl,h as he,i as l,X as Rt,Y as Tl,y as o,n as Le,j as ee,a8 as jl,a9 as Nl,m as lt,aa as zt,ab as Mt,ac as Bl,e as L,ad as W,B as u,ae as Ft,af as El,ag as Ge,ah as $l,ai as Rl,aj as Ml,ak as Gt,al as Fl,am as Gl,an as Ll,ao as Ol,ap as Hl,aq as Ql,ar as Yl,as as Jl,at as Wl,au as Kl,av as Ve,aw as Xl,ax as Zl,r as N,ay as ea,F,az as ta,aA as la,_ as aa,$ as Be,l as oa,s as g,x as t,a1 as sa,v as f,a2 as z,C as s,H as U,I as i,O as B,A as S,D as ie,Q as pe,M as ae,aB as Ct,aC as St,aD as At,L as _e,N as se,aE as X,E as I,a3 as Ee,a4 as $e,G as Z,a5 as It}from"./index--x-ecw0i.js";import{h as Lt}from"./moment-C5S46NFB.js";import{V as da}from"./VContainer-DZpjXtKH.js";import{V as re}from"./VAlert-BETuRkq4.js";import{V as v,b as x,a as be,c as Ut}from"./VCard-B7owJXFi.js";import{V as _}from"./VCol-9mkHKuYv.js";import{V as k}from"./VChip-Drqce34l.js";import{V as ye}from"./VAutocomplete-rhDGvp-s.js";import{c as Ze,m as na,d as ia,e as ra,V as ce,a as xe,f as Dt,b as ua}from"./VDataTable-D6YKsfi3.js";import{V as Tt}from"./VSkeletonLoader-N1XU37eY.js";import{V as ca}from"./VBadge-BZW1xqJy.js";import{V as Re}from"./VDialog-C4VoQ_dv.js";import{V as jt}from"./VForm-BBetik0M.js";import{a as Nt,b as ma,m as fa,V as J}from"./VTextField-CIWsNpzY.js";import{V as pa}from"./VSwitch-DSI1Cwkx.js";import{V as Bt,a as Me,b as Et,c as Fe}from"./VTabs-DNjTaM8E.js";import{V as _a}from"./VTooltip-CEY-ksB_.js";import"./VSlideGroup-B9WAwK8P.js";import"./dialog-transition-BDagy04W.js";const Ke=p=>p?Lt(p).format("DD-MM-YYYY HH:mm"):"",Xe=p=>p?Lt(p,"DD-MM-YYYY HH:mm").format("YYYY-MM-DD HH:mm"):null,Ae=Symbol.for("vuetify:v-expansion-panel"),Ot=ke({...lt(),...Nl()},"VExpansionPanelText"),et=we()({name:"VExpansionPanelText",props:Ot(),setup(p,E){let{slots:q}=E;const b=$t(Ae);if(!b)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:G,onAfterLeave:$}=Dl(p,b.isSelected);return he(()=>l(jl,{onAfterLeave:$},{default:()=>{var M;return[Rt(o("div",{class:ee(["v-expansion-panel-text",p.class]),style:Le(p.style)},[q.default&&G.value&&o("div",{class:"v-expansion-panel-text__wrapper"},[(M=q.default)==null?void 0:M.call(q)])]),[[Tl,b.isSelected.value]])]}})),{}}}),Ht=ke({color:String,expandIcon:{type:Ge,default:"$expand"},collapseIcon:{type:Ge,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...lt(),...El()},"VExpansionPanelTitle"),tt=we()({name:"VExpansionPanelTitle",directives:{vRipple:zt},props:Ht(),setup(p,E){let{slots:q}=E;const b=$t(Ae);if(!b)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:G,backgroundColorStyles:$}=Mt(()=>p.color),{dimensionStyles:M}=Bl(p),K=L(()=>({collapseIcon:p.collapseIcon,disabled:b.disabled.value,expanded:b.isSelected.value,expandIcon:p.expandIcon,readonly:p.readonly})),te=W(()=>b.isSelected.value?p.collapseIcon:p.expandIcon);return he(()=>{var oe;return Rt(o("button",{class:ee(["v-expansion-panel-title",{"v-expansion-panel-title--active":b.isSelected.value,"v-expansion-panel-title--focusable":p.focusable,"v-expansion-panel-title--static":p.static},G.value,p.class]),style:Le([$.value,M.value,p.style]),type:"button",tabindex:b.disabled.value?-1:void 0,disabled:b.disabled.value,"aria-expanded":b.isSelected.value,onClick:p.readonly?void 0:b.toggle},[o("span",{class:"v-expansion-panel-title__overlay"},null),(oe=q.default)==null?void 0:oe.call(q,K.value),!p.hideActions&&l(Ft,{defaults:{VIcon:{icon:te.value}}},{default:()=>{var de;return[o("span",{class:"v-expansion-panel-title__icon"},[((de=q.actions)==null?void 0:de.call(q,K.value))??l(u,null,null)])]}})]),[[zt,p.ripple]])}),{}}}),Qt=ke({title:String,text:String,bgColor:String,...Ll(),...Gl(),...Fl(),...Gt(),...Ht(),...Ot()},"VExpansionPanel"),ya=we()({name:"VExpansionPanel",props:Qt(),emits:{"group:selected":p=>!0},setup(p,E){let{slots:q}=E;const b=$l(p,Ae),{backgroundColorClasses:G,backgroundColorStyles:$}=Mt(()=>p.bgColor),{elevationClasses:M}=Rl(p),{roundedClasses:K}=Ml(p),te=W(()=>(b==null?void 0:b.disabled.value)||p.disabled),oe=L(()=>b.group.items.value.reduce((C,T,O)=>(b.group.selected.value.includes(T.id)&&C.push(O),C),[])),de=L(()=>{const C=b.group.items.value.findIndex(T=>T.id===b.id);return!b.isSelected.value&&oe.value.some(T=>T-C===1)}),ue=L(()=>{const C=b.group.items.value.findIndex(T=>T.id===b.id);return!b.isSelected.value&&oe.value.some(T=>T-C===-1)});return Ol(Ae,b),he(()=>{const C=!!(q.text||p.text),T=!!(q.title||p.title),O=tt.filterProps(p),ne=et.filterProps(p);return l(p.tag,{class:ee(["v-expansion-panel",{"v-expansion-panel--active":b.isSelected.value,"v-expansion-panel--before-active":de.value,"v-expansion-panel--after-active":ue.value,"v-expansion-panel--disabled":te.value},K.value,G.value,p.class]),style:Le([$.value,p.style])},{default:()=>[o("div",{class:ee(["v-expansion-panel__shadow",...M.value])},null),l(Ft,{defaults:{VExpansionPanelTitle:{...O},VExpansionPanelText:{...ne}}},{default:()=>{var P;return[T&&l(tt,{key:"title"},{default:()=>[q.title?q.title():p.title]}),C&&l(et,{key:"text"},{default:()=>[q.text?q.text():p.text]}),(P=q.default)==null?void 0:P.call(q)]}})]})}),{groupItem:b}}}),va=["default","accordion","inset","popout"],ga=ke({flat:Boolean,...Kl(),...Wl(Qt(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...Jl(),...lt(),...Gt(),variant:{type:String,default:"default",validator:p=>va.includes(p)}},"VExpansionPanels"),ba=we()({name:"VExpansionPanels",props:ga(),emits:{"update:modelValue":p=>!0},setup(p,E){let{slots:q}=E;const{next:b,prev:G}=Hl(p,Ae),{themeClasses:$}=Ql(p),M=W(()=>p.variant&&`v-expansion-panels--variant-${p.variant}`);return Yl({VExpansionPanel:{bgColor:W(()=>p.bgColor),collapseIcon:W(()=>p.collapseIcon),color:W(()=>p.color),eager:W(()=>p.eager),elevation:W(()=>p.elevation),expandIcon:W(()=>p.expandIcon),focusable:W(()=>p.focusable),hideActions:W(()=>p.hideActions),readonly:W(()=>p.readonly),ripple:W(()=>p.ripple),rounded:W(()=>p.rounded),static:W(()=>p.static)}}),he(()=>l(p.tag,{class:ee(["v-expansion-panels",{"v-expansion-panels--flat":p.flat,"v-expansion-panels--tile":p.tile},$.value,M.value,p.class]),style:Le(p.style)},{default:()=>{var K;return[(K=q.default)==null?void 0:K.call(q,{prev:G,next:b})]}})),{next:b,prev:G}}}),xa=ke({...na({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Va=we()({name:"VRadio",props:xa(),setup(p,E){let{slots:q}=E;return he(()=>{const b=Ze.filterProps(p);return l(Ze,Ve(b,{class:["v-radio",p.class],style:p.style,type:"radio"}),q)}),{}}}),wa=ke({height:{type:[Number,String],default:"auto"},...fa(),...la(ra(),["multiple"]),trueIcon:{type:Ge,default:"$radioOn"},falseIcon:{type:Ge,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ka=we()({name:"VRadioGroup",inheritAttrs:!1,props:wa(),emits:{"update:modelValue":p=>!0},setup(p,E){let{attrs:q,slots:b}=E;const G=Xl(),$=L(()=>p.id||`radio-group-${G}`),M=Zl(p,"modelValue"),K=N();return he(()=>{const[te,oe]=ea(q),de=Nt.filterProps(p),ue=Ze.filterProps(p),C=b.label?b.label({label:p.label,props:{for:$.value}}):p.label;return l(Nt,Ve({ref:K,class:["v-radio-group",p.class],style:p.style},te,de,{modelValue:M.value,"onUpdate:modelValue":T=>M.value=T,id:$.value}),{...b,default:T=>{let{id:O,messagesId:ne,isDisabled:P,isReadonly:Ie}=T;return o(F,null,[C&&l(ma,{id:O.value},{default:()=>[C]}),l(ia,Ve(ue,{id:O.value,"aria-describedby":ne.value,defaultsTarget:"VRadio",trueIcon:p.trueIcon,falseIcon:p.falseIcon,type:p.type,disabled:P.value,readonly:Ie.value,"aria-labelledby":C?O.value:void 0,multiple:!1},oe,{modelValue:M.value,"onUpdate:modelValue":le=>M.value=le}),b)])}})}),ta({},K)}}),ha={class:"d-flex align-center justify-space-between"},qa={class:"d-flex gap-2"},Pa={class:"d-flex align-center"},za={class:"text-h5 font-weight-bold text-blue"},Ca={class:"text-caption text-grey"},Sa={class:"d-flex align-center"},Aa={class:"text-h5 font-weight-bold text-green"},Ia={class:"d-flex align-center"},Ua={class:"text-h5 font-weight-bold text-orange"},Da={class:"d-flex align-center"},Ta={class:"text-h5 font-weight-bold text-purple"},ja={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},Na={class:"d-flex align-center mb-4"},Ba={class:"d-flex align-center mb-2"},Ea={class:"d-flex align-center mb-2"},$a={class:"d-flex align-center"},Ra={class:"d-flex align-center mb-2"},Ma={class:"d-flex align-center mb-2"},Fa={class:"d-flex justify-space-between align-center"},Ga={class:"text-caption text-grey"},La={class:"d-flex gap-2"},Oa={class:"d-flex align-center"},Ha={class:"font-weight-medium"},Qa={class:"text-caption text-grey"},Ya={class:"text-caption"},Ja={class:"text-no-wrap"},Wa={class:"text-no-wrap"},Ka={class:"d-flex align-center"},Xa={class:"font-weight-medium"},Za={class:"d-flex justify-end"},eo={class:"d-flex align-center justify-space-between"},to={class:"d-flex align-center"},lo={class:"text-white text-caption opacity-75"},ao={class:"text-center py-8"},oo={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},so={class:"d-flex align-center mb-4"},no={class:"d-flex align-center mb-2"},io={class:"d-flex align-center mb-2"},ro={class:"d-flex align-center"},uo={class:"d-flex align-center mb-2"},co={class:"d-flex align-center mb-2"},mo={class:"d-flex justify-space-between align-center"},fo={class:"text-caption text-grey"},po={class:"d-flex gap-2"},_o={class:"d-flex align-center"},yo={class:"font-weight-medium"},vo={class:"text-caption text-grey"},go={class:"d-flex align-center"},bo={class:"font-weight-medium"},xo={class:"text-no-wrap"},Vo={class:"text-no-wrap"},wo={class:"d-flex align-center"},ko={class:"font-weight-medium"},ho={class:"d-flex justify-end"},qo={class:"d-flex align-center justify-space-between"},Po={class:"d-flex align-center"},zo={class:"text-white text-caption opacity-75"},Co={class:"text-center py-8"},So={class:"d-flex justify-space-between align-center"},Ao={class:"text-body-2 text-grey"},Io={class:"text-h6 font-weight-bold"},Uo={class:"text-body-1 font-weight-medium"},Do={class:"text-body-1 font-weight-medium"},To={class:"text-body-1 font-weight-medium"},jo={class:"text-body-1 font-weight-medium"},No={class:"text-h6 font-weight-bold text-green"},Bo={class:"text-h6 font-weight-bold text-orange"},Eo={class:"text-h6 font-weight-bold text-red"},$o={class:"text-h6 font-weight-bold text-primary"},Ro={class:"d-flex align-center"},Mo={class:"font-weight-medium"},Fo={class:"text-caption text-grey"},Go={key:0,class:"d-flex flex-column"},Lo={class:"font-weight-medium text-green"},Oo={class:"text-caption text-orange"},Ho={class:"text-caption text-red"},Qo={key:1,class:"text-grey"},Yo={class:"text-white text-caption font-weight-bold"},Jo={key:0,class:"text-caption"},Wo={key:1,class:"text-caption text-grey"},Ko={class:"d-flex align-center mb-4"},Xo={class:"position-relative w-100"},Zo={key:0,class:"datepicker-label"},es={class:"d-flex align-center mb-4"},ts={class:"d-flex align-center mb-3"},ls={class:"font-weight-medium text-h6"},as={class:"text-caption text-grey"},os={class:"mb-2"},ss={class:"d-flex align-center mb-3"},ds={class:"text-h6 font-weight-bold text-green"},ns={class:"text-h6 font-weight-bold text-orange"},is={class:"text-h6 font-weight-bold text-red"},rs={class:"text-h6 font-weight-bold text-primary"},us={class:"d-flex align-center mb-4"},cs={class:"position-relative w-100"},ms={key:0,class:"datepicker-label"},fs={class:"position-relative w-100"},ps={key:0,class:"datepicker-label"},_s={class:"d-flex align-center justify-space-between mb-4"},ys={class:"d-flex align-center"},vs={class:"d-flex align-center mb-3"},gs={class:"text-body-2 text-grey"},bs={class:"d-flex align-center mb-3"},xs={class:"d-flex align-center justify-space-between mb-4"},Vs={class:"d-flex align-center"},ws={class:"d-flex align-center"},ks={class:"d-flex align-center"},hs={class:"d-flex align-center mb-4"},qs={class:"text-h6 font-weight-medium"},Ps={class:"d-flex align-center justify-space-between w-100 pr-4"},zs={class:"d-flex align-center"},Cs={class:"d-flex align-center"},Ss={class:"text-caption text-grey mb-2"},As={class:"d-flex align-center"},Is={class:"ml-2 flex-grow-1"},Us={class:"font-weight-medium"},Ds={key:0,class:"text-caption text-grey"},Ts={class:"mt-2"},js={class:"d-flex align-center"},Ns={class:"d-flex align-center justify-space-between mb-4"},Bs={class:"d-flex align-center"},Es={class:"d-flex gap-2"},$s={class:"d-flex justify-space-between align-center"},Rs={class:"text-caption text-grey"},Ms={class:"d-flex align-center mb-4"},Fs={class:"text-h6 font-weight-bold"},Gs={class:"text-body-1 font-weight-medium"},Ls={class:"text-body-1 font-weight-medium"},Os={class:"text-body-1 font-weight-medium"},Hs={class:"text-body-1 font-weight-medium"},Qs={class:"text-body-1 font-weight-medium"},Ys={class:"text-body-1 font-weight-medium"},Js={class:"text-body-1 font-weight-medium"},Ws={class:"text-body-1 font-weight-medium"},Ks={class:"text-h6 font-weight-bold text-green"},Xs={class:"text-h6 font-weight-bold text-blue"},Zs={class:"text-h6 font-weight-bold text-green"},ed={class:"text-h6 font-weight-bold text-orange"},td={class:"text-h6 font-weight-bold text-red"},ld={class:"text-body-1 font-weight-medium"},ad={class:"text-white text-caption font-weight-bold"},od={class:"text-caption text-grey"},sd={key:0,class:"text-caption text-grey ml-2"},dd={class:"text-caption text-grey ml-2"},nd={class:"text-white text-caption font-weight-bold"},id={key:0,class:"text-caption"},rd={key:1,class:"text-caption text-grey"},ud={class:"text-caption text-grey"},cd={__name:"Productions",setup(p){const E=N(!1),q=N(!1),b=N([]),G=N([]),$=N(!1),M=N(1),K=N(1),te=N(!1),oe=N(!1),de=N(!1),ue=N(!1),C=N(null),T=N(!0),O=N(!1),ne=N(!1),P=N(null),Ie=N(""),le=N(0),qe=N([]),Pe=N([]),Ue=N([]),Oe=N([]),H=Be({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),Q=Be({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",team_leader:""}),y=Be({id:null,planned_at:null,produced_at:null,notes:"",good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],staff:[],products:[]}),j=Be({batch_id:null,produced_at:null,notes:"",products:[]}),Yt=[{label:"By Product",value:"by_product"},{label:"By Ingredient",value:"by_ingredient"}],Jt=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],Wt=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],at=[{title:"On Date",value:"="},{title:"After",value:">"},{title:"Before",value:"<"},{title:"On or After",value:">="},{title:"On or Before",value:"<="},{title:"Between",value:"in"}],Kt=[{title:"Batch Code",key:"batch_code",sortable:!0},{title:"Status",key:"status",sortable:!0,align:"center"},{title:"Production Stats",key:"production_stats",sortable:!1},{title:"Planned Start",key:"planned_at",sortable:!0},{title:"Produced At",key:"produced_at",sortable:!0},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Created By",key:"created_by_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"100px"}],Xt=[{title:"Product",key:"product_name",sortable:!0},{title:"Planned Qty",key:"qty_product",sortable:!0,align:"center"},{title:"Status",key:"produced",sortable:!0,align:"center"},{title:"Actual Output",key:"good_qty",sortable:!1},{title:"Actions",key:"actions",sortable:!1,align:"center"}],Zt=[{title:"Product / Batch",key:"product_name",sortable:!0},{title:"Quantity",key:"qty_product",sortable:!0,align:"center"},{title:"Staffs",key:"staff_count",sortable:!0,align:"center"},{title:"Mode",key:"mode",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Planned At",key:"planned_at",sortable:!0},{title:"Produced At",key:"produced_at",sortable:!0},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"180px"}],ot=[{title:"Ingredient",key:"item_name"},{title:"Quantity Required",key:"qty_required"},{title:"Available",key:"available",align:"center"},{title:"Unit",key:"unit",align:"center"}],el=[{title:"Staff Member",key:"staff_id",width:"250px"},{title:"Role",key:"role",width:"240px"},{title:"Notes",key:"notes",width:"240px"},{title:"Actions",key:"actions",align:"center",sortable:!1}],st=d=>({completed:"green",partial:"orange",pending:"red",cancelled:"grey"})[d]||"grey",dt=d=>({completed:"Completed",partial:"Partial",pending:"Pending",cancelled:"Cancelled"})[d]||d,tl=d=>({completed:"bg-green",partial:"bg-orange",pending:"bg-red",cancelled:"bg-grey"})[d]||"bg-primary",ll=d=>({pending:"bg-orange",completed:"bg-green",active:"bg-primary",cancelled:"bg-red"})[d]||"bg-primary",al=L(()=>{let d=0;return Object.keys(H).forEach(e=>{const c=H[e];(Array.isArray(c)&&c.length||c&&c!=="all")&&d++}),d}),ol=L(()=>{let d=0;return Object.keys(Q).forEach(e=>{const c=Q[e];(Array.isArray(c)&&c.length||c&&c!=="all")&&d++}),d}),sl=()=>{$.value=!$.value,M.value=1,ve()},ve=()=>{$.value?ze():Cl()},ze=async()=>{E.value=!0;try{const d=new URLSearchParams({page:M.value,limit:10});Object.entries(Q).forEach(([a,m])=>{m&&m!=="all"&&!(Array.isArray(m)&&!m.length)&&d.append(a,m)});const c=await(await fetch(`/productions/batches?${d.toString()}`)).json();G.value=c.data||[],K.value=c.totalPages||1}catch(d){console.error("Failed to load batches:",d),G.value=[]}finally{E.value=!1}},dl=()=>{Object.assign(Q,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",team_leader:""}),ze()},nl=()=>{M.value=1,ze()},nt=async d=>{var e;try{const a=await(await fetch(`/productions/batches/${d.id}`)).json();C.value=a.batch,C.value.products=a.products||[],C.value.staff=((e=a.products.find(m=>m.staff.length))==null?void 0:e.staff)||[],de.value=!0}catch(c){console.error("Failed to load batch details:",c)}},il=async d=>{try{const c=await(await fetch(`/productions/batches/${d.id}`)).json();C.value=c.batch,j.batch_id=d.id,j.produced_at=Ke(new Date),j.notes="",j.products=c.products.map(a=>({production_id:a.production_id,product_id:a.product_id,product_name:a.product_name,planned_qty:a.qty_product,good_qty:a.good_qty||"",damaged_qty:a.damaged_qty||"",reject_qty:a.reject_qty||"",actual_qty:(a.good_qty||0)+(a.damaged_qty||0)+(a.reject_qty||0),hasDiscrepancy:parseFloat(a.good_qty)!==parseFloat(a.planned_qty),discrepancies:a.discrepancies||[]})),ue.value=!0}catch(e){console.error("Failed to load batch for actual production:",e)}},He=()=>{ue.value=!1,j.batch_id=null,j.produced_at=null,j.notes="",j.products=[]},ge=d=>{d.actual_qty=(Number(d.good_qty)||0)+(Number(d.damaged_qty)||0)+(Number(d.reject_qty)||0),d.hasDiscrepancy=d.good_qty!==d.planned_qty,d.hasDiscrepancy&&(!d.discrepancies||d.discrepancies.length===0)&&Qe(d)},Qe=d=>{d.discrepancies||(d.discrepancies=[]),d.discrepancies.push({reason_id:null,notes:""})},it=(d,e)=>{d.discrepancies&&d.discrepancies.splice(e,1)},De=L(()=>{const d={good_qty:0,damaged_qty:0,reject_qty:0,actual_qty:0};return j.products.forEach(e=>{d.good_qty+=Number(e.good_qty)||0,d.damaged_qty+=Number(e.damaged_qty)||0,d.reject_qty+=Number(e.reject_qty)||0,d.actual_qty+=Number(e.actual_qty)||0}),d}),rl=L(()=>{if(!j.produced_at||j.products.length===0)return!1;const d=j.products.every(c=>(Number(c.good_qty)||0)>=0&&(Number(c.damaged_qty)||0)>=0&&(Number(c.reject_qty)||0)>=0),e=j.products.every(c=>!c.hasDiscrepancy||c.discrepancies&&c.discrepancies.length>0&&c.discrepancies.every(a=>a.reason_id));return d&&e&&!q.value}),rt=async()=>{q.value=!0;try{const d={produced_at:Xe(j.produced_at),notes:j.notes,products:j.products.map(a=>({production_id:a.production_id,good_qty:Number(a.good_qty)||0,damaged_qty:Number(a.damaged_qty)||0,reject_qty:Number(a.reject_qty)||0,actual_qty:Number(a.actual_qty)||0,discrepancies:(a.discrepancies||[]).filter(m=>m.reason_id)}))},e=await fetch(`/productions/batches/${j.batch_id}/actual`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),c=await e.json();if(!e.ok){alert(c.message||"Failed to save actual production.");return}ue.value=!1,await ze(),He()}catch(d){console.error("Failed to save batch actual production:",d),alert("Failed to save actual production. Please try again.")}finally{q.value=!1}},ul=d=>{nt(d)},cl=async d=>{if(confirm(`Are you sure you want to delete batch ${d.batch_code}? This will also delete all productions in this batch.`))try{await fetch(`/productions/batches/${d.id}`,{method:"DELETE"}),await ze()}catch(e){console.error("Failed to delete batch:",e),alert("Failed to delete batch. Please try again.")}},ml=d=>{xt({id:d})},fl=L(()=>$.value?G.value.length:b.value.length),pl=L(()=>$.value?G.value.reduce((d,e)=>d+Number(e.total_good_qty||0),0):b.value.reduce((d,e)=>d+Number(e.qty_product||e.total_qty||0),0)),_l=L(()=>$.value?G.value.reduce((d,e)=>d+(e.staff?e.staff.length:0),0):b.value.reduce((d,e)=>d+Number(e.staff_count||0),0)),yl=L(()=>b.value.reduce((d,e)=>d+Number(e.total_pay||0),0).toFixed(2)),ut=L(()=>y.products.some(d=>(d.ingredients||[]).some(e=>e.exceeds))),ct=L(()=>{const d=y.staff.map(e=>{var c;return typeof e.staff_id=="object"?(c=e.staff_id)==null?void 0:c.id:e.staff_id}).filter(Boolean);return Pe.value.filter(e=>!d.includes(e.id))}),mt=L(()=>y.staff.filter(d=>d.staff_id).length),ft=L(()=>y.products.reduce((d,e)=>d+Number(e.computed_qty_product||0),0)),pt=L(()=>{const d=new Map;for(const e of y.products)for(const c of e.ingredients||[]){if(!c.item_id)continue;d.has(c.item_id)||d.set(c.item_id,{item_id:c.item_id,item_name:c.item_name,unit:c.unit,qty_required:0,available:c.available||0,exceeds:!1});const a=d.get(c.item_id);a.qty_required+=Number(c.qty_required||0),a.available=c.available||a.available||0}for(const e of d.values())e.qty_required=+e.qty_required.toFixed(3),e.exceeds=e.qty_required>(e.available||0);return Array.from(d.values()).sort((e,c)=>e.item_name.localeCompare(c.item_name))}),vl=L(()=>{if(!y.planned_at||!y.products.length)return!1;for(const c of y.products)if(!c.product_id||!c.mode||!c.computed_qty_product||c.computed_qty_product<=0||!c.ingredients||!c.ingredients.length)return!1;const d=y.staff.some(c=>c.staff_id),e=y.products.every(c=>(c.productGroups||[]).every(a=>!a.is_mandatory||c.group_choices[a.id]));return!(ut.value||!e||!d||q.value)});function Ce(d){return d?new Date(d).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}function Te(d){var e;return((e=qe.value.find(c=>c.id===d))==null?void 0:e.name)||"Product"}function gl(d){const e=Te(d.product_id);return d.product_id?d.computed_qty_product?`${e} • ${d.computed_qty_product} units`:e:"Select product & mode"}function bl(d,e){const c=Te(d.product_id);return`${e+1}. ${c}`}const Ye=N(!1);function xl(){const d=ft.value,e=Number(y.good_qty||0);Ye.value=!!(d&&e!==d),Ye.value&&!y.discrepancies.length&&Vl()}function Vl(){y.discrepancies.push({reason_id:null,notes:""})}function _t(){y.staff.push({staff_id:null,role:"",notes:""})}function wl(d){y.staff.splice(d,1)}function kl(){y.staff=[]}let hl=1;function yt(){return{uid:hl++,product_id:null,mode:"by_product",qty_product_input:null,base_ingredient_id:null,base_ingredient_qty:null,baseUnit:"",computed_qty_product:0,recipeItems:[],productGroups:[],group_choices:{},expandedGroups:[],ingredients:[],innerTab:"ingredients"}}function Je(){y.products.push(yt()),le.value==="summary"&&(le.value=0)}function ql(d){y.products.splice(d,1),typeof le.value=="number"&&le.value>=y.products.length&&(le.value=y.products.length?y.products.length-1:"summary")}async function vt(d){if(d.recipeItems=[],d.productGroups=[],d.group_choices={},d.expandedGroups=[],d.ingredients=[],d.base_ingredient_id=null,d.base_ingredient_qty=null,d.baseUnit="",d.computed_qty_product=0,!!d.product_id)try{const c=await(await fetch(`/products/${d.product_id}/groups`)).json();d.recipeItems=c.fixed_items||[],d.productGroups=c.groups||[],d.productGroups.forEach((a,m)=>{var r;const n=(r=a.combinations)==null?void 0:r.find(w=>w.is_default);n&&(d.group_choices[a.id]=n.id),d.expandedGroups.push(m)}),me(d)}catch(e){console.error("Failed to load product details:",e)}}function me(d){var a,m,n;if(!d.product_id||!d.mode){d.ingredients=[],d.computed_qty_product=0;return}let e=0;if(d.mode==="by_product")e=Number(d.qty_product_input||0);else if(d.mode==="by_ingredient"){const r=d.recipeItems.find(w=>w.item_id===Number(d.base_ingredient_id));d.baseUnit=(r==null?void 0:r.unit)||"",r&&r.quantity_per_unit>0&&d.base_ingredient_qty>0&&(e=Number(d.base_ingredient_qty)/r.quantity_per_unit)}if(!e||e<=0){d.ingredients=[],d.computed_qty_product=0;return}d.computed_qty_product=+e.toFixed(3);const c=[];for(const r of d.recipeItems){const w=((a=Ue.value.find(Y=>Y.item_id===r.item_id))==null?void 0:a.available_qty)||0,D=+(r.quantity_per_unit*e).toFixed(3);c.push({item_id:r.item_id,item_name:r.item_name,unit_id:r.unit_id,unit:r.unit,qty_required:D,available:+w,exceeds:D>w,from_group:!1,group_id:null,group_name:null,combination_id:null})}for(const r of d.productGroups){const w=d.group_choices[r.id];if(!w)continue;const D=(m=r.combinations)==null?void 0:m.find(Y=>Y.id===w);if(!(!D||!D.options))for(const Y of D.options){const fe=((n=Ue.value.find(Ne=>Ne.item_id===Y.item_id))==null?void 0:n.available_qty)||0,Se=+(Y.quantity_per_unit*e).toFixed(3);c.push({item_id:Y.item_id,item_name:Y.item_name,unit:Y.unit,qty_required:Se,available:+fe,exceeds:Se>fe,from_group:!0,group_id:r.id,group_name:r.name,combination_id:w})}}d.ingredients=c}function We(){te.value=!0,O.value=!1,ne.value=!1,T.value=!0,je(),Je(),_t()}function gt(){te.value=!1,Ye.value=!1,O.value=!1,ne.value=!1,je()}function je(){Object.assign(y,{id:null,planned_at:null,produced_at:null,notes:"",good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],staff:[],products:[]}),le.value=0}function Pl(){Object.assign(H,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),ve()}function zl(){M.value=1,ve()}async function Cl(){E.value=!0;try{const d=new URLSearchParams({page:M.value,limit:10});Object.entries(H).forEach(([a,m])=>{m&&m!=="all"&&!(Array.isArray(m)&&!m.length)&&d.append(a,m)});const c=await(await fetch(`/productions?${d.toString()}`)).json();b.value=c.data||[],K.value=c.totalPages||1}catch(d){console.error("Failed to load productions:",d),b.value=[]}finally{E.value=!1}}async function Sl(){try{const e=await(await fetch("/products?limit=1000&page=1")).json();qe.value=e.data||[]}catch(d){console.error("Failed to load products:",d)}}async function Al(){try{const e=await(await fetch("/staffs?status=Active&limit=1000&page=1")).json();Pe.value=e.data||[]}catch(d){console.error("Failed to load staff:",d)}}async function bt(){try{const d=await fetch("/items/availableStock");Ue.value=await d.json()}catch(d){console.error("Failed to load stock:",d)}}async function Il(){try{const e=await(await fetch("/productions/discrepancyReasons")).json();Oe.value=e.data||[]}catch(d){console.error("Failed to load discrepancy reasons:",d)}}async function xt(d){try{const e=await fetch(`/productions/${d.id}`);P.value=await e.json(),oe.value=!0}catch(e){console.error("Failed to load production details:",e)}}const Vt=d=>({"Team Leader":"blue",Assistant:"green",Support:"orange"})[d]||"grey",Ul=async d=>{O.value=!0,ne.value=!1,te.value=!0,T.value=!0,je();try{const e=await fetch(`/productions/batches/${d.id}`),c=await e.json();if(!e.ok)throw new Error(c.message||"Failed to load batch for editing.");y.id=c.batch.id,y.notes=c.batch.notes||"",y.planned_at=Ke(c.batch.planned_at),y.produced_at=Ke(c.batch.produced_at),y.products=[],(c.products||[]).forEach(a=>{const m=yt();m.production_id=a.production_id,m.product_id=a.product_id,m.product_name=a.product_name,m.planned_qty=a.qty_product||0,m.good_qty=a.good_qty||0,m.damaged_qty=a.damaged_qty||0,m.reject_qty=a.reject_qty||0,m.actual_qty=a.actual_qty||0,m.hasDiscrepancy=a.discrepancies.length>0,m.discrepancies=a.discrepancies||[],m.mode=a.mode||"by_product",y.staff=a.staff||[],m.mode==="by_product"?m.qty_product_input=Number(a.qty_product||0):(m.base_ingredient_id=a.base_ingredient_id||null,m.base_ingredient_qty=a.base_ingredient_qty||null),m.computed_qty_product=Number(a.qty_product||0)||0,y.products.push(m)}),y.products.length||Je();for(const a of c.products||[]){const m=y.products.find(r=>r.production_id===a.production_id)||y.products.find(r=>r.product_id===a.product_id);if(!m||!m.product_id)continue;await vt(m);const n=a.group_choices||[];n.length?n.forEach(r=>{r.group_id&&r.combination_id&&(m.group_choices[r.group_id]=r.combination_id)}):Array.isArray(a.ingredients)&&a.ingredients.forEach(r=>{r.group_id&&r.combination_id&&(m.group_choices[r.group_id]=r.combination_id)}),Array.isArray(a.ingredients)&&a.ingredients.length&&(m.ingredients=a.ingredients.map(r=>{var Y;const w=((Y=Ue.value.find(fe=>fe.item_id===r.item_id))==null?void 0:Y.available_qty)||0,D=Number(r.qty_required||r.quantity||0);return{item_id:r.item_id,item_name:r.item_name,unit:r.unit,qty_required:D,available:+w,exceeds:D>w,from_group:!!r.group_id,group_id:r.group_id||null,group_name:r.group_name||null,combination_id:r.combination_id||null}}))}le.value=y.products.length?0:"summary",xl()}catch(e){console.error("Failed to load batch for editing:",e),alert("Failed to load batch for editing."),te.value=!1}};async function wt(){q.value=!0;try{const d=y.products.map(r=>{const w=Object.entries(r.group_choices||{}).filter(([,D])=>D).map(([D,Y])=>({group_id:Number(D),combination_id:Y}));return{production_id:r.production_id||null,product_id:r.product_id,mode:r.mode,qty_product:r.computed_qty_product,good_qty:r.good_qty||0,damaged_qty:r.damaged_qty||0,reject_qty:r.reject_qty||0,actual_qty:r.actual_qty||0,discrepancies:r.discrepancies,base_ingredient_id:r.base_ingredient_id,base_ingredient_qty:r.base_ingredient_qty,ingredients:(r.ingredients||[]).map(D=>({item_id:D.item_id,qty_required:Number(D.qty_required||0),unit:D.unit,group_id:D.group_id||null,combination_id:D.combination_id||null})),group_choices:w}}),e={planned_at:Xe(y.planned_at),produced_at:y.produced_at?Xe(y.produced_at):null,notes:y.notes,products:d,staffs:y.staff.filter(r=>r.staff_id).map(r=>({staff_id:typeof r.staff_id=="object"?r.staff_id.id:r.staff_id,role:r.role||null,notes:r.notes||null}))},c=O.value?`/productions/${y.id}`:"/productions",a=O.value?"PUT":"POST",m=await fetch(c,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await m.json();if(!m.ok){n.error==="INSUFFICIENT_STOCK"?alert(`${n.message}
Available: ${n.details.available}
Required: ${n.details.required}`):alert(n.message||"Failed to save production.");return}te.value=!1,je(),await bt(),await ve()}catch(d){console.error("Failed to save production:",d),alert("Failed to save production. Please try again.")}finally{q.value=!1}}return oa(async()=>{await Promise.all([Al(),Sl(),ve(),Il(),bt()])}),(d,e)=>{const c=sa("VueDatePicker");return f(),g(da,{class:"production-container",fluid:""},{default:t(()=>[y.damaged_qty>0||y.reject_qty>0?(f(),g(re,{key:0,border:"start",class:"mt-2",type:"warning",variant:"tonal"},{default:t(()=>e[27]||(e[27]=[s(" Some quantities were marked as damaged or reject — please ensure they're tracked in the ledger. ")])),_:1})):z("",!0),l(v,{class:"mb-6",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-6"},{default:t(()=>[o("div",ha,[e[31]||(e[31]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Production Management "),o("p",{class:"text-body-1 text-grey"}," Manage production batches and individual productions ")],-1)),o("div",qa,[l(U,{class:"px-6",color:"primary",elevation:"2",size:"large",onClick:We},{default:t(()=>[l(u,{size:"20",start:""},{default:t(()=>e[28]||(e[28]=[s("mdi-plus-circle")])),_:1}),e[29]||(e[29]=s(" New Production "))]),_:1}),l(U,{class:"px-6",color:"secondary",elevation:"2",size:"large",onClick:sl},{default:t(()=>[l(u,{size:"20",start:""},{default:t(()=>e[30]||(e[30]=[s("mdi-view-grid")])),_:1}),s(" "+i($.value?"Show Individual":"Show Batches"),1)]),_:1})])])]),_:1})]),_:1}),l(B,{class:"mb-6"},{default:t(()=>[l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",Pa,[l(S,{class:"mr-3",color:"blue-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"blue",size:"24"},{default:t(()=>e[32]||(e[32]=[s("mdi-factory")])),_:1})]),_:1}),o("div",null,[o("div",za,i($.value?G.value.length:b.value.length),1),o("div",Ca,i($.value?"Total Batches":"Total Productions"),1)])])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",Sa,[l(S,{class:"mr-3",color:"green-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"green",size:"24"},{default:t(()=>e[33]||(e[33]=[s("mdi-account-group")])),_:1})]),_:1}),o("div",null,[o("div",Aa,i(_l.value),1),e[34]||(e[34]=o("div",{class:"text-caption text-grey"},"Staff Assignments",-1))])])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",Ia,[l(S,{class:"mr-3",color:"orange-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"orange",size:"24"},{default:t(()=>e[35]||(e[35]=[s("mdi-chart-line")])),_:1})]),_:1}),o("div",null,[o("div",Ua,i(pl.value),1),e[36]||(e[36]=o("div",{class:"text-caption text-grey"},"Total Units (Planned)",-1))])])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",Da,[l(S,{class:"mr-3",color:"purple-lighten-5",size:"48"},{default:t(()=>[l(u,{color:"purple",size:"24"},{default:t(()=>e[37]||(e[37]=[s("mdi-cash-multiple")])),_:1})]),_:1}),o("div",null,[o("div",Ta,i(yl.value),1),e[38]||(e[38]=o("div",{class:"text-caption text-grey"},"Labor Cost",-1))])])]),_:1})]),_:1})]),_:1})]),_:1}),$.value?(f(),g(v,{key:1,class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-0"},{default:t(()=>[o("div",ja,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[39]||(e[39]=[s("mdi-view-grid")])),_:1}),e[40]||(e[40]=o("h3",{class:"text-h6 font-weight-medium"},"Production Batches",-1))]),l(v,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",Na,[l(S,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[41]||(e[41]=[s("mdi-filter")])),_:1})]),_:1}),e[42]||(e[42]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Batch Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your batch records ")],-1)),l(ie),l(k,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[s(i(ol.value)+" Active ",1)]),_:1})]),l(pe,{class:"mb-6"}),l(B,{class:"align-start",dense:""},{default:t(()=>[l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",Ba,[l(u,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[43]||(e[43]=[s("mdi-package-variant")])),_:1}),e[44]||(e[44]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(ye,{modelValue:Q.product_id,"onUpdate:modelValue":e[0]||(e[0]=a=>Q.product_id=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:qe.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",Ea,[l(u,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[45]||(e[45]=[s("mdi-progress-clock")])),_:1}),e[46]||(e[46]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(ce,{modelValue:Q.status,"onUpdate:modelValue":e[1]||(e[1]=a=>Q.status=a),color:"primary",density:"compact","hide-details":"",items:Wt,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:m})=>[l(ae,Ct(St(m)),{prepend:t(()=>[l(u,{color:a.raw.color||"grey"},{default:t(()=>[s(i(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",$a,[l(u,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[s(i(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,i(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",Ra,[l(u,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[47]||(e[47]=[s("mdi-account-tie")])),_:1}),e[48]||(e[48]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(ye,{modelValue:Q.team_leader,"onUpdate:modelValue":e[2]||(e[2]=a=>Q.team_leader=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:Pe.value,placeholder:"All Leaders",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(v,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",Ma,[l(u,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[49]||(e[49]=[s("mdi-calendar-clock")])),_:1}),e[50]||(e[50]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(B,{class:"align-center",dense:""},{default:t(()=>[l(_,{cols:"12",sm:"4"},{default:t(()=>[l(ce,{modelValue:Q.planned_at_op,"onUpdate:modelValue":e[3]||(e[3]=a=>Q.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:at,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",sm:"4"},{default:t(()=>[l(c,{modelValue:Q.planned_at,"onUpdate:modelValue":e[4]||(e[4]=a=>Q.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),Q.planned_at_op==="in"?(f(),g(_,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(c,{modelValue:Q.planned_end,"onUpdate:modelValue":e[5]||(e[5]=a=>Q.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):z("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(pe,{class:"mt-4 mb-4"}),o("div",Fa,[o("div",Ga,[l(u,{class:"mr-1",size:"14"},{default:t(()=>e[51]||(e[51]=[s("mdi-information")])),_:1}),e[52]||(e[52]=s(" Use filters to find specific batch records "))]),o("div",La,[l(U,{class:"px-4",color:"grey",size:"small",variant:"outlined",onClick:dl},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[53]||(e[53]=[s("mdi-refresh")])),_:1}),e[54]||(e[54]=s(" Reset All "))]),_:1}),l(U,{class:"px-4",color:"primary",elevation:"2",size:"small",onClick:nl},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[55]||(e[55]=[s("mdi-filter-check")])),_:1}),e[56]||(e[56]=s(" Apply Filters "))]),_:1})])])]),_:1}),l(At,{active:E.value,color:"primary",height:"4",indeterminate:E.value},null,8,["active","indeterminate"]),l(xe,{class:"elevation-0",density:"comfortable",headers:Kt,hover:"",items:G.value,loading:E.value,search:Ie.value},{loading:t(()=>[l(Tt,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(k,{class:"font-weight-bold text-uppercase",color:st(a.status),size:"small",variant:"flat"},{default:t(()=>[s(i(dt(a.status)),1)]),_:2},1032,["color"])]),"item.batch_code":t(({item:a})=>[o("div",Oa,[l(S,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[57]||(e[57]=[s("mdi-package-variant")])),_:1})]),_:1}),o("div",null,[o("div",Ha,i(a.batch_code),1),o("div",Qa,i(a.total_products)+" products ",1)])])]),"item.production_stats":t(({item:a})=>[o("div",Ya,[l(k,{class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(a.total_good_qty||0)+" good ",1)]),_:2},1024),l(k,{class:"mr-1 mb-1",color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(a.total_damaged_qty||0)+" damaged ",1)]),_:2},1024),l(k,{class:"mb-1",color:"red",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(a.total_reject_qty||0)+" reject ",1)]),_:2},1024)])]),"item.planned_at":t(({item:a})=>[o("div",Ja,i(a.planned_at),1)]),"item.produced_at":t(({item:a})=>[o("div",Wa,i(a.produced_at||"Not completed"),1)]),"item.team_leader_name":t(({item:a})=>[o("div",Ka,[l(S,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(u,{color:"blue-grey",size:"14"},{default:t(()=>e[58]||(e[58]=[s("mdi-account-tie")])),_:1})]),_:1}),o("span",Xa,i(a.team_leader_name),1)])]),"item.actions":t(({item:a})=>[o("div",Za,[l(Dt,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:m})=>[l(U,Ve(m,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[l(u,null,{default:t(()=>e[59]||(e[59]=[s("mdi-dots-vertical")])),_:1})]),_:2},1040)]),default:t(()=>[l(v,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(x,{class:ee(["pa-4",tl(a.status)])},{default:t(()=>[o("div",eo,[o("div",to,[l(S,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"18"},{default:t(()=>e[60]||(e[60]=[s(" mdi-package-variant ")])),_:1})]),_:1}),o("div",null,[e[61]||(e[61]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Batch Actions ",-1)),o("div",lo,i(a.batch_code),1)])]),l(k,{color:"white",size:"small",variant:"flat"},{default:t(()=>[s(i(a.status),1)]),_:2},1024)])]),_:2},1032,["class"]),l(_e,{class:"pa-2",density:"compact"},{default:t(()=>[l(ae,{class:"rounded-lg mb-1 action-item",onClick:m=>nt(a)},{prepend:t(()=>[l(S,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"blue",size:"18"},{default:t(()=>e[62]||(e[62]=[s(" mdi-eye-outline ")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[63]||(e[63]=[s(" View Batch Details ")])),_:1}),l(X,{class:"text-caption text-blue"},{default:t(()=>e[64]||(e[64]=[s(" Complete batch information ")])),_:1})]),_:2},1032,["onClick"]),l(ae,{class:"rounded-lg mb-1 action-item",onClick:m=>il(a)},{prepend:t(()=>[l(S,{class:"mr-3",color:"green-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"green",size:"18"},{default:t(()=>e[65]||(e[65]=[s(" mdi-plus-circle ")])),_:1})]),_:1})]),default:t(()=>[a.produced_count>0?(f(),I(F,{key:0},[l(se,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[66]||(e[66]=[s(" Edit Actual Production ")])),_:1}),l(X,{class:"text-caption text-green"},{default:t(()=>e[67]||(e[67]=[s(" Edit Recorded output for all products ")])),_:1})],64)):(f(),I(F,{key:1},[l(se,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[68]||(e[68]=[s(" Add Actual Production ")])),_:1}),l(X,{class:"text-caption text-green"},{default:t(()=>e[69]||(e[69]=[s(" Record output for all products ")])),_:1})],64))]),_:2},1032,["onClick"]),l(ae,{class:"rounded-lg mb-1 action-item",onClick:m=>Ul(a)},{prepend:t(()=>[l(S,{class:"mr-3",color:"orange-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"orange",size:"18"},{default:t(()=>e[70]||(e[70]=[s(" mdi-pencil-outline ")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[71]||(e[71]=[s(" Edit Batch ")])),_:1}),l(X,{class:"text-caption text-orange"},{default:t(()=>e[72]||(e[72]=[s(" Modify batch products & staff ")])),_:1})]),_:2},1032,["onClick"]),l(ae,{class:"rounded-lg mb-1 action-item",onClick:m=>ul(a)},{prepend:t(()=>[l(S,{class:"mr-3",color:"purple-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"purple",size:"18"},{default:t(()=>e[73]||(e[73]=[s(" mdi-format-list-bulleted ")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[74]||(e[74]=[s(" View Products ")])),_:1}),l(X,{class:"text-caption text-purple"},{default:t(()=>e[75]||(e[75]=[s(" See all products in batch ")])),_:1})]),_:2},1032,["onClick"]),l(pe,{class:"my-2"}),l(ae,{class:"rounded-lg action-item text-error",onClick:m=>cl(a)},{prepend:t(()=>[l(S,{class:"mr-3",color:"red-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"red",size:"18"},{default:t(()=>e[76]||(e[76]=[s(" mdi-delete-outline ")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"text-body-2 font-weight-medium text-error"},{default:t(()=>e[77]||(e[77]=[s(" Delete Batch ")])),_:1}),l(X,{class:"text-caption text-red"},{default:t(()=>e[78]||(e[78]=[s(" Remove permanently ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",ao,[l(u,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[79]||(e[79]=[s(" mdi-inbox ")])),_:1}),e[82]||(e[82]=o("div",{class:"text-h6 text-grey"},"No batches found",-1)),e[83]||(e[83]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production batch ",-1)),l(U,{class:"mt-4",color:"primary",onClick:We},{default:t(()=>[l(u,{start:""},{default:t(()=>e[80]||(e[80]=[s("mdi-plus")])),_:1}),e[81]||(e[81]=s(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1})):(f(),g(v,{key:2,class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-0"},{default:t(()=>[o("div",oo,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[84]||(e[84]=[s("mdi-table")])),_:1}),e[85]||(e[85]=o("h3",{class:"text-h6 font-weight-medium"},"Production Records",-1))]),l(v,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",so,[l(S,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[86]||(e[86]=[s("mdi-filter")])),_:1})]),_:1}),e[87]||(e[87]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Production Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your production records ")],-1)),l(ie),l(k,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[s(i(al.value)+" Active ",1)]),_:1})]),l(pe,{class:"mb-6"}),l(B,{class:"align-start",dense:""},{default:t(()=>[l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",no,[l(u,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[88]||(e[88]=[s("mdi-package-variant")])),_:1}),e[89]||(e[89]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(ye,{modelValue:H.product_id,"onUpdate:modelValue":e[6]||(e[6]=a=>H.product_id=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:qe.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",io,[l(u,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[90]||(e[90]=[s("mdi-progress-clock")])),_:1}),e[91]||(e[91]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(ce,{modelValue:H.status,"onUpdate:modelValue":e[7]||(e[7]=a=>H.status=a),color:"primary",density:"compact","hide-details":"",items:Jt,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:m})=>[l(ae,Ct(St(m)),{prepend:t(()=>[l(u,{color:a.raw.color||"grey"},{default:t(()=>[s(i(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",ro,[l(u,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[s(i(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,i(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",uo,[l(u,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[92]||(e[92]=[s("mdi-account-tie")])),_:1}),e[93]||(e[93]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(ye,{modelValue:H.team_leader,"onUpdate:modelValue":e[8]||(e[8]=a=>H.team_leader=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:Pe.value,placeholder:"All Leaders",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(v,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",co,[l(u,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[94]||(e[94]=[s("mdi-calendar-clock")])),_:1}),e[95]||(e[95]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(B,{class:"align-center",dense:""},{default:t(()=>[l(_,{cols:"12",sm:"4"},{default:t(()=>[l(ce,{modelValue:H.planned_at_op,"onUpdate:modelValue":e[9]||(e[9]=a=>H.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:at,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12",sm:"4"},{default:t(()=>[l(c,{modelValue:H.planned_at,"onUpdate:modelValue":e[10]||(e[10]=a=>H.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),H.planned_at_op==="in"?(f(),g(_,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(c,{modelValue:H.planned_end,"onUpdate:modelValue":e[11]||(e[11]=a=>H.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):z("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(pe,{class:"mt-4 mb-4"}),o("div",mo,[o("div",fo,[l(u,{class:"mr-1",size:"14"},{default:t(()=>e[96]||(e[96]=[s("mdi-information")])),_:1}),e[97]||(e[97]=s(" Use filters to find specific production records "))]),o("div",po,[l(U,{class:"px-4",color:"grey",size:"small",variant:"outlined",onClick:Pl},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[98]||(e[98]=[s("mdi-refresh")])),_:1}),e[99]||(e[99]=s(" Reset All "))]),_:1}),l(U,{class:"px-4",color:"primary",elevation:"2",size:"small",onClick:zl},{default:t(()=>[l(u,{size:"18",start:""},{default:t(()=>e[100]||(e[100]=[s("mdi-filter-check")])),_:1}),e[101]||(e[101]=s(" Apply Filters "))]),_:1})])])]),_:1}),l(At,{active:E.value,color:"primary",height:"4",indeterminate:E.value},null,8,["active","indeterminate"]),l(xe,{class:"elevation-0",density:"comfortable",headers:Zt,hover:"",items:b.value,loading:E.value,search:Ie.value},{loading:t(()=>[l(Tt,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(k,{class:"font-weight-bold text-uppercase",color:a.produced_at?"green":"red",size:"small",variant:"flat"},{default:t(()=>[s(i(a.produced_at?"Completed":"Pending"),1)]),_:2},1032,["color"])]),"item.product_name":t(({item:a})=>[o("div",_o,[l(S,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[102]||(e[102]=[s("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",yo,i(a.product_name||a.batch_label),1),o("div",vo,i(a.mode||"Multiple Products"),1)])])]),"item.qty_product":t(({item:a})=>[l(k,{color:"green",size:"small",variant:"flat"},{default:t(()=>[l(u,{size:"16",start:""},{default:t(()=>e[103]||(e[103]=[s("mdi-counter")])),_:1}),s(" "+i(parseFloat(a.qty_product||a.total_qty||0)),1)]),_:2},1024)]),"item.staff_count":t(({item:a})=>[o("div",go,[l(S,{class:"mr-2",color:"blue-lighten-5",size:"28"},{default:t(()=>[l(u,{color:"blue",size:"14"},{default:t(()=>e[104]||(e[104]=[s("mdi-account-group")])),_:1})]),_:1}),o("span",bo,i(a.staff_count||0),1)])]),"item.planned_at":t(({item:a})=>[o("div",xo,i(a.planned_at),1)]),"item.produced_at":t(({item:a})=>[o("div",Vo,i(a.produced_at),1)]),"item.produced_by_name":t(({item:a})=>[o("div",wo,[l(S,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(u,{color:"blue-grey",size:"14"},{default:t(()=>e[105]||(e[105]=[s("mdi-account")])),_:1})]),_:1}),o("span",ko,i(a.produced_by_name),1)])]),"item.actions":t(({item:a})=>[o("div",ho,[l(Dt,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:m})=>[l(U,Ve(m,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[a.produced_at?(f(),g(u,{key:1},{default:t(()=>e[107]||(e[107]=[s("mdi-dots-vertical")])),_:1})):(f(),g(ca,{key:0,color:"orange",dot:"",location:"top end","offset-x":"2","offset-y":"2"},{default:t(()=>[l(u,null,{default:t(()=>e[106]||(e[106]=[s("mdi-dots-vertical")])),_:1})]),_:1}))]),_:2},1040)]),default:t(()=>[l(v,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(x,{class:ee(["pa-4",ll(a.produced_at?"completed":"pending")])},{default:t(()=>[o("div",qo,[o("div",Po,[l(S,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"18"},{default:t(()=>e[108]||(e[108]=[s(" mdi-factory ")])),_:1})]),_:1}),o("div",null,[e[109]||(e[109]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Production Actions ",-1)),o("div",zo,i(a.product_name||"Batch"),1)])]),l(k,{color:"white",size:"small",variant:"flat"},{default:t(()=>[s(i(a.produced_at?"completed":"pending"),1)]),_:2},1024)])]),_:2},1032,["class"]),l(_e,{class:"pa-2",density:"compact"},{default:t(()=>[l(ae,{class:"rounded-lg mb-1 action-item",onClick:m=>xt(a)},{prepend:t(()=>[l(S,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(u,{color:"blue",size:"18"},{default:t(()=>e[110]||(e[110]=[s(" mdi-eye-outline ")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[111]||(e[111]=[s(" View Details ")])),_:1}),l(X,{class:"text-caption text-blue"},{default:t(()=>e[112]||(e[112]=[s(" Complete information ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",Co,[l(u,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[113]||(e[113]=[s(" mdi-inbox ")])),_:1}),e[116]||(e[116]=o("div",{class:"text-h6 text-grey"},"No productions found",-1)),e[117]||(e[117]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production record ",-1)),l(U,{class:"mt-4",color:"primary",onClick:We},{default:t(()=>[l(u,{start:""},{default:t(()=>e[114]||(e[114]=[s("mdi-plus")])),_:1}),e[115]||(e[115]=s(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1})),l(v,{elevation:"2",rounded:"lg"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",So,[o("div",Ao," Showing "+i($.value?G.value.length:b.value.length)+" of "+i(fl.value)+" records ",1),l(ua,{modelValue:M.value,"onUpdate:modelValue":[e[12]||(e[12]=a=>M.value=a),ve],color:"primary",length:K.value,"total-visible":7},null,8,["modelValue","length"])])]),_:1})]),_:1}),l(Re,{modelValue:de.value,"onUpdate:modelValue":e[14]||(e[14]=a=>de.value=a),"max-width":"1200",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ee,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(S,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[118]||(e[118]=[s("mdi-package-variant")])),_:1})]),_:1}),l($e,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a;return[s(" Batch Details - "+i((a=C.value)==null?void 0:a.batch_code),1)]}),_:1}),l(ie),l(U,{color:"white",icon:"mdi-close",variant:"text",onClick:e[13]||(e[13]=a=>de.value=!1)})]),_:1}),l(x,{class:"pa-6"},{default:t(()=>{var a,m;return[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[l(B,null,{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>{var n;return[e[119]||(e[119]=o("div",{class:"text-body-2 text-grey"},"Batch Code",-1)),o("div",Io,i((n=C.value)==null?void 0:n.batch_code),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var n;return[e[120]||(e[120]=o("div",{class:"text-body-2 text-grey"},"Status",-1)),l(k,{class:"mt-1",color:st((n=C.value)==null?void 0:n.status),size:"small"},{default:t(()=>{var r;return[s(i(dt((r=C.value)==null?void 0:r.status)),1)]}),_:1},8,["color"])]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var n;return[e[121]||(e[121]=o("div",{class:"text-body-2 text-grey"},"Created By",-1)),o("div",Uo,i((n=C.value)==null?void 0:n.created_by_name),1)]}),_:1})]),_:1}),l(B,{class:"mt-2"},{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>{var n;return[e[122]||(e[122]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",Do,i((n=C.value)==null?void 0:n.planned_at),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var n;return[e[123]||(e[123]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",To,i(((n=C.value)==null?void 0:n.produced_at)||"Not completed"),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var n;return[e[124]||(e[124]=o("div",{class:"text-body-2 text-grey"},"Team Leader",-1)),o("div",jo,i((n=C.value)==null?void 0:n.team_leader_name),1)]}),_:1})]),_:1}),l(B,{class:"mt-4"},{default:t(()=>[l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var n;return[o("div",No,i(((n=C.value)==null?void 0:n.total_good_qty)||0),1),e[125]||(e[125]=o("div",{class:"text-caption text-grey"},"Good Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var n;return[o("div",Bo,i(((n=C.value)==null?void 0:n.total_damaged_qty)||0),1),e[126]||(e[126]=o("div",{class:"text-caption text-grey"},"Damaged",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var n;return[o("div",Eo,i(((n=C.value)==null?void 0:n.total_reject_qty)||0),1),e[127]||(e[127]=o("div",{class:"text-caption text-grey"},"Reject",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var n;return[o("div",$o,i(((n=C.value)==null?void 0:n.total_products)||0),1),e[128]||(e[128]=o("div",{class:"text-caption text-grey"},"Total Products",-1))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(v,{class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[129]||(e[129]=[s("mdi-format-list-bulleted")])),_:1}),e[130]||(e[130]=s(" Products in Batch "))]),_:1}),l(x,{class:"pa-0"},{default:t(()=>{var n;return[l(xe,{class:"elevation-0",headers:Xt,items:((n=C.value)==null?void 0:n.products)||[]},{"item.product_name":t(({item:r})=>[o("div",Ro,[l(S,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[131]||(e[131]=[s("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",Mo,i(r.product_name),1),o("div",Fo," Planned: "+i(r.qty_product)+" units ",1)])])]),"item.produced":t(({item:r})=>[l(k,{color:r.produced?"green":"orange",size:"small",variant:"flat"},{default:t(()=>[s(i(r.produced?"Produced":"Pending"),1)]),_:2},1032,["color"])]),"item.good_qty":t(({item:r})=>[r.produced?(f(),I("div",Go,[o("span",Lo,i(r.good_qty||0)+" good",1),o("span",Oo,i(r.damaged_qty||0)+" damaged",1),o("span",Ho,i(r.reject_qty||0)+" reject",1)])):(f(),I("span",Qo,"Not produced"))]),"item.actions":t(({item:r})=>[r.production_id?(f(),g(U,{key:0,color:"primary",size:"small",variant:"text",onClick:w=>ml(r.production_id)},{default:t(()=>[l(u,{size:"16"},{default:t(()=>e[132]||(e[132]=[s("mdi-eye")])),_:1}),e[133]||(e[133]=s(" View "))]),_:2},1032,["onClick"])):z("",!0)]),_:1},8,["items"])]}),_:1})]),_:1}),(m=(a=C.value)==null?void 0:a.staff)!=null&&m.length?(f(),g(v,{key:0,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"blue"},{default:t(()=>e[134]||(e[134]=[s("mdi-account-group")])),_:1}),e[135]||(e[135]=s(" Staff Assignments ")),l(k,{class:"ml-2",color:"blue",size:"small",variant:"flat"},{default:t(()=>[s(i(C.value.staff.length)+" staff ",1)]),_:1})]),_:1}),l(x,{class:"pa-0"},{default:t(()=>[l(_e,{class:"pa-0",lines:"two"},{default:t(()=>[(f(!0),I(F,null,Z(C.value.staff,(n,r)=>(f(),g(ae,{key:n.staff_id,class:ee(["px-4",{"bg-grey-lighten-4":r%2===0}])},{prepend:t(()=>[l(S,{class:"mr-3",color:"blue",size:"36"},{default:t(()=>[o("span",Yo,i(r+1),1)]),_:2},1024)]),default:t(()=>[l(se,{class:"font-weight-medium"},{default:t(()=>[s(i(n.staff_name)+" ",1),l(k,{class:"ml-2",color:Vt(n.role),size:"x-small",variant:"flat"},{default:t(()=>[s(i(n.role),1)]),_:2},1032,["color"])]),_:2},1024),l(X,{class:"mt-1"},{default:t(()=>[n.notes?(f(),I("span",Jo,i(n.notes),1)):(f(),I("span",Wo," No notes "))]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):z("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Re,{modelValue:ue.value,"onUpdate:modelValue":e[17]||(e[17]=a=>ue.value=a),"max-width":"1000",persistent:"",scrollable:""},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ee,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(S,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[136]||(e[136]=[s("mdi-plus-circle")])),_:1})]),_:1}),l($e,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a;return[s(" Add Actual Production - "+i((a=C.value)==null?void 0:a.batch_code),1)]}),_:1}),l(ie),l(U,{color:"white",icon:"mdi-close",variant:"text",onClick:He})]),_:1}),l(x,{class:"pa-6"},{default:t(()=>[l(jt,{onSubmit:It(rt,["prevent"])},{default:t(()=>[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Ko,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[137]||(e[137]=[s("mdi-calendar-clock")])),_:1}),e[138]||(e[138]=o("h4",{class:"text-h6 font-weight-medium"}," Production Information ",-1))]),l(B,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"6"},{default:t(()=>[o("div",Xo,[j.produced_at?(f(),I("span",Zo," Actual Production Date & Time ")):z("",!0),l(c,{modelValue:j.produced_at,"onUpdate:modelValue":e[15]||(e[15]=a=>j.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1}),l(_,{cols:"12",md:"6"},{default:t(()=>[l(J,{modelValue:j.notes,"onUpdate:modelValue":e[16]||(e[16]=a=>j.notes=a),color:"primary",label:"Production Notes (optional)","prepend-inner-icon":"mdi-note-text",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",es,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[139]||(e[139]=[s("mdi-scale-balance")])),_:1}),e[140]||(e[140]=o("h4",{class:"text-h6 font-weight-medium"}," Actual Production Quantities ",-1))]),j.products.some(a=>a.hasDiscrepancy)?(f(),g(re,{key:0,border:"start",class:"mb-4",type:"warning",variant:"tonal"},{default:t(()=>e[141]||(e[141]=[s(" Some products have discrepancies between planned and actual quantities. ")])),_:1})):z("",!0),(f(!0),I(F,null,Z(j.products,(a,m)=>(f(),g(v,{key:a.production_id,class:"mb-4",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",ts,[l(S,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"16"},{default:t(()=>e[142]||(e[142]=[s("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",ls,i(a.product_name),1),o("div",as," Planned: "+i(a.planned_qty)+" units ",1)]),l(ie),l(k,{color:a.hasDiscrepancy?"orange":"green",size:"small",variant:"flat"},{default:t(()=>[s(i(a.hasDiscrepancy?"Discrepancy":"On Track"),1)]),_:2},1032,["color"])]),l(B,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.good_qty,"onUpdate:modelValue":n=>a.good_qty=n,modelModifiers:{number:!0},color:"green",density:"compact",label:`Good Quantity (${a.planned_qty} planned)`,type:"number",variant:"outlined",onInput:n=>ge(a)},{"prepend-inner":t(()=>[l(u,{color:"green",size:"20"},{default:t(()=>e[143]||(e[143]=[s("mdi-check-decagram")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.damaged_qty,"onUpdate:modelValue":n=>a.damaged_qty=n,modelModifiers:{number:!0},color:"orange",density:"compact",label:"Damaged Quantity",type:"number",variant:"outlined",onInput:n=>ge(a)},{"prepend-inner":t(()=>[l(u,{color:"orange",size:"20"},{default:t(()=>e[144]||(e[144]=[s("mdi-alert-circle-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.reject_qty,"onUpdate:modelValue":n=>a.reject_qty=n,modelModifiers:{number:!0},color:"red",density:"compact",label:"Reject Quantity",type:"number",variant:"outlined",onInput:n=>ge(a)},{"prepend-inner":t(()=>[l(u,{color:"red",size:"20"},{default:t(()=>e[145]||(e[145]=[s("mdi-close-octagon-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.actual_qty,"onUpdate:modelValue":n=>a.actual_qty=n,modelModifiers:{number:!0},color:"primary",density:"compact",label:"Total Actual",readonly:"",type:"number",variant:"outlined"},{"prepend-inner":t(()=>[l(u,{color:"primary",size:"20"},{default:t(()=>e[146]||(e[146]=[s("mdi-counter")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a.hasDiscrepancy?(f(),I(F,{key:0},[l(pe,{class:"my-3"}),o("div",os,[l(k,{color:"orange",size:"small",variant:"flat"},{default:t(()=>[s(" Discrepancy: "+i(Math.abs(a.planned_qty-a.good_qty))+" units ",1)]),_:2},1024)]),(f(!0),I(F,null,Z(a.discrepancies,(n,r)=>(f(),g(B,{key:r,class:"align-center mb-2"},{default:t(()=>[l(_,{cols:"12",md:"5"},{default:t(()=>[l(ce,{modelValue:n.reason_id,"onUpdate:modelValue":w=>n.reason_id=w,density:"compact","item-title":"name","item-value":"id",items:Oe.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(_,{cols:"12",md:"5"},{default:t(()=>[l(J,{modelValue:n.notes,"onUpdate:modelValue":w=>n.notes=w,density:"compact",label:"Notes",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(_,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(U,{color:"error",icon:"",size:"small",variant:"text",onClick:w=>it(a,r)},{default:t(()=>[l(u,null,{default:t(()=>e[147]||(e[147]=[s("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(U,{color:"primary",size:"small",variant:"outlined",onClick:n=>Qe(a)},{default:t(()=>[l(u,{start:""},{default:t(()=>e[148]||(e[148]=[s("mdi-plus")])),_:1}),e[149]||(e[149]=s(" Add Reason "))]),_:2},1032,["onClick"])],64)):z("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(v,{class:"rounded-lg pa-4",variant:"outlined"},{default:t(()=>[o("div",ss,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[150]||(e[150]=[s("mdi-chart-box")])),_:1}),e[151]||(e[151]=o("h4",{class:"text-h6 font-weight-medium"},"Batch Summary",-1))]),l(B,null,{default:t(()=>[l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>[o("div",ds,i(De.value.good_qty),1),e[152]||(e[152]=o("div",{class:"text-caption text-grey"},"Total Good",-1))]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>[o("div",ns,i(De.value.damaged_qty),1),e[153]||(e[153]=o("div",{class:"text-caption text-grey"},"Total Damaged",-1))]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>[o("div",is,i(De.value.reject_qty),1),e[154]||(e[154]=o("div",{class:"text-caption text-grey"},"Total Reject",-1))]),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>[o("div",rs,i(De.value.actual_qty),1),e[155]||(e[155]=o("div",{class:"text-caption text-grey"},"Total Actual",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(Ut,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(ie),l(U,{class:"px-6",color:"grey",variant:"outlined",onClick:He},{default:t(()=>e[156]||(e[156]=[s(" Cancel ")])),_:1}),l(U,{class:"px-6",color:"success",disabled:!rl.value,elevation:"2",loading:q.value,onClick:rt},{default:t(()=>[l(u,{start:""},{default:t(()=>e[157]||(e[157]=[s("mdi-content-save-check")])),_:1}),e[158]||(e[158]=s(" Save Actual Production "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Re,{modelValue:te.value,"onUpdate:modelValue":e[24]||(e[24]=a=>te.value=a),"max-width":"1400",persistent:"",scrollable:""},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ee,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(S,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary",icon:O.value?"mdi-pencil":"mdi-plus"},null,8,["icon"])]),_:1}),l($e,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>[s(i(ne.value?"Add Actual Quantity":O.value?"Edit Production":"Create New Production (Multiple Products)"),1)]),_:1}),l(ie),l(U,{color:"white",icon:"mdi-close",variant:"text",onClick:gt})]),_:1}),l(x,{class:"pa-6"},{default:t(()=>[l(jt,{onSubmit:It(wt,["prevent"])},{default:t(()=>[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",us,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[159]||(e[159]=[s(" mdi-information ")])),_:1}),e[160]||(e[160]=o("h4",{class:"text-h6 font-weight-medium"},"Batch Information",-1))]),l(B,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>[o("div",cs,[y.planned_at?(f(),I("span",ms," Planned Production Date & Time ")):z("",!0),l(c,{modelValue:y.planned_at,"onUpdate:modelValue":e[18]||(e[18]=a=>y.planned_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Planned Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1}),O.value||ne.value?(f(),g(_,{key:0,cols:"12",md:"4"},{default:t(()=>[o("div",fs,[y.produced_at?(f(),I("span",ps," Actual Production Date & Time ")):z("",!0),l(c,{modelValue:y.produced_at,"onUpdate:modelValue":e[19]||(e[19]=a=>y.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1})):z("",!0),l(_,{cols:"12",md:"4"},{default:t(()=>[l(J,{modelValue:y.notes,"onUpdate:modelValue":e[20]||(e[20]=a=>y.notes=a),color:"primary",label:"Batch Notes (optional)","prepend-inner-icon":"mdi-note-text",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",_s,[o("div",ys,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[161]||(e[161]=[s(" mdi-package-variant ")])),_:1}),e[162]||(e[162]=o("h4",{class:"text-h6 font-weight-medium"}," Products in this Batch ",-1))]),l(U,{color:"primary",size:"small",variant:"outlined",onClick:Je},{default:t(()=>[l(u,{start:""},{default:t(()=>e[163]||(e[163]=[s("mdi-plus")])),_:1}),e[164]||(e[164]=s(" Add Product "))]),_:1})]),y.products.length?z("",!0):(f(),g(re,{key:0,border:"start",class:"mb-3",type:"info",variant:"tonal"},{default:t(()=>e[165]||(e[165]=[s(" Add one or more products to this production batch. Each product keeps its own mode and ingredients. ")])),_:1})),(f(!0),I(F,null,Z(y.products,(a,m)=>(f(),g(B,{key:a.uid,dense:""},{default:t(()=>[l(_,{cols:"12"},{default:t(()=>[l(v,{class:"mb-3",ripple:!1,variant:"outlined"},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",vs,[l(k,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[s(" Product #"+i(m+1),1)]),_:2},1024),o("span",gs,i(gl(a)),1),l(ie),y.products.length>1?(f(),g(U,{key:0,color:"error",icon:"",size:"x-small",variant:"text",onClick:n=>ql(m)},{default:t(()=>[l(u,null,{default:t(()=>e[166]||(e[166]=[s("mdi-close")])),_:1})]),_:2},1032,["onClick"])):z("",!0)]),l(B,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"5"},{default:t(()=>[l(ye,{modelValue:a.product_id,"onUpdate:modelValue":[n=>a.product_id=n,()=>vt(a)],clearable:"",density:"compact","item-title":"name","item-value":"id",items:qe.value,label:"Select Product","prepend-inner-icon":"mdi-package-variant",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(ce,{modelValue:a.mode,"onUpdate:modelValue":[n=>a.mode=n,()=>me(a)],density:"compact","item-title":"label","item-value":"value",items:Yt,label:"Production Mode","prepend-inner-icon":"mdi-cog",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a.mode==="by_product"?(f(),g(_,{key:0,cols:"12",md:"4"},{default:t(()=>[l(J,{modelValue:a.qty_product_input,"onUpdate:modelValue":n=>a.qty_product_input=n,modelModifiers:{number:!0},density:"compact",label:"Planned Units","prepend-inner-icon":"mdi-counter",type:"number",variant:"outlined",onInput:()=>me(a)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024)):a.mode==="by_ingredient"?(f(),I(F,{key:1},[l(_,{cols:"12",md:"4"},{default:t(()=>[l(ye,{modelValue:a.base_ingredient_id,"onUpdate:modelValue":[n=>a.base_ingredient_id=n,()=>me(a)],density:"compact",disabled:!a.recipeItems.length,"item-title":"item_name","item-value":"item_id",items:a.recipeItems,label:"Base Ingredient","prepend-inner-icon":"mdi-ingredient",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.base_ingredient_qty,"onUpdate:modelValue":n=>a.base_ingredient_qty=n,modelModifiers:{number:!0},density:"compact",disabled:!a.base_ingredient_id,label:`Base Qty (${a.baseUnit||"units"})`,"prepend-inner-icon":"mdi-weight",type:"number",variant:"outlined",onInput:()=>me(a)},null,8,["modelValue","onUpdate:modelValue","disabled","label","onInput"])]),_:2},1024),l(_,{class:"d-flex align-center",cols:"12",md:"1"},{default:t(()=>[a.computed_qty_product?(f(),g(k,{key:0,color:"blue",size:"small",variant:"flat"},{default:t(()=>[s(" Planned "+i(a.computed_qty_product)+" units ",1)]),_:2},1024)):z("",!0)]),_:2},1024)],64)):z("",!0),O.value||ne.value?(f(),g(x,{key:2,class:"pa-4"},{default:t(()=>[o("div",bs,[l(k,{color:a.hasDiscrepancy?"orange":"green",size:"small",variant:"flat"},{default:t(()=>[s(i(a.hasDiscrepancy?"Discrepancy: "+Math.abs(a.planned_qty-a.good_qty)+" units":"On Track"),1)]),_:2},1032,["color"])]),l(B,{dense:""},{default:t(()=>[l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.good_qty,"onUpdate:modelValue":n=>a.good_qty=n,modelModifiers:{number:!0},color:"green",density:"compact",label:`Good Quantity (${a.planned_qty} planned)`,type:"number",variant:"outlined",onInput:n=>ge(a)},{"prepend-inner":t(()=>[l(u,{color:"green",size:"20"},{default:t(()=>e[167]||(e[167]=[s("mdi-check-decagram")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.damaged_qty,"onUpdate:modelValue":n=>a.damaged_qty=n,modelModifiers:{number:!0},color:"orange",density:"compact",label:"Damaged Quantity",type:"number",variant:"outlined",onInput:n=>ge(a)},{"prepend-inner":t(()=>[l(u,{color:"orange",size:"20"},{default:t(()=>e[168]||(e[168]=[s("mdi-alert-circle-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.reject_qty,"onUpdate:modelValue":n=>a.reject_qty=n,modelModifiers:{number:!0},color:"red",density:"compact",label:"Reject Quantity",type:"number",variant:"outlined",onInput:n=>ge(a)},{"prepend-inner":t(()=>[l(u,{color:"red",size:"20"},{default:t(()=>e[169]||(e[169]=[s("mdi-close-octagon-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(_,{cols:"12",md:"3"},{default:t(()=>[l(J,{modelValue:a.actual_qty,"onUpdate:modelValue":n=>a.actual_qty=n,modelModifiers:{number:!0},color:"primary",density:"compact",label:"Total Actual",readonly:"",type:"number",variant:"outlined"},{"prepend-inner":t(()=>[l(u,{color:"primary",size:"20"},{default:t(()=>e[170]||(e[170]=[s("mdi-counter")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a.hasDiscrepancy?(f(),I(F,{key:0},[l(pe,{class:"my-3"}),(f(!0),I(F,null,Z(a.discrepancies,(n,r)=>(f(),g(B,{key:r,class:"align-center mb-2"},{default:t(()=>[l(_,{cols:"12",md:"5"},{default:t(()=>[l(ce,{modelValue:n.reason_id,"onUpdate:modelValue":w=>n.reason_id=w,density:"compact","item-title":"name","item-value":"id",items:Oe.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(_,{cols:"12",md:"5"},{default:t(()=>[l(J,{modelValue:n.notes,"onUpdate:modelValue":w=>n.notes=w,density:"compact",label:"Notes",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(_,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(U,{color:"error",icon:"",size:"small",variant:"text",onClick:w=>it(a,r)},{default:t(()=>[l(u,null,{default:t(()=>e[171]||(e[171]=[s("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(U,{color:"primary",size:"small",variant:"outlined",onClick:n=>Qe(a)},{default:t(()=>[l(u,{start:""},{default:t(()=>e[172]||(e[172]=[s("mdi-plus")])),_:1}),e[173]||(e[173]=s(" Add Reason "))]),_:2},1032,["onClick"])],64)):z("",!0)]),_:2},1024)):z("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),y.products.length?(f(),g(re,{key:1,border:"start",class:"mt-2",type:"success",variant:"tonal"},{default:t(()=>[e[174]||(e[174]=s(" Total planned units for this batch: ")),o("b",null,i(ft.value),1)]),_:1})):z("",!0)]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",xs,[o("div",Vs,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[175]||(e[175]=[s(" mdi-ingredient ")])),_:1}),e[176]||(e[176]=o("h4",{class:"text-h6 font-weight-medium"}," Ingredients & Groups ",-1))]),l(pa,{modelValue:T.value,"onUpdate:modelValue":e[21]||(e[21]=a=>T.value=a),color:"primary","hide-details":"",inset:"",label:T.value?"Editing Enabled":"Editing Disabled"},null,8,["modelValue","label"])]),ut.value?(f(),g(re,{key:0,border:"start",class:"mb-3",type:"error",variant:"tonal"},{default:t(()=>e[177]||(e[177]=[s(" Some ingredients exceed available stock. Please adjust quantities before saving. ")])),_:1})):z("",!0),l(Bt,{modelValue:le.value,"onUpdate:modelValue":e[22]||(e[22]=a=>le.value=a),"bg-color":"transparent",color:"primary",density:"comfortable","show-arrows":""},{default:t(()=>[(f(!0),I(F,null,Z(y.products,(a,m)=>(f(),g(Me,{key:a.uid,value:m},{default:t(()=>[s(i(bl(a,m)),1)]),_:2},1032,["value"]))),128)),y.products.length?(f(),g(Me,{key:0,value:"summary"},{default:t(()=>e[178]||(e[178]=[s(" All Ingredients Summary ")])),_:1})):z("",!0)]),_:1},8,["modelValue"]),l(Et,{modelValue:le.value,"onUpdate:modelValue":e[23]||(e[23]=a=>le.value=a),class:"mt-4"},{default:t(()=>[(f(!0),I(F,null,Z(y.products,(a,m)=>(f(),g(Fe,{key:`win-${a.uid}`,value:m},{default:t(()=>[l(Bt,{modelValue:a.innerTab,"onUpdate:modelValue":n=>a.innerTab=n,class:"mb-2",color:"primary",density:"compact"},{default:t(()=>[l(Me,{value:"ingredients"},{default:t(()=>e[179]||(e[179]=[s("Ingredients")])),_:1}),l(Me,{value:"groups"},{default:t(()=>e[180]||(e[180]=[s(" Ingredient Groups ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(Et,{modelValue:a.innerTab,"onUpdate:modelValue":n=>a.innerTab=n},{default:t(()=>[l(Fe,{value:"ingredients"},{default:t(()=>[l(xe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:ot,items:a.ingredients},{"item.item_name":t(({item:n})=>[o("div",ws,[n.from_group?(f(),g(u,{key:0,class:"mr-2",color:"purple",size:"16"},{default:t(()=>e[181]||(e[181]=[s(" mdi-cog ")])),_:1})):z("",!0),o("span",null,i(n.item_name),1),n.group_name?(f(),g(k,{key:1,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(n.group_name),1)]),_:2},1024)):z("",!0)])]),"item.qty_required":t(({item:n})=>[o("div",ks,[l(J,{modelValue:n.qty_required,"onUpdate:modelValue":r=>n.qty_required=r,modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",density:"compact",disabled:!T.value,error:n.exceeds,"error-messages":n.exceeds?["Exceeds available stock"]:[],"hide-details":"",inputmode:"none",spellcheck:"false",style:{"max-width":"140px"},type:"number",variant:"outlined",onInput:r=>n.exceeds=Number(n.qty_required)>Number(n.available||0)},{"append-inner":t(()=>[o("span",{class:ee(["text-caption",n.exceeds?"text-error":"text-grey"])},i(n.unit),3)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","error","error-messages","onInput"]),n.exceeds?(f(),g(_a,{key:0,location:"top",text:"Maximum available: "+(n.available||0)+" "+(n.unit||"")},{activator:t(({props:r})=>[l(U,Ve({ref_for:!0},r,{class:"ml-1",color:"orange",icon:"",size:"x-small",variant:"text",onClick:w=>{n.qty_required=n.available||0,n.exceeds=!1}}),{default:t(()=>[l(u,{size:"16"},{default:t(()=>e[182]||(e[182]=[s(" mdi-information-outline ")])),_:1})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):z("",!0)])]),"item.available":t(({item:n})=>[l(k,{class:"font-weight-medium",color:n.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[s(i(n.available||0)+" "+i(n.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:n})=>[l(k,{color:"blue-grey",size:"small",variant:"outlined"},{default:t(()=>[s(i(n.unit),1)]),_:2},1024)]),"no-data":t(()=>e[183]||(e[183]=[o("div",{class:"text-center py-4 text-grey"}," Configure this product (mode + quantity) to calculate ingredients ",-1)])),_:2},1032,["items"]),a.computed_qty_product?(f(),g(re,{key:0,border:"start",class:"mt-3",type:"success",variant:"tonal"},{default:t(()=>[e[184]||(e[184]=s(" Planned units for ")),o("b",null,i(Te(a.product_id)),1),e[185]||(e[185]=s(": ")),o("b",null,i(a.computed_qty_product),1),e[186]||(e[186]=s(". Ingredients above are specific to this product. "))]),_:2},1024)):z("",!0)]),_:2},1024),l(Fe,{value:"groups"},{default:t(()=>[a.productGroups&&a.productGroups.length?(f(),g(v,{key:0,class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(x,{class:"pa-4"},{default:t(()=>[o("div",hs,[l(u,{class:"mr-2",color:"purple"},{default:t(()=>e[187]||(e[187]=[s(" mdi-cog ")])),_:1}),o("h5",qs," Ingredient Groups for "+i(Te(a.product_id)),1),l(k,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[s(i(a.productGroups.length)+" groups ",1)]),_:2},1024)]),l(re,{class:"mb-4",type:"info",variant:"tonal"},{default:t(()=>e[188]||(e[188]=[s(" Select combinations per group to update ingredients for this product. ")])),_:1}),l(ba,{modelValue:a.expandedGroups,"onUpdate:modelValue":n=>a.expandedGroups=n,multiple:""},{default:t(()=>[(f(!0),I(F,null,Z(a.productGroups,(n,r)=>(f(),g(ya,{key:n.id,class:"mb-2"},{default:t(()=>[l(tt,{class:"font-weight-medium"},{default:t(()=>[o("div",Ps,[o("div",zs,[l(u,{class:"mr-2",color:"purple"},{default:t(()=>e[189]||(e[189]=[s(" mdi-cog ")])),_:1}),o("span",null,i(n.name),1),n.is_mandatory?(f(),g(k,{key:0,class:"ml-2",color:"red",size:"x-small",variant:"flat"},{default:t(()=>e[190]||(e[190]=[s(" Required ")])),_:1})):(f(),g(k,{key:1,class:"ml-2",color:"grey",size:"x-small",variant:"outlined"},{default:t(()=>e[191]||(e[191]=[s(" Optional ")])),_:1}))]),o("div",Cs,[l(k,{class:"mr-2",color:"blue",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(n.selection_mode),1)]),_:2},1024),a.group_choices[n.id]?(f(),g(k,{key:0,color:"green",size:"x-small",variant:"flat"},{default:t(()=>e[192]||(e[192]=[s(" Selected ")])),_:1})):(f(),g(k,{key:1,color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>e[193]||(e[193]=[s(" Not Selected ")])),_:1}))])])]),_:2},1024),l(et,null,{default:t(()=>[o("p",Ss,i(n.description),1),l(ka,{modelValue:a.group_choices[n.id],"onUpdate:modelValue":[w=>a.group_choices[n.id]=w,()=>me(a)],"hide-details":""},{default:t(()=>[l(B,null,{default:t(()=>[(f(!0),I(F,null,Z(n.combinations,w=>(f(),g(_,{key:w.id,cols:"12",md:"6"},{default:t(()=>[l(v,{class:ee(["combination-card",{selected:a.group_choices[n.id]===w.id}]),variant:"outlined",onClick:D=>{a.group_choices[n.id]=w.id,me(a)}},{default:t(()=>[l(x,{class:"pa-3"},{default:t(()=>[o("div",As,[l(Va,{"hide-details":"",value:w.id},null,8,["value"]),o("div",Is,[o("div",Us,i(w.name),1),w.notes?(f(),I("div",Ds,i(w.notes),1)):z("",!0),o("div",Ts,[(f(!0),I(F,null,Z(w.options,D=>(f(),g(k,{key:D.option_id,class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(D.item_name)+": "+i(D.quantity_per_unit)+" "+i(D.unit),1)]),_:2},1024))),128))])]),w.is_default?(f(),g(k,{key:0,color:"orange",size:"x-small",variant:"flat"},{default:t(()=>e[194]||(e[194]=[s(" Default ")])),_:1})):z("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):(f(),g(re,{key:1,border:"start",type:"info",variant:"tonal"},{default:t(()=>e[195]||(e[195]=[s(" No ingredient groups configured for this product. ")])),_:1}))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["value"]))),128)),l(Fe,{value:"summary"},{default:t(()=>[l(xe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:ot,items:pt.value},{"item.item_name":t(({item:a})=>[o("div",js,[l(S,{class:"mr-2",color:"primary",size:"22",variant:"tonal"},{default:t(()=>[l(u,{color:"primary",size:"14"},{default:t(()=>e[196]||(e[196]=[s(" mdi-ingredient ")])),_:1})]),_:1}),o("span",null,i(a.item_name),1)])]),"item.qty_required":t(({item:a})=>[l(k,{color:a.exceeds?"red":"green",size:"small",variant:"outlined"},{default:t(()=>[s(i(a.qty_required)+" "+i(a.unit),1)]),_:2},1032,["color"])]),"item.available":t(({item:a})=>[l(k,{color:a.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[s(i(a.available||0)+" "+i(a.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:a})=>[o("span",null,i(a.unit),1)]),"no-data":t(()=>e[197]||(e[197]=[o("div",{class:"text-center py-4 text-grey"}," Add products and configure ingredients to see a consolidated summary. ",-1)])),_:1},8,["items"]),pt.value.length?(f(),g(re,{key:0,border:"start",class:"mt-3",type:"success",variant:"tonal"},{default:t(()=>e[198]||(e[198]=[s(" Consolidated ingredient requirements across all products in this batch. ")])),_:1})):z("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Ns,[o("div",Bs,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[199]||(e[199]=[s(" mdi-account-group ")])),_:1}),e[200]||(e[200]=o("h4",{class:"text-h6 font-weight-medium"},"Staff Assignment",-1))]),o("div",Es,[l(U,{color:"primary",disabled:!ct.value.length,size:"small",variant:"outlined",onClick:_t},{default:t(()=>[l(u,{start:""},{default:t(()=>e[201]||(e[201]=[s("mdi-account-plus")])),_:1}),e[202]||(e[202]=s(" Add Staff "))]),_:1},8,["disabled"]),l(U,{color:"secondary",disabled:!y.staff.length,size:"small",variant:"outlined",onClick:kl},{default:t(()=>[l(u,{start:""},{default:t(()=>e[203]||(e[203]=[s("mdi-account-remove")])),_:1}),e[204]||(e[204]=s(" Clear All "))]),_:1},8,["disabled"])])]),l(xe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:el,items:y.staff},{"item.staff_id":t(({item:a})=>[l(ye,{modelValue:a.staff_id,"onUpdate:modelValue":m=>a.staff_id=m,density:"compact",disabled:!T.value,"hide-details":"","item-title":"name","item-value":"id",items:Pe.value,placeholder:"Select Staff",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),"item.role":t(({item:a})=>[l(ce,{modelValue:a.role,"onUpdate:modelValue":m=>a.role=m,density:"compact",disabled:!T.value,"hide-details":"",items:["Team Leader","Assistant","Support"],"prepend-inner-icon":"mdi-account-tie",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":t(({item:a})=>[l(J,{modelValue:a.notes,"onUpdate:modelValue":m=>a.notes=m,density:"compact",disabled:!T.value,"hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.actions":t(({index:a})=>[l(U,{color:"error",disabled:!T.value,icon:"",size:"small",variant:"text",onClick:m=>wl(a)},{default:t(()=>[l(u,null,{default:t(()=>e[205]||(e[205]=[s("mdi-delete")])),_:1})]),_:2},1032,["disabled","onClick"])]),"no-data":t(()=>e[206]||(e[206]=[o("div",{class:"text-center py-4 text-grey"},' No staff assigned. Click "Add Staff" to assign team members. ',-1)])),_:1},8,["items"]),y.staff.length?(f(),g(re,{key:0,border:"start",class:"mt-4",type:"info",variant:"tonal"},{default:t(()=>[o("div",$s,[o("div",null,[e[207]||(e[207]=o("strong",null,"Team Summary:",-1)),l(k,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[s(i(y.staff.length)+" staff members ",1)]),_:1})]),o("div",Rs,i(mt.value)+" of "+i(ct.value.length+mt.value)+" staff assigned ",1)])]),_:1})):z("",!0)]),_:1})]),_:1})]),_:1}),l(Ut,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(ie),l(U,{class:"px-6",color:"grey",variant:"outlined",onClick:gt},{default:t(()=>e[208]||(e[208]=[s(" Cancel ")])),_:1}),l(U,{class:"px-6",color:"success",disabled:!vl.value,elevation:"2",loading:q.value,onClick:wt},{default:t(()=>[l(u,{start:""},{default:t(()=>e[209]||(e[209]=[s("mdi-content-save-check")])),_:1}),s(" "+i(O.value?"Update Production":"Create Production"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Re,{modelValue:oe.value,"onUpdate:modelValue":e[26]||(e[26]=a=>oe.value=a),"max-width":"1000",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(Ee,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(S,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(u,{color:"primary"},{default:t(()=>e[210]||(e[210]=[s("mdi-eye")])),_:1})]),_:1}),l($e,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a,m;return[s(" Production Details - "+i((m=(a=P.value)==null?void 0:a.production)==null?void 0:m.product_name),1)]}),_:1}),l(ie),l(U,{color:"white",icon:"mdi-close",variant:"text",onClick:e[25]||(e[25]=a=>oe.value=!1)})]),_:1}),l(x,{class:"pa-6"},{default:t(()=>{var a,m,n,r,w,D,Y,fe,Se,Ne,kt,ht,qt,Pt;return[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>{var A,R;return[o("div",Ms,[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[211]||(e[211]=[s("mdi-information")])),_:1}),e[212]||(e[212]=o("h4",{class:"text-h6 font-weight-medium"},"Production Information",-1))]),l(B,null,{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[213]||(e[213]=o("div",{class:"text-body-2 text-grey"},"Production ID",-1)),o("div",Fs," #"+i((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.id),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[214]||(e[214]=o("div",{class:"text-body-2 text-grey"},"Product",-1)),o("div",Gs,i((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.product_name),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[215]||(e[215]=o("div",{class:"text-body-2 text-grey"},"Production Mode",-1)),o("div",Ls,i((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.mode),1)]}),_:1})]),_:1}),l(B,{class:"mt-2"},{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[216]||(e[216]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",Os,i(Ce((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.planned_at)),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[217]||(e[217]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",Hs,i(Ce((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.produced_at)),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[218]||(e[218]=o("div",{class:"text-body-2 text-grey"},"Produced By",-1)),o("div",Qs,i((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.produced_by_name),1)]}),_:1})]),_:1}),l(B,{class:"mt-2"},{default:t(()=>[l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[219]||(e[219]=o("div",{class:"text-body-2 text-grey"},"Created",-1)),o("div",Ys,i(Ce((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.created)),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[220]||(e[220]=o("div",{class:"text-body-2 text-grey"},"Last Updated",-1)),o("div",Js,i(Ce((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.updated_at)),1)]}),_:1}),l(_,{cols:"12",md:"4"},{default:t(()=>{var V,h;return[e[221]||(e[221]=o("div",{class:"text-body-2 text-grey"},"Batch ID",-1)),o("div",Ws,i(((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.batch_id)||"N/A"),1)]}),_:1})]),_:1}),l(B,{class:"mt-4"},{default:t(()=>[l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var V,h;return[o("div",Ks,i((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.qty_product),1),e[222]||(e[222]=o("div",{class:"text-caption text-grey"},"Planned Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var V,h;return[o("div",Xs,i((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.actual_qty),1),e[223]||(e[223]=o("div",{class:"text-caption text-grey"},"Actual Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"2"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var V,h;return[o("div",Zs,i(((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.good_qty)||0),1),e[224]||(e[224]=o("div",{class:"text-caption text-grey"},"Good",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"2"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var V,h;return[o("div",ed,i(((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.damaged_qty)||0),1),e[225]||(e[225]=o("div",{class:"text-caption text-grey"},"Damaged",-1))]}),_:1})]),_:1})]),_:1}),l(_,{cols:"12",md:"2"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(x,null,{default:t(()=>{var V,h;return[o("div",td,i(((h=(V=P.value)==null?void 0:V.production)==null?void 0:h.reject_qty)||0),1),e[226]||(e[226]=o("div",{class:"text-caption text-grey"},"Reject",-1))]}),_:1})]),_:1})]),_:1})]),_:1}),(R=(A=P.value)==null?void 0:A.production)!=null&&R.notes?(f(),g(B,{key:0,class:"mt-4"},{default:t(()=>[l(_,{cols:"12"},{default:t(()=>[e[227]||(e[227]=o("div",{class:"text-body-2 text-grey"},"Notes",-1)),o("div",ld,i(P.value.production.notes),1)]),_:1})]),_:1})):z("",!0)]}),_:1}),l(v,{class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"primary"},{default:t(()=>e[228]||(e[228]=[s("mdi-ingredient")])),_:1}),e[229]||(e[229]=s(" Ingredients Used ")),l(k,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>{var A,R;return[s(i(((R=(A=P.value)==null?void 0:A.items)==null?void 0:R.length)||0)+" items ",1)]}),_:1})]),_:1}),l(x,{class:"pa-0"},{default:t(()=>[l(_e,{class:"pa-0",lines:"two"},{default:t(()=>{var A;return[(f(!0),I(F,null,Z(((A=P.value)==null?void 0:A.items)||[],(R,V)=>(f(),g(ae,{key:R.id,class:ee(["px-4",{"bg-grey-lighten-4":V%2===0}])},{prepend:t(()=>[l(S,{class:"mr-3",color:"primary",size:"36"},{default:t(()=>[o("span",ad,i(V+1),1)]),_:2},1024)]),default:t(()=>[l(se,{class:"font-weight-medium"},{default:t(()=>[s(i(R.item_name)+" ",1),R.group_name?(f(),g(k,{key:0,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(R.group_name),1)]),_:2},1024)):z("",!0),R.combination_name?(f(),g(k,{key:1,class:"ml-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[s(i(R.combination_name),1)]),_:2},1024)):z("",!0)]),_:2},1024),l(X,{class:"mt-1"},{default:t(()=>[l(k,{class:"mr-2",color:"primary",size:"small",variant:"outlined"},{default:t(()=>[s(i(R.qty_required)+" "+i(R.unit||""),1)]),_:2},1024),o("span",od," Item ID: "+i(R.item_id),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]}),_:1})]),_:1})]),_:1}),(m=(a=P.value)==null?void 0:a.group_choices)!=null&&m.length?(f(),g(v,{key:0,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"purple"},{default:t(()=>e[230]||(e[230]=[s("mdi-cog")])),_:1}),e[231]||(e[231]=s(" Ingredient Group Choices ")),l(k,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[s(i(P.value.group_choices.length)+" groups ",1)]),_:1})]),_:1}),l(x,{class:"pa-0"},{default:t(()=>[l(_e,{class:"pa-0",lines:"two"},{default:t(()=>[(f(!0),I(F,null,Z(P.value.group_choices,(A,R)=>(f(),g(ae,{key:A.id,class:ee(["px-4",{"bg-grey-lighten-4":R%2===0}])},{prepend:t(()=>[l(S,{class:"mr-3",color:"purple",size:"36"},{default:t(()=>[l(u,{color:"white",size:"18"},{default:t(()=>e[232]||(e[232]=[s("mdi-cog")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"font-weight-medium"},{default:t(()=>[s(i(A.group_name),1)]),_:2},1024),l(X,{class:"mt-1"},{default:t(()=>[l(k,{color:"green",size:"small",variant:"outlined"},{default:t(()=>[s(i(A.combination_name),1)]),_:2},1024),A.chosen_by_name?(f(),I("span",sd," Chosen by: "+i(A.chosen_by_name),1)):z("",!0),o("span",dd," Created: "+i(Ce(A.created_at)),1)]),_:2},1024),A.notes?(f(),g(X,{key:0,class:"mt-1 text-caption"},{default:t(()=>[e[233]||(e[233]=o("strong",null,"Notes:",-1)),s(" "+i(A.notes),1)]),_:2},1024)):z("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):z("",!0),(r=(n=P.value)==null?void 0:n.staff)!=null&&r.length?(f(),g(v,{key:1,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"blue"},{default:t(()=>e[234]||(e[234]=[s("mdi-account-group")])),_:1}),e[235]||(e[235]=s(" Staff Assignments ")),l(k,{class:"ml-2",color:"blue",size:"small",variant:"flat"},{default:t(()=>[s(i(P.value.staff.length)+" staff ",1)]),_:1})]),_:1}),l(x,{class:"pa-0"},{default:t(()=>[l(_e,{class:"pa-0",lines:"two"},{default:t(()=>[(f(!0),I(F,null,Z(P.value.staff,(A,R)=>(f(),g(ae,{key:A.staff_id,class:ee(["px-4",{"bg-grey-lighten-4":R%2===0}])},{prepend:t(()=>[l(S,{class:"mr-3",color:"blue",size:"36"},{default:t(()=>[o("span",nd,i(R+1),1)]),_:2},1024)]),default:t(()=>[l(se,{class:"font-weight-medium"},{default:t(()=>[s(i(A.staff_name)+" ",1),l(k,{class:"ml-2",color:Vt(A.role),size:"x-small",variant:"flat"},{default:t(()=>[s(i(A.role),1)]),_:2},1032,["color"])]),_:2},1024),l(X,{class:"mt-1"},{default:t(()=>[A.notes?(f(),I("span",id,i(A.notes),1)):(f(),I("span",rd," No notes "))]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):z("",!0),(D=(w=P.value)==null?void 0:w.discrepancies)!=null&&D.length?(f(),g(v,{key:2,class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(be,{class:"d-flex align-center"},{default:t(()=>[l(u,{class:"mr-2",color:"orange"},{default:t(()=>e[236]||(e[236]=[s("mdi-alert-circle")])),_:1}),e[237]||(e[237]=s(" Discrepancies ")),l(k,{class:"ml-2",color:"orange",size:"small",variant:"flat"},{default:t(()=>[s(i(P.value.discrepancies.length)+" issues ",1)]),_:1})]),_:1}),l(x,{class:"pa-0"},{default:t(()=>[l(_e,{class:"pa-0",lines:"two"},{default:t(()=>[(f(!0),I(F,null,Z(P.value.discrepancies,(A,R)=>(f(),g(ae,{key:A.id,class:ee(["px-4",{"bg-grey-lighten-4":R%2===0}])},{prepend:t(()=>[l(S,{class:"mr-3",color:"orange",size:"36"},{default:t(()=>[l(u,{color:"white",size:"18"},{default:t(()=>e[238]||(e[238]=[s("mdi-alert")])),_:1})]),_:1})]),default:t(()=>[l(se,{class:"font-weight-medium"},{default:t(()=>[s(i(A.reason_name),1)]),_:2},1024),l(X,{class:"mt-1"},{default:t(()=>[o("span",ud," Reason ID: "+i(A.reason_id),1)]),_:2},1024),A.notes?(f(),g(X,{key:0,class:"mt-1 text-caption"},{default:t(()=>[e[239]||(e[239]=o("strong",null,"Notes:",-1)),s(" "+i(A.notes),1)]),_:2},1024)):z("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):z("",!0),!((fe=(Y=P.value)==null?void 0:Y.items)!=null&&fe.length)&&!((Ne=(Se=P.value)==null?void 0:Se.staff)!=null&&Ne.length)&&!((ht=(kt=P.value)==null?void 0:kt.group_choices)!=null&&ht.length)&&!((Pt=(qt=P.value)==null?void 0:qt.discrepancies)!=null&&Pt.length)?(f(),g(v,{key:3,class:"rounded-lg text-center py-8",variant:"outlined"},{default:t(()=>[l(u,{class:"mb-2",color:"grey",size:"48"},{default:t(()=>e[240]||(e[240]=[s("mdi-information-outline")])),_:1}),e[241]||(e[241]=o("div",{class:"text-h6 text-grey"},"No Additional Data",-1)),e[242]||(e[242]=o("div",{class:"text-body-2 text-grey mt-2"}," This production record doesn't have any additional items, staff, or discrepancies. ",-1))]),_:1})):z("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Id=aa(cd,[["__scopeId","data-v-26e15cde"]]);export{Id as default};
