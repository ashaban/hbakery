import{_ as L,s as E,v as I,x as l,i as a,y as v,a3 as p,B as f,C as n,D as j,H as m,a5 as S,I as H,$,af as G,aM as K,a1 as Q,r as g,a0 as R,l as W}from"./index-BEY1_AxZ.js";import{u as X,r as F}from"./index-BpVqu971.js";import{V as B}from"./VDialog-BZVGdgk4.js";import{V as C,b as U,c as Y}from"./VCard-BWg2kNvx.js";import{V as M}from"./VForm-DWJZ0vFn.js";import{V as y}from"./VTextField-CUtfiNtd.js";import{a as Z}from"./VDataTable-XrgRokO0.js";import{V as _}from"./VContainer-4YzK1OXF.js";import"./dialog-transition-CW_75ERn.js";import"./VChip-B31zWpvD.js";import"./VSlideGroup-BBNvX3-_.js";const ee={setup(){const s=Q(),e=g(!1),x=g([]),t=g({}),h=g([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Short Name",key:"shortname"},{title:"Edit",key:"edit"}]),V=g(!1),o=g(!1),w=g(!1),N=g(!1),u=R({name:"",shortname:""}),c=X({name:{required:F},shortname:{required:F}},u);function D(){e.value=!0,fetch("/units").then(d=>{d.json().then(r=>{e.value=!1,x.value=r}).catch(()=>{e.value=!1})}).catch(()=>{e.value=!1})}function A(){c.value.name.$touch(),V.value=!0,u.name=""}function T(d){t.value=JSON.parse(JSON.stringify(d)),o.value=!0,u.name=d.name,u.shortname=d.shortname}async function q(){if(c.value.$touch(),!await c.value.$validate())return;e.value=!0,V.value=!1;const r=new FormData;r.append("name",u.name),r.append("shortname",u.shortname),fetch("/units",{body:r,method:"POST"}).then(i=>{e.value=!1,i.status!==200&&i.status!==201?i.json().then(b=>{s.commit("setMessage",{type:"error",text:"Failed to save Unit! "+b.error,timeout:2e3})}):i.json().then(()=>{D(),s.commit("setMessage",{type:"primary",text:"Unit saved successfully!",timeout:2e3})})}).catch(i=>{e.value=!1,s.commit("setMessage",{type:"error",text:"Failed to save Unit!",timeout:2e3}),console.error("Error:",i)})}async function z(){if(c.value.$touch(),!await c.value.$validate())return;e.value=!0;const r=new FormData;r.append("name",u.name),r.append("shortname",u.shortname),fetch("/units/"+t.value.id,{body:r,method:"PUT"}).then(i=>{e.value=!1,o.value=!1,i.status!==200&&i.status!==201?i.json().then(b=>{s.commit("setMessage",{type:"error",text:"Failed to edit Unit! "+b.error,timeout:2e3})}):i.json().then(()=>{D(),s.commit("setMessage",{type:"primary",text:"Unit edited successfully!",timeout:2e3})})}).catch(i=>{e.value=!1,s.commit("setMessage",{type:"error",text:"Failed to edit Unit!",timeout:2e3}),console.error("Error:",i)})}function P(){e.value=!0;const d=new FormData;w.value=!1,fetch("/units/"+t.value.id,{body:d,method:"DELETE"}).then(r=>{e.value=!1,o.value=!1,r.status!==200&&r.status!==201?r.json().then(i=>{s.commit("setMessage",{type:"error",text:"Failed to delete Unit! "+i.error,timeout:2e3})}):r.json().then(()=>{D(),s.commit("setMessage",{type:"primary",text:"Unit delete successfully!",timeout:2e3})})}).catch(r=>{e.value=!1,s.commit("setMessage",{type:"error",text:"Failed to delete Unit!",timeout:2e3}),console.error("Error:",r)})}function O(){fetch("/units?response=csv").then(d=>{d.text().then(r=>{const i="csv",J="data:text/csv;charset=utf-8,"+escape(r),k=document.createElement("a");k.setAttribute("href",J),k.setAttribute("download",`Unit.${i}`),k.click()})}).catch(()=>{e.value=!1})}return W(()=>{D()}),{loading:e,values:x,headers:h,addDialog:V,editDialog:o,form:N,state:u,v$:c,editingItem:t,confirmDeleteDialog:w,csvExport:O,loadValues:D,activateAddDialog:A,activateEditDialog:T,create:q,saveEdit:z,remove:P}}},te={class:"d-flex align-center flex-wrap"},ae={class:"d-flex justify-end"},oe={class:"d-flex align-center flex-wrap"},le={class:"d-flex justify-end justify-space-between"},ne={class:"d-flex justify-space-between mb-6"};function re(s,e,x,t,h,V){return I(),E(_,{fluid:""},{default:l(()=>[a(B,{modelValue:t.addDialog,"onUpdate:modelValue":e[4]||(e[4]=o=>t.addDialog=o),transition:"dialog-top-transition",width:"600"},{default:l(()=>[a(C,{class:"rounded-xl pa-4",elevation:"10"},{default:l(()=>[a(p,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:l(()=>[v("div",te,[a(f,{class:"mr-2 text-white"},{default:l(()=>e[16]||(e[16]=[n("mdi-map")])),_:1}),e[17]||(e[17]=v("span",{class:"text-white font-weight-bold text-h6"},"Add Unit",-1))]),a(j),a(m,{color:"white",icon:"mdi-close",onClick:e[0]||(e[0]=o=>t.addDialog=!1)})]),_:1}),a(U,{class:"pt-6"},{default:l(()=>[a(M,{onSubmit:e[3]||(e[3]=S(()=>{},["prevent"]))},{default:l(()=>[a(y,{modelValue:t.state.name,"onUpdate:modelValue":e[1]||(e[1]=o=>t.state.name=o),"bg-color":"#BDBDBD","error-messages":t.v$.name.$errors.map(o=>o.$message),label:"Unit Name",required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"]),a(y,{modelValue:t.state.shortname,"onUpdate:modelValue":e[2]||(e[2]=o=>t.state.shortname=o),"bg-color":"#BDBDBD","error-messages":t.v$.shortname.$errors.map(o=>o.$message),label:"Short Name",required:"",onBlur:t.v$.shortname.$touch,onInput:t.v$.shortname.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),v("div",ae,[a(m,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.create},{default:l(()=>[a(f,{start:""},{default:l(()=>e[18]||(e[18]=[n("mdi-plus")])),_:1}),e[19]||(e[19]=n(" Add "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:t.editDialog,"onUpdate:modelValue":e[12]||(e[12]=o=>t.editDialog=o),transition:"dialog-top-transition",width:"400"},{default:l(()=>[a(C,{class:"rounded-xl pa-4",elevation:"10"},{default:l(()=>[a(p,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:l(()=>[v("div",oe,[a(f,{class:"mr-2 text-white"},{default:l(()=>e[20]||(e[20]=[n("mdi-map")])),_:1}),e[21]||(e[21]=v("span",{class:"text-white font-weight-bold text-h6"},"Edit Unit",-1))]),a(j),a(m,{color:"white",icon:"mdi-close",onClick:e[5]||(e[5]=o=>t.editDialog=!1)})]),_:1}),a(U,{class:"pt-6"},{default:l(()=>[a(M,{onSubmit:e[9]||(e[9]=S(()=>{},["prevent"]))},{default:l(()=>[e[22]||(e[22]=v("br",null,null,-1)),a(y,{modelValue:t.editingItem.id,"onUpdate:modelValue":e[6]||(e[6]=o=>t.editingItem.id=o),"bg-color":"#BDBDBD",label:"ID",readonly:""},null,8,["modelValue"]),a(y,{modelValue:t.state.name,"onUpdate:modelValue":e[7]||(e[7]=o=>t.state.name=o),"bg-color":"#BDBDBD",clearable:"","error-messages":t.v$.name.$errors.map(o=>o.$message),label:"Unit",readonly:t.loading,required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","readonly","onBlur","onInput"]),a(y,{modelValue:t.state.shortname,"onUpdate:modelValue":e[8]||(e[8]=o=>t.state.shortname=o),"bg-color":"#BDBDBD","error-messages":t.v$.shortname.$errors.map(o=>o.$message),label:"Short Name",required:"",onBlur:t.v$.shortname.$touch,onInput:t.v$.shortname.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1})]),_:1}),a(Y,{class:"d-flex justify-end justify-space-between"},{default:l(()=>[a(m,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.saveEdit},{default:l(()=>[a(f,{start:""},{default:l(()=>e[23]||(e[23]=[n("mdi-plus")])),_:1}),e[24]||(e[24]=n(" Save "))]),_:1},8,["disabled","loading","onClick"]),a(m,{color:"black",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[10]||(e[10]=o=>t.editDialog=!1)},{default:l(()=>[a(f,{start:""},{default:l(()=>e[25]||(e[25]=[n("mdi-cancel")])),_:1}),e[26]||(e[26]=n(" Cancel "))]),_:1},8,["disabled","loading"]),a(m,{color:"error",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[11]||(e[11]=o=>t.confirmDeleteDialog=!0)},{default:l(()=>[a(f,{start:""},{default:l(()=>e[27]||(e[27]=[n("mdi-delete")])),_:1}),e[28]||(e[28]=n(" Delete "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:t.confirmDeleteDialog,"onUpdate:modelValue":e[15]||(e[15]=o=>t.confirmDeleteDialog=o),persistent:"",width:"auto"},{default:l(()=>[a(C,null,{default:l(()=>[a(p,{color:"warning",title:"Confirm Deleteting "+t.state.name},{default:l(()=>[a(m,{color:"white",icon:"mdi-close",onClick:e[13]||(e[13]=o=>t.confirmDeleteDialog=!1)})]),_:1},8,["title"]),a(U,null,{default:l(()=>[n("Are you sure you want to delete "+H(t.state.name)+"?",1)]),_:1}),v("div",le,[a(m,{color:"success",onClick:e[14]||(e[14]=o=>t.confirmDeleteDialog=!1)},{default:l(()=>e[29]||(e[29]=[n("Cancel")])),_:1}),a(m,{color:"error",onClick:t.remove},{default:l(()=>e[30]||(e[30]=[n("Proceed")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),v("div",ne,[e[35]||(e[35]=n(" Unit ")),a(m,{class:"text-black justify-end",size:"small",onClick:t.csvExport},{default:l(()=>[a(f,{color:"green",start:""},{default:l(()=>e[31]||(e[31]=[n("mdi-download")])),_:1}),e[32]||(e[32]=n(" Download "))]),_:1},8,["onClick"]),s.$store.getters.hasTask("can_add_settings")?(I(),E(m,{key:0,class:"text-white justify-end",color:"#1A237E",size:"small",onClick:t.activateAddDialog},{default:l(()=>[a(f,null,{default:l(()=>e[33]||(e[33]=[n("mdi-plus")])),_:1}),e[34]||(e[34]=n(" Add New"))]),_:1},8,["onClick"])):$("",!0)]),a(G,{active:t.loading,indeterminate:t.loading},null,8,["active","indeterminate"]),a(Z,{class:"elevation-1",dense:"",headers:t.headers,height:"300",items:t.values,loading:t.loading},K({_:2},[s.$store.getters.hasTask("can_add_settings")?{name:"item.edit",fn:l(({item:o})=>[a(f,{color:"#3F51B5",onClick:w=>t.activateEditDialog(o)},{default:l(()=>e[36]||(e[36]=[n("mdi-square-edit-outline")])),_:2},1032,["onClick"])]),key:"0"}:void 0]),1032,["headers","items","loading"])]),_:1})}const be=L(ee,[["render",re]]);export{be as default};
