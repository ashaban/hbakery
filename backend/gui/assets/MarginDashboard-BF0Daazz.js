import{_ as ut,r as V,d as w,k as ct,c as pt,q as z,v as e,a0 as mt,a1 as ft,t as g,h as a,x as o,G as j,B as n,A as p,N as L,O as vt,z as I,H as d,D as S,ay as D,Q as E,ae as U}from"./index-CvqfsKbz.js";import{E as F}from"./index-CMKRocWQ.js";import{V as gt}from"./VContainer-BBk2FiR3.js";import{V as m,b as f}from"./VCard-BH6mYS9X.js";import{V as y}from"./VCol-_bfXGXKh.js";import{V as H}from"./VAutocomplete-CcnWSf-M.js";import{V as P}from"./VChip-DD800yi0.js";import{a as O}from"./VDataTable-CTPdSVK4.js";import{V as M}from"./VSkeletonLoader-B-pY1Zx2.js";import{u as _t,i as yt,c as xt,b as bt,a as ht,d as wt,e as St,f as kt,g as Pt}from"./install-_nF_yPR_.js";import"./VTextField-Ccwdki6l.js";import"./VSlideGroup-BbGWgYtj.js";import"./dialog-transition-4lhr0DM9.js";const $t={class:"d-flex align-center justify-space-between"},Vt={class:"d-flex align-center mb-4"},zt={class:"d-flex align-center mb-2"},Ct={class:"d-flex align-center mb-2"},Lt={class:"d-flex align-center mb-2"},Dt={class:"d-flex align-center mb-2"},Et={class:"d-flex justify-space-between align-center"},Ft={class:"text-caption text-grey"},At={class:"d-flex gap-2"},Tt={class:"d-flex align-center"},It={class:"text-h5 font-weight-bold text-green"},Ot={class:"text-caption text-green"},Mt={class:"d-flex align-center"},Rt={class:"text-h5 font-weight-bold text-red"},Nt={class:"text-caption text-red"},jt={class:"d-flex align-center"},qt={class:"text-h5 font-weight-bold text-blue"},Bt={class:"text-caption text-blue"},Qt={class:"d-flex align-center"},Wt={class:"text-h5 font-weight-bold text-orange"},Ut={class:"text-caption text-orange"},Ht={class:"d-flex align-center mb-4"},Kt={key:1,class:"text-center py-8"},Zt={key:2,class:"text-center py-8 text-grey"},Gt={class:"d-flex align-center mb-4"},Jt={key:1,class:"text-center py-8"},Xt={key:2,class:"text-center py-8 text-grey"},Yt={class:"d-flex align-center mb-4"},te={key:1,class:"text-center py-8"},ee={key:2,class:"text-center py-8 text-grey"},ae={class:"d-flex align-center mb-4"},le={key:1,class:"text-center py-8"},oe={key:2,class:"text-center py-8 text-grey"},se={class:"d-flex align-center mb-4"},re={key:1,class:"text-center py-8"},ie={key:2,class:"text-center py-8 text-grey"},ne={class:"d-flex align-center mb-4"},de={key:1,class:"text-center py-8"},ue={key:2,class:"text-center py-8 text-grey"},ce={class:"d-flex align-center justify-space-between mb-4"},pe={class:"d-flex align-center"},me={class:"font-weight-medium"},fe={class:"font-weight-medium text-green"},ve={class:"font-weight-medium text-green"},ge={class:"d-flex align-center justify-space-between mb-4"},_e={class:"d-flex align-center"},ye={class:"font-weight-medium"},xe={class:"text-caption"},be={class:"font-weight-medium text-blue"},he={class:"d-flex align-center justify-space-between mb-4"},we={class:"d-flex align-center"},Se={class:"font-weight-medium"},ke={class:"font-weight-medium text-red"},Pe={class:"text-caption text-white"},$e={class:"d-flex align-center justify-space-between mb-4"},Ve={class:"d-flex align-center"},ze={class:"d-flex gap-2"},Ce={class:"font-weight-medium"},Le={class:"font-weight-medium text-deep-purple"},De={class:"text-caption"},Ee={class:"text-caption text-white"},Fe={__name:"MarginDashboard",setup(Ae){_t([yt,xt,bt,ht,wt,St,kt,Pt]);const A=mt(),v=V(!1),q=V([]),B=V([]),x=V({}),_=V({}),$=V({}),b=V({}),h=V({start_date:new Date().toISOString().split("T")[0].replace(/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-01"),end_date:new Date().toISOString().split("T")[0],product_id:null,outlet_id:null}),K=[{title:"Product",key:"product_name",sortable:!0},{title:"Quantity",key:"total_qty",sortable:!0,align:"center"},{title:"Total Sales",key:"total_sales",sortable:!0,align:"end"},{title:"Paid Amount",key:"total_paid",sortable:!0,align:"end"},{title:"Payment Rate",key:"payment_rate",sortable:!0,align:"center"}],Z=[{title:"Ingredient",key:"ingredient_name",sortable:!0},{title:"Quantity Used",key:"total_consumed",sortable:!0,align:"center"},{title:"Avg Price",key:"avg_price",sortable:!0,align:"end"},{title:"Total Cost",key:"total_cost",sortable:!0,align:"end"}],G=[{title:"Expenditure Type",key:"type_name",sortable:!0},{title:"Total Amount",key:"total_amount",sortable:!0,align:"end"},{title:"Percentage",key:"percentage",sortable:!0,align:"center",width:"200px"}],J=[{title:"Product",key:"product_name",sortable:!0},{title:"Quantity Lost",key:"total_qty",sortable:!0,align:"center"},{title:"Total Cost Value",key:"total_cost_value",sortable:!0,align:"end"},{title:"Avg Cost/Unit",key:"avg_cost_per_unit",sortable:!0,align:"end"},{title:"Events Count",key:"out_events_count",sortable:!0,align:"center"},{title:"% of Total Loss",key:"percentage_of_total",sortable:!0,align:"center",width:"200px"}],Q=w(()=>b.value.data&&b.value.data.length>0),T=w(()=>{const r=x.value.total_sales_amount||0,t=_.value.totalExpenditure||0,s=$.value.totalIngredientCost||0;return r-t-s}),R=w(()=>{const r=x.value.total_sales_amount||0;return r===0?0:(T.value/r*100).toFixed(1)}),W=w(()=>x.value.total_sales_amount>0||_.value.totalExpenditure>0||$.value.totalIngredientCost>0),X=w(()=>x.value.data&&x.value.data.length>0),Y=w(()=>_.value.data&&_.value.data.length>0),tt=w(()=>{var t;const r=((t=b.value.data)==null?void 0:t.slice().sort((s,l)=>l.total_cost_value-s.total_cost_value))||[];return{title:{text:"Product Loss by Cost Value",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:s=>{const l=s[0],i=r[l.dataIndex];return`
          <b>${i.product_name}</b><br/>
          Loss Value: ${u(i.total_cost_value)}<br/>
          Quantity: ${i.total_qty} units<br/>
          Events: ${i.out_events_count}<br/>
          Avg Cost: ${u(i.avg_cost_per_unit)}/unit
        `}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"value",axisLabel:{formatter:s=>s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(0)+"K":s}},yAxis:{type:"category",data:r.map(s=>s.product_name),axisLabel:{fontSize:10}},series:[{name:"Loss Value",type:"bar",data:r.map(s=>s.total_cost_value),itemStyle:{color:"#7E57C2"},label:{show:!0,position:"right",formatter:s=>u(s.value)}}]}}),et=w(()=>{var t;const r=((t=b.value.data)==null?void 0:t.map(s=>({name:s.product_name,value:s.total_qty})))||[];return{title:{text:"Product Loss by Quantity",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:s=>{var i;const l=(i=b.value.data)==null?void 0:i.find(c=>c.product_name===s.name);return`
          <b>${s.name}</b><br/>
          Quantity: ${s.value} units<br/>
          Value: ${u((l==null?void 0:l.total_cost_value)||0)}<br/>
          ${s.percent}% of total loss
        `}},legend:{orient:"vertical",right:10,top:"center",formatter:s=>{var i;const l=(i=b.value.data)==null?void 0:i.find(c=>c.product_name===s);return l?`${s}
${l.total_qty} units`:s},textStyle:{fontSize:10}},series:[{name:"Loss Quantity",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold",formatter:s=>`${s.name}
${s.value} units
${s.percent}%`}},labelLine:{show:!1},data:r}]}}),at=w(()=>{const r=x.value.total_sales_amount||0,t=_.value.totalExpenditure||0,s=$.value.totalIngredientCost||0,l=T.value;return{title:{text:"Financial Performance Overview",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:i=>{let c="<b>Financial Overview</b><br/>";return i.forEach(k=>{c+=`${k.marker} ${k.seriesName}: ${u(k.value)}<br/>`}),c}},legend:{data:["Sales Revenue","Total Expenditure","Production Cost","Profit Margin"],top:"10%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},xAxis:{type:"category",data:["Performance"],axisLabel:{fontSize:12}},yAxis:{type:"value",axisLabel:{formatter:i=>i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(0)+"K":i}},series:[{name:"Sales Revenue",type:"bar",data:[r],itemStyle:{color:"#4CAF50"},label:{show:!0,position:"top",formatter:i=>u(i.value)}},{name:"Total Expenditure",type:"bar",data:[t],itemStyle:{color:"#F44336"},label:{show:!0,position:"top",formatter:i=>u(i.value)}},{name:"Production Cost",type:"bar",data:[s],itemStyle:{color:"#2196F3"},label:{show:!0,position:"top",formatter:i=>u(i.value)}},{name:"Profit Margin",type:"bar",data:[l],itemStyle:{color:l>=0?"#FF9800":"#FF5722"},label:{show:!0,position:"top",formatter:i=>u(i.value)}}]}}),lt=w(()=>{const r=parseFloat(R.value);return{title:{text:"Profit Margin %",left:"center",top:"10%",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{formatter:"Profit Margin: {c}%"},series:[{type:"gauge",center:["50%","60%"],startAngle:180,endAngle:0,min:-50,max:50,splitNumber:10,itemStyle:{color:r>=0?"#FF9800":"#FF5722"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30,color:[[.3,"#FF6B6B"],[.7,"#FFE66D"],[1,"#4ECDC4"]]}},axisTick:{distance:-45,splitNumber:5,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-52,length:14,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-20,color:"#999",fontSize:12},anchor:{show:!1},title:{show:!1},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:30,fontWeight:"bolder",formatter:"{value}%",color:"inherit"},data:[{value:r}]}]}}),ot=w(()=>{var t;const r=((t=_.value.data)==null?void 0:t.map(s=>({name:s.type_name,value:s.total_amount})))||[];return{title:{text:"Expenditure Distribution",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:s=>`
          <b>${s.name}</b><br/>
          ${s.marker} ${u(s.value)}<br/>
          ${s.percent}%
        `},legend:{orient:"vertical",right:10,top:"center",formatter:s=>{var i;const l=(i=_.value.data)==null?void 0:i.find(c=>c.type_name===s);return l?`${s}
${u(l.total_amount)}`:s},textStyle:{fontSize:10}},series:[{name:"Expenditure",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold",formatter:s=>`${s.name}
${u(s.value)}
${s.percent}%`}},labelLine:{show:!1},data:r}]}}),st=w(()=>{var t;const r=((t=x.value.data)==null?void 0:t.slice().sort((s,l)=>l.total_sales-s.total_sales).slice(0,8))||[];return{title:{text:"Top Selling Products",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:s=>{const l=s[0],i=r[l.dataIndex];return`
          <b>${i.product_name}</b><br/>
          Sales: ${u(i.total_sales)}<br/>
          Quantity: ${i.total_qty}<br/>
          Paid: ${u(i.total_paid)}<br/>
          Payment Rate: ${i.payment_rate}%
        `}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"value",axisLabel:{formatter:s=>s>=1e6?(s/1e6).toFixed(1)+"M":s>=1e3?(s/1e3).toFixed(0)+"K":s}},yAxis:{type:"category",data:r.map(s=>s.product_name),axisLabel:{fontSize:10}},series:[{name:"Sales Amount",type:"bar",data:r.map(s=>s.total_sales),itemStyle:{color:"#4CAF50"},label:{show:!0,position:"right",formatter:s=>u(s.value)}}]}});function u(r){return r?new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(r):"TZS 0"}function rt(r){return r>=90?"green":r>=75?"orange":"red"}function it(){h.value={start_date:new Date().toISOString().split("T")[0].replace(/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-01"),end_date:new Date().toISOString().split("T")[0],product_id:null,outlet_id:null},N()}async function N(){v.value=!0;try{const r=new URLSearchParams;A.state.auth.outlets.length&&h.value.outlet_id===null&&A.state.auth.outlets.forEach(c=>r.append("outlet_id[]",c.outlet_id)),Object.entries(h.value).forEach(([c,k])=>{k&&r.append(c,k)});const[t,s,l,i]=await Promise.all([fetch(`/reports/salesByProduct?${r}`),fetch(`/reports/expenditureByType?${r}`),fetch(`/reports/productionIngredientsCost?${r}`),fetch(`/reports/giveOutByProduct?${r}`)]);if(!t.ok)throw new Error("Sales API failed");if(!s.ok)throw new Error("Expenditure API failed");if(!l.ok)throw new Error("Production API failed");if(!i.ok)throw new Error("Product Loss API failed");if(x.value=await t.json(),_.value=await s.json(),$.value=await l.json(),b.value=await i.json(),_.value.data){const c=_.value.totalExpenditure;_.value.data.forEach(k=>{k.percentage=c>0?k.total_amount/c*100:0})}if(x.value.data&&x.value.data.forEach(c=>{c.payment_rate=c.total_sales>0?Math.round(c.total_paid/c.total_sales*100):0}),b.value.data){const c=b.value.total_out_value||0,k=b.value.total_out_qty||0;b.value.data.forEach(C=>{C.avg_cost_per_unit=C.total_qty>0?C.total_cost_value/C.total_qty:0,C.percentage_of_total=c>0?C.total_cost_value/c*100:0})}}catch(r){console.error("Failed to load dashboard data:",r)}finally{v.value=!1}}function nt(){const r={filters:h.value,sales:x.value,expenditure:_.value,production:$.value,profitMargin:T.value,profitMarginPercentage:R.value},t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(r,null,2)),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download",`dashboard-export-${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(s),s.click(),s.remove()}async function dt(){try{const r=new URLSearchParams({limit:1e3});A.state.auth.outlets.length?A.state.auth.outlets.forEach(l=>r.append("id[]",l.outlet_id)):r.append("id[]",-1);const[t,s]=await Promise.all([fetch("/products?limit=1000"),fetch(`/outlets?${r}`)]);if(t.ok){const l=await t.json();q.value=l.data||[]}if(s.ok){const l=await s.json();B.value=l.data||[]}}catch(r){console.error("Failed to load reference data:",r)}}return ct(async()=>{await dt(),await N()}),pt(()=>[...Object.values(h.value)],()=>{},{deep:!0}),(r,t)=>{const s=ft("VueDatePicker");return g(),z(gt,{class:"dashboard-container",fluid:""},{default:e(()=>[a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-6"},{default:e(()=>[o("div",$t,[t[6]||(t[6]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Bakery Dashboard "),o("p",{class:"text-body-1 text-grey"}," Comprehensive overview of sales, expenditures, and production performance ")],-1)),a(j,{class:"px-6",color:"primary",elevation:"2",size:"large",onClick:nt},{default:e(()=>[a(p,{size:"20",start:""},{default:e(()=>t[4]||(t[4]=[n("mdi-file-export")])),_:1}),t[5]||(t[5]=n(" Export Report "))]),_:1})])]),_:1})]),_:1}),a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-6"},{default:e(()=>[o("div",Vt,[a(p,{class:"mr-2",color:"primary"},{default:e(()=>t[7]||(t[7]=[n("mdi-filter")])),_:1}),t[8]||(t[8]=o("h3",{class:"text-h6 font-weight-medium"},"Dashboard Filters",-1))]),a(L,{dense:""},{default:e(()=>[a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[o("div",zt,[a(p,{class:"mr-2",color:"green",size:"18"},{default:e(()=>t[9]||(t[9]=[n("mdi-calendar")])),_:1}),t[10]||(t[10]=o("label",{class:"text-caption font-weight-medium text-primary"},"Start Date",-1))]),a(s,{modelValue:h.value.start_date,"onUpdate:modelValue":t[0]||(t[0]=l=>h.value.start_date=l),"auto-apply":"",format:"yyyy-MM-dd","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[o("div",Ct,[a(p,{class:"mr-2",color:"red",size:"18"},{default:e(()=>t[11]||(t[11]=[n("mdi-calendar")])),_:1}),t[12]||(t[12]=o("label",{class:"text-caption font-weight-medium text-primary"},"End Date",-1))]),a(s,{modelValue:h.value.end_date,"onUpdate:modelValue":t[1]||(t[1]=l=>h.value.end_date=l),"auto-apply":"",format:"yyyy-MM-dd","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[o("div",Lt,[a(p,{class:"mr-2",color:"blue",size:"18"},{default:e(()=>t[13]||(t[13]=[n("mdi-package-variant")])),_:1}),t[14]||(t[14]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),a(H,{modelValue:h.value.product_id,"onUpdate:modelValue":t[2]||(t[2]=l=>h.value.product_id=l),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:q.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[o("div",Dt,[a(p,{class:"mr-2",color:"purple",size:"18"},{default:e(()=>t[15]||(t[15]=[n("mdi-store")])),_:1}),t[16]||(t[16]=o("label",{class:"text-caption font-weight-medium text-primary"},"Outlet",-1))]),a(H,{modelValue:h.value.outlet_id,"onUpdate:modelValue":t[3]||(t[3]=l=>h.value.outlet_id=l),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:B.value,placeholder:"All Outlets",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),a(vt,{class:"my-4"}),o("div",Et,[o("div",Ft,[a(p,{class:"mr-1",size:"14"},{default:e(()=>t[17]||(t[17]=[n("mdi-information")])),_:1}),t[18]||(t[18]=n(" Apply filters to update dashboard data "))]),o("div",At,[a(j,{class:"px-4",color:"grey",size:"small",variant:"outlined",onClick:it},{default:e(()=>[a(p,{size:"18",start:""},{default:e(()=>t[19]||(t[19]=[n("mdi-refresh")])),_:1}),t[20]||(t[20]=n(" Reset "))]),_:1}),a(j,{class:"px-4",color:"primary",elevation:"2",loading:v.value,size:"small",onClick:N},{default:e(()=>[a(p,{size:"18",start:""},{default:e(()=>t[21]||(t[21]=[n("mdi-chart-bar")])),_:1}),t[22]||(t[22]=n(" Apply Filters "))]),_:1},8,["loading"])])])]),_:1})]),_:1}),a(L,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",Tt,[a(I,{class:"mr-3",color:"green-lighten-5",size:"48"},{default:e(()=>[a(p,{color:"green",size:"24"},{default:e(()=>t[23]||(t[23]=[n("mdi-cash")])),_:1})]),_:1}),o("div",null,[o("div",It,d(u(x.value.total_sales_amount||0)),1),t[24]||(t[24]=o("div",{class:"text-caption text-grey"},"Total Sales",-1)),o("div",Ot,d(u(x.value.total_paid_amount||0))+" Paid ",1)])])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>{var l;return[o("div",Mt,[a(I,{class:"mr-3",color:"red-lighten-5",size:"48"},{default:e(()=>[a(p,{color:"red",size:"24"},{default:e(()=>t[25]||(t[25]=[n("mdi-cash-remove")])),_:1})]),_:1}),o("div",null,[o("div",Rt,d(u(_.value.totalExpenditure||0)),1),t[26]||(t[26]=o("div",{class:"text-caption text-grey"},"Total Expenditure",-1)),o("div",Nt,d(((l=_.value.data)==null?void 0:l.length)||0)+" Categories ",1)])])]}),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>{var l;return[o("div",jt,[a(I,{class:"mr-3",color:"blue-lighten-5",size:"48"},{default:e(()=>[a(p,{color:"blue",size:"24"},{default:e(()=>t[27]||(t[27]=[n("mdi-factory")])),_:1})]),_:1}),o("div",null,[o("div",qt,d(u($.value.totalIngredientCost||0)),1),t[28]||(t[28]=o("div",{class:"text-caption text-grey"},"Production Cost",-1)),o("div",Bt,d(((l=$.value.data)==null?void 0:l.length)||0)+" Ingredients ",1)])])]}),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",Qt,[a(I,{class:"mr-3",color:"orange-lighten-5",size:"48"},{default:e(()=>[a(p,{color:"orange",size:"24"},{default:e(()=>t[29]||(t[29]=[n("mdi-chart-line")])),_:1})]),_:1}),o("div",null,[o("div",Wt,d(u(T.value)),1),t[30]||(t[30]=o("div",{class:"text-caption text-grey"},"Profit Margin",-1)),o("div",Ut,d(R.value)+"% ",1)])])]),_:1})]),_:1})]),_:1})]),_:1}),a(L,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"8"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",Ht,[a(p,{class:"mr-2",color:"primary"},{default:e(()=>t[31]||(t[31]=[n("mdi-chart-bar")])),_:1}),t[32]||(t[32]=o("h4",{class:"text-h6 font-weight-medium"}," Cost vs Revenue Analysis ",-1))]),!v.value&&W.value?(g(),z(D(F),{key:0,option:at.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",Kt,[a(E,{color:"primary",indeterminate:""}),t[33]||(t[33]=o("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",Zt," No data available for the selected period "))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"4"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",Gt,[a(p,{class:"mr-2",color:"orange"},{default:e(()=>t[34]||(t[34]=[n("mdi-gauge")])),_:1}),t[35]||(t[35]=o("h4",{class:"text-h6 font-weight-medium"},"Profit Margin",-1))]),!v.value&&W.value?(g(),z(D(F),{key:0,option:lt.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",Jt,[a(E,{color:"orange",indeterminate:""}),t[36]||(t[36]=o("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",Xt," No data available for the selected period "))]),_:1})]),_:1})]),_:1})]),_:1}),a(L,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",Yt,[a(p,{class:"mr-2",color:"red"},{default:e(()=>t[37]||(t[37]=[n("mdi-chart-pie")])),_:1}),t[38]||(t[38]=o("h4",{class:"text-h6 font-weight-medium"},"Expenditure Breakdown",-1))]),!v.value&&Y.value?(g(),z(D(F),{key:0,option:ot.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",te,[a(E,{color:"red",indeterminate:""}),t[39]||(t[39]=o("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",ee," No expenditure data available "))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",ae,[a(p,{class:"mr-2",color:"green"},{default:e(()=>t[40]||(t[40]=[n("mdi-chart-bar")])),_:1}),t[41]||(t[41]=o("h4",{class:"text-h6 font-weight-medium"},"Top Selling Products",-1))]),!v.value&&X.value?(g(),z(D(F),{key:0,option:st.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",le,[a(E,{color:"green",indeterminate:""}),t[42]||(t[42]=o("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",oe," No sales data available "))]),_:1})]),_:1})]),_:1})]),_:1}),a(L,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",se,[a(p,{class:"mr-2",color:"deep-purple"},{default:e(()=>t[43]||(t[43]=[n("mdi-chart-bar")])),_:1}),t[44]||(t[44]=o("h4",{class:"text-h6 font-weight-medium"},"Product Loss by Value",-1))]),!v.value&&Q.value?(g(),z(D(F),{key:0,option:tt.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",re,[a(E,{color:"deep-purple",indeterminate:""}),t[45]||(t[45]=o("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",ie," No product loss data available "))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",ne,[a(p,{class:"mr-2",color:"deep-purple"},{default:e(()=>t[46]||(t[46]=[n("mdi-chart-pie")])),_:1}),t[47]||(t[47]=o("h4",{class:"text-h6 font-weight-medium"}," Product Loss by Quantity ",-1))]),!v.value&&Q.value?(g(),z(D(F),{key:0,option:et.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",de,[a(E,{color:"deep-purple",indeterminate:""}),t[48]||(t[48]=o("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",ue," No product loss data available "))]),_:1})]),_:1})]),_:1})]),_:1}),a(L,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",ce,[o("div",pe,[a(p,{class:"mr-2",color:"green"},{default:e(()=>t[49]||(t[49]=[n("mdi-cash-multiple")])),_:1}),t[50]||(t[50]=o("h4",{class:"text-h6 font-weight-medium"},"Sales by Product",-1))]),a(P,{color:"green",size:"small",variant:"flat"},{default:e(()=>{var l;return[n(d(((l=x.value.data)==null?void 0:l.length)||0)+" Products ",1)]}),_:1})]),a(O,{density:"comfortable",headers:K,"hide-default-footer":"",items:x.value.data||[],loading:v.value},{loading:e(()=>[a(M,{type:"table-row@5"})]),"item.product_name":e(({item:l})=>[o("div",me,d(l.product_name),1)]),"item.total_qty":e(({item:l})=>[a(P,{color:"blue",size:"small",variant:"outlined"},{default:e(()=>[n(d(l.total_qty),1)]),_:2},1024)]),"item.total_sales":e(({item:l})=>[o("div",fe,d(u(l.total_sales)),1)]),"item.total_paid":e(({item:l})=>[o("div",ve,d(u(l.total_paid)),1)]),"item.payment_rate":e(({item:l})=>[a(P,{color:rt(l.payment_rate),size:"small",variant:"flat"},{default:e(()=>[n(d(l.payment_rate)+"% ",1)]),_:2},1032,["color"])]),"no-data":e(()=>t[51]||(t[51]=[o("div",{class:"text-center py-4 text-grey"}," No sales data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",ge,[o("div",_e,[a(p,{class:"mr-2",color:"blue"},{default:e(()=>t[52]||(t[52]=[n("mdi-ingredient")])),_:1}),t[53]||(t[53]=o("h4",{class:"text-h6 font-weight-medium"}," Production Ingredients Cost ",-1))]),a(P,{color:"blue",size:"small",variant:"flat"},{default:e(()=>{var l;return[n(d(((l=$.value.data)==null?void 0:l.length)||0)+" Ingredients ",1)]}),_:1})]),a(O,{density:"comfortable",headers:Z,"hide-default-footer":"",items:$.value.data||[],loading:v.value},{loading:e(()=>[a(M,{type:"table-row@5"})]),"item.ingredient_name":e(({item:l})=>[o("div",ye,d(l.ingredient_name),1)]),"item.total_consumed":e(({item:l})=>[a(P,{color:"blue-grey",size:"small",variant:"outlined"},{default:e(()=>[n(d(l.total_consumed),1)]),_:2},1024)]),"item.avg_price":e(({item:l})=>[o("div",xe,d(u(l.avg_price)),1)]),"item.total_cost":e(({item:l})=>[o("div",be,d(u(l.total_cost)),1)]),"no-data":e(()=>t[54]||(t[54]=[o("div",{class:"text-center py-4 text-grey"}," No production data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",he,[o("div",we,[a(p,{class:"mr-2",color:"red"},{default:e(()=>t[55]||(t[55]=[n("mdi-cash-remove")])),_:1}),t[56]||(t[56]=o("h4",{class:"text-h6 font-weight-medium"},"Expenditure by Type",-1))]),a(P,{color:"red",size:"small",variant:"flat"},{default:e(()=>[n(" Total: "+d(u(_.value.totalExpenditure||0)),1)]),_:1})]),a(O,{density:"comfortable",headers:G,"hide-default-footer":"",items:_.value.data||[],loading:v.value},{loading:e(()=>[a(M,{type:"table-row@5"})]),"item.type_name":e(({item:l})=>[o("div",Se,d(l.type_name),1)]),"item.total_amount":e(({item:l})=>[o("div",ke,d(u(l.total_amount)),1)]),"item.percentage":e(({item:l})=>[a(U,{color:"red",height:"8","model-value":l.percentage,rounded:""},{default:e(()=>[o("span",Pe,d(l.percentage.toFixed(1))+"%",1)]),_:2},1032,["model-value"])]),"no-data":e(()=>t[57]||(t[57]=[o("div",{class:"text-center py-4 text-grey"}," No expenditure data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1}),a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[o("div",$e,[o("div",Ve,[a(p,{class:"mr-2",color:"deep-purple"},{default:e(()=>t[58]||(t[58]=[n("mdi-archive-alert")])),_:1}),t[59]||(t[59]=o("h4",{class:"text-h6 font-weight-medium"},"Product Loss Details",-1))]),o("div",ze,[a(P,{color:"deep-purple",size:"small",variant:"flat"},{default:e(()=>[n(" Total Value: "+d(u(b.value.total_out_value||0)),1)]),_:1}),a(P,{color:"deep-purple",size:"small",variant:"outlined"},{default:e(()=>[n(d(b.value.total_out_qty||0)+" Units ",1)]),_:1})])]),a(O,{density:"comfortable",headers:J,"hide-default-footer":"",items:b.value.data||[],loading:v.value},{loading:e(()=>[a(M,{type:"table-row@5"})]),"item.product_name":e(({item:l})=>[o("div",Ce,d(l.product_name),1)]),"item.total_qty":e(({item:l})=>[a(P,{color:"deep-purple",size:"small",variant:"outlined"},{default:e(()=>[n(d(l.total_qty),1)]),_:2},1024)]),"item.total_cost_value":e(({item:l})=>[o("div",Le,d(u(l.total_cost_value)),1)]),"item.out_events_count":e(({item:l})=>[a(P,{color:"orange",size:"small",variant:"outlined"},{default:e(()=>[n(d(l.out_events_count)+" events ",1)]),_:2},1024)]),"item.avg_cost_per_unit":e(({item:l})=>[o("div",De,d(u(l.avg_cost_per_unit)),1)]),"item.percentage_of_total":e(({item:l})=>[a(U,{color:"deep-purple",height:"8","model-value":l.percentage_of_total,rounded:""},{default:e(()=>[o("span",Ee,d(l.percentage_of_total.toFixed(1))+"%",1)]),_:2},1032,["model-value"])]),"no-data":e(()=>t[60]||(t[60]=[o("div",{class:"text-center py-4 text-grey"}," No product loss data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1})}}},Ke=ut(Fe,[["__scopeId","data-v-823f1cd0"]]);export{Ke as default};
