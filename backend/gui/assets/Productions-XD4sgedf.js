import{g as Tt,p as $t,f as Bt,h as l,a5 as he,a6 as zl,d as E,a7 as Pl,r as A,a8 as Cl,x as o,F as T,a9 as Al,aa as qt,ab as Ul,_ as Sl,$ as Ie,k as Il,q as y,v as t,a1 as Dl,t as m,Z as x,B as d,G as h,A as c,H as n,N as j,z,C as te,O as me,L as Y,ac as ht,ad as zt,ae as Pt,i as se,K as fe,M as W,af as H,D as C,a2 as De,a3 as je,E as Q,a4 as Ct}from"./index-BfzjJhGR.js";import{h as Mt}from"./moment-C5S46NFB.js";import{V as jl}from"./VContainer-DMmTm0lR.js";import{V as le}from"./VAlert-Dmm__00_.js";import{V as v,b,a as ke,c as At}from"./VCard-DSdvF0Jv.js";import{V as p}from"./VCol-fxUKiZAX.js";import{V as w}from"./VChip-DcD339JZ.js";import{V as pe}from"./VAutocomplete-CansSyFn.js";import{c as Qe,m as Nl,d as Tl,e as $l,V as ne,a as qe,f as Ut,b as Bl}from"./VDataTable-BxSiHLBg.js";import{V as St}from"./VSkeletonLoader-COnkLji0.js";import{V as Ml}from"./VBadge-Da5ZKzc8.js";import{V as Ne}from"./VDialog-DkUPUNzj.js";import{V as It}from"./VForm-Dsng_Xzb.js";import{a as Dt,b as Fl,m as Rl,V as F}from"./VTextField-BNYimcDb.js";import{V as Gl}from"./VSwitch-zj4Ye_hy.js";import{V as jt,a as Te,b as Nt,c as $e}from"./VTabs-DSfSbVKY.js";import{V as El}from"./VTooltip-CEazVVqn.js";import{V as Ol,a as Ll,b as Hl,c as Ql}from"./VExpansionPanels-BFV3eFJI.js";import"./VSlideGroup-CwezdU9i.js";import"./dialog-transition-rCN2GvE7.js";const Le=I=>I?Mt(I).format("DD-MM-YYYY HH:mm"):"",He=I=>I?Mt(I,"DD-MM-YYYY HH:mm").format("YYYY-MM-DD HH:mm"):null,Yl=$t({...Nl({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Jl=Tt()({name:"VRadio",props:Yl(),setup(I,O){let{slots:J}=O;return Bt(()=>{const M=Qe.filterProps(I);return l(Qe,he(M,{class:["v-radio",I.class],style:I.style,type:"radio"}),J)}),{}}}),Kl=$t({height:{type:[Number,String],default:"auto"},...Rl(),...Ul($l(),["multiple"]),trueIcon:{type:qt,default:"$radioOn"},falseIcon:{type:qt,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Wl=Tt()({name:"VRadioGroup",inheritAttrs:!1,props:Kl(),emits:{"update:modelValue":I=>!0},setup(I,O){let{attrs:J,slots:M}=O;const X=zl(),L=E(()=>I.id||`radio-group-${X}`),K=Pl(I,"modelValue"),_e=A();return Bt(()=>{const[ee,ge]=Cl(J),ye=Dt.filterProps(I),re=Qe.filterProps(I),S=M.label?M.label({label:I.label,props:{for:L.value}}):I.label;return l(Dt,he({ref:_e,class:["v-radio-group",I.class],style:I.style},ee,ye,{modelValue:K.value,"onUpdate:modelValue":R=>K.value=R,id:L.value}),{...M,default:R=>{let{id:G,messagesId:ue,isDisabled:ve,isReadonly:q}=R;return o(T,null,[S&&l(Fl,{id:G.value},{default:()=>[S]}),l(Tl,he(re,{id:G.value,"aria-describedby":ue.value,defaultsTarget:"VRadio",trueIcon:I.trueIcon,falseIcon:I.falseIcon,type:I.type,disabled:ve.value,readonly:q.value,"aria-labelledby":S?G.value:void 0,multiple:!1},ge,{modelValue:K.value,"onUpdate:modelValue":Ae=>K.value=Ae}),M)])}})}),Al({},_e)}}),Zl={class:"d-flex align-center justify-space-between"},Xl={class:"d-flex gap-2"},ea={class:"d-flex align-center"},ta={class:"text-h5 font-weight-bold text-blue"},la={class:"text-caption text-grey"},aa={class:"d-flex align-center"},oa={class:"text-h5 font-weight-bold text-green"},da={class:"d-flex align-center"},sa={class:"text-h5 font-weight-bold text-orange"},ia={class:"d-flex align-center"},na={class:"text-h5 font-weight-bold text-purple"},ra={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},ua={class:"d-flex align-center mb-4"},ca={class:"d-flex align-center mb-2"},ma={class:"d-flex align-center mb-2"},fa={class:"d-flex align-center"},pa={class:"d-flex align-center mb-2"},_a={class:"d-flex align-center mb-2"},ga={class:"d-flex justify-space-between align-center"},ya={class:"text-caption text-grey"},va={class:"d-flex gap-2"},ba={class:"d-flex align-center"},xa={class:"font-weight-medium"},Va={class:"text-caption text-grey"},wa={class:"text-caption"},ka={class:"text-no-wrap"},qa={class:"text-no-wrap"},ha={class:"d-flex align-center"},za={class:"font-weight-medium"},Pa={class:"d-flex justify-end"},Ca={class:"d-flex align-center justify-space-between"},Aa={class:"d-flex align-center"},Ua={class:"text-white text-caption opacity-75"},Sa={class:"text-center py-8"},Ia={class:"d-flex align-center pa-4 bg-grey-lighten-4 rounded-t-lg"},Da={class:"d-flex align-center mb-4"},ja={class:"d-flex align-center mb-2"},Na={class:"d-flex align-center mb-2"},Ta={class:"d-flex align-center"},$a={class:"d-flex align-center mb-2"},Ba={class:"d-flex align-center mb-2"},Ma={class:"d-flex justify-space-between align-center"},Fa={class:"text-caption text-grey"},Ra={class:"d-flex gap-2"},Ga={class:"d-flex align-center"},Ea={class:"font-weight-medium"},Oa={class:"text-caption text-grey"},La={class:"d-flex align-center"},Ha={class:"font-weight-medium"},Qa={class:"text-no-wrap"},Ya={class:"text-no-wrap"},Ja={class:"d-flex align-center"},Ka={class:"font-weight-medium"},Wa={class:"d-flex justify-end"},Za={class:"d-flex align-center justify-space-between"},Xa={class:"d-flex align-center"},eo={class:"text-white text-caption opacity-75"},to={class:"text-center py-8"},lo={class:"d-flex justify-space-between align-center"},ao={class:"text-body-2 text-grey"},oo={class:"text-h6 font-weight-bold"},so={class:"text-body-1 font-weight-medium"},io={class:"text-body-1 font-weight-medium"},no={class:"text-body-1 font-weight-medium"},ro={class:"text-body-1 font-weight-medium"},uo={class:"text-h6 font-weight-bold text-green"},co={class:"text-h6 font-weight-bold text-orange"},mo={class:"text-h6 font-weight-bold text-red"},fo={class:"text-h6 font-weight-bold text-primary"},po={class:"d-flex align-center"},_o={class:"font-weight-medium"},go={class:"text-caption text-grey"},yo={key:0,class:"d-flex flex-column"},vo={class:"font-weight-medium text-green"},bo={class:"text-caption text-orange"},xo={class:"text-caption text-red"},Vo={key:1,class:"text-grey"},wo={class:"text-white text-caption font-weight-bold"},ko={key:0,class:"text-caption"},qo={key:1,class:"text-caption text-grey"},ho={class:"d-flex align-center mb-4"},zo={class:"position-relative w-100"},Po={key:0,class:"datepicker-label"},Co={class:"d-flex align-center mb-4"},Ao={class:"d-flex align-center mb-3"},Uo={class:"font-weight-medium text-h6"},So={class:"text-caption text-grey"},Io={class:"mb-2"},Do={class:"d-flex align-center mb-3"},jo={class:"text-h6 font-weight-bold text-green"},No={class:"text-h6 font-weight-bold text-orange"},To={class:"text-h6 font-weight-bold text-red"},$o={class:"text-h6 font-weight-bold text-primary"},Bo={class:"d-flex align-center mb-4"},Mo={class:"position-relative w-100"},Fo={key:0,class:"datepicker-label"},Ro={class:"position-relative w-100"},Go={key:0,class:"datepicker-label"},Eo={class:"d-flex align-center justify-space-between mb-4"},Oo={class:"d-flex align-center"},Lo={class:"d-flex align-center mb-3"},Ho={class:"text-body-2 text-grey"},Qo={class:"d-flex align-center mb-3"},Yo={class:"d-flex align-center justify-space-between mb-4"},Jo={class:"d-flex align-center"},Ko={class:"d-flex align-center"},Wo={class:"d-flex align-center"},Zo={class:"d-flex align-center mb-4"},Xo={class:"text-h6 font-weight-medium"},ed={class:"d-flex align-center justify-space-between w-100 pr-4"},td={class:"d-flex align-center"},ld={class:"d-flex align-center"},ad={class:"text-caption text-grey mb-2"},od={class:"d-flex align-center"},dd={class:"ml-2 flex-grow-1"},sd={class:"font-weight-medium"},id={key:0,class:"text-caption text-grey"},nd={class:"mt-2"},rd={class:"d-flex align-center"},ud={class:"d-flex align-center justify-space-between mb-4"},cd={class:"d-flex align-center"},md={class:"d-flex gap-2"},fd={class:"d-flex justify-space-between align-center"},pd={class:"text-caption text-grey"},_d={class:"d-flex align-center mb-4"},gd={class:"text-h6 font-weight-bold"},yd={class:"text-body-1 font-weight-medium"},vd={class:"text-body-1 font-weight-medium"},bd={class:"text-body-1 font-weight-medium"},xd={class:"text-body-1 font-weight-medium"},Vd={class:"text-body-1 font-weight-medium"},wd={class:"text-body-1 font-weight-medium"},kd={class:"text-body-1 font-weight-medium"},qd={class:"text-body-1 font-weight-medium"},hd={class:"text-h6 font-weight-bold text-green"},zd={class:"text-h6 font-weight-bold text-blue"},Pd={class:"text-h6 font-weight-bold text-green"},Cd={class:"text-h6 font-weight-bold text-orange"},Ad={class:"text-h6 font-weight-bold text-red"},Ud={class:"text-body-1 font-weight-medium"},Sd={class:"text-white text-caption font-weight-bold"},Id={class:"text-caption text-grey"},Dd={key:0,class:"text-caption text-grey ml-2"},jd={class:"text-caption text-grey ml-2"},Nd={class:"text-white text-caption font-weight-bold"},Td={key:0,class:"text-caption"},$d={key:1,class:"text-caption text-grey"},Bd={class:"text-caption text-grey"},Md={__name:"Productions",setup(I){const O=A(!1),J=A(!1),M=A([]),X=A([]),L=A(!0),K=A(1),_e=A(1),ee=A(!1),ge=A(!1),ye=A(!1),re=A(!1),S=A(null),R=A(!0),G=A(!1),ue=A(!1),ve=A(!1),q=A(null),Ae=A(""),Z=A(0),ae=A([]),be=A(!1),xe=A([]),Be=A([]),ze=A([]),Ye=A([]),Me=A([]),$=Ie({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),B=Ie({product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",team_leader:""}),g=Ie({id:null,planned_at:null,produced_at:null,notes:"",good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],staff:[],products:[]}),D=Ie({batch_id:null,produced_at:null,notes:"",products:[]}),Ft=[{label:"By Product",value:"by_product"},{label:"By Ingredient",value:"by_ingredient"}],Rt=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],Gt=[{title:"All Status",value:"all",icon:"mdi-view-grid"},{title:"Pending",value:"pending",icon:"mdi-clock-outline",color:"orange"},{title:"Completed",value:"completed",icon:"mdi-check-circle",color:"green"}],Je=[{title:"On Date",value:"="},{title:"After",value:">"},{title:"Before",value:"<"},{title:"On or After",value:">="},{title:"On or Before",value:"<="},{title:"Between",value:"in"}],Et=[{title:"Batch Code",key:"batch_code",sortable:!0},{title:"Status",key:"status",sortable:!0,align:"center"},{title:"Production Stats",key:"production_stats",sortable:!1},{title:"Planned Start",key:"planned_at",sortable:!0},{title:"Produced At",key:"produced_at",sortable:!0},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Planned By",key:"created_by_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"100px"}],Ot=[{title:"Product",key:"product_name",sortable:!0},{title:"Planned Qty",key:"qty_product",sortable:!0,align:"center"},{title:"Status",key:"produced",sortable:!0,align:"center"},{title:"Actual Output",key:"good_qty",sortable:!1},{title:"Actions",key:"actions",sortable:!1,align:"center"}],Lt=[{title:"Product / Batch",key:"product_name",sortable:!0},{title:"Quantity",key:"qty_product",sortable:!0,align:"center"},{title:"Staffs",key:"staff_count",sortable:!0,align:"center"},{title:"Mode",key:"mode",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Planned At",key:"planned_at",sortable:!0},{title:"Produced At",key:"produced_at",sortable:!0},{title:"Team Leader",key:"team_leader_name",sortable:!0},{title:"Actions",key:"actions",sortable:!1,align:"end",width:"180px"}],Ke=[{title:"Ingredient",key:"item_name"},{title:"Quantity Required",key:"qty_required"},{title:"Available",key:"available",align:"center"},{title:"Balance",key:"balance",align:"center"},{title:"Unit",key:"unit",align:"center"}],Ht=[{title:"Staff Member",key:"staff_id",width:"250px"},{title:"Role",key:"role",width:"240px"},{title:"Notes",key:"notes",width:"240px"},{title:"Actions",key:"actions",align:"center",sortable:!1}],We=s=>({completed:"green",partial:"orange",pending:"red",cancelled:"grey"})[s]||"grey",Ze=s=>({completed:"Completed",partial:"Partial",pending:"Pending",cancelled:"Cancelled"})[s]||s,Qt=s=>({completed:"bg-green",partial:"bg-orange",pending:"bg-red",cancelled:"bg-grey"})[s]||"bg-primary",Yt=s=>({pending:"bg-orange",completed:"bg-green",active:"bg-primary",cancelled:"bg-red"})[s]||"bg-primary",Jt=E(()=>{let s=0;return Object.keys($).forEach(e=>{const u=$[e];(Array.isArray(u)&&u.length||u&&u!=="all")&&s++}),s}),Kt=E(()=>{let s=0;return Object.keys(B).forEach(e=>{const u=B[e];(Array.isArray(u)&&u.length||u&&u!=="all")&&s++}),s}),Wt=()=>{L.value=!L.value,K.value=1,Ve()},Ve=()=>{L.value?Pe():xl()},Pe=async()=>{O.value=!0;try{const s=new URLSearchParams({page:K.value,limit:10});Object.entries(B).forEach(([a,r])=>{r&&r!=="all"&&!(Array.isArray(r)&&!r.length)&&s.append(a,r)});const u=await(await fetch(`/productions/batches?${s.toString()}`)).json();X.value=u.data||[],_e.value=u.totalPages||1}catch(s){console.error("Failed to load batches:",s),X.value=[]}finally{O.value=!1}},Zt=()=>{Object.assign(B,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",team_leader:""}),Pe()},Xt=()=>{K.value=1,Pe()},Xe=async s=>{var e;try{const a=await(await fetch(`/productions/batches/${s.id}`)).json();S.value=a.batch,S.value.products=a.products||[],S.value.staff=((e=a.products.find(r=>r.staff.length))==null?void 0:e.staff)||[],ye.value=!0}catch(u){console.error("Failed to load batch details:",u)}},el=async s=>{try{const u=await(await fetch(`/productions/batches/${s.id}`)).json();S.value=u.batch,D.batch_id=s.id,D.produced_at=Le(new Date),D.notes="",D.products=u.products.map(a=>({production_id:a.production_id,product_id:a.product_id,product_name:a.product_name,planned_qty:a.qty_product,good_qty:a.good_qty||"",damaged_qty:a.damaged_qty||"",reject_qty:a.reject_qty||"",actual_qty:(a.good_qty||0)+(a.damaged_qty||0)+(a.reject_qty||0),hasDiscrepancy:parseFloat(a.good_qty)!==parseFloat(a.planned_qty),discrepancies:a.discrepancies||[]})),re.value=!0}catch(e){console.error("Failed to load batch for actual production:",e)}},Fe=()=>{re.value=!1,D.batch_id=null,D.produced_at=null,D.notes="",D.products=[]},we=s=>{s.actual_qty=(Number(s.good_qty)||0)+(Number(s.damaged_qty)||0)+(Number(s.reject_qty)||0),s.hasDiscrepancy=Number(s.good_qty)!==Number(s.planned_qty),s.hasDiscrepancy||(s.discrepancies=[]),s.hasDiscrepancy&&(!s.discrepancies||s.discrepancies.length===0)&&Re(s)},Re=s=>{s.discrepancies||(s.discrepancies=[]),s.discrepancies.push({reason_id:null,notes:""})},et=(s,e)=>{s.discrepancies&&s.discrepancies.splice(e,1)},Ue=E(()=>{const s={good_qty:0,damaged_qty:0,reject_qty:0,actual_qty:0};return D.products.forEach(e=>{s.good_qty+=Number(e.good_qty)||0,s.damaged_qty+=Number(e.damaged_qty)||0,s.reject_qty+=Number(e.reject_qty)||0,s.actual_qty+=Number(e.actual_qty)||0}),s}),tl=E(()=>!D.produced_at||D.products.length===0?!1:D.products.every(e=>(Number(e.good_qty)||0)>=0&&(Number(e.damaged_qty)||0)>=0&&(Number(e.reject_qty)||0)>=0)&&!J.value),tt=async()=>{J.value=!0;try{const s={produced_at:He(D.produced_at),notes:D.notes,products:D.products.map(a=>({production_id:a.production_id,good_qty:Number(a.good_qty)||0,damaged_qty:Number(a.damaged_qty)||0,reject_qty:Number(a.reject_qty)||0,actual_qty:Number(a.actual_qty)||0,discrepancies:(a.discrepancies||[]).filter(r=>r.reason_id)}))},e=await fetch(`/productions/batches/${D.batch_id}/actual`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),u=await e.json();if(!e.ok){alert(u.message||"Failed to save actual production.");return}re.value=!1,await Pe(),Fe()}catch(s){console.error("Failed to save batch actual production:",s),alert("Failed to save actual production. Please try again.")}finally{J.value=!1}},ll=s=>{Xe(s)},al=async s=>{if(confirm(`Are you sure you want to delete batch ${s.batch_code}? This will also delete all productions in this batch.`))try{await fetch(`/productions/batches/${s.id}`,{method:"DELETE"}),await Pe()}catch(e){console.error("Failed to delete batch:",e),alert("Failed to delete batch. Please try again.")}},ol=s=>{mt({id:s})},dl=E(()=>L.value?X.value.length:M.value.length),sl=E(()=>L.value?X.value.reduce((s,e)=>s+Number(e.total_good_qty||0),0):M.value.reduce((s,e)=>s+Number(e.qty_product||e.total_qty||0),0)),il=E(()=>L.value?X.value.reduce((s,e)=>s+(e.staff?e.staff.length:0),0):M.value.reduce((s,e)=>s+Number(e.staff_count||0),0)),nl=E(()=>M.value.reduce((s,e)=>s+Number(e.total_pay||0),0).toFixed(2)),lt=E(()=>g.products.flatMap(e=>e.ingredients||[]).some(e=>e.exceeds)),at=E(()=>{const s=g.staff.map(e=>{var u;return typeof e.staff_id=="object"?(u=e.staff_id)==null?void 0:u.id:e.staff_id}).filter(Boolean);return ze.value.filter(e=>!s.includes(e.id))}),ot=E(()=>g.staff.filter(s=>s.staff_id).length),dt=E(()=>g.products.reduce((s,e)=>s+Number(e.computed_qty_product||0),0)),st=E(()=>{const s=new Map;for(const e of g.products)for(const u of e.ingredients||[]){if(!u.item_id)continue;s.has(u.item_id)||s.set(u.item_id,{item_id:u.item_id,item_name:u.item_name,unit:u.unit,qty_required:0,available:u.available||0,exceeds:u.exceeds||!1});const a=s.get(u.item_id);a.qty_required+=Number(u.qty_required||0)}return Array.from(s.values()).sort((e,u)=>e.item_name.localeCompare(u.item_name))}),rl=E(()=>{if(!g.planned_at||!g.products.length)return!1;for(const u of g.products)if(!u.product_id||!u.mode||!u.computed_qty_product||u.computed_qty_product<=0||!u.ingredients||!u.ingredients.length)return!1;const s=g.staff.some(u=>u.staff_id),e=g.products.every(u=>(u.productGroups||[]).every(a=>!a.is_mandatory||u.group_choices[a.id]));return!(lt.value||!e||!s||J.value)});function oe(s){return s?new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}function Se(s){var e;return((e=xe.value.find(u=>u.id===s))==null?void 0:e.name)||"Product"}function ul(s){const e=Se(s.product_id);return s.product_id?s.computed_qty_product?`${e} • ${s.computed_qty_product} units`:e:"Select product & mode"}function cl(s,e){const u=Se(s.product_id);return`${e+1}. ${u}`}const Ge=A(!1);function ml(){const s=dt.value,e=Number(g.good_qty||0);Ge.value=!!(s&&e!==s),Ge.value&&!g.discrepancies.length&&fl()}function fl(){g.discrepancies.push({reason_id:null,notes:""})}function it(){g.staff.push({staff_id:null,role:"",notes:""})}function pl(s){g.staff.splice(s,1)}function _l(){g.staff=[]}let gl=1;function nt(){return{uid:gl++,product_id:null,mode:"by_product",qty_product_input:null,base_ingredient_id:null,base_ingredient_qty:null,baseUnit:"",computed_qty_product:0,recipeItems:[],productGroups:[],group_choices:{},expandedGroups:[],ingredients:[],innerTab:"ingredients"}}function Ee(){g.products.push(nt()),Z.value==="summary"&&(Z.value=0),de()}function yl(s){g.products.splice(s,1),typeof Z.value=="number"&&Z.value>=g.products.length&&(Z.value=g.products.length?g.products.length-1:"summary"),de()}async function rt(s){const e=Be.value.find(u=>u.product_id===s.product_id);if(e){Object.keys(e).forEach(u=>{s[u]=e[u]}),de();return}if(s.recipeItems=[],s.productGroups=[],s.group_choices={},s.expandedGroups=[],s.ingredients=[],s.base_ingredient_id=null,s.base_ingredient_qty=null,s.baseUnit="",s.computed_qty_product=0,!!s.product_id)try{const a=await(await fetch(`/products/${s.product_id}/groups?active=true`)).json();s.recipeItems=a.fixed_items||[],s.productGroups=a.groups||[];const r=ae.value.find(i=>i.product===s.product_id);if(!be.value&&r){s.productGroups=[];for(const i of ae.value||[]){if(i.product!==s.product_id)continue;const f=await(await fetch(`/products/groups/${i.group}`)).json();f.deprecated=!0,s.productGroups.push(f)}}s.productGroups.forEach((i,_)=>{var U;const f=(U=i.combinations)==null?void 0:U.find(ie=>ie.is_default);f&&(s.group_choices[i.id]=f.id),s.expandedGroups.push(_)}),ce(s)}catch(u){console.error("Failed to load product details:",u)}}function ce(s){var a;if(!s.product_id||!s.mode){s.ingredients=[],s.computed_qty_product=0,de();return}let e=0;if(s.mode==="by_product")e=Number(s.qty_product_input||0);else if(s.mode==="by_ingredient"){const r=s.recipeItems.find(i=>i.item_id===Number(s.base_ingredient_id));s.baseUnit=(r==null?void 0:r.unit)||"",r&&r.quantity_per_unit>0&&s.base_ingredient_qty>0&&(e=Number(s.base_ingredient_qty)/r.quantity_per_unit)}if(!e||e<=0){s.ingredients=[],s.computed_qty_product=0,de();return}s.computed_qty_product=+e.toFixed(3);const u=[];for(const r of s.recipeItems){const i=+(r.quantity_per_unit*e).toFixed(3);u.push({item_id:r.item_id,item_name:r.item_name,unit_id:r.unit_id,unit:r.unit,qty_required:i,from_group:!1,group_id:null,group_name:null,combination_id:null})}for(const r of s.productGroups){const i=s.group_choices[r.id];if(!i)continue;const _=(a=r.combinations)==null?void 0:a.find(f=>f.id===i);if(!(!_||!_.options))for(const f of _.options){const U=+(f.quantity_per_unit*e).toFixed(3);u.push({item_id:f.item_id,item_name:f.item_name,unit:f.unit,qty_required:U,from_group:!0,group_id:r.id,group_name:r.name,combination_id:i})}}s.ingredients=u,de()}function Oe(){ee.value=!0,G.value=!1,ue.value=!1,R.value=!0,Ce(),Ee(),it()}function ut(){ee.value=!1,Ge.value=!1,G.value=!1,ue.value=!1,Ce()}function Ce(){Object.assign(g,{id:null,planned_at:null,produced_at:null,notes:"",good_qty:null,damaged_qty:null,reject_qty:null,actual_qty:null,discrepancies:[],staff:[],products:[]}),Z.value=0,ae.value=[],be.value=!1,Be.value=[],ve.value=!1}function vl(){Object.assign($,{product_id:"",status:"all",planned_at:"",planned_end:"",planned_at_op:"=",produced_at:"",produced_end:"",produced_at_op:"=",team_leader:"",discrepancy_reason:[]}),Ve()}function bl(){K.value=1,Ve()}async function xl(){O.value=!0;try{const s=new URLSearchParams({page:K.value,limit:10});Object.entries($).forEach(([a,r])=>{r&&r!=="all"&&!(Array.isArray(r)&&!r.length)&&s.append(a,r)});const u=await(await fetch(`/productions?${s.toString()}`)).json();M.value=u.data||[],_e.value=u.totalPages||1}catch(s){console.error("Failed to load productions:",s),M.value=[]}finally{O.value=!1}}async function Vl(){try{const e=await(await fetch("/products?limit=1000&page=1&active=true")).json();xe.value=e.data||[]}catch(s){console.error("Failed to load products:",s)}}async function wl(){try{const e=await(await fetch("/staffs?status=Active&limit=1000&page=1")).json();ze.value=e.data||[]}catch(s){console.error("Failed to load staff:",s)}}async function ct(){try{const s=await fetch("/items/availableStock");Ye.value=await s.json()}catch(s){console.error("Failed to load stock:",s)}}async function kl(){try{const e=await(await fetch("/productions/discrepancyReasons")).json();Me.value=e.data||[]}catch(s){console.error("Failed to load discrepancy reasons:",s)}}async function mt(s){try{const e=await fetch(`/productions/${s.id}`);q.value=await e.json(),ge.value=!0}catch(e){console.error("Failed to load production details:",e)}}const ft=s=>({"Team Leader":"blue",Assistant:"green",Support:"orange"})[s]||"grey";function ql(s,e){let u=0;for(const r of g.products)for(const i of r.ingredients||[])i.item_id===s&&(u+=Number(i.qty_required||0));if(u<=e)return;const a=e/u;for(const r of g.products)for(const i of r.ingredients||[])i.item_id===s&&(i.qty_required=+(Number(i.qty_required||0)*a).toFixed(3));de()}function de(){const s=new Map;for(const e of g.products)for(const u of e.ingredients||[]){if(!u.item_id)continue;const a=u.item_id;s.has(a)||s.set(a,{item_id:u.item_id,item_name:u.item_name,unit:u.unit,total_required:0,available:0,balance:0,exceeds:!1,previously_used:0});const r=s.get(a);r.total_required+=Number(u.qty_required||0)}for(const[e,u]of s){const a=Ye.value.find(_=>_.item_id===e),r=a?Number(a.available_qty):0;let i=0;if(G.value)for(const _ of g.products)for(const f of _.ingredients||[])f.item_id===e&&(f.previously_used!==void 0?i+=Number(f.previously_used||0):i+=Number(f.qty_required||0));u.available=r+i,u.previously_used=i,u.exceeds=u.total_required>u.available,u.balance=parseFloat((u.available-u.total_required).toFixed(6))}for(const e of g.products)for(const u of e.ingredients||[]){if(!u.item_id)continue;const a=s.get(u.item_id);a&&(u.available=a.available,u.exceeds=a.exceeds,u.balance=a.balance,u.previously_used=a.previously_used)}}const pt=s=>{G.value=!0,ue.value=!1,ee.value=!0,R.value=!0;const e=g.id;Ce(),be.value=s,_t(e)},hl=s=>{G.value=!0,ue.value=!1,ee.value=!0,R.value=!0,Ce(),_t(s.id)},_t=async s=>{try{const e=await fetch(`/productions/batches/${s}`),u=await e.json();if(!e.ok)throw new Error(u.message||"Failed to load batch for editing.");g.id=u.batch.id,g.notes=u.batch.notes||"",g.planned_at=Le(u.batch.planned_at),g.produced_at=Le(u.batch.produced_at),g.products=[],(u.products||[]).forEach(a=>{for(const i of xe.value)i.id===a.product_id&&(i.editing=!0);const r=nt();r.production_id=a.production_id,r.product_id=a.product_id,r.product_name=a.product_name,r.planned_qty=a.qty_product||"",r.good_qty=a.good_qty||"",r.damaged_qty=a.damaged_qty||"",r.reject_qty=a.reject_qty||"",r.actual_qty=a.actual_qty||"",r.hasDiscrepancy=a.discrepancies.length>0,r.discrepancies=a.discrepancies||[],r.mode=a.mode||"by_product",g.staff=a.staff||[],(a.good_qty||a.damaged_qty||a.reject_qty)&&(ve.value=!0),r.mode==="by_product"?r.qty_product_input=Number(a.qty_product||0):(r.base_ingredient_id=a.base_ingredient_id||null,r.base_ingredient_qty=a.base_ingredient_qty||null),r.computed_qty_product=Number(a.qty_product||0)||0,g.products.push(r)}),g.products.length||Ee();for(const a of u.products||[]){ae.value=a.ingredients.filter(f=>f.group_active===!1&&f.group_id!==null).map(f=>({product:a.product_id,group:f.group_id})),ae.value.length&&(ae.value=[...new Map(ae.value.map(f=>[`${f.product}-${f.group}`,f])).values()]);const r=g.products.find(f=>f.production_id===a.production_id)||g.products.find(f=>f.product_id===a.product_id);if(!r||!r.product_id)continue;await rt(r);const i=a.group_choices||[];i.length?i.forEach(f=>{f.group_id&&f.combination_id&&(r.group_choices[f.group_id]=f.combination_id)}):Array.isArray(a.ingredients)&&a.ingredients.forEach(f=>{f.group_id&&f.combination_id&&(r.group_choices[f.group_id]=f.combination_id)});const _=JSON.parse(JSON.stringify(r.ingredients));if(Array.isArray(a.ingredients)&&a.ingredients.length){r.ingredients=[];for(const f of a.ingredients){if(be.value&&!_.find(ie=>ie.item_id===f.item_id))continue;const U=Number(f.qty_required||f.quantity||0);r.ingredients.push({item_id:f.item_id,item_name:f.item_name,unit:f.unit,qty_required:U,previously_used:U,from_group:!!f.group_id,group_id:f.group_id||null,group_name:f.group_name||null,combination_id:f.combination_id||null})}}Be.value.push(JSON.parse(JSON.stringify(r)))}Z.value=g.products.length?0:"summary",ml(),de()}catch(e){console.error("Failed to load batch for editing:",e),alert("Failed to load batch for editing."),ee.value=!1}};async function gt(){J.value=!0;try{const s=g.products.map(_=>{const f=Object.entries(_.group_choices||{}).filter(([,U])=>U).map(([U,ie])=>({group_id:Number(U),combination_id:ie}));return{production_id:_.production_id||null,product_id:_.product_id,mode:_.mode,qty_product:_.computed_qty_product,good_qty:_.good_qty||0,damaged_qty:_.damaged_qty||0,reject_qty:_.reject_qty||0,actual_qty:_.actual_qty||0,discrepancies:_.discrepancies,base_ingredient_id:_.base_ingredient_id,base_ingredient_qty:_.base_ingredient_qty,ingredients:(_.ingredients||[]).map(U=>({item_id:U.item_id,qty_required:Number(U.qty_required||0),unit:U.unit,group_id:U.group_id||null,combination_id:U.combination_id||null})),group_choices:f}}),e={planned_at:He(g.planned_at),produced_at:g.produced_at?He(g.produced_at):null,notes:g.notes,products:s,staffs:g.staff.filter(_=>_.staff_id).map(_=>({staff_id:typeof _.staff_id=="object"?_.staff_id.id:_.staff_id,role:_.role||null,notes:_.notes||null}))},u=G.value?`/productions/${g.id}`:"/productions",a=G.value?"PUT":"POST",r=await fetch(u,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await r.json();if(!r.ok){i.error==="INSUFFICIENT_STOCK"?alert(`${i.message}
Available: ${i.details.available}
Required: ${i.details.required}`):alert(i.message||"Failed to save production.");return}ee.value=!1,Ce(),await ct(),await Ve()}catch(s){console.error("Failed to save production:",s),alert("Failed to save production. Please try again.")}finally{J.value=!1}}return Il(async()=>{await Promise.all([wl(),Vl(),Ve(),kl(),ct()])}),(s,e)=>{const u=Dl("VueDatePicker");return m(),y(jl,{class:"production-container",fluid:""},{default:t(()=>[g.damaged_qty>0||g.reject_qty>0?(m(),y(le,{key:0,border:"start",class:"mt-2",type:"warning",variant:"tonal"},{default:t(()=>e[29]||(e[29]=[d(" Some quantities were marked as damaged or reject — please ensure they're tracked in the ledger. ")])),_:1})):x("",!0),l(v,{class:"mb-6",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-6"},{default:t(()=>[o("div",Zl,[e[33]||(e[33]=o("div",null,[o("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Production Management "),o("p",{class:"text-body-1 text-grey"}," Manage production batches and individual productions ")],-1)),o("div",Xl,[s.$store.getters.hasTask("can_schedule_production")?(m(),y(h,{key:0,class:"px-6",color:"primary",elevation:"2",size:"large",onClick:Oe},{default:t(()=>[l(c,{size:"20",start:""},{default:t(()=>e[30]||(e[30]=[d("mdi-plus-circle")])),_:1}),e[31]||(e[31]=d(" New Production "))]),_:1})):x("",!0),l(h,{class:"px-6",color:"secondary",elevation:"2",size:"large",onClick:Wt},{default:t(()=>[l(c,{size:"20",start:""},{default:t(()=>e[32]||(e[32]=[d("mdi-view-grid")])),_:1}),d(" "+n(L.value?"Show Individual":"Show Batches"),1)]),_:1})])])]),_:1})]),_:1}),l(j,{class:"mb-6"},{default:t(()=>[l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",ea,[l(z,{class:"mr-3",color:"blue-lighten-5",size:"48"},{default:t(()=>[l(c,{color:"blue",size:"24"},{default:t(()=>e[34]||(e[34]=[d("mdi-factory")])),_:1})]),_:1}),o("div",null,[o("div",ta,n(L.value?X.value.length:M.value.length),1),o("div",la,n(L.value?"Total Batches":"Total Productions"),1)])])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",aa,[l(z,{class:"mr-3",color:"green-lighten-5",size:"48"},{default:t(()=>[l(c,{color:"green",size:"24"},{default:t(()=>e[35]||(e[35]=[d("mdi-account-group")])),_:1})]),_:1}),o("div",null,[o("div",oa,n(il.value),1),e[36]||(e[36]=o("div",{class:"text-caption text-grey"},"Staff Assignments",-1))])])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",da,[l(z,{class:"mr-3",color:"orange-lighten-5",size:"48"},{default:t(()=>[l(c,{color:"orange",size:"24"},{default:t(()=>e[37]||(e[37]=[d("mdi-chart-line")])),_:1})]),_:1}),o("div",null,[o("div",sa,n(sl.value),1),e[38]||(e[38]=o("div",{class:"text-caption text-grey"},"Total Units (Planned)",-1))])])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3",sm:"6"},{default:t(()=>[l(v,{border:"",class:"stat-card",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",ia,[l(z,{class:"mr-3",color:"purple-lighten-5",size:"48"},{default:t(()=>[l(c,{color:"purple",size:"24"},{default:t(()=>e[39]||(e[39]=[d("mdi-cash-multiple")])),_:1})]),_:1}),o("div",null,[o("div",na,n(nl.value),1),e[40]||(e[40]=o("div",{class:"text-caption text-grey"},"Labor Cost",-1))])])]),_:1})]),_:1})]),_:1})]),_:1}),L.value?(m(),y(v,{key:1,class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-0"},{default:t(()=>[o("div",ra,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[41]||(e[41]=[d("mdi-view-grid")])),_:1}),e[42]||(e[42]=o("h3",{class:"text-h6 font-weight-medium"},"Production Batches",-1))]),l(v,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",ua,[l(z,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(c,{color:"primary"},{default:t(()=>e[43]||(e[43]=[d("mdi-filter")])),_:1})]),_:1}),e[44]||(e[44]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Batch Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your batch records ")],-1)),l(te),l(w,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(n(Kt.value)+" Active ",1)]),_:1})]),l(me,{class:"mb-6"}),l(j,{class:"align-start",dense:""},{default:t(()=>[l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",ca,[l(c,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[45]||(e[45]=[d("mdi-package-variant")])),_:1}),e[46]||(e[46]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(pe,{modelValue:B.product_id,"onUpdate:modelValue":e[0]||(e[0]=a=>B.product_id=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:xe.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",ma,[l(c,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[47]||(e[47]=[d("mdi-progress-clock")])),_:1}),e[48]||(e[48]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(ne,{modelValue:B.status,"onUpdate:modelValue":e[1]||(e[1]=a=>B.status=a),color:"primary",density:"compact","hide-details":"",items:Gt,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:r})=>[l(Y,ht(zt(r)),{prepend:t(()=>[l(c,{color:a.raw.color||"grey"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",fa,[l(c,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,n(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",pa,[l(c,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[49]||(e[49]=[d("mdi-account-tie")])),_:1}),e[50]||(e[50]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(pe,{modelValue:B.team_leader,"onUpdate:modelValue":e[2]||(e[2]=a=>B.team_leader=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:ze.value,placeholder:"All Leaders",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(v,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",_a,[l(c,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[51]||(e[51]=[d("mdi-calendar-clock")])),_:1}),e[52]||(e[52]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(j,{class:"align-center",dense:""},{default:t(()=>[l(p,{cols:"12",sm:"4"},{default:t(()=>[l(ne,{modelValue:B.planned_at_op,"onUpdate:modelValue":e[3]||(e[3]=a=>B.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:Je,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(p,{cols:"12",sm:"4"},{default:t(()=>[l(u,{modelValue:B.planned_at,"onUpdate:modelValue":e[4]||(e[4]=a=>B.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),B.planned_at_op==="in"?(m(),y(p,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(u,{modelValue:B.planned_end,"onUpdate:modelValue":e[5]||(e[5]=a=>B.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(me,{class:"mt-4 mb-4"}),o("div",ga,[o("div",ya,[l(c,{class:"mr-1",size:"14"},{default:t(()=>e[53]||(e[53]=[d("mdi-information")])),_:1}),e[54]||(e[54]=d(" Use filters to find specific batch records "))]),o("div",va,[l(h,{class:"px-4",color:"grey",variant:"outlined",onClick:Zt},{default:t(()=>[l(c,{size:"18",start:""},{default:t(()=>e[55]||(e[55]=[d("mdi-refresh")])),_:1}),e[56]||(e[56]=d(" Reset All "))]),_:1}),l(h,{class:"px-4",color:"primary",elevation:"2",onClick:Xt},{default:t(()=>[l(c,{size:"18",start:""},{default:t(()=>e[57]||(e[57]=[d("mdi-filter-check")])),_:1}),e[58]||(e[58]=d(" Apply Filters "))]),_:1})])])]),_:1}),l(Pt,{active:O.value,color:"primary",height:"4",indeterminate:O.value},null,8,["active","indeterminate"]),l(qe,{class:"elevation-0",density:"comfortable",headers:Et,hover:"",items:X.value,loading:O.value,search:Ae.value},{loading:t(()=>[l(St,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(w,{class:"font-weight-bold text-uppercase",color:We(a.status),size:"small",variant:"flat"},{default:t(()=>[d(n(Ze(a.status)),1)]),_:2},1032,["color"])]),"item.batch_code":t(({item:a})=>[o("div",ba,[l(z,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"16"},{default:t(()=>e[59]||(e[59]=[d("mdi-package-variant")])),_:1})]),_:1}),o("div",null,[o("div",xa,n(a.batch_code),1),o("div",Va,n(a.total_products)+" products ",1)])])]),"item.production_stats":t(({item:a})=>[o("div",wa,[l(w,{class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(a.total_good_qty||0)+" good ",1)]),_:2},1024),l(w,{class:"mr-1 mb-1",color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(a.total_damaged_qty||0)+" damaged ",1)]),_:2},1024),l(w,{class:"mb-1",color:"red",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(a.total_reject_qty||0)+" reject ",1)]),_:2},1024)])]),"item.planned_at":t(({item:a})=>[o("div",ka,n(oe(a.planned_at)),1)]),"item.produced_at":t(({item:a})=>[o("div",qa,n(oe(a.produced_at)||"Not completed"),1)]),"item.team_leader_name":t(({item:a})=>[o("div",ha,[l(z,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(c,{color:"blue-grey",size:"14"},{default:t(()=>e[60]||(e[60]=[d("mdi-account-tie")])),_:1})]),_:1}),o("span",za,n(a.team_leader_name),1)])]),"item.actions":t(({item:a})=>[o("div",Pa,[l(Ut,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:r})=>[l(h,he(r,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[l(c,null,{default:t(()=>e[61]||(e[61]=[d("mdi-dots-vertical")])),_:1})]),_:2},1040)]),default:t(()=>[l(v,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(b,{class:se(["pa-4",Qt(a.status)])},{default:t(()=>[o("div",Ca,[o("div",Aa,[l(z,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"18"},{default:t(()=>e[62]||(e[62]=[d(" mdi-package-variant ")])),_:1})]),_:1}),o("div",null,[e[63]||(e[63]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Batch Actions ",-1)),o("div",Ua,n(a.batch_code),1)])]),l(w,{color:"white",size:"small",variant:"flat"},{default:t(()=>[d(n(a.status),1)]),_:2},1024)])]),_:2},1032,["class"]),l(fe,{class:"pa-2",density:"compact"},{default:t(()=>[s.$store.getters.hasTask("can_see_production")?(m(),y(Y,{key:0,class:"rounded-lg mb-1 action-item",onClick:r=>Xe(a)},{prepend:t(()=>[l(z,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(c,{color:"blue",size:"18"},{default:t(()=>e[64]||(e[64]=[d(" mdi-eye-outline ")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[65]||(e[65]=[d(" View Batch Details ")])),_:1}),l(H,{class:"text-caption text-blue"},{default:t(()=>e[66]||(e[66]=[d(" Complete batch information ")])),_:1})]),_:2},1032,["onClick"])):x("",!0),a.produced_count>0&&s.$store.getters.hasTask("can_edit_actual_production")||a.produced_count<=0&&s.$store.getters.hasTask("can_add_actual_production")?(m(),y(Y,{key:1,class:"rounded-lg mb-1 action-item",onClick:r=>el(a)},{prepend:t(()=>[l(z,{class:"mr-3",color:"green-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(c,{color:"green",size:"18"},{default:t(()=>e[67]||(e[67]=[d(" mdi-plus-circle ")])),_:1})]),_:1})]),default:t(()=>[a.produced_count>0?(m(),C(T,{key:0},[l(W,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[68]||(e[68]=[d(" Edit Actual Production ")])),_:1}),l(H,{class:"text-caption text-green"},{default:t(()=>e[69]||(e[69]=[d(" Edit Recorded output for all products ")])),_:1})],64)):(m(),C(T,{key:1},[l(W,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[70]||(e[70]=[d(" Add Actual Production ")])),_:1}),l(H,{class:"text-caption text-green"},{default:t(()=>e[71]||(e[71]=[d(" Record output for all products ")])),_:1})],64))]),_:2},1032,["onClick"])):x("",!0),s.$store.getters.hasTask("can_edit_production")?(m(),y(Y,{key:2,class:"rounded-lg mb-1 action-item",onClick:r=>hl(a)},{prepend:t(()=>[l(z,{class:"mr-3",color:"orange-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(c,{color:"orange",size:"18"},{default:t(()=>e[72]||(e[72]=[d(" mdi-pencil-outline ")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[73]||(e[73]=[d(" Edit Batch ")])),_:1}),l(H,{class:"text-caption text-orange"},{default:t(()=>e[74]||(e[74]=[d(" Modify batch products & staff ")])),_:1})]),_:2},1032,["onClick"])):x("",!0),l(Y,{class:"rounded-lg mb-1 action-item",onClick:r=>ll(a)},{prepend:t(()=>[l(z,{class:"mr-3",color:"purple-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(c,{color:"purple",size:"18"},{default:t(()=>e[75]||(e[75]=[d(" mdi-format-list-bulleted ")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[76]||(e[76]=[d(" View Products ")])),_:1}),l(H,{class:"text-caption text-purple"},{default:t(()=>e[77]||(e[77]=[d(" See all products in batch ")])),_:1})]),_:2},1032,["onClick"]),l(me,{class:"my-2"}),s.$store.getters.hasTask("can_delete_production")?(m(),y(Y,{key:3,class:"rounded-lg action-item text-error",onClick:r=>al(a)},{prepend:t(()=>[l(z,{class:"mr-3",color:"red-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(c,{color:"red",size:"18"},{default:t(()=>e[78]||(e[78]=[d(" mdi-delete-outline ")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"text-body-2 font-weight-medium text-error"},{default:t(()=>e[79]||(e[79]=[d(" Delete Batch ")])),_:1}),l(H,{class:"text-caption text-red"},{default:t(()=>e[80]||(e[80]=[d(" Remove permanently ")])),_:1})]),_:2},1032,["onClick"])):x("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",Sa,[l(c,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[81]||(e[81]=[d(" mdi-inbox ")])),_:1}),e[84]||(e[84]=o("div",{class:"text-h6 text-grey"},"No batches found",-1)),e[85]||(e[85]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production batch ",-1)),l(h,{class:"mt-4",color:"primary",onClick:Oe},{default:t(()=>[l(c,{start:""},{default:t(()=>e[82]||(e[82]=[d("mdi-plus")])),_:1}),e[83]||(e[83]=d(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1})):(m(),y(v,{key:2,class:"mb-4",elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-0"},{default:t(()=>[o("div",Ia,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[86]||(e[86]=[d("mdi-table")])),_:1}),e[87]||(e[87]=o("h3",{class:"text-h6 font-weight-medium"},"Production Records",-1))]),l(v,{border:"",class:"pa-6 mb-6",elevation:"3",rounded:"lg"},{default:t(()=>[o("div",Da,[l(z,{class:"mr-3",color:"primary",size:"40",variant:"tonal"},{default:t(()=>[l(c,{color:"primary"},{default:t(()=>e[88]||(e[88]=[d("mdi-filter")])),_:1})]),_:1}),e[89]||(e[89]=o("div",null,[o("h3",{class:"text-h6 font-weight-bold text-primary"}," Production Filters "),o("p",{class:"text-caption text-grey mt-1"}," Refine your production records ")],-1)),l(te),l(w,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(n(Jt.value)+" Active ",1)]),_:1})]),l(me,{class:"mb-6"}),l(j,{class:"align-start",dense:""},{default:t(()=>[l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",ja,[l(c,{class:"mr-2",color:"primary",size:"18"},{default:t(()=>e[90]||(e[90]=[d("mdi-package-variant")])),_:1}),e[91]||(e[91]=o("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),l(pe,{modelValue:$.product_id,"onUpdate:modelValue":e[6]||(e[6]=a=>$.product_id=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:xe.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",Na,[l(c,{class:"mr-2",color:"blue",size:"18"},{default:t(()=>e[92]||(e[92]=[d("mdi-progress-clock")])),_:1}),e[93]||(e[93]=o("label",{class:"text-caption font-weight-medium text-primary"},"Status",-1))]),l(ne,{modelValue:$.status,"onUpdate:modelValue":e[7]||(e[7]=a=>$.status=a),color:"primary",density:"compact","hide-details":"",items:Rt,placeholder:"Select Status",variant:"underlined"},{item:t(({item:a,props:r})=>[l(Y,ht(zt(r)),{prepend:t(()=>[l(c,{color:a.raw.color||"grey"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:t(({item:a})=>[o("div",Ta,[l(c,{class:"mr-2",color:a.raw.color||"grey",size:"16"},{default:t(()=>[d(n(a.raw.icon),1)]),_:2},1032,["color"]),o("span",null,n(a.title),1)])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"3",md:"4",sm:"6"},{default:t(()=>[l(v,{border:"",class:"rounded-lg h-100",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",$a,[l(c,{class:"mr-2",color:"purple",size:"18"},{default:t(()=>e[94]||(e[94]=[d("mdi-account-tie")])),_:1}),e[95]||(e[95]=o("label",{class:"text-caption font-weight-medium text-primary"},"Team Leader",-1))]),l(pe,{modelValue:$.team_leader,"onUpdate:modelValue":e[8]||(e[8]=a=>$.team_leader=a),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:ze.value,placeholder:"All Leaders",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",lg:"6",md:"8"},{default:t(()=>[l(v,{border:"",class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",Ba,[l(c,{class:"mr-2",color:"green",size:"18"},{default:t(()=>e[96]||(e[96]=[d("mdi-calendar-clock")])),_:1}),e[97]||(e[97]=o("label",{class:"text-caption font-weight-medium text-primary"},"Planned Date Range",-1))]),l(j,{class:"align-center",dense:""},{default:t(()=>[l(p,{cols:"12",sm:"4"},{default:t(()=>[l(ne,{modelValue:$.planned_at_op,"onUpdate:modelValue":e[9]||(e[9]=a=>$.planned_at_op=a),color:"primary",density:"compact","hide-details":"",items:Je,variant:"underlined"},null,8,["modelValue"])]),_:1}),l(p,{cols:"12",sm:"4"},{default:t(()=>[l(u,{modelValue:$.planned_at,"onUpdate:modelValue":e[10]||(e[10]=a=>$.planned_at=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1}),$.planned_at_op==="in"?(m(),y(p,{key:0,cols:"12",sm:"4"},{default:t(()=>[l(u,{modelValue:$.planned_end,"onUpdate:modelValue":e[11]||(e[11]=a=>$.planned_end=a),"auto-apply":"",format:"dd-MM-yyyy","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(me,{class:"mt-4 mb-4"}),o("div",Ma,[o("div",Fa,[l(c,{class:"mr-1",size:"14"},{default:t(()=>e[98]||(e[98]=[d("mdi-information")])),_:1}),e[99]||(e[99]=d(" Use filters to find specific production records "))]),o("div",Ra,[l(h,{class:"px-4",color:"grey",variant:"outlined",onClick:vl},{default:t(()=>[l(c,{size:"18",start:""},{default:t(()=>e[100]||(e[100]=[d("mdi-refresh")])),_:1}),e[101]||(e[101]=d(" Reset All "))]),_:1}),l(h,{class:"px-4",color:"primary",elevation:"2",onClick:bl},{default:t(()=>[l(c,{size:"18",start:""},{default:t(()=>e[102]||(e[102]=[d("mdi-filter-check")])),_:1}),e[103]||(e[103]=d(" Apply Filters "))]),_:1})])])]),_:1}),l(Pt,{active:O.value,color:"primary",height:"4",indeterminate:O.value},null,8,["active","indeterminate"]),l(qe,{class:"elevation-0",density:"comfortable",headers:Lt,hover:"",items:M.value,loading:O.value,search:Ae.value},{loading:t(()=>[l(St,{type:"table-row@10"})]),"item.status":t(({item:a})=>[l(w,{class:"font-weight-bold text-uppercase",color:a.produced_at?"green":"red",size:"small",variant:"flat"},{default:t(()=>[d(n(a.produced_at?"Completed":"Pending"),1)]),_:2},1032,["color"])]),"item.product_name":t(({item:a})=>[o("div",Ga,[l(z,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"16"},{default:t(()=>e[104]||(e[104]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",Ea,n(a.product_name||a.batch_label),1),o("div",Oa,n(a.mode||"Multiple Products"),1)])])]),"item.qty_product":t(({item:a})=>[l(w,{color:"green",size:"small",variant:"flat"},{default:t(()=>[l(c,{size:"16",start:""},{default:t(()=>e[105]||(e[105]=[d("mdi-counter")])),_:1}),d(" "+n(parseFloat(a.qty_product||a.total_qty||0)),1)]),_:2},1024)]),"item.staff_count":t(({item:a})=>[o("div",La,[l(z,{class:"mr-2",color:"blue-lighten-5",size:"28"},{default:t(()=>[l(c,{color:"blue",size:"14"},{default:t(()=>e[106]||(e[106]=[d("mdi-account-group")])),_:1})]),_:1}),o("span",Ha,n(a.staff_count||0),1)])]),"item.planned_at":t(({item:a})=>[o("div",Qa,n(a.planned_at),1)]),"item.produced_at":t(({item:a})=>[o("div",Ya,n(a.produced_at),1)]),"item.produced_by_name":t(({item:a})=>[o("div",Ja,[l(z,{class:"mr-2",color:"blue-grey-lighten-5",size:"28"},{default:t(()=>[l(c,{color:"blue-grey",size:"14"},{default:t(()=>e[107]||(e[107]=[d("mdi-account")])),_:1})]),_:1}),o("span",Ka,n(a.produced_by_name),1)])]),"item.actions":t(({item:a})=>[o("div",Wa,[l(Ut,{"close-on-content-click":!1,location:"bottom end",transition:"scale-transition"},{activator:t(({props:r})=>[l(h,he(r,{class:"action-menu-btn",color:"primary",icon:"",size:"small",variant:"text"}),{default:t(()=>[a.produced_at?(m(),y(c,{key:1},{default:t(()=>e[109]||(e[109]=[d("mdi-dots-vertical")])),_:1})):(m(),y(Ml,{key:0,color:"orange",dot:"",location:"top end","offset-x":"2","offset-y":"2"},{default:t(()=>[l(c,null,{default:t(()=>e[108]||(e[108]=[d("mdi-dots-vertical")])),_:1})]),_:1}))]),_:2},1040)]),default:t(()=>[l(v,{elevation:"8","min-width":"240",rounded:"lg"},{default:t(()=>[l(b,{class:se(["pa-4",Yt(a.produced_at?"completed":"pending")])},{default:t(()=>[o("div",Za,[o("div",Xa,[l(z,{class:"mr-3",color:"white",size:"32",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"18"},{default:t(()=>e[110]||(e[110]=[d(" mdi-factory ")])),_:1})]),_:1}),o("div",null,[e[111]||(e[111]=o("div",{class:"text-white text-body-2 font-weight-bold"}," Production Actions ",-1)),o("div",eo,n(a.product_name||"Batch"),1)])]),l(w,{color:"white",size:"small",variant:"flat"},{default:t(()=>[d(n(a.produced_at?"completed":"pending"),1)]),_:2},1024)])]),_:2},1032,["class"]),l(fe,{class:"pa-2",density:"compact"},{default:t(()=>[l(Y,{class:"rounded-lg mb-1 action-item",onClick:r=>mt(a)},{prepend:t(()=>[l(z,{class:"mr-3",color:"blue-lighten-5",size:"36",variant:"flat"},{default:t(()=>[l(c,{color:"blue",size:"18"},{default:t(()=>e[112]||(e[112]=[d(" mdi-eye-outline ")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"text-body-2 font-weight-medium"},{default:t(()=>e[113]||(e[113]=[d(" View Details ")])),_:1}),l(H,{class:"text-caption text-blue"},{default:t(()=>e[114]||(e[114]=[d(" Complete information ")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[o("div",to,[l(c,{class:"mb-4",color:"grey-lighten-2",size:"64"},{default:t(()=>e[115]||(e[115]=[d(" mdi-inbox ")])),_:1}),e[118]||(e[118]=o("div",{class:"text-h6 text-grey"},"No productions found",-1)),e[119]||(e[119]=o("div",{class:"text-body-2 text-grey mt-2"}," Get started by creating your first production record ",-1)),l(h,{class:"mt-4",color:"primary",onClick:Oe},{default:t(()=>[l(c,{start:""},{default:t(()=>e[116]||(e[116]=[d("mdi-plus")])),_:1}),e[117]||(e[117]=d(" Create Production "))]),_:1})])]),_:1},8,["items","loading","search"])]),_:1})]),_:1})),l(v,{elevation:"2",rounded:"lg"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",lo,[o("div",ao," Showing "+n(L.value?X.value.length:M.value.length)+" of "+n(dl.value)+" records ",1),l(Bl,{modelValue:K.value,"onUpdate:modelValue":[e[12]||(e[12]=a=>K.value=a),Ve],color:"primary",length:_e.value,"total-visible":7},null,8,["modelValue","length"])])]),_:1})]),_:1}),l(Ne,{modelValue:ye.value,"onUpdate:modelValue":e[14]||(e[14]=a=>ye.value=a),"max-width":"1200",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(De,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(z,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(c,{color:"primary"},{default:t(()=>e[120]||(e[120]=[d("mdi-package-variant")])),_:1})]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a;return[d(" Batch Details - "+n((a=S.value)==null?void 0:a.batch_code),1)]}),_:1}),l(te),l(h,{color:"white",icon:"mdi-close",variant:"text",onClick:e[13]||(e[13]=a=>ye.value=!1)})]),_:1}),l(b,{class:"pa-6"},{default:t(()=>{var a,r;return[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[l(j,null,{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[121]||(e[121]=o("div",{class:"text-body-2 text-grey"},"Batch Code",-1)),o("div",oo,n((i=S.value)==null?void 0:i.batch_code),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[122]||(e[122]=o("div",{class:"text-body-2 text-grey"},"Status",-1)),l(w,{class:"mt-1",color:We((i=S.value)==null?void 0:i.status),size:"small"},{default:t(()=>{var _;return[d(n(Ze((_=S.value)==null?void 0:_.status)),1)]}),_:1},8,["color"])]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[123]||(e[123]=o("div",{class:"text-body-2 text-grey"},"Planned By",-1)),o("div",so,n((i=S.value)==null?void 0:i.created_by_name),1)]}),_:1})]),_:1}),l(j,{class:"mt-2"},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[124]||(e[124]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",io,n(oe((i=S.value)==null?void 0:i.planned_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[125]||(e[125]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",no,n(oe((i=S.value)==null?void 0:i.produced_at)||"Not completed"),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var i;return[e[126]||(e[126]=o("div",{class:"text-body-2 text-grey"},"Team Leader",-1)),o("div",ro,n((i=S.value)==null?void 0:i.team_leader_name),1)]}),_:1})]),_:1}),l(j,{class:"mt-4"},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var i;return[o("div",uo,n(((i=S.value)==null?void 0:i.total_good_qty)||0),1),e[127]||(e[127]=o("div",{class:"text-caption text-grey"},"Good Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var i;return[o("div",co,n(((i=S.value)==null?void 0:i.total_damaged_qty)||0),1),e[128]||(e[128]=o("div",{class:"text-caption text-grey"},"Damaged",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var i;return[o("div",mo,n(((i=S.value)==null?void 0:i.total_reject_qty)||0),1),e[129]||(e[129]=o("div",{class:"text-caption text-grey"},"Reject",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var i;return[o("div",fo,n(((i=S.value)==null?void 0:i.total_products)||0),1),e[130]||(e[130]=o("div",{class:"text-caption text-grey"},"Total Products",-1))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(v,{class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(ke,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[131]||(e[131]=[d("mdi-format-list-bulleted")])),_:1}),e[132]||(e[132]=d(" Products in Batch "))]),_:1}),l(b,{class:"pa-0"},{default:t(()=>{var i;return[l(qe,{class:"elevation-0",headers:Ot,items:((i=S.value)==null?void 0:i.products)||[]},{"item.product_name":t(({item:_})=>[o("div",po,[l(z,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"16"},{default:t(()=>e[133]||(e[133]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",_o,n(_.product_name),1),o("div",go," Planned: "+n(_.qty_product)+" units ",1)])])]),"item.produced":t(({item:_})=>[l(w,{color:_.produced_at?"green":"orange",size:"small",variant:"flat"},{default:t(()=>[d(n(_.produced_at?"Produced":"Pending"),1)]),_:2},1032,["color"])]),"item.good_qty":t(({item:_})=>[_.produced_at?(m(),C("div",yo,[o("span",vo,n(_.good_qty||0)+" good",1),o("span",bo,n(_.damaged_qty||0)+" damaged",1),o("span",xo,n(_.reject_qty||0)+" reject",1)])):(m(),C("span",Vo,"Not produced"))]),"item.actions":t(({item:_})=>[_.production_id?(m(),y(h,{key:0,color:"primary",size:"small",variant:"text",onClick:f=>ol(_.production_id)},{default:t(()=>[l(c,{size:"16"},{default:t(()=>e[134]||(e[134]=[d("mdi-eye")])),_:1}),e[135]||(e[135]=d(" View "))]),_:2},1032,["onClick"])):x("",!0)]),_:1},8,["items"])]}),_:1})]),_:1}),(r=(a=S.value)==null?void 0:a.staff)!=null&&r.length?(m(),y(v,{key:0,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(ke,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"mr-2",color:"blue"},{default:t(()=>e[136]||(e[136]=[d("mdi-account-group")])),_:1}),e[137]||(e[137]=d(" Staff Assignments ")),l(w,{class:"ml-2",color:"blue",size:"small",variant:"flat"},{default:t(()=>[d(n(S.value.staff.length)+" staff ",1)]),_:1})]),_:1}),l(b,{class:"pa-0"},{default:t(()=>[l(fe,{class:"pa-0",lines:"two"},{default:t(()=>[(m(!0),C(T,null,Q(S.value.staff,(i,_)=>(m(),y(Y,{key:i.staff_id,class:se(["px-4",{"bg-grey-lighten-4":_%2===0}])},{prepend:t(()=>[l(z,{class:"mr-3",color:"blue",size:"36"},{default:t(()=>[o("span",wo,n(_+1),1)]),_:2},1024)]),default:t(()=>[l(W,{class:"font-weight-medium"},{default:t(()=>[d(n(i.staff_name)+" ",1),l(w,{class:"ml-2",color:ft(i.role),size:"x-small",variant:"flat"},{default:t(()=>[d(n(i.role),1)]),_:2},1032,["color"])]),_:2},1024),l(H,{class:"mt-1"},{default:t(()=>[i.notes?(m(),C("span",ko,n(i.notes),1)):(m(),C("span",qo," No notes "))]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ne,{modelValue:re.value,"onUpdate:modelValue":e[17]||(e[17]=a=>re.value=a),"max-width":"1000",persistent:"",scrollable:""},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(De,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(z,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(c,{color:"primary"},{default:t(()=>e[138]||(e[138]=[d("mdi-plus-circle")])),_:1})]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a;return[d(" Add Actual Production - "+n((a=S.value)==null?void 0:a.batch_code),1)]}),_:1}),l(te),l(h,{color:"white",icon:"mdi-close",variant:"text",onClick:Fe})]),_:1}),l(b,{class:"pa-6"},{default:t(()=>[l(It,{onSubmit:Ct(tt,["prevent"])},{default:t(()=>[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",ho,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[139]||(e[139]=[d("mdi-calendar-clock")])),_:1}),e[140]||(e[140]=o("h4",{class:"text-h6 font-weight-medium"}," Production Information ",-1))]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"6"},{default:t(()=>[o("div",zo,[D.produced_at?(m(),C("span",Po," Actual Production Date & Time ")):x("",!0),l(u,{modelValue:D.produced_at,"onUpdate:modelValue":e[15]||(e[15]=a=>D.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1}),l(p,{cols:"12",md:"6"},{default:t(()=>[l(F,{modelValue:D.notes,"onUpdate:modelValue":e[16]||(e[16]=a=>D.notes=a),color:"primary",label:"Production Notes (optional)","prepend-inner-icon":"mdi-note-text",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Co,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[141]||(e[141]=[d("mdi-scale-balance")])),_:1}),e[142]||(e[142]=o("h4",{class:"text-h6 font-weight-medium"}," Actual Production Quantities ",-1))]),D.products.some(a=>a.hasDiscrepancy)?(m(),y(le,{key:0,border:"start",class:"mb-4",type:"warning",variant:"tonal"},{default:t(()=>e[143]||(e[143]=[d(" Some products have discrepancies between planned and actual quantities. ")])),_:1})):x("",!0),(m(!0),C(T,null,Q(D.products,(a,r)=>(m(),y(v,{key:a.production_id,class:"mb-4",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",Ao,[l(z,{class:"mr-3",color:"primary",size:"32",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"16"},{default:t(()=>e[144]||(e[144]=[d("mdi-package")])),_:1})]),_:1}),o("div",null,[o("div",Uo,n(a.product_name),1),o("div",So," Planned: "+n(a.planned_qty)+" units ",1)]),l(te),l(w,{color:a.hasDiscrepancy?"orange":"green",size:"small",variant:"flat"},{default:t(()=>[d(n(a.hasDiscrepancy?"Discrepancy":"On Track"),1)]),_:2},1032,["color"])]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.good_qty,"onUpdate:modelValue":i=>a.good_qty=i,modelModifiers:{number:!0},color:"green",density:"compact",label:`Good Quantity (${a.planned_qty} planned)`,type:"number",variant:"outlined",onInput:i=>we(a)},{"prepend-inner":t(()=>[l(c,{color:"green",size:"20"},{default:t(()=>e[145]||(e[145]=[d("mdi-check-decagram")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.damaged_qty,"onUpdate:modelValue":i=>a.damaged_qty=i,modelModifiers:{number:!0},color:"orange",density:"compact",label:"Damaged Quantity",type:"number",variant:"outlined",onInput:i=>we(a)},{"prepend-inner":t(()=>[l(c,{color:"orange",size:"20"},{default:t(()=>e[146]||(e[146]=[d("mdi-alert-circle-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.reject_qty,"onUpdate:modelValue":i=>a.reject_qty=i,modelModifiers:{number:!0},color:"red",density:"compact",label:"Reject Quantity",type:"number",variant:"outlined",onInput:i=>we(a)},{"prepend-inner":t(()=>[l(c,{color:"red",size:"20"},{default:t(()=>e[147]||(e[147]=[d("mdi-close-octagon-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.actual_qty,"onUpdate:modelValue":i=>a.actual_qty=i,modelModifiers:{number:!0},color:"primary",density:"compact",label:"Total Actual",readonly:"",type:"number",variant:"outlined"},{"prepend-inner":t(()=>[l(c,{color:"primary",size:"20"},{default:t(()=>e[148]||(e[148]=[d("mdi-counter")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a.hasDiscrepancy?(m(),C(T,{key:0},[l(me,{class:"my-3"}),o("div",Io,[l(w,{color:"orange",size:"small",variant:"flat"},{default:t(()=>[d(" Discrepancy: "+n(Math.abs(a.planned_qty-a.good_qty))+" units ",1)]),_:2},1024)]),(m(!0),C(T,null,Q(a.discrepancies,(i,_)=>(m(),y(j,{key:_,class:"align-center mb-2"},{default:t(()=>[l(p,{cols:"12",md:"5"},{default:t(()=>[l(ne,{modelValue:i.reason_id,"onUpdate:modelValue":f=>i.reason_id=f,density:"compact","item-title":"name","item-value":"id",items:Me.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(p,{cols:"12",md:"5"},{default:t(()=>[l(F,{modelValue:i.notes,"onUpdate:modelValue":f=>i.notes=f,density:"compact",label:"Notes",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(h,{color:"error",icon:"",size:"small",variant:"text",onClick:f=>et(a,_)},{default:t(()=>[l(c,null,{default:t(()=>e[149]||(e[149]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(h,{color:"primary",size:"small",variant:"outlined",onClick:i=>Re(a)},{default:t(()=>[l(c,{start:""},{default:t(()=>e[150]||(e[150]=[d("mdi-plus")])),_:1}),e[151]||(e[151]=d(" Add Reason "))]),_:2},1032,["onClick"])],64)):x("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(v,{class:"rounded-lg pa-4",variant:"outlined"},{default:t(()=>[o("div",Do,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[152]||(e[152]=[d("mdi-chart-box")])),_:1}),e[153]||(e[153]=o("h4",{class:"text-h6 font-weight-medium"},"Batch Summary",-1))]),l(j,null,{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>[o("div",jo,n(Ue.value.good_qty),1),e[154]||(e[154]=o("div",{class:"text-caption text-grey"},"Total Good",-1))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>[o("div",No,n(Ue.value.damaged_qty),1),e[155]||(e[155]=o("div",{class:"text-caption text-grey"},"Total Damaged",-1))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>[o("div",To,n(Ue.value.reject_qty),1),e[156]||(e[156]=o("div",{class:"text-caption text-grey"},"Total Reject",-1))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>[o("div",$o,n(Ue.value.actual_qty),1),e[157]||(e[157]=o("div",{class:"text-caption text-grey"},"Total Actual",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(At,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(te),l(h,{class:"px-6",color:"grey",variant:"outlined",onClick:Fe},{default:t(()=>e[158]||(e[158]=[d(" Cancel ")])),_:1}),l(h,{class:"px-6",color:"success",disabled:!tl.value,elevation:"2",loading:J.value,onClick:tt},{default:t(()=>[l(c,{start:""},{default:t(()=>e[159]||(e[159]=[d("mdi-content-save-check")])),_:1}),e[160]||(e[160]=d(" Save Actual Production "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ne,{modelValue:ee.value,"onUpdate:modelValue":e[26]||(e[26]=a=>ee.value=a),"max-width":"1400",persistent:"",scrollable:""},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(De,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(z,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(c,{color:"primary",icon:G.value?"mdi-pencil":"mdi-plus"},null,8,["icon"])]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>[d(n(ue.value?"Add Actual Quantity":G.value?"Edit Production":"Create New Production (Multiple Products)"),1)]),_:1}),l(te),l(h,{color:"white",icon:"mdi-close",variant:"text",onClick:ut})]),_:1}),l(b,{class:"pa-6"},{default:t(()=>[l(It,{onSubmit:Ct(gt,["prevent"])},{default:t(()=>[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Bo,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[161]||(e[161]=[d(" mdi-information ")])),_:1}),e[162]||(e[162]=o("h4",{class:"text-h6 font-weight-medium"},"Batch Information",-1))]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>[o("div",Mo,[g.planned_at?(m(),C("span",Fo," Planned Production Date & Time ")):x("",!0),l(u,{modelValue:g.planned_at,"onUpdate:modelValue":e[18]||(e[18]=a=>g.planned_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Planned Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1}),ve.value?(m(),y(p,{key:0,cols:"12",md:"4"},{default:t(()=>[o("div",Ro,[g.produced_at?(m(),C("span",Go," Actual Production Date & Time ")):x("",!0),l(u,{modelValue:g.produced_at,"onUpdate:modelValue":e[19]||(e[19]=a=>g.produced_at=a),"auto-apply":"",class:"rounded-lg border px-4 py-2 w-100","enable-time-picker":!0,format:"dd-MM-yyyy HH:mm","model-type":"format",placeholder:"Select Actual Production Date & Time",teleport:!0},null,8,["modelValue"])])]),_:1})):x("",!0),l(p,{cols:"12",md:"4"},{default:t(()=>[l(F,{modelValue:g.notes,"onUpdate:modelValue":e[20]||(e[20]=a=>g.notes=a),color:"primary",label:"Batch Notes (optional)","prepend-inner-icon":"mdi-note-text",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Eo,[o("div",Oo,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[163]||(e[163]=[d(" mdi-package-variant ")])),_:1}),e[164]||(e[164]=o("h4",{class:"text-h6 font-weight-medium"}," Products in this Batch ",-1))]),l(h,{color:"primary",size:"small",variant:"outlined",onClick:Ee},{default:t(()=>[l(c,{start:""},{default:t(()=>e[165]||(e[165]=[d("mdi-plus")])),_:1}),e[166]||(e[166]=d(" Add Product "))]),_:1})]),g.products.length?x("",!0):(m(),y(le,{key:0,border:"start",class:"mb-3",type:"info",variant:"tonal"},{default:t(()=>e[167]||(e[167]=[d(" Add one or more products to this production batch. Each product keeps its own mode and ingredients. ")])),_:1})),(m(!0),C(T,null,Q(g.products,(a,r)=>(m(),y(j,{key:a.uid,dense:""},{default:t(()=>[l(p,{cols:"12"},{default:t(()=>[l(v,{class:"mb-3",ripple:!1,variant:"outlined"},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",Lo,[l(w,{class:"mr-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(" Product #"+n(r+1),1)]),_:2},1024),o("span",Ho,n(ul(a)),1),l(te),g.products.length>1?(m(),y(h,{key:0,color:"error",icon:"",size:"x-small",variant:"text",onClick:i=>yl(r)},{default:t(()=>[l(c,null,{default:t(()=>e[168]||(e[168]=[d("mdi-close")])),_:1})]),_:2},1032,["onClick"])):x("",!0)]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"5"},{default:t(()=>[l(pe,{modelValue:a.product_id,"onUpdate:modelValue":[i=>a.product_id=i,()=>rt(a)],clearable:"",density:"compact","item-title":"name","item-value":"id",items:xe.value,label:"Select Product","prepend-inner-icon":"mdi-package-variant",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(ne,{modelValue:a.mode,"onUpdate:modelValue":[i=>a.mode=i,()=>ce(a)],density:"compact","item-title":"label","item-value":"value",items:Ft,label:"Production Mode","prepend-inner-icon":"mdi-cog",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a.mode==="by_product"?(m(),y(p,{key:0,cols:"12",md:"4"},{default:t(()=>[l(F,{modelValue:a.qty_product_input,"onUpdate:modelValue":i=>a.qty_product_input=i,modelModifiers:{number:!0},density:"compact",label:"Planned Units","prepend-inner-icon":"mdi-counter",type:"number",variant:"outlined",onInput:()=>ce(a)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024)):a.mode==="by_ingredient"?(m(),C(T,{key:1},[l(p,{cols:"12",md:"4"},{default:t(()=>[l(pe,{modelValue:a.base_ingredient_id,"onUpdate:modelValue":[i=>a.base_ingredient_id=i,()=>ce(a)],density:"compact",disabled:!a.recipeItems.length,"item-title":"item_name","item-value":"item_id",items:a.recipeItems,label:"Base Ingredient","prepend-inner-icon":"mdi-ingredient",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.base_ingredient_qty,"onUpdate:modelValue":i=>a.base_ingredient_qty=i,modelModifiers:{number:!0},density:"compact",disabled:!a.base_ingredient_id,label:`Base Qty (${a.baseUnit||"units"})`,"prepend-inner-icon":"mdi-weight",type:"number",variant:"outlined",onInput:()=>ce(a)},null,8,["modelValue","onUpdate:modelValue","disabled","label","onInput"])]),_:2},1024),l(p,{class:"d-flex align-center",cols:"12",md:"1"},{default:t(()=>[a.computed_qty_product?(m(),y(w,{key:0,color:"blue",size:"small",variant:"flat"},{default:t(()=>[d(" Planned "+n(a.computed_qty_product)+" units ",1)]),_:2},1024)):x("",!0)]),_:2},1024)],64)):x("",!0),ve.value?(m(),y(b,{key:2,class:"pa-4"},{default:t(()=>[o("div",Qo,[l(w,{color:a.hasDiscrepancy?"orange":"green",size:"small",variant:"flat"},{default:t(()=>[d(n(a.hasDiscrepancy?"Discrepancy: "+Math.abs(a.planned_qty-a.good_qty)+" units":"On Track"),1)]),_:2},1032,["color"])]),l(j,{dense:""},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.good_qty,"onUpdate:modelValue":i=>a.good_qty=i,modelModifiers:{number:!0},color:"green",density:"compact",label:`Good Quantity (${a.planned_qty} planned)`,type:"number",variant:"outlined",onInput:i=>we(a)},{"prepend-inner":t(()=>[l(c,{color:"green",size:"20"},{default:t(()=>e[169]||(e[169]=[d("mdi-check-decagram")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.damaged_qty,"onUpdate:modelValue":i=>a.damaged_qty=i,modelModifiers:{number:!0},color:"orange",density:"compact",label:"Damaged Quantity",type:"number",variant:"outlined",onInput:i=>we(a)},{"prepend-inner":t(()=>[l(c,{color:"orange",size:"20"},{default:t(()=>e[170]||(e[170]=[d("mdi-alert-circle-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.reject_qty,"onUpdate:modelValue":i=>a.reject_qty=i,modelModifiers:{number:!0},color:"red",density:"compact",label:"Reject Quantity",type:"number",variant:"outlined",onInput:i=>we(a)},{"prepend-inner":t(()=>[l(c,{color:"red",size:"20"},{default:t(()=>e[171]||(e[171]=[d("mdi-close-octagon-outline")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onInput"])]),_:2},1024),l(p,{cols:"12",md:"3"},{default:t(()=>[l(F,{modelValue:a.actual_qty,"onUpdate:modelValue":i=>a.actual_qty=i,modelModifiers:{number:!0},color:"primary",density:"compact",label:"Total Actual",readonly:"",type:"number",variant:"outlined"},{"prepend-inner":t(()=>[l(c,{color:"primary",size:"20"},{default:t(()=>e[172]||(e[172]=[d("mdi-counter")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),a.hasDiscrepancy?(m(),C(T,{key:0},[l(me,{class:"my-3"}),(m(!0),C(T,null,Q(a.discrepancies,(i,_)=>(m(),y(j,{key:_,class:"align-center mb-2"},{default:t(()=>[l(p,{cols:"12",md:"5"},{default:t(()=>[l(ne,{modelValue:i.reason_id,"onUpdate:modelValue":f=>i.reason_id=f,density:"compact","item-title":"name","item-value":"id",items:Me.value,label:"Reason","prepend-inner-icon":"mdi-alert-circle-outline",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),l(p,{cols:"12",md:"5"},{default:t(()=>[l(F,{modelValue:i.notes,"onUpdate:modelValue":f=>i.notes=f,density:"compact",label:"Notes",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(p,{class:"text-right",cols:"12",md:"2"},{default:t(()=>[l(h,{color:"error",icon:"",size:"small",variant:"text",onClick:f=>et(a,_)},{default:t(()=>[l(c,null,{default:t(()=>e[173]||(e[173]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),l(h,{color:"primary",size:"small",variant:"outlined",onClick:i=>Re(a)},{default:t(()=>[l(c,{start:""},{default:t(()=>e[174]||(e[174]=[d("mdi-plus")])),_:1}),e[175]||(e[175]=d(" Add Reason "))]),_:2},1032,["onClick"])],64)):x("",!0)]),_:2},1024)):x("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),g.products.length?(m(),y(le,{key:1,border:"start",class:"mt-2",type:"success",variant:"tonal"},{default:t(()=>[e[176]||(e[176]=d(" Total planned units for this batch: ")),o("b",null,n(dt.value),1)]),_:1})):x("",!0)]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",Yo,[o("div",Jo,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[177]||(e[177]=[d(" mdi-ingredient ")])),_:1}),e[178]||(e[178]=o("h4",{class:"text-h6 font-weight-medium"}," Ingredients & Groups ",-1))]),ae.value.length&&!be.value?(m(),y(h,{key:0,color:"warning",onClick:e[21]||(e[21]=a=>pt(!0))},{default:t(()=>e[179]||(e[179]=[d("Ignore Deprecated Ingredients Options")])),_:1})):ae.value.length&&be.value?(m(),y(h,{key:1,color:"success",onClick:e[22]||(e[22]=a=>pt(!1))},{default:t(()=>e[180]||(e[180]=[d("Use Deprecated Ingredients Options")])),_:1})):x("",!0),l(Gl,{modelValue:R.value,"onUpdate:modelValue":e[23]||(e[23]=a=>R.value=a),color:"primary","hide-details":"",inset:"",label:R.value?"Editing Enabled":"Editing Disabled"},null,8,["modelValue","label"])]),lt.value?(m(),y(le,{key:0,border:"start",class:"mb-3",type:"error",variant:"tonal"},{default:t(()=>e[181]||(e[181]=[d(" Some ingredients exceed available stock. Please adjust quantities before saving. ")])),_:1})):x("",!0),l(jt,{modelValue:Z.value,"onUpdate:modelValue":e[24]||(e[24]=a=>Z.value=a),"bg-color":"transparent",color:"primary",density:"comfortable","show-arrows":""},{default:t(()=>[(m(!0),C(T,null,Q(g.products,(a,r)=>(m(),y(Te,{key:a.uid,value:r},{default:t(()=>[d(n(cl(a,r)),1)]),_:2},1032,["value"]))),128)),g.products.length?(m(),y(Te,{key:0,value:"summary"},{default:t(()=>e[182]||(e[182]=[d(" All Ingredients Summary ")])),_:1})):x("",!0)]),_:1},8,["modelValue"]),l(Nt,{modelValue:Z.value,"onUpdate:modelValue":e[25]||(e[25]=a=>Z.value=a),class:"mt-4"},{default:t(()=>[(m(!0),C(T,null,Q(g.products,(a,r)=>(m(),y($e,{key:`win-${a.uid}`,value:r},{default:t(()=>[l(jt,{modelValue:a.innerTab,"onUpdate:modelValue":i=>a.innerTab=i,class:"mb-2",color:"primary",density:"compact"},{default:t(()=>[l(Te,{value:"ingredients"},{default:t(()=>e[183]||(e[183]=[d("Ingredients")])),_:1}),l(Te,{value:"groups"},{default:t(()=>e[184]||(e[184]=[d(" Ingredient Groups ")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(Nt,{modelValue:a.innerTab,"onUpdate:modelValue":i=>a.innerTab=i},{default:t(()=>[l($e,{value:"ingredients"},{default:t(()=>[l(qe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Ke,items:a.ingredients},{"item.item_name":t(({item:i})=>[o("div",Ko,[i.from_group?(m(),y(c,{key:0,class:"mr-2",color:"purple",size:"16"},{default:t(()=>e[185]||(e[185]=[d(" mdi-cog ")])),_:1})):x("",!0),o("span",null,n(i.item_name),1),i.group_name?(m(),y(w,{key:1,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(i.group_name),1)]),_:2},1024)):x("",!0)])]),"item.qty_required":t(({item:i})=>[o("div",Wo,[l(F,{modelValue:i.qty_required,"onUpdate:modelValue":_=>i.qty_required=_,modelModifiers:{number:!0},autocomplete:"off",autocorrect:"off",density:"compact",disabled:!R.value,error:i.exceeds,"error-messages":i.exceeds?["Exceeds available stock across all products"]:[],"hide-details":"",inputmode:"none",spellcheck:"false",style:{"max-width":"140px"},type:"number",variant:"outlined",onInput:de},{"append-inner":t(()=>[o("span",{class:se(["text-caption",i.exceeds?"text-error":"text-grey"])},n(i.unit),3)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","error","error-messages"]),i.exceeds?(m(),y(El,{key:0,location:"top",text:G.value?`Stock: ${i.available-(i.previously_used||0)} + Previously allocated: ${i.previously_used||0} = ${i.available} available for editing`:`Maximum available: ${i.available} ${i.unit||""} (across all products)`},{activator:t(({props:_})=>[l(h,he({ref_for:!0},_,{class:"ml-1",color:"orange",icon:"",size:"x-small",variant:"text",onClick:f=>ql(i.item_id,i.available)}),{default:t(()=>[l(c,{size:"16"},{default:t(()=>e[186]||(e[186]=[d(" mdi-information-outline ")])),_:1})]),_:2},1040,["onClick"])]),_:2},1032,["text"])):x("",!0)])]),"item.balance":t(({item:i})=>[l(w,{class:"font-weight-medium",color:i.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[d(n(i.balance||0)+" "+n(i.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:i})=>[l(w,{color:"blue-grey",size:"small",variant:"outlined"},{default:t(()=>[d(n(i.unit),1)]),_:2},1024)]),"no-data":t(()=>e[187]||(e[187]=[o("div",{class:"text-center py-4 text-grey"}," Configure this product (mode + quantity) to calculate ingredients ",-1)])),_:2},1032,["items"]),a.computed_qty_product?(m(),y(le,{key:0,border:"start",class:"mt-3",type:"success",variant:"tonal"},{default:t(()=>[e[188]||(e[188]=d(" Planned units for ")),o("b",null,n(Se(a.product_id)),1),e[189]||(e[189]=d(": ")),o("b",null,n(a.computed_qty_product),1),e[190]||(e[190]=d(". Ingredients above are specific to this product. "))]),_:2},1024)):x("",!0)]),_:2},1024),l($e,{value:"groups"},{default:t(()=>[a.productGroups&&a.productGroups.length?(m(),y(v,{key:0,class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(b,{class:"pa-4"},{default:t(()=>[o("div",Zo,[l(c,{class:"mr-2",color:"purple"},{default:t(()=>e[191]||(e[191]=[d(" mdi-cog ")])),_:1}),o("h5",Xo," Ingredient Groups for "+n(Se(a.product_id)),1),l(w,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[d(n(a.productGroups.length)+" groups ",1)]),_:2},1024)]),l(le,{class:"mb-4",type:"info",variant:"tonal"},{default:t(()=>e[192]||(e[192]=[d(" Select combinations per group to update ingredients for this product. ")])),_:1}),l(Ol,{modelValue:a.expandedGroups,"onUpdate:modelValue":i=>a.expandedGroups=i,multiple:""},{default:t(()=>[(m(!0),C(T,null,Q(a.productGroups,(i,_)=>(m(),y(Ll,{key:i.id,class:"mb-2"},{default:t(()=>[l(Hl,{class:"font-weight-medium"},{default:t(()=>[o("div",ed,[o("div",td,[l(c,{class:"mr-2",color:"purple"},{default:t(()=>e[193]||(e[193]=[d(" mdi-cog ")])),_:1}),o("span",null,n(i.name),1),i.is_mandatory?(m(),y(w,{key:0,class:"ml-2",color:"red",size:"x-small",variant:"flat"},{default:t(()=>e[194]||(e[194]=[d(" Required ")])),_:1})):(m(),y(w,{key:1,class:"ml-2",color:"grey",size:"x-small",variant:"outlined"},{default:t(()=>e[195]||(e[195]=[d(" Optional ")])),_:1})),i.deprecated?(m(),y(w,{key:2,class:"ml-2",color:"warning",size:"x-small",variant:"flat"},{default:t(()=>e[196]||(e[196]=[d(" Deprecated ")])),_:1})):x("",!0)]),o("div",ld,[l(w,{class:"mr-2",color:"blue",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(i.selection_mode),1)]),_:2},1024),a.group_choices[i.id]?(m(),y(w,{key:0,color:"green",size:"x-small",variant:"flat"},{default:t(()=>e[197]||(e[197]=[d(" Selected ")])),_:1})):(m(),y(w,{key:1,color:"orange",size:"x-small",variant:"outlined"},{default:t(()=>e[198]||(e[198]=[d(" Not Selected ")])),_:1}))])])]),_:2},1024),l(Ql,null,{default:t(()=>[o("p",ad,n(i.description),1),l(Wl,{modelValue:a.group_choices[i.id],"onUpdate:modelValue":[f=>a.group_choices[i.id]=f,()=>ce(a)],"hide-details":""},{default:t(()=>[l(j,null,{default:t(()=>[(m(!0),C(T,null,Q(i.combinations,f=>(m(),y(p,{key:f.id,cols:"12",md:"6"},{default:t(()=>[l(v,{class:se(["combination-card",{selected:a.group_choices[i.id]===f.id}]),variant:"outlined",onClick:U=>{a.group_choices[i.id]=f.id,ce(a)}},{default:t(()=>[l(b,{class:"pa-3"},{default:t(()=>[o("div",od,[l(Jl,{"hide-details":"",value:f.id},null,8,["value"]),o("div",dd,[o("div",sd,n(f.name),1),f.notes?(m(),C("div",id,n(f.notes),1)):x("",!0),o("div",nd,[(m(!0),C(T,null,Q(f.options,U=>(m(),y(w,{key:U.option_id,class:"mr-1 mb-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(U.item_name)+": "+n(U.quantity_per_unit)+" "+n(U.unit),1)]),_:2},1024))),128))])]),f.is_default?(m(),y(w,{key:0,color:"orange",size:"x-small",variant:"flat"},{default:t(()=>e[199]||(e[199]=[d(" Default ")])),_:1})):x("",!0)])]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):(m(),y(le,{key:1,border:"start",type:"info",variant:"tonal"},{default:t(()=>e[200]||(e[200]=[d(" No ingredient groups configured for this product. ")])),_:1}))]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["value"]))),128)),l($e,{value:"summary"},{default:t(()=>[l(qe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Ke,items:st.value},{"item.item_name":t(({item:a})=>[o("div",rd,[l(z,{class:"mr-2",color:"primary",size:"22",variant:"tonal"},{default:t(()=>[l(c,{color:"primary",size:"14"},{default:t(()=>e[201]||(e[201]=[d(" mdi-ingredient ")])),_:1})]),_:1}),o("span",null,n(a.item_name),1)])]),"item.qty_required":t(({item:a})=>[l(w,{color:a.exceeds?"red":"green",size:"small",variant:"outlined"},{default:t(()=>[d(n(a.qty_required)+" "+n(a.unit),1)]),_:2},1032,["color"])]),"item.available":t(({item:a})=>[l(w,{color:a.exceeds?"red":"blue",size:"small",variant:"outlined"},{default:t(()=>[d(n(a.available||0)+" "+n(a.unit),1)]),_:2},1032,["color"])]),"item.unit":t(({item:a})=>[o("span",null,n(a.unit),1)]),"no-data":t(()=>e[202]||(e[202]=[o("div",{class:"text-center py-4 text-grey"}," Add products and configure ingredients to see a consolidated summary. ",-1)])),_:1},8,["items"]),st.value.length?(m(),y(le,{key:0,border:"start",class:"mt-3",type:"success",variant:"tonal"},{default:t(()=>e[203]||(e[203]=[d(" Consolidated ingredient requirements across all products in this batch. ")])),_:1})):x("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>[o("div",ud,[o("div",cd,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[204]||(e[204]=[d(" mdi-account-group ")])),_:1}),e[205]||(e[205]=o("h4",{class:"text-h6 font-weight-medium"},"Staff Assignment",-1))]),o("div",md,[l(h,{color:"primary",disabled:!at.value.length,size:"small",variant:"outlined",onClick:it},{default:t(()=>[l(c,{start:""},{default:t(()=>e[206]||(e[206]=[d("mdi-account-plus")])),_:1}),e[207]||(e[207]=d(" Add Staff "))]),_:1},8,["disabled"]),l(h,{color:"secondary",disabled:!g.staff.length,size:"small",variant:"outlined",onClick:_l},{default:t(()=>[l(c,{start:""},{default:t(()=>e[208]||(e[208]=[d("mdi-account-remove")])),_:1}),e[209]||(e[209]=d(" Clear All "))]),_:1},8,["disabled"])])]),l(qe,{class:"elevation-1 rounded-lg",density:"comfortable",headers:Ht,items:g.staff},{"item.staff_id":t(({item:a})=>[l(pe,{modelValue:a.staff_id,"onUpdate:modelValue":r=>a.staff_id=r,density:"compact",disabled:!R.value,"hide-details":"","item-title":"name","item-value":"id",items:ze.value,placeholder:"Select Staff",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled","items"])]),"item.role":t(({item:a})=>[l(ne,{modelValue:a.role,"onUpdate:modelValue":r=>a.role=r,density:"compact",disabled:!R.value,"hide-details":"",items:["Team Leader","Assistant","Support"],"prepend-inner-icon":"mdi-account-tie",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.notes":t(({item:a})=>[l(F,{modelValue:a.notes,"onUpdate:modelValue":r=>a.notes=r,density:"compact",disabled:!R.value,"hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),"item.actions":t(({index:a})=>[l(h,{color:"error",disabled:!R.value,icon:"",size:"small",variant:"text",onClick:r=>pl(a)},{default:t(()=>[l(c,null,{default:t(()=>e[210]||(e[210]=[d("mdi-delete")])),_:1})]),_:2},1032,["disabled","onClick"])]),"no-data":t(()=>e[211]||(e[211]=[o("div",{class:"text-center py-4 text-grey"},' No staff assigned. Click "Add Staff" to assign team members. ',-1)])),_:1},8,["items"]),g.staff.length?(m(),y(le,{key:0,border:"start",class:"mt-4",type:"info",variant:"tonal"},{default:t(()=>[o("div",fd,[o("div",null,[e[212]||(e[212]=o("strong",null,"Team Summary:",-1)),l(w,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>[d(n(g.staff.length)+" staff members ",1)]),_:1})]),o("div",pd,n(ot.value)+" of "+n(at.value.length+ot.value)+" staff assigned ",1)])]),_:1})):x("",!0)]),_:1})]),_:1})]),_:1}),l(At,{class:"pa-6 bg-grey-lighten-4 rounded-b-xl"},{default:t(()=>[l(te),l(h,{class:"px-6",color:"grey",variant:"outlined",onClick:ut},{default:t(()=>e[213]||(e[213]=[d(" Cancel ")])),_:1}),l(h,{class:"px-6",color:"success",disabled:!rl.value,elevation:"2",loading:J.value,onClick:gt},{default:t(()=>[l(c,{start:""},{default:t(()=>e[214]||(e[214]=[d("mdi-content-save-check")])),_:1}),d(" "+n(G.value?"Update Production":"Create Production"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ne,{modelValue:ge.value,"onUpdate:modelValue":e[28]||(e[28]=a=>ge.value=a),"max-width":"1000",scrollable:"",transition:"dialog-bottom-transition"},{default:t(()=>[l(v,{class:"rounded-xl",elevation:"16"},{default:t(()=>[l(De,{class:"rounded-t-xl",color:"primary",density:"comfortable"},{default:t(()=>[l(z,{class:"mr-3",color:"white",size:"36"},{default:t(()=>[l(c,{color:"primary"},{default:t(()=>e[215]||(e[215]=[d("mdi-eye")])),_:1})]),_:1}),l(je,{class:"text-h5 font-weight-bold text-white"},{default:t(()=>{var a,r;return[d(" Production Details - "+n((r=(a=q.value)==null?void 0:a.production)==null?void 0:r.product_name),1)]}),_:1}),l(te),l(h,{color:"white",icon:"mdi-close",variant:"text",onClick:e[27]||(e[27]=a=>ge.value=!1)})]),_:1}),l(b,{class:"pa-6"},{default:t(()=>{var a,r,i,_,f,U,ie,yt,vt,bt,xt,Vt,wt,kt;return[l(v,{class:"rounded-lg pa-4 mb-4",variant:"outlined"},{default:t(()=>{var P,N;return[o("div",_d,[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[216]||(e[216]=[d("mdi-information")])),_:1}),e[217]||(e[217]=o("h4",{class:"text-h6 font-weight-medium"},"Production Information",-1))]),l(j,null,{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[218]||(e[218]=o("div",{class:"text-body-2 text-grey"},"Production ID",-1)),o("div",gd," #"+n((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.id),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[219]||(e[219]=o("div",{class:"text-body-2 text-grey"},"Product",-1)),o("div",yd,n((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.product_name),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[220]||(e[220]=o("div",{class:"text-body-2 text-grey"},"Production Mode",-1)),o("div",vd,n((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.mode),1)]}),_:1})]),_:1}),l(j,{class:"mt-2"},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[221]||(e[221]=o("div",{class:"text-body-2 text-grey"},"Planned At",-1)),o("div",bd,n(oe((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.planned_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[222]||(e[222]=o("div",{class:"text-body-2 text-grey"},"Produced At",-1)),o("div",xd,n(oe((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.produced_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[223]||(e[223]=o("div",{class:"text-body-2 text-grey"},"Produced By",-1)),o("div",Vd,n((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.produced_by_name),1)]}),_:1})]),_:1}),l(j,{class:"mt-2"},{default:t(()=>[l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[224]||(e[224]=o("div",{class:"text-body-2 text-grey"},"Created",-1)),o("div",wd,n(oe((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.created)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[225]||(e[225]=o("div",{class:"text-body-2 text-grey"},"Last Updated",-1)),o("div",kd,n(oe((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.updated_at)),1)]}),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>{var V,k;return[e[226]||(e[226]=o("div",{class:"text-body-2 text-grey"},"Batch ID",-1)),o("div",qd,n(((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.batch_id)||"N/A"),1)]}),_:1})]),_:1}),l(j,{class:"mt-4"},{default:t(()=>[l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var V,k;return[o("div",hd,n((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.qty_product),1),e[227]||(e[227]=o("div",{class:"text-caption text-grey"},"Planned Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"3"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var V,k;return[o("div",zd,n((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.actual_qty),1),e[228]||(e[228]=o("div",{class:"text-caption text-grey"},"Actual Quantity",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"2"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var V,k;return[o("div",Pd,n(((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.good_qty)||0),1),e[229]||(e[229]=o("div",{class:"text-caption text-grey"},"Good",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"2"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var V,k;return[o("div",Cd,n(((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.damaged_qty)||0),1),e[230]||(e[230]=o("div",{class:"text-caption text-grey"},"Damaged",-1))]}),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"2"},{default:t(()=>[l(v,{border:"",class:"text-center",variant:"outlined"},{default:t(()=>[l(b,null,{default:t(()=>{var V,k;return[o("div",Ad,n(((k=(V=q.value)==null?void 0:V.production)==null?void 0:k.reject_qty)||0),1),e[231]||(e[231]=o("div",{class:"text-caption text-grey"},"Reject",-1))]}),_:1})]),_:1})]),_:1})]),_:1}),(N=(P=q.value)==null?void 0:P.production)!=null&&N.notes?(m(),y(j,{key:0,class:"mt-4"},{default:t(()=>[l(p,{cols:"12"},{default:t(()=>[e[232]||(e[232]=o("div",{class:"text-body-2 text-grey"},"Notes",-1)),o("div",Ud,n(q.value.production.notes),1)]),_:1})]),_:1})):x("",!0)]}),_:1}),l(v,{class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(ke,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"mr-2",color:"primary"},{default:t(()=>e[233]||(e[233]=[d("mdi-ingredient")])),_:1}),e[234]||(e[234]=d(" Ingredients Used ")),l(w,{class:"ml-2",color:"primary",size:"small",variant:"flat"},{default:t(()=>{var P,N;return[d(n(((N=(P=q.value)==null?void 0:P.items)==null?void 0:N.length)||0)+" items ",1)]}),_:1})]),_:1}),l(b,{class:"pa-0"},{default:t(()=>[l(fe,{class:"pa-0",lines:"two"},{default:t(()=>{var P;return[(m(!0),C(T,null,Q(((P=q.value)==null?void 0:P.items)||[],(N,V)=>(m(),y(Y,{key:N.id,class:se(["px-4",{"bg-grey-lighten-4":V%2===0}])},{prepend:t(()=>[l(z,{class:"mr-3",color:"primary",size:"36"},{default:t(()=>[o("span",Sd,n(V+1),1)]),_:2},1024)]),default:t(()=>[l(W,{class:"font-weight-medium"},{default:t(()=>[d(n(N.item_name)+" ",1),N.group_name?(m(),y(w,{key:0,class:"ml-2",color:"purple",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(N.group_name),1)]),_:2},1024)):x("",!0),N.combination_name?(m(),y(w,{key:1,class:"ml-1",color:"green",size:"x-small",variant:"outlined"},{default:t(()=>[d(n(N.combination_name),1)]),_:2},1024)):x("",!0)]),_:2},1024),l(H,{class:"mt-1"},{default:t(()=>[l(w,{class:"mr-2",color:"primary",size:"small",variant:"outlined"},{default:t(()=>[d(n(N.qty_required)+" "+n(N.unit||""),1)]),_:2},1024),o("span",Id," Item ID: "+n(N.item_id),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]}),_:1})]),_:1})]),_:1}),(r=(a=q.value)==null?void 0:a.group_choices)!=null&&r.length?(m(),y(v,{key:0,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(ke,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"mr-2",color:"purple"},{default:t(()=>e[235]||(e[235]=[d("mdi-cog")])),_:1}),e[236]||(e[236]=d(" Ingredient Group Choices ")),l(w,{class:"ml-2",color:"purple",size:"small",variant:"flat"},{default:t(()=>[d(n(q.value.group_choices.length)+" groups ",1)]),_:1})]),_:1}),l(b,{class:"pa-0"},{default:t(()=>[l(fe,{class:"pa-0",lines:"two"},{default:t(()=>[(m(!0),C(T,null,Q(q.value.group_choices,(P,N)=>(m(),y(Y,{key:P.id,class:se(["px-4",{"bg-grey-lighten-4":N%2===0}])},{prepend:t(()=>[l(z,{class:"mr-3",color:"purple",size:"36"},{default:t(()=>[l(c,{color:"white",size:"18"},{default:t(()=>e[237]||(e[237]=[d("mdi-cog")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"font-weight-medium"},{default:t(()=>[d(n(P.group_name),1)]),_:2},1024),l(H,{class:"mt-1"},{default:t(()=>[l(w,{color:"green",size:"small",variant:"outlined"},{default:t(()=>[d(n(P.combination_name),1)]),_:2},1024),P.chosen_by_name?(m(),C("span",Dd," Chosen by: "+n(P.chosen_by_name),1)):x("",!0),o("span",jd," Created: "+n(oe(P.created_at)),1)]),_:2},1024),P.notes?(m(),y(H,{key:0,class:"mt-1 text-caption"},{default:t(()=>[e[238]||(e[238]=o("strong",null,"Notes:",-1)),d(" "+n(P.notes),1)]),_:2},1024)):x("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0),(_=(i=q.value)==null?void 0:i.staff)!=null&&_.length?(m(),y(v,{key:1,class:"rounded-lg mb-4",variant:"outlined"},{default:t(()=>[l(ke,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"mr-2",color:"blue"},{default:t(()=>e[239]||(e[239]=[d("mdi-account-group")])),_:1}),e[240]||(e[240]=d(" Staff Assignments ")),l(w,{class:"ml-2",color:"blue",size:"small",variant:"flat"},{default:t(()=>[d(n(q.value.staff.length)+" staff ",1)]),_:1})]),_:1}),l(b,{class:"pa-0"},{default:t(()=>[l(fe,{class:"pa-0",lines:"two"},{default:t(()=>[(m(!0),C(T,null,Q(q.value.staff,(P,N)=>(m(),y(Y,{key:P.staff_id,class:se(["px-4",{"bg-grey-lighten-4":N%2===0}])},{prepend:t(()=>[l(z,{class:"mr-3",color:"blue",size:"36"},{default:t(()=>[o("span",Nd,n(N+1),1)]),_:2},1024)]),default:t(()=>[l(W,{class:"font-weight-medium"},{default:t(()=>[d(n(P.staff_name)+" ",1),l(w,{class:"ml-2",color:ft(P.role),size:"x-small",variant:"flat"},{default:t(()=>[d(n(P.role),1)]),_:2},1032,["color"])]),_:2},1024),l(H,{class:"mt-1"},{default:t(()=>[P.notes?(m(),C("span",Td,n(P.notes),1)):(m(),C("span",$d," No notes "))]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0),(U=(f=q.value)==null?void 0:f.discrepancies)!=null&&U.length?(m(),y(v,{key:2,class:"rounded-lg",variant:"outlined"},{default:t(()=>[l(ke,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"mr-2",color:"orange"},{default:t(()=>e[241]||(e[241]=[d("mdi-alert-circle")])),_:1}),e[242]||(e[242]=d(" Discrepancies ")),l(w,{class:"ml-2",color:"orange",size:"small",variant:"flat"},{default:t(()=>[d(n(q.value.discrepancies.length)+" issues ",1)]),_:1})]),_:1}),l(b,{class:"pa-0"},{default:t(()=>[l(fe,{class:"pa-0",lines:"two"},{default:t(()=>[(m(!0),C(T,null,Q(q.value.discrepancies,(P,N)=>(m(),y(Y,{key:P.id,class:se(["px-4",{"bg-grey-lighten-4":N%2===0}])},{prepend:t(()=>[l(z,{class:"mr-3",color:"orange",size:"36"},{default:t(()=>[l(c,{color:"white",size:"18"},{default:t(()=>e[243]||(e[243]=[d("mdi-alert")])),_:1})]),_:1})]),default:t(()=>[l(W,{class:"font-weight-medium"},{default:t(()=>[d(n(P.reason_name),1)]),_:2},1024),l(H,{class:"mt-1"},{default:t(()=>[o("span",Bd," Reason ID: "+n(P.reason_id),1)]),_:2},1024),P.notes?(m(),y(H,{key:0,class:"mt-1 text-caption"},{default:t(()=>[e[244]||(e[244]=o("strong",null,"Notes:",-1)),d(" "+n(P.notes),1)]),_:2},1024)):x("",!0)]),_:2},1032,["class"]))),128))]),_:1})]),_:1})]),_:1})):x("",!0),!((yt=(ie=q.value)==null?void 0:ie.items)!=null&&yt.length)&&!((bt=(vt=q.value)==null?void 0:vt.staff)!=null&&bt.length)&&!((Vt=(xt=q.value)==null?void 0:xt.group_choices)!=null&&Vt.length)&&!((kt=(wt=q.value)==null?void 0:wt.discrepancies)!=null&&kt.length)?(m(),y(v,{key:3,class:"rounded-lg text-center py-8",variant:"outlined"},{default:t(()=>[l(c,{class:"mb-2",color:"grey",size:"48"},{default:t(()=>e[245]||(e[245]=[d("mdi-information-outline")])),_:1}),e[246]||(e[246]=o("div",{class:"text-h6 text-grey"},"No Additional Data",-1)),e[247]||(e[247]=o("div",{class:"text-body-2 text-grey mt-2"}," This production record doesn't have any additional items, staff, or discrepancies. ",-1))]),_:1})):x("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},ss=Sl(Md,[["__scopeId","data-v-7c77e507"]]);export{ss as default};
