import{_ as Y,s as h,v as w,x as o,i as l,y as s,a3 as U,B as g,C as r,D as A,H as f,a2 as I,a5 as M,O as S,I as n,aD as Z,E as $,a0 as ee,r as c,$ as te,l as ae}from"./index--x-ecw0i.js";import{u as le,r as q}from"./index-BpAaSitK.js";import{V as p}from"./VDialog-C4VoQ_dv.js";import{V as N,b as E,c as oe}from"./VCard-B7owJXFi.js";import{V as T}from"./VForm-BBetik0M.js";import{V as b}from"./VCol-9mkHKuYv.js";import{V}from"./VTextField-CIWsNpzY.js";import{V as z}from"./VAutocomplete-rhDGvp-s.js";import{V as P}from"./VAlert-BETuRkq4.js";import{a as ne}from"./VDataTable-D6YKsfi3.js";import{V as ie}from"./VContainer-DZpjXtKH.js";import"./dialog-transition-BDagy04W.js";import"./VChip-Drqce34l.js";import"./VSlideGroup-B9WAwK8P.js";const re={setup(){const v=ee(),e=c(!1),C=c([]),t=c([]),y=c({}),F=c([{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"Unit",key:"unit"},{title:"Edit",key:"edit"}]),a=c(!1),x=c(!1),j=c(!1),H=c(!1),m=te({name:"",unit:"",human_readable_unit:"",conversion_factor:1}),D=le({name:{required:q},unit:{required:q}},m),O=u=>{const i=t.value.find(d=>d.id===u);return i?i.name:""};function _(){e.value=!0,fetch("/items").then(u=>{u.json().then(i=>{e.value=!1,C.value=i}).catch(()=>{e.value=!1})}).catch(()=>{e.value=!1})}function R(){a.value=!0,m.name="",m.unit="",m.human_readable_unit="",m.conversion_factor=1,D.value.$reset()}function J(u){y.value=JSON.parse(JSON.stringify(u)),x.value=!0,m.name=u.name,m.unit=u.unitid,m.human_readable_unit=u.human_readable_unit||"",m.conversion_factor=u.conversion_factor||1,D.value.$reset()}function L(){e.value=!0,fetch("/units").then(u=>{u.json().then(i=>{t.value=i,e.value=!1})})}async function G(){if(D.value.$touch(),!await D.value.$validate())return;e.value=!0,a.value=!1;const i=new FormData;i.append("name",m.name),i.append("unit",m.unit),i.append("human_readable_unit",m.human_readable_unit),i.append("conversion_factor",m.conversion_factor),fetch("/items",{body:i,method:"POST"}).then(d=>{e.value=!1,d.status!==200&&d.status!==201?d.json().then(B=>{v.commit("setMessage",{type:"error",text:"Failed to save Item! "+B.error,timeout:2e3})}):d.json().then(()=>{_(),v.commit("setMessage",{type:"primary",text:"Item saved successfully!",timeout:2e3})})}).catch(d=>{e.value=!1,v.commit("setMessage",{type:"error",text:"Failed to save Item!",timeout:2e3}),console.error("Error:",d)})}async function K(){if(D.value.$touch(),!await D.value.$validate())return;e.value=!0;const i=new FormData;i.append("name",m.name),i.append("unit",m.unit),i.append("human_readable_unit",m.human_readable_unit),i.append("conversion_factor",m.conversion_factor),fetch("/items/"+y.value.id,{body:i,method:"PUT"}).then(d=>{e.value=!1,x.value=!1,d.status!==200&&d.status!==201?d.json().then(B=>{v.commit("setMessage",{type:"error",text:"Failed to edit Item! "+B.error,timeout:2e3})}):d.json().then(()=>{_(),v.commit("setMessage",{type:"primary",text:"Item edited successfully!",timeout:2e3})})}).catch(d=>{e.value=!1,v.commit("setMessage",{type:"error",text:"Failed to edit Item!",timeout:2e3}),console.error("Error:",d)})}function Q(){e.value=!0;const u=new FormData;j.value=!1,fetch("/items/"+y.value.id,{body:u,method:"DELETE"}).then(i=>{e.value=!1,x.value=!1,i.status!==200&&i.status!==201?i.json().then(d=>{v.commit("setMessage",{type:"error",text:"Failed to delete Item! "+d.error,timeout:2e3})}):i.json().then(()=>{_(),v.commit("setMessage",{type:"primary",text:"Item deleted successfully!",timeout:2e3})})}).catch(i=>{e.value=!1,v.commit("setMessage",{type:"error",text:"Failed to delete Item!",timeout:2e3}),console.error("Error:",i)})}function W(){fetch("/units?response=csv").then(u=>{u.text().then(i=>{const d="csv",X="data:text/csv;charset=utf-8,"+escape(i),k=document.createElement("a");k.setAttribute("href",X),k.setAttribute("download",`Item.${d}`),k.click()})}).catch(()=>{e.value=!1})}return ae(()=>{_(),L()}),{loading:e,values:C,units:t,headers:F,addDialog:a,editDialog:x,form:H,state:m,v$:D,editingItem:y,confirmDeleteDialog:j,csvExport:W,loadValues:_,activateAddDialog:R,activateEditDialog:J,create:G,saveEdit:K,remove:Q,getUnitName:O}}},se={class:"d-flex align-center flex-wrap"},de={class:"text-caption text-grey"},me={class:"d-flex justify-end"},ue={class:"d-flex align-center flex-wrap"},fe={class:"text-caption text-grey"},ve={class:"d-flex justify-end justify-space-between"},ge={class:"d-flex justify-space-between mb-6"},ce={class:"d-flex gap-2"},be={class:"d-flex flex-column"},De={class:"font-weight-medium"},Ve={key:0,class:"text-caption text-grey"};function ye(v,e,C,t,y,F){return w(),h(ie,{fluid:""},{default:o(()=>[l(p,{modelValue:t.addDialog,"onUpdate:modelValue":e[6]||(e[6]=a=>t.addDialog=a),transition:"dialog-top-transition",width:"800"},{default:o(()=>[l(N,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[l(U,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:o(()=>[s("div",se,[l(g,{class:"mr-2 text-white"},{default:o(()=>e[20]||(e[20]=[r("mdi-map")])),_:1}),e[21]||(e[21]=s("span",{class:"text-white font-weight-bold text-h6"},"Add Item",-1))]),l(A),l(f,{color:"white",icon:"mdi-close",onClick:e[0]||(e[0]=a=>t.addDialog=!1)})]),_:1}),l(E,{class:"pt-6"},{default:o(()=>[l(T,{onSubmit:e[5]||(e[5]=M(()=>{},["prevent"]))},{default:o(()=>[l(S,{dense:""},{default:o(()=>[l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.state.name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.state.name=a),"bg-color":"#BDBDBD","error-messages":t.v$.name.$errors.map(a=>a.$message),label:"Item Name",required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(z,{modelValue:t.state.unit,"onUpdate:modelValue":e[2]||(e[2]=a=>t.state.unit=a),autocomplete:"off",autocorrect:"off","bg-color":"#BDBDBD","error-messages":t.v$.unit.$errors.map(a=>a.$message),inputmode:"none","item-title":a=>a?`${a.name??""}${a.shortname?` (${a.shortname})`:""}`:"","item-value":"id",items:t.units,label:"Base Unit",required:"",spellcheck:"false",onBlur:t.v$.unit.$touch,onChange:t.v$.unit.$touch},null,8,["modelValue","error-messages","item-title","items","onBlur","onChange"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.state.human_readable_unit,"onUpdate:modelValue":e[3]||(e[3]=a=>t.state.human_readable_unit=a),"bg-color":"#BDBDBD",hint:"Display unit for better readability",label:"Human Readable Unit (e.g. kilogram, liter)","persistent-hint":""},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.state.conversion_factor,"onUpdate:modelValue":e[4]||(e[4]=a=>t.state.conversion_factor=a),"bg-color":"#BDBDBD",hint:"How many human readable units equal 1 base unit",label:"Conversion Factor","persistent-hint":"",step:"0.000001",type:"number"},{append:o(()=>[s("span",de," 1 "+n(t.getUnitName(t.state.unit)||"base")+" = "+n(t.state.conversion_factor||0)+" "+n(t.state.human_readable_unit||"human"),1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t.state.human_readable_unit&&t.state.conversion_factor?(w(),h(P,{key:0,border:"start",class:"mt-4",type:"info",variant:"outlined"},{default:o(()=>[e[22]||(e[22]=s("strong",null,"Conversion Preview:",-1)),e[23]||(e[23]=s("br",null,null,-1)),r(" 1 "+n(t.getUnitName(t.state.unit))+" = "+n(t.state.conversion_factor)+" "+n(t.state.human_readable_unit),1),e[24]||(e[24]=s("br",null,null,-1)),r(" 10 "+n(t.getUnitName(t.state.unit))+" = "+n((10*t.state.conversion_factor).toFixed(6))+" "+n(t.state.human_readable_unit),1),e[25]||(e[25]=s("br",null,null,-1)),r(" 100 "+n(t.getUnitName(t.state.unit))+" = "+n((100*t.state.conversion_factor).toFixed(6))+" "+n(t.state.human_readable_unit),1)]),_:1})):I("",!0)]),_:1}),s("div",me,[l(f,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.create},{default:o(()=>[l(g,{start:""},{default:o(()=>e[26]||(e[26]=[r("mdi-plus")])),_:1}),e[27]||(e[27]=r(" Add "))]),_:1},8,["disabled","loading","onClick"])])]),_:1})]),_:1},8,["modelValue"]),l(p,{modelValue:t.editDialog,"onUpdate:modelValue":e[16]||(e[16]=a=>t.editDialog=a),transition:"dialog-top-transition",width:"800"},{default:o(()=>[l(N,{class:"rounded-xl pa-4",elevation:"10"},{default:o(()=>[l(U,{class:"rounded-lg flex-wrap px-4",color:"primary",flat:""},{default:o(()=>[s("div",ue,[l(g,{class:"mr-2 text-white"},{default:o(()=>e[28]||(e[28]=[r("mdi-map")])),_:1}),e[29]||(e[29]=s("span",{class:"text-white font-weight-bold text-h6"},"Edit Item",-1))]),l(A),l(f,{color:"white",icon:"mdi-close",onClick:e[7]||(e[7]=a=>t.editDialog=!1)})]),_:1}),l(E,{class:"pt-6"},{default:o(()=>[l(T,{onSubmit:e[13]||(e[13]=M(()=>{},["prevent"]))},{default:o(()=>[l(S,{dense:""},{default:o(()=>[l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.editingItem.id,"onUpdate:modelValue":e[8]||(e[8]=a=>t.editingItem.id=a),"bg-color":"#BDBDBD",label:"ID",readonly:""},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.state.name,"onUpdate:modelValue":e[9]||(e[9]=a=>t.state.name=a),"bg-color":"#BDBDBD",clearable:"","error-messages":t.v$.name.$errors.map(a=>a.$message),label:"Item Name",readonly:t.loading,required:"",onBlur:t.v$.name.$touch,onInput:t.v$.name.$touch},null,8,["modelValue","error-messages","readonly","onBlur","onInput"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(z,{modelValue:t.state.unit,"onUpdate:modelValue":e[10]||(e[10]=a=>t.state.unit=a),"bg-color":"#BDBDBD","error-messages":t.v$.unit.$errors.map(a=>a.$message),"item-title":a=>a?`${a.name??""}${a.shortname?` (${a.shortname})`:""}`:"","item-value":"id",items:t.units,label:"Base Unit",required:"",onBlur:t.v$.unit.$touch,onChange:t.v$.unit.$touch},null,8,["modelValue","error-messages","item-title","items","onBlur","onChange"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.state.human_readable_unit,"onUpdate:modelValue":e[11]||(e[11]=a=>t.state.human_readable_unit=a),"bg-color":"#BDBDBD",hint:"Display unit for better readability",label:"Human Readable Unit","persistent-hint":""},null,8,["modelValue"])]),_:1}),l(b,{cols:"12",sm:"6"},{default:o(()=>[l(V,{modelValue:t.state.conversion_factor,"onUpdate:modelValue":e[12]||(e[12]=a=>t.state.conversion_factor=a),"bg-color":"#BDBDBD",hint:"How many human readable units equal 1 base unit",label:"Conversion Factor","persistent-hint":"",step:"0.000001",type:"number"},{append:o(()=>[s("span",fe," 1 "+n(t.getUnitName(t.state.unit)||"base")+" = "+n(t.state.conversion_factor||0)+" "+n(t.state.human_readable_unit||"human"),1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t.state.human_readable_unit&&t.state.conversion_factor?(w(),h(P,{key:0,border:"start",class:"mt-4",type:"info",variant:"outlined"},{default:o(()=>[e[30]||(e[30]=s("strong",null,"Conversion Preview:",-1)),e[31]||(e[31]=s("br",null,null,-1)),r(" 1 "+n(t.getUnitName(t.state.unit))+" = "+n(t.state.conversion_factor)+" "+n(t.state.human_readable_unit),1),e[32]||(e[32]=s("br",null,null,-1)),r(" 10 "+n(t.getUnitName(t.state.unit))+" = "+n((10*t.state.conversion_factor).toFixed(6))+" "+n(t.state.human_readable_unit),1),e[33]||(e[33]=s("br",null,null,-1)),r(" 100 "+n(t.getUnitName(t.state.unit))+" = "+n((100*t.state.conversion_factor).toFixed(6))+" "+n(t.state.human_readable_unit),1)]),_:1})):I("",!0)]),_:1}),l(oe,{class:"d-flex justify-end justify-space-between"},{default:o(()=>[l(f,{color:"success",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:t.saveEdit},{default:o(()=>[l(g,{start:""},{default:o(()=>e[34]||(e[34]=[r("mdi-content-save")])),_:1}),e[35]||(e[35]=r(" Save "))]),_:1},8,["disabled","loading","onClick"]),l(f,{color:"grey",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[14]||(e[14]=a=>t.editDialog=!1)},{default:o(()=>[l(g,{start:""},{default:o(()=>e[36]||(e[36]=[r("mdi-cancel")])),_:1}),e[37]||(e[37]=r(" Cancel "))]),_:1},8,["disabled","loading"]),l(f,{color:"error",disabled:t.v$.$error,loading:t.loading,size:"large",type:"submit",variant:"elevated",onClick:e[15]||(e[15]=a=>t.confirmDeleteDialog=!0)},{default:o(()=>[l(g,{start:""},{default:o(()=>e[38]||(e[38]=[r("mdi-delete")])),_:1}),e[39]||(e[39]=r(" Delete "))]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(p,{modelValue:t.confirmDeleteDialog,"onUpdate:modelValue":e[19]||(e[19]=a=>t.confirmDeleteDialog=a),persistent:"",width:"auto"},{default:o(()=>[l(N,null,{default:o(()=>[l(U,{color:"warning",title:"Confirm Deleting "+t.state.name},{default:o(()=>[l(f,{color:"white",icon:"mdi-close",onClick:e[17]||(e[17]=a=>t.confirmDeleteDialog=!1)})]),_:1},8,["title"]),l(E,null,{default:o(()=>[r("Are you sure you want to delete "+n(t.state.name)+"?",1)]),_:1}),s("div",ve,[l(f,{color:"grey",onClick:e[18]||(e[18]=a=>t.confirmDeleteDialog=!1)},{default:o(()=>e[40]||(e[40]=[r("Cancel")])),_:1}),l(f,{color:"error",onClick:t.remove},{default:o(()=>e[41]||(e[41]=[r("Proceed")])),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"]),s("div",ge,[e[46]||(e[46]=s("h3",null,"Items",-1)),s("div",ce,[l(f,{class:"text-black",size:"small",onClick:t.csvExport},{default:o(()=>[l(g,{color:"green",start:""},{default:o(()=>e[42]||(e[42]=[r("mdi-download")])),_:1}),e[43]||(e[43]=r(" Download "))]),_:1},8,["onClick"]),l(f,{class:"text-white",color:"#1A237E",size:"small",onClick:t.activateAddDialog},{default:o(()=>[l(g,{start:""},{default:o(()=>e[44]||(e[44]=[r("mdi-plus")])),_:1}),e[45]||(e[45]=r(" Add New "))]),_:1},8,["onClick"])])]),l(Z,{active:t.loading,indeterminate:t.loading},null,8,["active","indeterminate"]),l(ne,{class:"elevation-1",dense:"",headers:t.headers,height:"300",items:t.values,loading:t.loading},{"item.unit":o(({item:a})=>[s("div",be,[s("span",De,n(a.unit),1),a.human_readable_unit?(w(),$("span",Ve," (1 "+n(a.unit)+" = "+n(a.conversion_factor)+" "+n(a.human_readable_unit)+") ",1)):I("",!0)])]),"item.edit":o(({item:a})=>[l(g,{color:"#3F51B5",onClick:x=>t.activateEditDialog(a)},{default:o(()=>e[47]||(e[47]=[r("mdi-square-edit-outline")])),_:2},1032,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1})}const Me=Y(re,[["render",ye]]);export{Me as default};
