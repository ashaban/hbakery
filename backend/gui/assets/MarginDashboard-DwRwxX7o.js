import{E as L}from"./index-B7N-gri4.js";import{_ as dt,r as $,e as w,l as ut,d as ct,s as C,x as e,a2 as pt,v as g,i as a,y as l,H as N,C as n,B as c,O as D,Q as mt,A as T,I as d,E as S,ay as E,R as F,af as W}from"./index-BEY1_AxZ.js";import{V as ft}from"./VContainer-4YzK1OXF.js";import{V as m,b as f}from"./VCard-BWg2kNvx.js";import{V as y}from"./VCol-D55Xswv8.js";import{V as U}from"./VAutocomplete-BZjErokO.js";import{V as P}from"./VChip-B31zWpvD.js";import{a as I}from"./VDataTable-XrgRokO0.js";import{V as O}from"./VSkeletonLoader-B_7LBbGf.js";import{u as vt,i as gt,c as _t,b as yt,a as xt,d as bt,e as ht,f as wt,g as St}from"./install-DoKjw2Sc.js";import"./VTextField-CUtfiNtd.js";import"./VSlideGroup-BBNvX3-_.js";import"./dialog-transition-CW_75ERn.js";const kt={class:"d-flex align-center justify-space-between"},Pt={class:"d-flex align-center mb-4"},Vt={class:"d-flex align-center mb-2"},$t={class:"d-flex align-center mb-2"},Ct={class:"d-flex align-center mb-2"},zt={class:"d-flex align-center mb-2"},Lt={class:"d-flex justify-space-between align-center"},Dt={class:"text-caption text-grey"},Et={class:"d-flex gap-2"},Ft={class:"d-flex align-center"},At={class:"text-h5 font-weight-bold text-green"},Tt={class:"text-caption text-green"},It={class:"d-flex align-center"},Ot={class:"text-h5 font-weight-bold text-red"},Mt={class:"text-caption text-red"},Rt={class:"d-flex align-center"},Nt={class:"text-h5 font-weight-bold text-blue"},jt={class:"text-caption text-blue"},qt={class:"d-flex align-center"},Bt={class:"text-h5 font-weight-bold text-orange"},Qt={class:"text-caption text-orange"},Wt={class:"d-flex align-center mb-4"},Ut={key:1,class:"text-center py-8"},Ht={key:2,class:"text-center py-8 text-grey"},Kt={class:"d-flex align-center mb-4"},Zt={key:1,class:"text-center py-8"},Gt={key:2,class:"text-center py-8 text-grey"},Jt={class:"d-flex align-center mb-4"},Xt={key:1,class:"text-center py-8"},Yt={key:2,class:"text-center py-8 text-grey"},te={class:"d-flex align-center mb-4"},ee={key:1,class:"text-center py-8"},ae={key:2,class:"text-center py-8 text-grey"},le={class:"d-flex align-center mb-4"},oe={key:1,class:"text-center py-8"},se={key:2,class:"text-center py-8 text-grey"},re={class:"d-flex align-center mb-4"},ie={key:1,class:"text-center py-8"},ne={key:2,class:"text-center py-8 text-grey"},de={class:"d-flex align-center justify-space-between mb-4"},ue={class:"d-flex align-center"},ce={class:"font-weight-medium"},pe={class:"font-weight-medium text-green"},me={class:"font-weight-medium text-green"},fe={class:"d-flex align-center justify-space-between mb-4"},ve={class:"d-flex align-center"},ge={class:"font-weight-medium"},_e={class:"text-caption"},ye={class:"font-weight-medium text-blue"},xe={class:"d-flex align-center justify-space-between mb-4"},be={class:"d-flex align-center"},he={class:"font-weight-medium"},we={class:"font-weight-medium text-red"},Se={class:"text-caption text-white"},ke={class:"d-flex align-center justify-space-between mb-4"},Pe={class:"d-flex align-center"},Ve={class:"d-flex gap-2"},$e={class:"font-weight-medium"},Ce={class:"font-weight-medium text-deep-purple"},ze={class:"text-caption"},Le={class:"text-caption text-white"},De={__name:"MarginDashboard",setup(Ee){vt([gt,_t,yt,xt,bt,ht,wt,St]);const v=$(!1),j=$([]),q=$([]),x=$({}),_=$({}),V=$({}),b=$({}),h=$({start_date:new Date().toISOString().split("T")[0].replace(/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-01"),end_date:new Date().toISOString().split("T")[0],product_id:null,outlet_id:null}),H=[{title:"Product",key:"product_name",sortable:!0},{title:"Quantity",key:"total_qty",sortable:!0,align:"center"},{title:"Total Sales",key:"total_sales",sortable:!0,align:"end"},{title:"Paid Amount",key:"total_paid",sortable:!0,align:"end"},{title:"Payment Rate",key:"payment_rate",sortable:!0,align:"center"}],K=[{title:"Ingredient",key:"ingredient_name",sortable:!0},{title:"Quantity Used",key:"total_consumed",sortable:!0,align:"center"},{title:"Avg Price",key:"avg_price",sortable:!0,align:"end"},{title:"Total Cost",key:"total_cost",sortable:!0,align:"end"}],Z=[{title:"Expenditure Type",key:"type_name",sortable:!0},{title:"Total Amount",key:"total_amount",sortable:!0,align:"end"},{title:"Percentage",key:"percentage",sortable:!0,align:"center",width:"200px"}],G=[{title:"Product",key:"product_name",sortable:!0},{title:"Quantity Lost",key:"total_qty",sortable:!0,align:"center"},{title:"Total Cost Value",key:"total_cost_value",sortable:!0,align:"end"},{title:"Avg Cost/Unit",key:"avg_cost_per_unit",sortable:!0,align:"end"},{title:"Events Count",key:"out_events_count",sortable:!0,align:"center"},{title:"% of Total Loss",key:"percentage_of_total",sortable:!0,align:"center",width:"200px"}],B=w(()=>b.value.data&&b.value.data.length>0),A=w(()=>{const r=x.value.total_sales_amount||0,t=_.value.totalExpenditure||0,o=V.value.totalIngredientCost||0;return r-t-o}),M=w(()=>{const r=x.value.total_sales_amount||0;return r===0?0:(A.value/r*100).toFixed(1)}),Q=w(()=>x.value.total_sales_amount>0||_.value.totalExpenditure>0||V.value.totalIngredientCost>0),J=w(()=>x.value.data&&x.value.data.length>0),X=w(()=>_.value.data&&_.value.data.length>0),Y=w(()=>{var t;const r=((t=b.value.data)==null?void 0:t.slice().sort((o,s)=>s.total_cost_value-o.total_cost_value))||[];return{title:{text:"Product Loss by Cost Value",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:o=>{const s=o[0],i=r[s.dataIndex];return`
          <b>${i.product_name}</b><br/>
          Loss Value: ${u(i.total_cost_value)}<br/>
          Quantity: ${i.total_qty} units<br/>
          Events: ${i.out_events_count}<br/>
          Avg Cost: ${u(i.avg_cost_per_unit)}/unit
        `}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"value",axisLabel:{formatter:o=>o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(0)+"K":o}},yAxis:{type:"category",data:r.map(o=>o.product_name),axisLabel:{fontSize:10}},series:[{name:"Loss Value",type:"bar",data:r.map(o=>o.total_cost_value),itemStyle:{color:"#7E57C2"},label:{show:!0,position:"right",formatter:o=>u(o.value)}}]}}),tt=w(()=>{var t;const r=((t=b.value.data)==null?void 0:t.map(o=>({name:o.product_name,value:o.total_qty})))||[];return{title:{text:"Product Loss by Quantity",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:o=>{var i;const s=(i=b.value.data)==null?void 0:i.find(p=>p.product_name===o.name);return`
          <b>${o.name}</b><br/>
          Quantity: ${o.value} units<br/>
          Value: ${u((s==null?void 0:s.total_cost_value)||0)}<br/>
          ${o.percent}% of total loss
        `}},legend:{orient:"vertical",right:10,top:"center",formatter:o=>{var i;const s=(i=b.value.data)==null?void 0:i.find(p=>p.product_name===o);return s?`${o}
${s.total_qty} units`:o},textStyle:{fontSize:10}},series:[{name:"Loss Quantity",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold",formatter:o=>`${o.name}
${o.value} units
${o.percent}%`}},labelLine:{show:!1},data:r}]}}),et=w(()=>{const r=x.value.total_sales_amount||0,t=_.value.totalExpenditure||0,o=V.value.totalIngredientCost||0,s=A.value;return{title:{text:"Financial Performance Overview",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:i=>{let p="<b>Financial Overview</b><br/>";return i.forEach(k=>{p+=`${k.marker} ${k.seriesName}: ${u(k.value)}<br/>`}),p}},legend:{data:["Sales Revenue","Total Expenditure","Production Cost","Profit Margin"],top:"10%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},xAxis:{type:"category",data:["Performance"],axisLabel:{fontSize:12}},yAxis:{type:"value",axisLabel:{formatter:i=>i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(0)+"K":i}},series:[{name:"Sales Revenue",type:"bar",data:[r],itemStyle:{color:"#4CAF50"},label:{show:!0,position:"top",formatter:i=>u(i.value)}},{name:"Total Expenditure",type:"bar",data:[t],itemStyle:{color:"#F44336"},label:{show:!0,position:"top",formatter:i=>u(i.value)}},{name:"Production Cost",type:"bar",data:[o],itemStyle:{color:"#2196F3"},label:{show:!0,position:"top",formatter:i=>u(i.value)}},{name:"Profit Margin",type:"bar",data:[s],itemStyle:{color:s>=0?"#FF9800":"#FF5722"},label:{show:!0,position:"top",formatter:i=>u(i.value)}}]}}),at=w(()=>{const r=parseFloat(M.value);return{title:{text:"Profit Margin %",left:"center",top:"10%",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{formatter:"Profit Margin: {c}%"},series:[{type:"gauge",center:["50%","60%"],startAngle:180,endAngle:0,min:-50,max:50,splitNumber:10,itemStyle:{color:r>=0?"#FF9800":"#FF5722"},progress:{show:!0,width:30},pointer:{show:!1},axisLine:{lineStyle:{width:30,color:[[.3,"#FF6B6B"],[.7,"#FFE66D"],[1,"#4ECDC4"]]}},axisTick:{distance:-45,splitNumber:5,lineStyle:{width:2,color:"#999"}},splitLine:{distance:-52,length:14,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:-20,color:"#999",fontSize:12},anchor:{show:!1},title:{show:!1},detail:{valueAnimation:!0,width:"60%",lineHeight:40,borderRadius:8,offsetCenter:[0,"-15%"],fontSize:30,fontWeight:"bolder",formatter:"{value}%",color:"inherit"},data:[{value:r}]}]}}),lt=w(()=>{var t;const r=((t=_.value.data)==null?void 0:t.map(o=>({name:o.type_name,value:o.total_amount})))||[];return{title:{text:"Expenditure Distribution",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"item",formatter:o=>`
          <b>${o.name}</b><br/>
          ${o.marker} ${u(o.value)}<br/>
          ${o.percent}%
        `},legend:{orient:"vertical",right:10,top:"center",formatter:o=>{var i;const s=(i=_.value.data)==null?void 0:i.find(p=>p.type_name===o);return s?`${o}
${u(s.total_amount)}`:o},textStyle:{fontSize:10}},series:[{name:"Expenditure",type:"pie",radius:["40%","70%"],center:["40%","50%"],avoidLabelOverlap:!1,itemStyle:{borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold",formatter:o=>`${o.name}
${u(o.value)}
${o.percent}%`}},labelLine:{show:!1},data:r}]}}),ot=w(()=>{var t;const r=((t=x.value.data)==null?void 0:t.slice().sort((o,s)=>s.total_sales-o.total_sales).slice(0,8))||[];return{title:{text:"Top Selling Products",left:"center",textStyle:{fontSize:16,fontWeight:"bold"}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:o=>{const s=o[0],i=r[s.dataIndex];return`
          <b>${i.product_name}</b><br/>
          Sales: ${u(i.total_sales)}<br/>
          Quantity: ${i.total_qty}<br/>
          Paid: ${u(i.total_paid)}<br/>
          Payment Rate: ${i.payment_rate}%
        `}},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"value",axisLabel:{formatter:o=>o>=1e6?(o/1e6).toFixed(1)+"M":o>=1e3?(o/1e3).toFixed(0)+"K":o}},yAxis:{type:"category",data:r.map(o=>o.product_name),axisLabel:{fontSize:10}},series:[{name:"Sales Amount",type:"bar",data:r.map(o=>o.total_sales),itemStyle:{color:"#4CAF50"},label:{show:!0,position:"right",formatter:o=>u(o.value)}}]}});function u(r){return r?new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(r):"TZS 0"}function st(r){return r>=90?"green":r>=75?"orange":"red"}function rt(){h.value={start_date:new Date().toISOString().split("T")[0].replace(/(\d{4})-(\d{2})-(\d{2})/,"$1-$2-01"),end_date:new Date().toISOString().split("T")[0],product_id:null,outlet_id:null},R()}async function R(){v.value=!0;try{const r=new URLSearchParams;Object.entries(h.value).forEach(([p,k])=>{k&&r.append(p,k)});const[t,o,s,i]=await Promise.all([fetch(`/reports/salesByProduct?${r}`),fetch(`/reports/expenditureByType?${r}`),fetch(`/reports/productionIngredientsCost?${r}`),fetch(`/reports/giveOutByProduct?${r}`)]);if(!t.ok)throw new Error("Sales API failed");if(!o.ok)throw new Error("Expenditure API failed");if(!s.ok)throw new Error("Production API failed");if(!i.ok)throw new Error("Product Loss API failed");if(x.value=await t.json(),_.value=await o.json(),V.value=await s.json(),b.value=await i.json(),_.value.data){const p=_.value.totalExpenditure;_.value.data.forEach(k=>{k.percentage=p>0?k.total_amount/p*100:0})}if(x.value.data&&x.value.data.forEach(p=>{p.payment_rate=p.total_sales>0?Math.round(p.total_paid/p.total_sales*100):0}),b.value.data){const p=b.value.total_out_value||0,k=b.value.total_out_qty||0;b.value.data.forEach(z=>{z.avg_cost_per_unit=z.total_qty>0?z.total_cost_value/z.total_qty:0,z.percentage_of_total=p>0?z.total_cost_value/p*100:0})}}catch(r){console.error("Failed to load dashboard data:",r)}finally{v.value=!1}}function it(){const r={filters:h.value,sales:x.value,expenditure:_.value,production:V.value,profitMargin:A.value,profitMarginPercentage:M.value},t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(r,null,2)),o=document.createElement("a");o.setAttribute("href",t),o.setAttribute("download",`dashboard-export-${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(o),o.click(),o.remove()}async function nt(){try{const[r,t]=await Promise.all([fetch("/products?limit=1000"),fetch("/outlets?limit=1000")]);if(r.ok){const o=await r.json();j.value=o.data||[]}if(t.ok){const o=await t.json();q.value=o.data||[]}}catch(r){console.error("Failed to load reference data:",r)}}return ut(async()=>{await nt(),await R()}),ct(()=>[...Object.values(h.value)],()=>{},{deep:!0}),(r,t)=>{const o=pt("VueDatePicker");return g(),C(ft,{class:"dashboard-container",fluid:""},{default:e(()=>[a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-6"},{default:e(()=>[l("div",kt,[t[6]||(t[6]=l("div",null,[l("h1",{class:"text-h4 font-weight-bold text-primary mb-2"}," Bakery Dashboard "),l("p",{class:"text-body-1 text-grey"}," Comprehensive overview of sales, expenditures, and production performance ")],-1)),a(N,{class:"px-6",color:"primary",elevation:"2",size:"large",onClick:it},{default:e(()=>[a(c,{size:"20",start:""},{default:e(()=>t[4]||(t[4]=[n("mdi-file-export")])),_:1}),t[5]||(t[5]=n(" Export Report "))]),_:1})])]),_:1})]),_:1}),a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-6"},{default:e(()=>[l("div",Pt,[a(c,{class:"mr-2",color:"primary"},{default:e(()=>t[7]||(t[7]=[n("mdi-filter")])),_:1}),t[8]||(t[8]=l("h3",{class:"text-h6 font-weight-medium"},"Dashboard Filters",-1))]),a(D,{dense:""},{default:e(()=>[a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[l("div",Vt,[a(c,{class:"mr-2",color:"green",size:"18"},{default:e(()=>t[9]||(t[9]=[n("mdi-calendar")])),_:1}),t[10]||(t[10]=l("label",{class:"text-caption font-weight-medium text-primary"},"Start Date",-1))]),a(o,{modelValue:h.value.start_date,"onUpdate:modelValue":t[0]||(t[0]=s=>h.value.start_date=s),"auto-apply":"",format:"yyyy-MM-dd","model-type":"format",placeholder:"Start Date",teleport:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[l("div",$t,[a(c,{class:"mr-2",color:"red",size:"18"},{default:e(()=>t[11]||(t[11]=[n("mdi-calendar")])),_:1}),t[12]||(t[12]=l("label",{class:"text-caption font-weight-medium text-primary"},"End Date",-1))]),a(o,{modelValue:h.value.end_date,"onUpdate:modelValue":t[1]||(t[1]=s=>h.value.end_date=s),"auto-apply":"",format:"yyyy-MM-dd","model-type":"format",placeholder:"End Date",teleport:!0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[l("div",Ct,[a(c,{class:"mr-2",color:"blue",size:"18"},{default:e(()=>t[13]||(t[13]=[n("mdi-package-variant")])),_:1}),t[14]||(t[14]=l("label",{class:"text-caption font-weight-medium text-primary"},"Product",-1))]),a(U,{modelValue:h.value.product_id,"onUpdate:modelValue":t[2]||(t[2]=s=>h.value.product_id=s),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:j.value,placeholder:"All Products",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3"},{default:e(()=>[a(m,{border:"",class:"rounded-lg",variant:"outlined"},{default:e(()=>[a(f,{class:"pa-3"},{default:e(()=>[l("div",zt,[a(c,{class:"mr-2",color:"purple",size:"18"},{default:e(()=>t[15]||(t[15]=[n("mdi-store")])),_:1}),t[16]||(t[16]=l("label",{class:"text-caption font-weight-medium text-primary"},"Outlet",-1))]),a(U,{modelValue:h.value.outlet_id,"onUpdate:modelValue":t[3]||(t[3]=s=>h.value.outlet_id=s),clearable:"",color:"primary",density:"compact","hide-details":"","item-title":"name","item-value":"id",items:q.value,placeholder:"All Outlets",variant:"underlined"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),a(mt,{class:"my-4"}),l("div",Lt,[l("div",Dt,[a(c,{class:"mr-1",size:"14"},{default:e(()=>t[17]||(t[17]=[n("mdi-information")])),_:1}),t[18]||(t[18]=n(" Apply filters to update dashboard data "))]),l("div",Et,[a(N,{class:"px-4",color:"grey",size:"small",variant:"outlined",onClick:rt},{default:e(()=>[a(c,{size:"18",start:""},{default:e(()=>t[19]||(t[19]=[n("mdi-refresh")])),_:1}),t[20]||(t[20]=n(" Reset "))]),_:1}),a(N,{class:"px-4",color:"primary",elevation:"2",loading:v.value,size:"small",onClick:R},{default:e(()=>[a(c,{size:"18",start:""},{default:e(()=>t[21]||(t[21]=[n("mdi-chart-bar")])),_:1}),t[22]||(t[22]=n(" Apply Filters "))]),_:1},8,["loading"])])])]),_:1})]),_:1}),a(D,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",Ft,[a(T,{class:"mr-3",color:"green-lighten-5",size:"48"},{default:e(()=>[a(c,{color:"green",size:"24"},{default:e(()=>t[23]||(t[23]=[n("mdi-cash")])),_:1})]),_:1}),l("div",null,[l("div",At,d(u(x.value.total_sales_amount||0)),1),t[24]||(t[24]=l("div",{class:"text-caption text-grey"},"Total Sales",-1)),l("div",Tt,d(u(x.value.total_paid_amount||0))+" Paid ",1)])])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>{var s;return[l("div",It,[a(T,{class:"mr-3",color:"red-lighten-5",size:"48"},{default:e(()=>[a(c,{color:"red",size:"24"},{default:e(()=>t[25]||(t[25]=[n("mdi-cash-remove")])),_:1})]),_:1}),l("div",null,[l("div",Ot,d(u(_.value.totalExpenditure||0)),1),t[26]||(t[26]=l("div",{class:"text-caption text-grey"},"Total Expenditure",-1)),l("div",Mt,d(((s=_.value.data)==null?void 0:s.length)||0)+" Categories ",1)])])]}),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>{var s;return[l("div",Rt,[a(T,{class:"mr-3",color:"blue-lighten-5",size:"48"},{default:e(()=>[a(c,{color:"blue",size:"24"},{default:e(()=>t[27]||(t[27]=[n("mdi-factory")])),_:1})]),_:1}),l("div",null,[l("div",Nt,d(u(V.value.totalIngredientCost||0)),1),t[28]||(t[28]=l("div",{class:"text-caption text-grey"},"Production Cost",-1)),l("div",jt,d(((s=V.value.data)==null?void 0:s.length)||0)+" Ingredients ",1)])])]}),_:1})]),_:1})]),_:1}),a(y,{cols:"12",md:"3",sm:"6"},{default:e(()=>[a(m,{border:"",class:"kpi-card",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",qt,[a(T,{class:"mr-3",color:"orange-lighten-5",size:"48"},{default:e(()=>[a(c,{color:"orange",size:"24"},{default:e(()=>t[29]||(t[29]=[n("mdi-chart-line")])),_:1})]),_:1}),l("div",null,[l("div",Bt,d(u(A.value)),1),t[30]||(t[30]=l("div",{class:"text-caption text-grey"},"Profit Margin",-1)),l("div",Qt,d(M.value)+"% ",1)])])]),_:1})]),_:1})]),_:1})]),_:1}),a(D,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"8"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",Wt,[a(c,{class:"mr-2",color:"primary"},{default:e(()=>t[31]||(t[31]=[n("mdi-chart-bar")])),_:1}),t[32]||(t[32]=l("h4",{class:"text-h6 font-weight-medium"}," Cost vs Revenue Analysis ",-1))]),!v.value&&Q.value?(g(),C(E(L),{key:0,option:et.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",Ut,[a(F,{color:"primary",indeterminate:""}),t[33]||(t[33]=l("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",Ht," No data available for the selected period "))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"4"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",Kt,[a(c,{class:"mr-2",color:"orange"},{default:e(()=>t[34]||(t[34]=[n("mdi-gauge")])),_:1}),t[35]||(t[35]=l("h4",{class:"text-h6 font-weight-medium"},"Profit Margin",-1))]),!v.value&&Q.value?(g(),C(E(L),{key:0,option:at.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",Zt,[a(F,{color:"orange",indeterminate:""}),t[36]||(t[36]=l("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",Gt," No data available for the selected period "))]),_:1})]),_:1})]),_:1})]),_:1}),a(D,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",Jt,[a(c,{class:"mr-2",color:"red"},{default:e(()=>t[37]||(t[37]=[n("mdi-chart-pie")])),_:1}),t[38]||(t[38]=l("h4",{class:"text-h6 font-weight-medium"},"Expenditure Breakdown",-1))]),!v.value&&X.value?(g(),C(E(L),{key:0,option:lt.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",Xt,[a(F,{color:"red",indeterminate:""}),t[39]||(t[39]=l("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",Yt," No expenditure data available "))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",te,[a(c,{class:"mr-2",color:"green"},{default:e(()=>t[40]||(t[40]=[n("mdi-chart-bar")])),_:1}),t[41]||(t[41]=l("h4",{class:"text-h6 font-weight-medium"},"Top Selling Products",-1))]),!v.value&&J.value?(g(),C(E(L),{key:0,option:ot.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",ee,[a(F,{color:"green",indeterminate:""}),t[42]||(t[42]=l("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",ae," No sales data available "))]),_:1})]),_:1})]),_:1})]),_:1}),a(D,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",le,[a(c,{class:"mr-2",color:"deep-purple"},{default:e(()=>t[43]||(t[43]=[n("mdi-chart-bar")])),_:1}),t[44]||(t[44]=l("h4",{class:"text-h6 font-weight-medium"},"Product Loss by Value",-1))]),!v.value&&B.value?(g(),C(E(L),{key:0,option:Y.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",oe,[a(F,{color:"deep-purple",indeterminate:""}),t[45]||(t[45]=l("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",se," No product loss data available "))]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",re,[a(c,{class:"mr-2",color:"deep-purple"},{default:e(()=>t[46]||(t[46]=[n("mdi-chart-pie")])),_:1}),t[47]||(t[47]=l("h4",{class:"text-h6 font-weight-medium"}," Product Loss by Quantity ",-1))]),!v.value&&B.value?(g(),C(E(L),{key:0,option:tt.value,style:{height:"400px",width:"100%"}},null,8,["option"])):v.value?(g(),S("div",ie,[a(F,{color:"deep-purple",indeterminate:""}),t[48]||(t[48]=l("div",{class:"mt-2 text-caption text-grey"}," Loading chart data... ",-1))])):(g(),S("div",ne," No product loss data available "))]),_:1})]),_:1})]),_:1})]),_:1}),a(D,{class:"mb-6"},{default:e(()=>[a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",de,[l("div",ue,[a(c,{class:"mr-2",color:"green"},{default:e(()=>t[49]||(t[49]=[n("mdi-cash-multiple")])),_:1}),t[50]||(t[50]=l("h4",{class:"text-h6 font-weight-medium"},"Sales by Product",-1))]),a(P,{color:"green",size:"small",variant:"flat"},{default:e(()=>{var s;return[n(d(((s=x.value.data)==null?void 0:s.length)||0)+" Products ",1)]}),_:1})]),a(I,{density:"comfortable",headers:H,"hide-default-footer":"",items:x.value.data||[],loading:v.value},{loading:e(()=>[a(O,{type:"table-row@5"})]),"item.product_name":e(({item:s})=>[l("div",ce,d(s.product_name),1)]),"item.total_qty":e(({item:s})=>[a(P,{color:"blue",size:"small",variant:"outlined"},{default:e(()=>[n(d(s.total_qty),1)]),_:2},1024)]),"item.total_sales":e(({item:s})=>[l("div",pe,d(u(s.total_sales)),1)]),"item.total_paid":e(({item:s})=>[l("div",me,d(u(s.total_paid)),1)]),"item.payment_rate":e(({item:s})=>[a(P,{color:st(s.payment_rate),size:"small",variant:"flat"},{default:e(()=>[n(d(s.payment_rate)+"% ",1)]),_:2},1032,["color"])]),"no-data":e(()=>t[51]||(t[51]=[l("div",{class:"text-center py-4 text-grey"}," No sales data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1}),a(y,{cols:"12",lg:"6"},{default:e(()=>[a(m,{class:"rounded-lg",elevation:"2"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",fe,[l("div",ve,[a(c,{class:"mr-2",color:"blue"},{default:e(()=>t[52]||(t[52]=[n("mdi-ingredient")])),_:1}),t[53]||(t[53]=l("h4",{class:"text-h6 font-weight-medium"}," Production Ingredients Cost ",-1))]),a(P,{color:"blue",size:"small",variant:"flat"},{default:e(()=>{var s;return[n(d(((s=V.value.data)==null?void 0:s.length)||0)+" Ingredients ",1)]}),_:1})]),a(I,{density:"comfortable",headers:K,"hide-default-footer":"",items:V.value.data||[],loading:v.value},{loading:e(()=>[a(O,{type:"table-row@5"})]),"item.ingredient_name":e(({item:s})=>[l("div",ge,d(s.ingredient_name),1)]),"item.total_consumed":e(({item:s})=>[a(P,{color:"blue-grey",size:"small",variant:"outlined"},{default:e(()=>[n(d(s.total_consumed),1)]),_:2},1024)]),"item.avg_price":e(({item:s})=>[l("div",_e,d(u(s.avg_price)),1)]),"item.total_cost":e(({item:s})=>[l("div",ye,d(u(s.total_cost)),1)]),"no-data":e(()=>t[54]||(t[54]=[l("div",{class:"text-center py-4 text-grey"}," No production data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1})]),_:1}),a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",xe,[l("div",be,[a(c,{class:"mr-2",color:"red"},{default:e(()=>t[55]||(t[55]=[n("mdi-cash-remove")])),_:1}),t[56]||(t[56]=l("h4",{class:"text-h6 font-weight-medium"},"Expenditure by Type",-1))]),a(P,{color:"red",size:"small",variant:"flat"},{default:e(()=>[n(" Total: "+d(u(_.value.totalExpenditure||0)),1)]),_:1})]),a(I,{density:"comfortable",headers:Z,"hide-default-footer":"",items:_.value.data||[],loading:v.value},{loading:e(()=>[a(O,{type:"table-row@5"})]),"item.type_name":e(({item:s})=>[l("div",he,d(s.type_name),1)]),"item.total_amount":e(({item:s})=>[l("div",we,d(u(s.total_amount)),1)]),"item.percentage":e(({item:s})=>[a(W,{color:"red",height:"8","model-value":s.percentage,rounded:""},{default:e(()=>[l("span",Se,d(s.percentage.toFixed(1))+"%",1)]),_:2},1032,["model-value"])]),"no-data":e(()=>t[57]||(t[57]=[l("div",{class:"text-center py-4 text-grey"}," No expenditure data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1}),a(m,{class:"mb-6",elevation:"2",rounded:"lg"},{default:e(()=>[a(f,{class:"pa-4"},{default:e(()=>[l("div",ke,[l("div",Pe,[a(c,{class:"mr-2",color:"deep-purple"},{default:e(()=>t[58]||(t[58]=[n("mdi-archive-alert")])),_:1}),t[59]||(t[59]=l("h4",{class:"text-h6 font-weight-medium"},"Product Loss Details",-1))]),l("div",Ve,[a(P,{color:"deep-purple",size:"small",variant:"flat"},{default:e(()=>[n(" Total Value: "+d(u(b.value.total_out_value||0)),1)]),_:1}),a(P,{color:"deep-purple",size:"small",variant:"outlined"},{default:e(()=>[n(d(b.value.total_out_qty||0)+" Units ",1)]),_:1})])]),a(I,{density:"comfortable",headers:G,"hide-default-footer":"",items:b.value.data||[],loading:v.value},{loading:e(()=>[a(O,{type:"table-row@5"})]),"item.product_name":e(({item:s})=>[l("div",$e,d(s.product_name),1)]),"item.total_qty":e(({item:s})=>[a(P,{color:"deep-purple",size:"small",variant:"outlined"},{default:e(()=>[n(d(s.total_qty),1)]),_:2},1024)]),"item.total_cost_value":e(({item:s})=>[l("div",Ce,d(u(s.total_cost_value)),1)]),"item.out_events_count":e(({item:s})=>[a(P,{color:"orange",size:"small",variant:"outlined"},{default:e(()=>[n(d(s.out_events_count)+" events ",1)]),_:2},1024)]),"item.avg_cost_per_unit":e(({item:s})=>[l("div",ze,d(u(s.avg_cost_per_unit)),1)]),"item.percentage_of_total":e(({item:s})=>[a(W,{color:"deep-purple",height:"8","model-value":s.percentage_of_total,rounded:""},{default:e(()=>[l("span",Le,d(s.percentage_of_total.toFixed(1))+"%",1)]),_:2},1032,["model-value"])]),"no-data":e(()=>t[60]||(t[60]=[l("div",{class:"text-center py-4 text-grey"}," No product loss data available for the selected period ",-1)])),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1})}}},Ue=dt(De,[["__scopeId","data-v-55558159"]]);export{Ue as default};
